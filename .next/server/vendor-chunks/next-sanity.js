/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/next-sanity";
exports.ids = ["vendor-chunks/next-sanity"];
exports.modules = {

/***/ "(ssr)/./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js":
/*!************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js ***!
  \************************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @lightSyntaxTransform\n * @noflow\n * @nolint\n * @preventMunge\n * @preserve-invariant-messages\n */\n\n\"use no memo\";\n\"use strict\";\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n  // If the importer is in node compatibility mode or this is not an ESM\n  // file that has been converted to a CommonJS file using a Babel-\n  // compatible transform (i.e. \"__esModule\" has not been set), then set\n  // \"default\" to the CommonJS \"module.exports\" for node compatibility.\n  isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", { value: mod, enumerable: true }) : target,\n  mod\n));\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\n\n// src/index.ts\nvar index_exports = {};\n__export(index_exports, {\n  $dispatcherGuard: () => $dispatcherGuard,\n  $makeReadOnly: () => $makeReadOnly,\n  $reset: () => $reset,\n  $structuralCheck: () => $structuralCheck,\n  c: () => c,\n  clearRenderCounterRegistry: () => clearRenderCounterRegistry,\n  renderCounterRegistry: () => renderCounterRegistry,\n  useRenderCounter: () => useRenderCounter\n});\nmodule.exports = __toCommonJS(index_exports);\nvar React = __toESM(__webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\"));\nvar { useRef, useEffect, isValidElement } = React;\nvar _a;\nvar ReactSecretInternals = (\n  //@ts-ignore\n  (_a = React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE) != null ? _a : React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n);\nvar $empty = Symbol.for(\"react.memo_cache_sentinel\");\nvar _a2;\nvar c = (\n  // @ts-expect-error\n  typeof ((_a2 = React.__COMPILER_RUNTIME) == null ? void 0 : _a2.c) === \"function\" ? (\n    // @ts-expect-error\n    React.__COMPILER_RUNTIME.c\n  ) : function c2(size) {\n    return React.useMemo(() => {\n      const $ = new Array(size);\n      for (let ii = 0; ii < size; ii++) {\n        $[ii] = $empty;\n      }\n      $[$empty] = true;\n      return $;\n    }, []);\n  }\n);\nvar LazyGuardDispatcher = {};\n[\n  \"readContext\",\n  \"useCallback\",\n  \"useContext\",\n  \"useEffect\",\n  \"useImperativeHandle\",\n  \"useInsertionEffect\",\n  \"useLayoutEffect\",\n  \"useMemo\",\n  \"useReducer\",\n  \"useRef\",\n  \"useState\",\n  \"useDebugValue\",\n  \"useDeferredValue\",\n  \"useTransition\",\n  \"useMutableSource\",\n  \"useSyncExternalStore\",\n  \"useId\",\n  \"unstable_isNewReconciler\",\n  \"getCacheSignal\",\n  \"getCacheForType\",\n  \"useCacheRefresh\"\n].forEach((name) => {\n  LazyGuardDispatcher[name] = () => {\n    throw new Error(\n      `[React] Unexpected React hook call (${name}) from a React compiled function. Check that all hooks are called directly and named according to convention ('use[A-Z]') `\n    );\n  };\n});\nvar originalDispatcher = null;\nLazyGuardDispatcher[\"useMemoCache\"] = (count) => {\n  if (originalDispatcher == null) {\n    throw new Error(\n      \"React Compiler internal invariant violation: unexpected null dispatcher\"\n    );\n  } else {\n    return originalDispatcher.useMemoCache(count);\n  }\n};\nfunction setCurrent(newDispatcher) {\n  ReactSecretInternals.ReactCurrentDispatcher.current = newDispatcher;\n  return ReactSecretInternals.ReactCurrentDispatcher.current;\n}\nvar guardFrames = [];\nfunction $dispatcherGuard(kind) {\n  const curr = ReactSecretInternals.ReactCurrentDispatcher.current;\n  if (kind === 0 /* PushGuardContext */) {\n    guardFrames.push(curr);\n    if (guardFrames.length === 1) {\n      originalDispatcher = curr;\n    }\n    if (curr === LazyGuardDispatcher) {\n      throw new Error(\n        `[React] Unexpected call to custom hook or component from a React compiled function. Check that (1) all hooks are called directly and named according to convention ('use[A-Z]') and (2) components are returned as JSX instead of being directly invoked.`\n      );\n    }\n    setCurrent(LazyGuardDispatcher);\n  } else if (kind === 1 /* PopGuardContext */) {\n    const lastFrame = guardFrames.pop();\n    if (lastFrame == null) {\n      throw new Error(\n        \"React Compiler internal error: unexpected null in guard stack\"\n      );\n    }\n    if (guardFrames.length === 0) {\n      originalDispatcher = null;\n    }\n    setCurrent(lastFrame);\n  } else if (kind === 2 /* PushExpectHook */) {\n    guardFrames.push(curr);\n    setCurrent(originalDispatcher);\n  } else if (kind === 3 /* PopExpectHook */) {\n    const lastFrame = guardFrames.pop();\n    if (lastFrame == null) {\n      throw new Error(\n        \"React Compiler internal error: unexpected null in guard stack\"\n      );\n    }\n    setCurrent(lastFrame);\n  } else {\n    throw new Error(\"React Compiler internal error: unreachable block\" + kind);\n  }\n}\nfunction $reset($) {\n  for (let ii = 0; ii < $.length; ii++) {\n    $[ii] = $empty;\n  }\n}\nfunction $makeReadOnly() {\n  throw new Error(\"TODO: implement $makeReadOnly in react-compiler-runtime\");\n}\nvar renderCounterRegistry = /* @__PURE__ */ new Map();\nfunction clearRenderCounterRegistry() {\n  for (const counters of renderCounterRegistry.values()) {\n    counters.forEach((counter) => {\n      counter.count = 0;\n    });\n  }\n}\nfunction registerRenderCounter(name, val) {\n  let counters = renderCounterRegistry.get(name);\n  if (counters == null) {\n    counters = /* @__PURE__ */ new Set();\n    renderCounterRegistry.set(name, counters);\n  }\n  counters.add(val);\n}\nfunction removeRenderCounter(name, val) {\n  const counters = renderCounterRegistry.get(name);\n  if (counters == null) {\n    return;\n  }\n  counters.delete(val);\n}\nfunction useRenderCounter(name) {\n  const val = useRef(null);\n  if (val.current != null) {\n    val.current.count += 1;\n  }\n  useEffect(() => {\n    if (val.current == null) {\n      const counter = { count: 0 };\n      registerRenderCounter(name, counter);\n      val.current = counter;\n    }\n    return () => {\n      if (val.current !== null) {\n        removeRenderCounter(name, val.current);\n      }\n    };\n  });\n}\nvar seenErrors = /* @__PURE__ */ new Set();\nfunction $structuralCheck(oldValue, newValue, variableName, fnName, kind, loc) {\n  function error(l, r, path, depth) {\n    const str = `${fnName}:${loc} [${kind}] ${variableName}${path} changed from ${l} to ${r} at depth ${depth}`;\n    if (seenErrors.has(str)) {\n      return;\n    }\n    seenErrors.add(str);\n    console.error(str);\n  }\n  const depthLimit = 2;\n  function recur(oldValue2, newValue2, path, depth) {\n    if (depth > depthLimit) {\n      return;\n    } else if (oldValue2 === newValue2) {\n      return;\n    } else if (typeof oldValue2 !== typeof newValue2) {\n      error(`type ${typeof oldValue2}`, `type ${typeof newValue2}`, path, depth);\n    } else if (typeof oldValue2 === \"object\") {\n      const oldArray = Array.isArray(oldValue2);\n      const newArray = Array.isArray(newValue2);\n      if (oldValue2 === null && newValue2 !== null) {\n        error(\"null\", `type ${typeof newValue2}`, path, depth);\n      } else if (newValue2 === null) {\n        error(`type ${typeof oldValue2}`, \"null\", path, depth);\n      } else if (oldValue2 instanceof Map) {\n        if (!(newValue2 instanceof Map)) {\n          error(`Map instance`, `other value`, path, depth);\n        } else if (oldValue2.size !== newValue2.size) {\n          error(\n            `Map instance with size ${oldValue2.size}`,\n            `Map instance with size ${newValue2.size}`,\n            path,\n            depth\n          );\n        } else {\n          for (const [k, v] of oldValue2) {\n            if (!newValue2.has(k)) {\n              error(\n                `Map instance with key ${k}`,\n                `Map instance without key ${k}`,\n                path,\n                depth\n              );\n            } else {\n              recur(v, newValue2.get(k), `${path}.get(${k})`, depth + 1);\n            }\n          }\n        }\n      } else if (newValue2 instanceof Map) {\n        error(\"other value\", `Map instance`, path, depth);\n      } else if (oldValue2 instanceof Set) {\n        if (!(newValue2 instanceof Set)) {\n          error(`Set instance`, `other value`, path, depth);\n        } else if (oldValue2.size !== newValue2.size) {\n          error(\n            `Set instance with size ${oldValue2.size}`,\n            `Set instance with size ${newValue2.size}`,\n            path,\n            depth\n          );\n        } else {\n          for (const v of newValue2) {\n            if (!oldValue2.has(v)) {\n              error(\n                `Set instance without element ${v}`,\n                `Set instance with element ${v}`,\n                path,\n                depth\n              );\n            }\n          }\n        }\n      } else if (newValue2 instanceof Set) {\n        error(\"other value\", `Set instance`, path, depth);\n      } else if (oldArray || newArray) {\n        if (oldArray !== newArray) {\n          error(\n            `type ${oldArray ? \"array\" : \"object\"}`,\n            `type ${newArray ? \"array\" : \"object\"}`,\n            path,\n            depth\n          );\n        } else if (oldValue2.length !== newValue2.length) {\n          error(\n            `array with length ${oldValue2.length}`,\n            `array with length ${newValue2.length}`,\n            path,\n            depth\n          );\n        } else {\n          for (let ii = 0; ii < oldValue2.length; ii++) {\n            recur(oldValue2[ii], newValue2[ii], `${path}[${ii}]`, depth + 1);\n          }\n        }\n      } else if (isValidElement(oldValue2) || isValidElement(newValue2)) {\n        if (isValidElement(oldValue2) !== isValidElement(newValue2)) {\n          error(\n            `type ${isValidElement(oldValue2) ? \"React element\" : \"object\"}`,\n            `type ${isValidElement(newValue2) ? \"React element\" : \"object\"}`,\n            path,\n            depth\n          );\n        } else if (oldValue2.type !== newValue2.type) {\n          error(\n            `React element of type ${oldValue2.type}`,\n            `React element of type ${newValue2.type}`,\n            path,\n            depth\n          );\n        } else {\n          recur(\n            oldValue2.props,\n            newValue2.props,\n            `[props of ${path}]`,\n            depth + 1\n          );\n        }\n      } else {\n        for (const key in newValue2) {\n          if (!(key in oldValue2)) {\n            error(\n              `object without key ${key}`,\n              `object with key ${key}`,\n              path,\n              depth\n            );\n          }\n        }\n        for (const key in oldValue2) {\n          if (!(key in newValue2)) {\n            error(\n              `object with key ${key}`,\n              `object without key ${key}`,\n              path,\n              depth\n            );\n          } else {\n            recur(oldValue2[key], newValue2[key], `${path}.${key}`, depth + 1);\n          }\n        }\n      }\n    } else if (typeof oldValue2 === \"function\") {\n      return;\n    } else if (isNaN(oldValue2) || isNaN(newValue2)) {\n      if (isNaN(oldValue2) !== isNaN(newValue2)) {\n        error(\n          `${isNaN(oldValue2) ? \"NaN\" : \"non-NaN value\"}`,\n          `${isNaN(newValue2) ? \"NaN\" : \"non-NaN value\"}`,\n          path,\n          depth\n        );\n      }\n    } else if (oldValue2 !== newValue2) {\n      error(oldValue2, newValue2, path, depth);\n    }\n  }\n  recur(oldValue, newValue, \"\", 0);\n}\n// Annotate the CommonJS export names for ESM import in node:\n0 && (0);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL3JlYWN0LWNvbXBpbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsa0NBQWtDO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsNEZBQTRGO0FBQ3pIO0FBQ0E7QUFDQTtBQUNBLG1HQUFtRztBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSw4QkFBOEI7QUFDdkc7QUFDQTtBQUNBLG9EQUFvRCxrQkFBa0IsYUFBYTs7QUFFbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9CQUFvQixtQkFBTyxDQUFDLHdHQUFPO0FBQ25DLE1BQU0sb0NBQW9DO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixXQUFXO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLEtBQUs7QUFDbEQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsYUFBYSwyQ0FBMkM7QUFDeEQsYUFBYSwyQ0FBMkM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxDQVNMO0FBQ0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4vbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9yZWFjdC1jb21waWxlci1ydW50aW1lL2Rpc3QvaW5kZXguanM/Mzc3YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGxpZ2h0U3ludGF4VHJhbnNmb3JtXG4gKiBAbm9mbG93XG4gKiBAbm9saW50XG4gKiBAcHJldmVudE11bmdlXG4gKiBAcHJlc2VydmUtaW52YXJpYW50LW1lc3NhZ2VzXG4gKi9cblxuXCJ1c2Ugbm8gbWVtb1wiO1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGUgPSBPYmplY3QuY3JlYXRlO1xudmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2dldE93blByb3BEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xudmFyIF9fZ2V0UHJvdG9PZiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjtcbnZhciBfX2hhc093blByb3AgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7XG4gIGZvciAodmFyIG5hbWUgaW4gYWxsKVxuICAgIF9fZGVmUHJvcCh0YXJnZXQsIG5hbWUsIHsgZ2V0OiBhbGxbbmFtZV0sIGVudW1lcmFibGU6IHRydWUgfSk7XG59O1xudmFyIF9fY29weVByb3BzID0gKHRvLCBmcm9tLCBleGNlcHQsIGRlc2MpID0+IHtcbiAgaWYgKGZyb20gJiYgdHlwZW9mIGZyb20gPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGZyb20gPT09IFwiZnVuY3Rpb25cIikge1xuICAgIGZvciAobGV0IGtleSBvZiBfX2dldE93blByb3BOYW1lcyhmcm9tKSlcbiAgICAgIGlmICghX19oYXNPd25Qcm9wLmNhbGwodG8sIGtleSkgJiYga2V5ICE9PSBleGNlcHQpXG4gICAgICAgIF9fZGVmUHJvcCh0bywga2V5LCB7IGdldDogKCkgPT4gZnJvbVtrZXldLCBlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZSB9KTtcbiAgfVxuICByZXR1cm4gdG87XG59O1xudmFyIF9fdG9FU00gPSAobW9kLCBpc05vZGVNb2RlLCB0YXJnZXQpID0+ICh0YXJnZXQgPSBtb2QgIT0gbnVsbCA/IF9fY3JlYXRlKF9fZ2V0UHJvdG9PZihtb2QpKSA6IHt9LCBfX2NvcHlQcm9wcyhcbiAgLy8gSWYgdGhlIGltcG9ydGVyIGlzIGluIG5vZGUgY29tcGF0aWJpbGl0eSBtb2RlIG9yIHRoaXMgaXMgbm90IGFuIEVTTVxuICAvLyBmaWxlIHRoYXQgaGFzIGJlZW4gY29udmVydGVkIHRvIGEgQ29tbW9uSlMgZmlsZSB1c2luZyBhIEJhYmVsLVxuICAvLyBjb21wYXRpYmxlIHRyYW5zZm9ybSAoaS5lLiBcIl9fZXNNb2R1bGVcIiBoYXMgbm90IGJlZW4gc2V0KSwgdGhlbiBzZXRcbiAgLy8gXCJkZWZhdWx0XCIgdG8gdGhlIENvbW1vbkpTIFwibW9kdWxlLmV4cG9ydHNcIiBmb3Igbm9kZSBjb21wYXRpYmlsaXR5LlxuICBpc05vZGVNb2RlIHx8ICFtb2QgfHwgIW1vZC5fX2VzTW9kdWxlID8gX19kZWZQcm9wKHRhcmdldCwgXCJkZWZhdWx0XCIsIHsgdmFsdWU6IG1vZCwgZW51bWVyYWJsZTogdHJ1ZSB9KSA6IHRhcmdldCxcbiAgbW9kXG4pKTtcbnZhciBfX3RvQ29tbW9uSlMgPSAobW9kKSA9PiBfX2NvcHlQcm9wcyhfX2RlZlByb3Aoe30sIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pLCBtb2QpO1xuXG4vLyBzcmMvaW5kZXgudHNcbnZhciBpbmRleF9leHBvcnRzID0ge307XG5fX2V4cG9ydChpbmRleF9leHBvcnRzLCB7XG4gICRkaXNwYXRjaGVyR3VhcmQ6ICgpID0+ICRkaXNwYXRjaGVyR3VhcmQsXG4gICRtYWtlUmVhZE9ubHk6ICgpID0+ICRtYWtlUmVhZE9ubHksXG4gICRyZXNldDogKCkgPT4gJHJlc2V0LFxuICAkc3RydWN0dXJhbENoZWNrOiAoKSA9PiAkc3RydWN0dXJhbENoZWNrLFxuICBjOiAoKSA9PiBjLFxuICBjbGVhclJlbmRlckNvdW50ZXJSZWdpc3RyeTogKCkgPT4gY2xlYXJSZW5kZXJDb3VudGVyUmVnaXN0cnksXG4gIHJlbmRlckNvdW50ZXJSZWdpc3RyeTogKCkgPT4gcmVuZGVyQ291bnRlclJlZ2lzdHJ5LFxuICB1c2VSZW5kZXJDb3VudGVyOiAoKSA9PiB1c2VSZW5kZXJDb3VudGVyXG59KTtcbm1vZHVsZS5leHBvcnRzID0gX190b0NvbW1vbkpTKGluZGV4X2V4cG9ydHMpO1xudmFyIFJlYWN0ID0gX190b0VTTShyZXF1aXJlKFwicmVhY3RcIikpO1xudmFyIHsgdXNlUmVmLCB1c2VFZmZlY3QsIGlzVmFsaWRFbGVtZW50IH0gPSBSZWFjdDtcbnZhciBfYTtcbnZhciBSZWFjdFNlY3JldEludGVybmFscyA9IChcbiAgLy9AdHMtaWdub3JlXG4gIChfYSA9IFJlYWN0Ll9fQ0xJRU5UX0lOVEVSTkFMU19ET19OT1RfVVNFX09SX1dBUk5fVVNFUlNfVEhFWV9DQU5OT1RfVVBHUkFERSkgIT0gbnVsbCA/IF9hIDogUmVhY3QuX19TRUNSRVRfSU5URVJOQUxTX0RPX05PVF9VU0VfT1JfWU9VX1dJTExfQkVfRklSRURcbik7XG52YXIgJGVtcHR5ID0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIik7XG52YXIgX2EyO1xudmFyIGMgPSAoXG4gIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgdHlwZW9mICgoX2EyID0gUmVhY3QuX19DT01QSUxFUl9SVU5USU1FKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmMpID09PSBcImZ1bmN0aW9uXCIgPyAoXG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgIFJlYWN0Ll9fQ09NUElMRVJfUlVOVElNRS5jXG4gICkgOiBmdW5jdGlvbiBjMihzaXplKSB7XG4gICAgcmV0dXJuIFJlYWN0LnVzZU1lbW8oKCkgPT4ge1xuICAgICAgY29uc3QgJCA9IG5ldyBBcnJheShzaXplKTtcbiAgICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCBzaXplOyBpaSsrKSB7XG4gICAgICAgICRbaWldID0gJGVtcHR5O1xuICAgICAgfVxuICAgICAgJFskZW1wdHldID0gdHJ1ZTtcbiAgICAgIHJldHVybiAkO1xuICAgIH0sIFtdKTtcbiAgfVxuKTtcbnZhciBMYXp5R3VhcmREaXNwYXRjaGVyID0ge307XG5bXG4gIFwicmVhZENvbnRleHRcIixcbiAgXCJ1c2VDYWxsYmFja1wiLFxuICBcInVzZUNvbnRleHRcIixcbiAgXCJ1c2VFZmZlY3RcIixcbiAgXCJ1c2VJbXBlcmF0aXZlSGFuZGxlXCIsXG4gIFwidXNlSW5zZXJ0aW9uRWZmZWN0XCIsXG4gIFwidXNlTGF5b3V0RWZmZWN0XCIsXG4gIFwidXNlTWVtb1wiLFxuICBcInVzZVJlZHVjZXJcIixcbiAgXCJ1c2VSZWZcIixcbiAgXCJ1c2VTdGF0ZVwiLFxuICBcInVzZURlYnVnVmFsdWVcIixcbiAgXCJ1c2VEZWZlcnJlZFZhbHVlXCIsXG4gIFwidXNlVHJhbnNpdGlvblwiLFxuICBcInVzZU11dGFibGVTb3VyY2VcIixcbiAgXCJ1c2VTeW5jRXh0ZXJuYWxTdG9yZVwiLFxuICBcInVzZUlkXCIsXG4gIFwidW5zdGFibGVfaXNOZXdSZWNvbmNpbGVyXCIsXG4gIFwiZ2V0Q2FjaGVTaWduYWxcIixcbiAgXCJnZXRDYWNoZUZvclR5cGVcIixcbiAgXCJ1c2VDYWNoZVJlZnJlc2hcIlxuXS5mb3JFYWNoKChuYW1lKSA9PiB7XG4gIExhenlHdWFyZERpc3BhdGNoZXJbbmFtZV0gPSAoKSA9PiB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYFtSZWFjdF0gVW5leHBlY3RlZCBSZWFjdCBob29rIGNhbGwgKCR7bmFtZX0pIGZyb20gYSBSZWFjdCBjb21waWxlZCBmdW5jdGlvbi4gQ2hlY2sgdGhhdCBhbGwgaG9va3MgYXJlIGNhbGxlZCBkaXJlY3RseSBhbmQgbmFtZWQgYWNjb3JkaW5nIHRvIGNvbnZlbnRpb24gKCd1c2VbQS1aXScpIGBcbiAgICApO1xuICB9O1xufSk7XG52YXIgb3JpZ2luYWxEaXNwYXRjaGVyID0gbnVsbDtcbkxhenlHdWFyZERpc3BhdGNoZXJbXCJ1c2VNZW1vQ2FjaGVcIl0gPSAoY291bnQpID0+IHtcbiAgaWYgKG9yaWdpbmFsRGlzcGF0Y2hlciA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJSZWFjdCBDb21waWxlciBpbnRlcm5hbCBpbnZhcmlhbnQgdmlvbGF0aW9uOiB1bmV4cGVjdGVkIG51bGwgZGlzcGF0Y2hlclwiXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gb3JpZ2luYWxEaXNwYXRjaGVyLnVzZU1lbW9DYWNoZShjb3VudCk7XG4gIH1cbn07XG5mdW5jdGlvbiBzZXRDdXJyZW50KG5ld0Rpc3BhdGNoZXIpIHtcbiAgUmVhY3RTZWNyZXRJbnRlcm5hbHMuUmVhY3RDdXJyZW50RGlzcGF0Y2hlci5jdXJyZW50ID0gbmV3RGlzcGF0Y2hlcjtcbiAgcmV0dXJuIFJlYWN0U2VjcmV0SW50ZXJuYWxzLlJlYWN0Q3VycmVudERpc3BhdGNoZXIuY3VycmVudDtcbn1cbnZhciBndWFyZEZyYW1lcyA9IFtdO1xuZnVuY3Rpb24gJGRpc3BhdGNoZXJHdWFyZChraW5kKSB7XG4gIGNvbnN0IGN1cnIgPSBSZWFjdFNlY3JldEludGVybmFscy5SZWFjdEN1cnJlbnREaXNwYXRjaGVyLmN1cnJlbnQ7XG4gIGlmIChraW5kID09PSAwIC8qIFB1c2hHdWFyZENvbnRleHQgKi8pIHtcbiAgICBndWFyZEZyYW1lcy5wdXNoKGN1cnIpO1xuICAgIGlmIChndWFyZEZyYW1lcy5sZW5ndGggPT09IDEpIHtcbiAgICAgIG9yaWdpbmFsRGlzcGF0Y2hlciA9IGN1cnI7XG4gICAgfVxuICAgIGlmIChjdXJyID09PSBMYXp5R3VhcmREaXNwYXRjaGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBbUmVhY3RdIFVuZXhwZWN0ZWQgY2FsbCB0byBjdXN0b20gaG9vayBvciBjb21wb25lbnQgZnJvbSBhIFJlYWN0IGNvbXBpbGVkIGZ1bmN0aW9uLiBDaGVjayB0aGF0ICgxKSBhbGwgaG9va3MgYXJlIGNhbGxlZCBkaXJlY3RseSBhbmQgbmFtZWQgYWNjb3JkaW5nIHRvIGNvbnZlbnRpb24gKCd1c2VbQS1aXScpIGFuZCAoMikgY29tcG9uZW50cyBhcmUgcmV0dXJuZWQgYXMgSlNYIGluc3RlYWQgb2YgYmVpbmcgZGlyZWN0bHkgaW52b2tlZC5gXG4gICAgICApO1xuICAgIH1cbiAgICBzZXRDdXJyZW50KExhenlHdWFyZERpc3BhdGNoZXIpO1xuICB9IGVsc2UgaWYgKGtpbmQgPT09IDEgLyogUG9wR3VhcmRDb250ZXh0ICovKSB7XG4gICAgY29uc3QgbGFzdEZyYW1lID0gZ3VhcmRGcmFtZXMucG9wKCk7XG4gICAgaWYgKGxhc3RGcmFtZSA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiUmVhY3QgQ29tcGlsZXIgaW50ZXJuYWwgZXJyb3I6IHVuZXhwZWN0ZWQgbnVsbCBpbiBndWFyZCBzdGFja1wiXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoZ3VhcmRGcmFtZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBvcmlnaW5hbERpc3BhdGNoZXIgPSBudWxsO1xuICAgIH1cbiAgICBzZXRDdXJyZW50KGxhc3RGcmFtZSk7XG4gIH0gZWxzZSBpZiAoa2luZCA9PT0gMiAvKiBQdXNoRXhwZWN0SG9vayAqLykge1xuICAgIGd1YXJkRnJhbWVzLnB1c2goY3Vycik7XG4gICAgc2V0Q3VycmVudChvcmlnaW5hbERpc3BhdGNoZXIpO1xuICB9IGVsc2UgaWYgKGtpbmQgPT09IDMgLyogUG9wRXhwZWN0SG9vayAqLykge1xuICAgIGNvbnN0IGxhc3RGcmFtZSA9IGd1YXJkRnJhbWVzLnBvcCgpO1xuICAgIGlmIChsYXN0RnJhbWUgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIlJlYWN0IENvbXBpbGVyIGludGVybmFsIGVycm9yOiB1bmV4cGVjdGVkIG51bGwgaW4gZ3VhcmQgc3RhY2tcIlxuICAgICAgKTtcbiAgICB9XG4gICAgc2V0Q3VycmVudChsYXN0RnJhbWUpO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlJlYWN0IENvbXBpbGVyIGludGVybmFsIGVycm9yOiB1bnJlYWNoYWJsZSBibG9ja1wiICsga2luZCk7XG4gIH1cbn1cbmZ1bmN0aW9uICRyZXNldCgkKSB7XG4gIGZvciAobGV0IGlpID0gMDsgaWkgPCAkLmxlbmd0aDsgaWkrKykge1xuICAgICRbaWldID0gJGVtcHR5O1xuICB9XG59XG5mdW5jdGlvbiAkbWFrZVJlYWRPbmx5KCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJUT0RPOiBpbXBsZW1lbnQgJG1ha2VSZWFkT25seSBpbiByZWFjdC1jb21waWxlci1ydW50aW1lXCIpO1xufVxudmFyIHJlbmRlckNvdW50ZXJSZWdpc3RyeSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5mdW5jdGlvbiBjbGVhclJlbmRlckNvdW50ZXJSZWdpc3RyeSgpIHtcbiAgZm9yIChjb25zdCBjb3VudGVycyBvZiByZW5kZXJDb3VudGVyUmVnaXN0cnkudmFsdWVzKCkpIHtcbiAgICBjb3VudGVycy5mb3JFYWNoKChjb3VudGVyKSA9PiB7XG4gICAgICBjb3VudGVyLmNvdW50ID0gMDtcbiAgICB9KTtcbiAgfVxufVxuZnVuY3Rpb24gcmVnaXN0ZXJSZW5kZXJDb3VudGVyKG5hbWUsIHZhbCkge1xuICBsZXQgY291bnRlcnMgPSByZW5kZXJDb3VudGVyUmVnaXN0cnkuZ2V0KG5hbWUpO1xuICBpZiAoY291bnRlcnMgPT0gbnVsbCkge1xuICAgIGNvdW50ZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICByZW5kZXJDb3VudGVyUmVnaXN0cnkuc2V0KG5hbWUsIGNvdW50ZXJzKTtcbiAgfVxuICBjb3VudGVycy5hZGQodmFsKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZVJlbmRlckNvdW50ZXIobmFtZSwgdmFsKSB7XG4gIGNvbnN0IGNvdW50ZXJzID0gcmVuZGVyQ291bnRlclJlZ2lzdHJ5LmdldChuYW1lKTtcbiAgaWYgKGNvdW50ZXJzID09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY291bnRlcnMuZGVsZXRlKHZhbCk7XG59XG5mdW5jdGlvbiB1c2VSZW5kZXJDb3VudGVyKG5hbWUpIHtcbiAgY29uc3QgdmFsID0gdXNlUmVmKG51bGwpO1xuICBpZiAodmFsLmN1cnJlbnQgIT0gbnVsbCkge1xuICAgIHZhbC5jdXJyZW50LmNvdW50ICs9IDE7XG4gIH1cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodmFsLmN1cnJlbnQgPT0gbnVsbCkge1xuICAgICAgY29uc3QgY291bnRlciA9IHsgY291bnQ6IDAgfTtcbiAgICAgIHJlZ2lzdGVyUmVuZGVyQ291bnRlcihuYW1lLCBjb3VudGVyKTtcbiAgICAgIHZhbC5jdXJyZW50ID0gY291bnRlcjtcbiAgICB9XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlmICh2YWwuY3VycmVudCAhPT0gbnVsbCkge1xuICAgICAgICByZW1vdmVSZW5kZXJDb3VudGVyKG5hbWUsIHZhbC5jdXJyZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICB9KTtcbn1cbnZhciBzZWVuRXJyb3JzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbmZ1bmN0aW9uICRzdHJ1Y3R1cmFsQ2hlY2sob2xkVmFsdWUsIG5ld1ZhbHVlLCB2YXJpYWJsZU5hbWUsIGZuTmFtZSwga2luZCwgbG9jKSB7XG4gIGZ1bmN0aW9uIGVycm9yKGwsIHIsIHBhdGgsIGRlcHRoKSB7XG4gICAgY29uc3Qgc3RyID0gYCR7Zm5OYW1lfToke2xvY30gWyR7a2luZH1dICR7dmFyaWFibGVOYW1lfSR7cGF0aH0gY2hhbmdlZCBmcm9tICR7bH0gdG8gJHtyfSBhdCBkZXB0aCAke2RlcHRofWA7XG4gICAgaWYgKHNlZW5FcnJvcnMuaGFzKHN0cikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2VlbkVycm9ycy5hZGQoc3RyKTtcbiAgICBjb25zb2xlLmVycm9yKHN0cik7XG4gIH1cbiAgY29uc3QgZGVwdGhMaW1pdCA9IDI7XG4gIGZ1bmN0aW9uIHJlY3VyKG9sZFZhbHVlMiwgbmV3VmFsdWUyLCBwYXRoLCBkZXB0aCkge1xuICAgIGlmIChkZXB0aCA+IGRlcHRoTGltaXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKG9sZFZhbHVlMiA9PT0gbmV3VmFsdWUyKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygb2xkVmFsdWUyICE9PSB0eXBlb2YgbmV3VmFsdWUyKSB7XG4gICAgICBlcnJvcihgdHlwZSAke3R5cGVvZiBvbGRWYWx1ZTJ9YCwgYHR5cGUgJHt0eXBlb2YgbmV3VmFsdWUyfWAsIHBhdGgsIGRlcHRoKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBvbGRWYWx1ZTIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIGNvbnN0IG9sZEFycmF5ID0gQXJyYXkuaXNBcnJheShvbGRWYWx1ZTIpO1xuICAgICAgY29uc3QgbmV3QXJyYXkgPSBBcnJheS5pc0FycmF5KG5ld1ZhbHVlMik7XG4gICAgICBpZiAob2xkVmFsdWUyID09PSBudWxsICYmIG5ld1ZhbHVlMiAhPT0gbnVsbCkge1xuICAgICAgICBlcnJvcihcIm51bGxcIiwgYHR5cGUgJHt0eXBlb2YgbmV3VmFsdWUyfWAsIHBhdGgsIGRlcHRoKTtcbiAgICAgIH0gZWxzZSBpZiAobmV3VmFsdWUyID09PSBudWxsKSB7XG4gICAgICAgIGVycm9yKGB0eXBlICR7dHlwZW9mIG9sZFZhbHVlMn1gLCBcIm51bGxcIiwgcGF0aCwgZGVwdGgpO1xuICAgICAgfSBlbHNlIGlmIChvbGRWYWx1ZTIgaW5zdGFuY2VvZiBNYXApIHtcbiAgICAgICAgaWYgKCEobmV3VmFsdWUyIGluc3RhbmNlb2YgTWFwKSkge1xuICAgICAgICAgIGVycm9yKGBNYXAgaW5zdGFuY2VgLCBgb3RoZXIgdmFsdWVgLCBwYXRoLCBkZXB0aCk7XG4gICAgICAgIH0gZWxzZSBpZiAob2xkVmFsdWUyLnNpemUgIT09IG5ld1ZhbHVlMi5zaXplKSB7XG4gICAgICAgICAgZXJyb3IoXG4gICAgICAgICAgICBgTWFwIGluc3RhbmNlIHdpdGggc2l6ZSAke29sZFZhbHVlMi5zaXplfWAsXG4gICAgICAgICAgICBgTWFwIGluc3RhbmNlIHdpdGggc2l6ZSAke25ld1ZhbHVlMi5zaXplfWAsXG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgZGVwdGhcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAoY29uc3QgW2ssIHZdIG9mIG9sZFZhbHVlMikge1xuICAgICAgICAgICAgaWYgKCFuZXdWYWx1ZTIuaGFzKGspKSB7XG4gICAgICAgICAgICAgIGVycm9yKFxuICAgICAgICAgICAgICAgIGBNYXAgaW5zdGFuY2Ugd2l0aCBrZXkgJHtrfWAsXG4gICAgICAgICAgICAgICAgYE1hcCBpbnN0YW5jZSB3aXRob3V0IGtleSAke2t9YCxcbiAgICAgICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgICAgIGRlcHRoXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZWN1cih2LCBuZXdWYWx1ZTIuZ2V0KGspLCBgJHtwYXRofS5nZXQoJHtrfSlgLCBkZXB0aCArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChuZXdWYWx1ZTIgaW5zdGFuY2VvZiBNYXApIHtcbiAgICAgICAgZXJyb3IoXCJvdGhlciB2YWx1ZVwiLCBgTWFwIGluc3RhbmNlYCwgcGF0aCwgZGVwdGgpO1xuICAgICAgfSBlbHNlIGlmIChvbGRWYWx1ZTIgaW5zdGFuY2VvZiBTZXQpIHtcbiAgICAgICAgaWYgKCEobmV3VmFsdWUyIGluc3RhbmNlb2YgU2V0KSkge1xuICAgICAgICAgIGVycm9yKGBTZXQgaW5zdGFuY2VgLCBgb3RoZXIgdmFsdWVgLCBwYXRoLCBkZXB0aCk7XG4gICAgICAgIH0gZWxzZSBpZiAob2xkVmFsdWUyLnNpemUgIT09IG5ld1ZhbHVlMi5zaXplKSB7XG4gICAgICAgICAgZXJyb3IoXG4gICAgICAgICAgICBgU2V0IGluc3RhbmNlIHdpdGggc2l6ZSAke29sZFZhbHVlMi5zaXplfWAsXG4gICAgICAgICAgICBgU2V0IGluc3RhbmNlIHdpdGggc2l6ZSAke25ld1ZhbHVlMi5zaXplfWAsXG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgZGVwdGhcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAoY29uc3QgdiBvZiBuZXdWYWx1ZTIpIHtcbiAgICAgICAgICAgIGlmICghb2xkVmFsdWUyLmhhcyh2KSkge1xuICAgICAgICAgICAgICBlcnJvcihcbiAgICAgICAgICAgICAgICBgU2V0IGluc3RhbmNlIHdpdGhvdXQgZWxlbWVudCAke3Z9YCxcbiAgICAgICAgICAgICAgICBgU2V0IGluc3RhbmNlIHdpdGggZWxlbWVudCAke3Z9YCxcbiAgICAgICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgICAgIGRlcHRoXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG5ld1ZhbHVlMiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICBlcnJvcihcIm90aGVyIHZhbHVlXCIsIGBTZXQgaW5zdGFuY2VgLCBwYXRoLCBkZXB0aCk7XG4gICAgICB9IGVsc2UgaWYgKG9sZEFycmF5IHx8IG5ld0FycmF5KSB7XG4gICAgICAgIGlmIChvbGRBcnJheSAhPT0gbmV3QXJyYXkpIHtcbiAgICAgICAgICBlcnJvcihcbiAgICAgICAgICAgIGB0eXBlICR7b2xkQXJyYXkgPyBcImFycmF5XCIgOiBcIm9iamVjdFwifWAsXG4gICAgICAgICAgICBgdHlwZSAke25ld0FycmF5ID8gXCJhcnJheVwiIDogXCJvYmplY3RcIn1gLFxuICAgICAgICAgICAgcGF0aCxcbiAgICAgICAgICAgIGRlcHRoXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChvbGRWYWx1ZTIubGVuZ3RoICE9PSBuZXdWYWx1ZTIubGVuZ3RoKSB7XG4gICAgICAgICAgZXJyb3IoXG4gICAgICAgICAgICBgYXJyYXkgd2l0aCBsZW5ndGggJHtvbGRWYWx1ZTIubGVuZ3RofWAsXG4gICAgICAgICAgICBgYXJyYXkgd2l0aCBsZW5ndGggJHtuZXdWYWx1ZTIubGVuZ3RofWAsXG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgZGVwdGhcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCBvbGRWYWx1ZTIubGVuZ3RoOyBpaSsrKSB7XG4gICAgICAgICAgICByZWN1cihvbGRWYWx1ZTJbaWldLCBuZXdWYWx1ZTJbaWldLCBgJHtwYXRofVske2lpfV1gLCBkZXB0aCArIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChpc1ZhbGlkRWxlbWVudChvbGRWYWx1ZTIpIHx8IGlzVmFsaWRFbGVtZW50KG5ld1ZhbHVlMikpIHtcbiAgICAgICAgaWYgKGlzVmFsaWRFbGVtZW50KG9sZFZhbHVlMikgIT09IGlzVmFsaWRFbGVtZW50KG5ld1ZhbHVlMikpIHtcbiAgICAgICAgICBlcnJvcihcbiAgICAgICAgICAgIGB0eXBlICR7aXNWYWxpZEVsZW1lbnQob2xkVmFsdWUyKSA/IFwiUmVhY3QgZWxlbWVudFwiIDogXCJvYmplY3RcIn1gLFxuICAgICAgICAgICAgYHR5cGUgJHtpc1ZhbGlkRWxlbWVudChuZXdWYWx1ZTIpID8gXCJSZWFjdCBlbGVtZW50XCIgOiBcIm9iamVjdFwifWAsXG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgZGVwdGhcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKG9sZFZhbHVlMi50eXBlICE9PSBuZXdWYWx1ZTIudHlwZSkge1xuICAgICAgICAgIGVycm9yKFxuICAgICAgICAgICAgYFJlYWN0IGVsZW1lbnQgb2YgdHlwZSAke29sZFZhbHVlMi50eXBlfWAsXG4gICAgICAgICAgICBgUmVhY3QgZWxlbWVudCBvZiB0eXBlICR7bmV3VmFsdWUyLnR5cGV9YCxcbiAgICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgICBkZXB0aFxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVjdXIoXG4gICAgICAgICAgICBvbGRWYWx1ZTIucHJvcHMsXG4gICAgICAgICAgICBuZXdWYWx1ZTIucHJvcHMsXG4gICAgICAgICAgICBgW3Byb3BzIG9mICR7cGF0aH1dYCxcbiAgICAgICAgICAgIGRlcHRoICsgMVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIG5ld1ZhbHVlMikge1xuICAgICAgICAgIGlmICghKGtleSBpbiBvbGRWYWx1ZTIpKSB7XG4gICAgICAgICAgICBlcnJvcihcbiAgICAgICAgICAgICAgYG9iamVjdCB3aXRob3V0IGtleSAke2tleX1gLFxuICAgICAgICAgICAgICBgb2JqZWN0IHdpdGgga2V5ICR7a2V5fWAsXG4gICAgICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgICAgIGRlcHRoXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvbGRWYWx1ZTIpIHtcbiAgICAgICAgICBpZiAoIShrZXkgaW4gbmV3VmFsdWUyKSkge1xuICAgICAgICAgICAgZXJyb3IoXG4gICAgICAgICAgICAgIGBvYmplY3Qgd2l0aCBrZXkgJHtrZXl9YCxcbiAgICAgICAgICAgICAgYG9iamVjdCB3aXRob3V0IGtleSAke2tleX1gLFxuICAgICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgICBkZXB0aFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVjdXIob2xkVmFsdWUyW2tleV0sIG5ld1ZhbHVlMltrZXldLCBgJHtwYXRofS4ke2tleX1gLCBkZXB0aCArIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9sZFZhbHVlMiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChpc05hTihvbGRWYWx1ZTIpIHx8IGlzTmFOKG5ld1ZhbHVlMikpIHtcbiAgICAgIGlmIChpc05hTihvbGRWYWx1ZTIpICE9PSBpc05hTihuZXdWYWx1ZTIpKSB7XG4gICAgICAgIGVycm9yKFxuICAgICAgICAgIGAke2lzTmFOKG9sZFZhbHVlMikgPyBcIk5hTlwiIDogXCJub24tTmFOIHZhbHVlXCJ9YCxcbiAgICAgICAgICBgJHtpc05hTihuZXdWYWx1ZTIpID8gXCJOYU5cIiA6IFwibm9uLU5hTiB2YWx1ZVwifWAsXG4gICAgICAgICAgcGF0aCxcbiAgICAgICAgICBkZXB0aFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAob2xkVmFsdWUyICE9PSBuZXdWYWx1ZTIpIHtcbiAgICAgIGVycm9yKG9sZFZhbHVlMiwgbmV3VmFsdWUyLCBwYXRoLCBkZXB0aCk7XG4gICAgfVxuICB9XG4gIHJlY3VyKG9sZFZhbHVlLCBuZXdWYWx1ZSwgXCJcIiwgMCk7XG59XG4vLyBBbm5vdGF0ZSB0aGUgQ29tbW9uSlMgZXhwb3J0IG5hbWVzIGZvciBFU00gaW1wb3J0IGluIG5vZGU6XG4wICYmIChtb2R1bGUuZXhwb3J0cyA9IHtcbiAgJGRpc3BhdGNoZXJHdWFyZCxcbiAgJG1ha2VSZWFkT25seSxcbiAgJHJlc2V0LFxuICAkc3RydWN0dXJhbENoZWNrLFxuICBjLFxuICBjbGVhclJlbmRlckNvdW50ZXJSZWdpc3RyeSxcbiAgcmVuZGVyQ291bnRlclJlZ2lzdHJ5LFxuICB1c2VSZW5kZXJDb3VudGVyXG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js":
/*!*******************************************************************!*\
  !*** ./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ VisualEditing)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var _sanity_visual_editing_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/visual-editing/react */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js\");\n/* harmony import */ var next_navigation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/navigation.js */ \"(ssr)/./node_modules/next/dist/api/navigation.js\");\n/* harmony import */ var next_sanity_visual_editing_server_actions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-sanity/visual-editing/server-actions */ \"(ssr)/./node_modules/next-sanity/dist/visual-editing/server-actions.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n\n\n\n\n\nfunction pathHasPrefix(path, prefix) {\n  if (typeof path != \"string\")\n    return !1;\n  const { pathname } = parsePath(path);\n  return pathname === prefix || pathname.startsWith(`${prefix}/`);\n}\nfunction parsePath(path) {\n  const hashIndex = path.indexOf(\"#\"), queryIndex = path.indexOf(\"?\"), hasQuery = queryIndex > -1 && (hashIndex < 0 || queryIndex < hashIndex);\n  return hasQuery || hashIndex > -1 ? {\n    pathname: path.substring(0, hasQuery ? queryIndex : hashIndex),\n    query: hasQuery ? path.substring(queryIndex, hashIndex > -1 ? hashIndex : void 0) : \"\",\n    hash: hashIndex > -1 ? path.slice(hashIndex) : \"\"\n  } : { pathname: path, query: \"\", hash: \"\" };\n}\nfunction addPathPrefix(path, prefix) {\n  if (!path.startsWith(\"/\") || !prefix)\n    return path;\n  if (path === \"/\" && prefix)\n    return prefix;\n  const { pathname, query, hash } = parsePath(path);\n  return `${prefix}${pathname}${query}${hash}`;\n}\nfunction removePathPrefix(path, prefix) {\n  if (!pathHasPrefix(path, prefix))\n    return path;\n  const withoutPrefix = path.slice(prefix.length);\n  return withoutPrefix.startsWith(\"/\") ? withoutPrefix : `/${withoutPrefix}`;\n}\nconst normalizePathTrailingSlash = (path, trailingSlash) => {\n  const { pathname, query, hash } = parsePath(path);\n  return trailingSlash ? pathname.endsWith(\"/\") ? `${pathname}${query}${hash}` : `${pathname}/${query}${hash}` : `${removeTrailingSlash(pathname)}${query}${hash}`;\n};\nfunction removeTrailingSlash(route) {\n  return route.replace(/\\/$/, \"\") || \"/\";\n}\nfunction VisualEditing(props) {\n  const { basePath = \"\", plugins, components, refresh, trailingSlash = !1, zIndex } = props, router = (0,next_navigation_js__WEBPACK_IMPORTED_MODULE_1__.useRouter)(), routerRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(router), [navigate, setNavigate] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();\n  (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n    routerRef.current = router;\n  }, [router]);\n  const history = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(\n    () => ({\n      subscribe: (_navigate) => (setNavigate(() => _navigate), () => setNavigate(void 0)),\n      update: (update) => {\n        switch (update.type) {\n          case \"push\":\n            return routerRef.current.push(removePathPrefix(update.url, basePath));\n          case \"pop\":\n            return routerRef.current.back();\n          case \"replace\":\n            return routerRef.current.replace(removePathPrefix(update.url, basePath));\n          default:\n            throw new Error(`Unknown update type: ${update.type}`);\n        }\n      }\n    }),\n    [basePath]\n  ), pathname = (0,next_navigation_js__WEBPACK_IMPORTED_MODULE_1__.usePathname)(), searchParams = (0,next_navigation_js__WEBPACK_IMPORTED_MODULE_1__.useSearchParams)();\n  (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n    navigate && navigate({\n      type: \"push\",\n      url: normalizePathTrailingSlash(\n        addPathPrefix(`${pathname}${searchParams?.size ? `?${searchParams}` : \"\"}`, basePath),\n        trailingSlash\n      )\n    });\n  }, [basePath, navigate, pathname, searchParams, trailingSlash]);\n  const handleRefresh = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(\n    (payload) => {\n      if (refresh) return refresh(payload);\n      const manualFastRefresh = () => (console.debug(\n        \"Live preview is setup, calling router.refresh() to refresh the server components without refetching cached data\"\n      ), routerRef.current.refresh(), Promise.resolve()), manualFallbackRefresh = () => (console.debug(\n        \"No loaders in live mode detected, or preview kit setup, revalidating root layout\"\n      ), (0,next_sanity_visual_editing_server_actions__WEBPACK_IMPORTED_MODULE_3__.revalidateRootLayout)()), mutationFallbackRefresh = () => (console.debug(\n        \"No loaders in live mode detected, or preview kit setup, revalidating root layout\"\n      ), (0,next_sanity_visual_editing_server_actions__WEBPACK_IMPORTED_MODULE_3__.revalidateRootLayout)());\n      switch (payload.source) {\n        case \"manual\":\n          return payload.livePreviewEnabled ? manualFastRefresh() : manualFallbackRefresh();\n        case \"mutation\":\n          return payload.livePreviewEnabled ? mutationFastRefresh() : mutationFallbackRefresh();\n        default:\n          throw new Error(\"Unknown refresh source\", { cause: payload });\n      }\n    },\n    [refresh]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    _sanity_visual_editing_react__WEBPACK_IMPORTED_MODULE_4__.VisualEditing,\n    {\n      plugins,\n      components,\n      history,\n      portal: !0,\n      refresh: handleRefresh,\n      zIndex\n    }\n  );\n}\nfunction mutationFastRefresh() {\n  return console.debug(\n    \"Live preview is setup, mutation is skipped assuming its handled by the live preview\"\n  ), !1;\n}\n\n//# sourceMappingURL=VisualEditing.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvZGlzdC9fY2h1bmtzLWVzL1Zpc3VhbEVkaXRpbmcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXdDO0FBQ3dDO0FBQ0g7QUFDSTtBQUNQO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLFVBQVUsV0FBVztBQUNyQix1REFBdUQsT0FBTztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksSUFBSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDLFlBQVksT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsS0FBSztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELGNBQWM7QUFDM0U7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDLHFEQUFxRCxTQUFTLEVBQUUsTUFBTSxFQUFFLEtBQUssT0FBTyxTQUFTLEdBQUcsTUFBTSxFQUFFLEtBQUssT0FBTyw4QkFBOEIsRUFBRSxNQUFNLEVBQUUsS0FBSztBQUNqSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSwwRUFBMEUsa0JBQWtCLDZEQUFTLGdCQUFnQiw2Q0FBTSxvQ0FBb0MsK0NBQVE7QUFDakwsRUFBRSxnREFBUztBQUNYO0FBQ0EsR0FBRztBQUNILGtCQUFrQiw4Q0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELFlBQVk7QUFDaEU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdCQUFnQiwrREFBVyxtQkFBbUIsbUVBQWU7QUFDN0QsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixTQUFTLEVBQUUseUJBQXlCLGFBQWEsT0FBTztBQUNqRjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCx3QkFBd0Isa0RBQVc7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywrRkFBb0I7QUFDN0I7QUFDQSxTQUFTLCtGQUFvQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsZ0JBQWdCO0FBQ3RFO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSx5QkFBeUIsc0RBQUc7QUFDNUIsSUFBSSx1RUFBZTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9kaXN0L19jaHVua3MtZXMvVmlzdWFsRWRpdGluZy5qcz9lMGRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGpzeCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xuaW1wb3J0IHsgVmlzdWFsRWRpdGluZyBhcyBWaXN1YWxFZGl0aW5nJDEgfSBmcm9tIFwiQHNhbml0eS92aXN1YWwtZWRpdGluZy9yZWFjdFwiO1xuaW1wb3J0IHsgdXNlUm91dGVyLCB1c2VQYXRobmFtZSwgdXNlU2VhcmNoUGFyYW1zIH0gZnJvbSBcIm5leHQvbmF2aWdhdGlvbi5qc1wiO1xuaW1wb3J0IHsgcmV2YWxpZGF0ZVJvb3RMYXlvdXQgfSBmcm9tIFwibmV4dC1zYW5pdHkvdmlzdWFsLWVkaXRpbmcvc2VydmVyLWFjdGlvbnNcIjtcbmltcG9ydCB7IHVzZVJlZiwgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcbmZ1bmN0aW9uIHBhdGhIYXNQcmVmaXgocGF0aCwgcHJlZml4KSB7XG4gIGlmICh0eXBlb2YgcGF0aCAhPSBcInN0cmluZ1wiKVxuICAgIHJldHVybiAhMTtcbiAgY29uc3QgeyBwYXRobmFtZSB9ID0gcGFyc2VQYXRoKHBhdGgpO1xuICByZXR1cm4gcGF0aG5hbWUgPT09IHByZWZpeCB8fCBwYXRobmFtZS5zdGFydHNXaXRoKGAke3ByZWZpeH0vYCk7XG59XG5mdW5jdGlvbiBwYXJzZVBhdGgocGF0aCkge1xuICBjb25zdCBoYXNoSW5kZXggPSBwYXRoLmluZGV4T2YoXCIjXCIpLCBxdWVyeUluZGV4ID0gcGF0aC5pbmRleE9mKFwiP1wiKSwgaGFzUXVlcnkgPSBxdWVyeUluZGV4ID4gLTEgJiYgKGhhc2hJbmRleCA8IDAgfHwgcXVlcnlJbmRleCA8IGhhc2hJbmRleCk7XG4gIHJldHVybiBoYXNRdWVyeSB8fCBoYXNoSW5kZXggPiAtMSA/IHtcbiAgICBwYXRobmFtZTogcGF0aC5zdWJzdHJpbmcoMCwgaGFzUXVlcnkgPyBxdWVyeUluZGV4IDogaGFzaEluZGV4KSxcbiAgICBxdWVyeTogaGFzUXVlcnkgPyBwYXRoLnN1YnN0cmluZyhxdWVyeUluZGV4LCBoYXNoSW5kZXggPiAtMSA/IGhhc2hJbmRleCA6IHZvaWQgMCkgOiBcIlwiLFxuICAgIGhhc2g6IGhhc2hJbmRleCA+IC0xID8gcGF0aC5zbGljZShoYXNoSW5kZXgpIDogXCJcIlxuICB9IDogeyBwYXRobmFtZTogcGF0aCwgcXVlcnk6IFwiXCIsIGhhc2g6IFwiXCIgfTtcbn1cbmZ1bmN0aW9uIGFkZFBhdGhQcmVmaXgocGF0aCwgcHJlZml4KSB7XG4gIGlmICghcGF0aC5zdGFydHNXaXRoKFwiL1wiKSB8fCAhcHJlZml4KVxuICAgIHJldHVybiBwYXRoO1xuICBpZiAocGF0aCA9PT0gXCIvXCIgJiYgcHJlZml4KVxuICAgIHJldHVybiBwcmVmaXg7XG4gIGNvbnN0IHsgcGF0aG5hbWUsIHF1ZXJ5LCBoYXNoIH0gPSBwYXJzZVBhdGgocGF0aCk7XG4gIHJldHVybiBgJHtwcmVmaXh9JHtwYXRobmFtZX0ke3F1ZXJ5fSR7aGFzaH1gO1xufVxuZnVuY3Rpb24gcmVtb3ZlUGF0aFByZWZpeChwYXRoLCBwcmVmaXgpIHtcbiAgaWYgKCFwYXRoSGFzUHJlZml4KHBhdGgsIHByZWZpeCkpXG4gICAgcmV0dXJuIHBhdGg7XG4gIGNvbnN0IHdpdGhvdXRQcmVmaXggPSBwYXRoLnNsaWNlKHByZWZpeC5sZW5ndGgpO1xuICByZXR1cm4gd2l0aG91dFByZWZpeC5zdGFydHNXaXRoKFwiL1wiKSA/IHdpdGhvdXRQcmVmaXggOiBgLyR7d2l0aG91dFByZWZpeH1gO1xufVxuY29uc3Qgbm9ybWFsaXplUGF0aFRyYWlsaW5nU2xhc2ggPSAocGF0aCwgdHJhaWxpbmdTbGFzaCkgPT4ge1xuICBjb25zdCB7IHBhdGhuYW1lLCBxdWVyeSwgaGFzaCB9ID0gcGFyc2VQYXRoKHBhdGgpO1xuICByZXR1cm4gdHJhaWxpbmdTbGFzaCA/IHBhdGhuYW1lLmVuZHNXaXRoKFwiL1wiKSA/IGAke3BhdGhuYW1lfSR7cXVlcnl9JHtoYXNofWAgOiBgJHtwYXRobmFtZX0vJHtxdWVyeX0ke2hhc2h9YCA6IGAke3JlbW92ZVRyYWlsaW5nU2xhc2gocGF0aG5hbWUpfSR7cXVlcnl9JHtoYXNofWA7XG59O1xuZnVuY3Rpb24gcmVtb3ZlVHJhaWxpbmdTbGFzaChyb3V0ZSkge1xuICByZXR1cm4gcm91dGUucmVwbGFjZSgvXFwvJC8sIFwiXCIpIHx8IFwiL1wiO1xufVxuZnVuY3Rpb24gVmlzdWFsRWRpdGluZyhwcm9wcykge1xuICBjb25zdCB7IGJhc2VQYXRoID0gXCJcIiwgcGx1Z2lucywgY29tcG9uZW50cywgcmVmcmVzaCwgdHJhaWxpbmdTbGFzaCA9ICExLCB6SW5kZXggfSA9IHByb3BzLCByb3V0ZXIgPSB1c2VSb3V0ZXIoKSwgcm91dGVyUmVmID0gdXNlUmVmKHJvdXRlciksIFtuYXZpZ2F0ZSwgc2V0TmF2aWdhdGVdID0gdXNlU3RhdGUoKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICByb3V0ZXJSZWYuY3VycmVudCA9IHJvdXRlcjtcbiAgfSwgW3JvdXRlcl0pO1xuICBjb25zdCBoaXN0b3J5ID0gdXNlTWVtbyhcbiAgICAoKSA9PiAoe1xuICAgICAgc3Vic2NyaWJlOiAoX25hdmlnYXRlKSA9PiAoc2V0TmF2aWdhdGUoKCkgPT4gX25hdmlnYXRlKSwgKCkgPT4gc2V0TmF2aWdhdGUodm9pZCAwKSksXG4gICAgICB1cGRhdGU6ICh1cGRhdGUpID0+IHtcbiAgICAgICAgc3dpdGNoICh1cGRhdGUudHlwZSkge1xuICAgICAgICAgIGNhc2UgXCJwdXNoXCI6XG4gICAgICAgICAgICByZXR1cm4gcm91dGVyUmVmLmN1cnJlbnQucHVzaChyZW1vdmVQYXRoUHJlZml4KHVwZGF0ZS51cmwsIGJhc2VQYXRoKSk7XG4gICAgICAgICAgY2FzZSBcInBvcFwiOlxuICAgICAgICAgICAgcmV0dXJuIHJvdXRlclJlZi5jdXJyZW50LmJhY2soKTtcbiAgICAgICAgICBjYXNlIFwicmVwbGFjZVwiOlxuICAgICAgICAgICAgcmV0dXJuIHJvdXRlclJlZi5jdXJyZW50LnJlcGxhY2UocmVtb3ZlUGF0aFByZWZpeCh1cGRhdGUudXJsLCBiYXNlUGF0aCkpO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdXBkYXRlIHR5cGU6ICR7dXBkYXRlLnR5cGV9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSxcbiAgICBbYmFzZVBhdGhdXG4gICksIHBhdGhuYW1lID0gdXNlUGF0aG5hbWUoKSwgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbmF2aWdhdGUgJiYgbmF2aWdhdGUoe1xuICAgICAgdHlwZTogXCJwdXNoXCIsXG4gICAgICB1cmw6IG5vcm1hbGl6ZVBhdGhUcmFpbGluZ1NsYXNoKFxuICAgICAgICBhZGRQYXRoUHJlZml4KGAke3BhdGhuYW1lfSR7c2VhcmNoUGFyYW1zPy5zaXplID8gYD8ke3NlYXJjaFBhcmFtc31gIDogXCJcIn1gLCBiYXNlUGF0aCksXG4gICAgICAgIHRyYWlsaW5nU2xhc2hcbiAgICAgIClcbiAgICB9KTtcbiAgfSwgW2Jhc2VQYXRoLCBuYXZpZ2F0ZSwgcGF0aG5hbWUsIHNlYXJjaFBhcmFtcywgdHJhaWxpbmdTbGFzaF0pO1xuICBjb25zdCBoYW5kbGVSZWZyZXNoID0gdXNlQ2FsbGJhY2soXG4gICAgKHBheWxvYWQpID0+IHtcbiAgICAgIGlmIChyZWZyZXNoKSByZXR1cm4gcmVmcmVzaChwYXlsb2FkKTtcbiAgICAgIGNvbnN0IG1hbnVhbEZhc3RSZWZyZXNoID0gKCkgPT4gKGNvbnNvbGUuZGVidWcoXG4gICAgICAgIFwiTGl2ZSBwcmV2aWV3IGlzIHNldHVwLCBjYWxsaW5nIHJvdXRlci5yZWZyZXNoKCkgdG8gcmVmcmVzaCB0aGUgc2VydmVyIGNvbXBvbmVudHMgd2l0aG91dCByZWZldGNoaW5nIGNhY2hlZCBkYXRhXCJcbiAgICAgICksIHJvdXRlclJlZi5jdXJyZW50LnJlZnJlc2goKSwgUHJvbWlzZS5yZXNvbHZlKCkpLCBtYW51YWxGYWxsYmFja1JlZnJlc2ggPSAoKSA9PiAoY29uc29sZS5kZWJ1ZyhcbiAgICAgICAgXCJObyBsb2FkZXJzIGluIGxpdmUgbW9kZSBkZXRlY3RlZCwgb3IgcHJldmlldyBraXQgc2V0dXAsIHJldmFsaWRhdGluZyByb290IGxheW91dFwiXG4gICAgICApLCByZXZhbGlkYXRlUm9vdExheW91dCgpKSwgbXV0YXRpb25GYWxsYmFja1JlZnJlc2ggPSAoKSA9PiAoY29uc29sZS5kZWJ1ZyhcbiAgICAgICAgXCJObyBsb2FkZXJzIGluIGxpdmUgbW9kZSBkZXRlY3RlZCwgb3IgcHJldmlldyBraXQgc2V0dXAsIHJldmFsaWRhdGluZyByb290IGxheW91dFwiXG4gICAgICApLCByZXZhbGlkYXRlUm9vdExheW91dCgpKTtcbiAgICAgIHN3aXRjaCAocGF5bG9hZC5zb3VyY2UpIHtcbiAgICAgICAgY2FzZSBcIm1hbnVhbFwiOlxuICAgICAgICAgIHJldHVybiBwYXlsb2FkLmxpdmVQcmV2aWV3RW5hYmxlZCA/IG1hbnVhbEZhc3RSZWZyZXNoKCkgOiBtYW51YWxGYWxsYmFja1JlZnJlc2goKTtcbiAgICAgICAgY2FzZSBcIm11dGF0aW9uXCI6XG4gICAgICAgICAgcmV0dXJuIHBheWxvYWQubGl2ZVByZXZpZXdFbmFibGVkID8gbXV0YXRpb25GYXN0UmVmcmVzaCgpIDogbXV0YXRpb25GYWxsYmFja1JlZnJlc2goKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIHJlZnJlc2ggc291cmNlXCIsIHsgY2F1c2U6IHBheWxvYWQgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbcmVmcmVzaF1cbiAgKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgVmlzdWFsRWRpdGluZyQxLFxuICAgIHtcbiAgICAgIHBsdWdpbnMsXG4gICAgICBjb21wb25lbnRzLFxuICAgICAgaGlzdG9yeSxcbiAgICAgIHBvcnRhbDogITAsXG4gICAgICByZWZyZXNoOiBoYW5kbGVSZWZyZXNoLFxuICAgICAgekluZGV4XG4gICAgfVxuICApO1xufVxuZnVuY3Rpb24gbXV0YXRpb25GYXN0UmVmcmVzaCgpIHtcbiAgcmV0dXJuIGNvbnNvbGUuZGVidWcoXG4gICAgXCJMaXZlIHByZXZpZXcgaXMgc2V0dXAsIG11dGF0aW9uIGlzIHNraXBwZWQgYXNzdW1pbmcgaXRzIGhhbmRsZWQgYnkgdGhlIGxpdmUgcHJldmlld1wiXG4gICksICExO1xufVxuZXhwb3J0IHtcbiAgVmlzdWFsRWRpdGluZyBhcyBkZWZhdWx0XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VmlzdWFsRWRpdGluZy5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/dist/visual-editing/client-component.js":
/*!**************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/client-component.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ VisualEditingLazyClientComponent)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \n\nconst VisualEditingClientComponent = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(()=>Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/@sanity\"), __webpack_require__.e(\"vendor-chunks/rxjs\"), __webpack_require__.e(\"vendor-chunks/next-sanity\"), __webpack_require__.e(\"vendor-chunks/motion-dom\"), __webpack_require__.e(\"vendor-chunks/lodash-es\"), __webpack_require__.e(\"vendor-chunks/framer-motion\"), __webpack_require__.e(\"vendor-chunks/lodash\"), __webpack_require__.e(\"vendor-chunks/motion-utils\"), __webpack_require__.e(\"vendor-chunks/@juggle\"), __webpack_require__.e(\"vendor-chunks/stylis\"), __webpack_require__.e(\"vendor-chunks/@emotion\"), __webpack_require__.e(\"vendor-chunks/react-is\"), __webpack_require__.e(\"vendor-chunks/valibot\"), __webpack_require__.e(\"vendor-chunks/scroll-into-view-if-needed\"), __webpack_require__.e(\"vendor-chunks/mendoza\"), __webpack_require__.e(\"vendor-chunks/get-random-values-esm\"), __webpack_require__.e(\"vendor-chunks/compute-scroll-into-view\"), __webpack_require__.e(\"vendor-chunks/@vercel\"), __webpack_require__.e(\"vendor-chunks/styled-components\"), __webpack_require__.e(\"vendor-chunks/react-compiler-runtime\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../_chunks-es/VisualEditing.js */ \"(ssr)/./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js\")));\nfunction VisualEditingLazyClientComponent(props) {\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Suspense, {\n        fallback: null,\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(VisualEditingClientComponent, {\n            ...props\n        })\n    });\n}\n //# sourceMappingURL=client-component.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvZGlzdC92aXN1YWwtZWRpdGluZy9jbGllbnQtY29tcG9uZW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBWUEsTUFBTUEsNkNBQStCQywyQ0FBSUEsQ0FBQyxJQUFNLHV0Q0FBTztBQUVoRCxTQUFTQyxpQ0FBaUNDLEtBQUE7SUFDL0MsT0FDRSxnQkFBQUMsc0RBQUFBLENBQUNDLDJDQUFRQSxFQUFSO1FBQVNDLFVBQVU7UUFDbEJDLFVBQUEsZ0JBQUFILHNEQUFBQSxDQUFDSiw4QkFBQTtZQUE4QixHQUFHRyxLQUFBO1FBQUE7SUFBTztBQUcvQyIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi4vLi4vc3JjL3Zpc3VhbC1lZGl0aW5nL2NsaWVudC1jb21wb25lbnQvVmlzdWFsRWRpdGluZ0xhenkudHN4PzAwMmUiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKlxuICogSWYgcGFnZXMgcm91dGVyIHN1cHBvcnRlZCBgbmV4dC9keW5hbWljYCBpbXBvcnRzIChpdCB3YW50cyBgbmV4dC9keW5hbWljLmpzYCksXG4gKiBvciBpZiB0dXJib3BhY2sgaW4gYXBwIHJvdXRlciBhbGxvd2VkIGBuZXh0L2R5bmFtaWMuanNgIChpdCBkb2Vzbid0IHlldClcbiAqIHdlIGNvdWxkIHVzZSBgZHluYW1pYygoKSA9PiBpbXBvcnQoJy4uLiksIHtzc3I6IGZhbHNlfSlgIGhlcmUuXG4gKiBTaW5jZSB3ZSBjYW4ndCwgd2UgbmVlZCB0byB1c2UgYSBsYXp5IGltcG9ydCBhbmQgU3VzcGVuc2Ugb3Vyc2VsZi5cbiAqL1xuXG5pbXBvcnQge2xhenksIFN1c3BlbnNlfSBmcm9tICdyZWFjdCdcblxuaW1wb3J0IHR5cGUge1Zpc3VhbEVkaXRpbmdQcm9wc30gZnJvbSAnLi9WaXN1YWxFZGl0aW5nJ1xuXG5jb25zdCBWaXN1YWxFZGl0aW5nQ2xpZW50Q29tcG9uZW50ID0gbGF6eSgoKSA9PiBpbXBvcnQoJy4vVmlzdWFsRWRpdGluZycpKVxuXG5leHBvcnQgZnVuY3Rpb24gVmlzdWFsRWRpdGluZ0xhenlDbGllbnRDb21wb25lbnQocHJvcHM6IFZpc3VhbEVkaXRpbmdQcm9wcyk6IFJlYWN0LlJlYWN0Tm9kZSB7XG4gIHJldHVybiAoXG4gICAgPFN1c3BlbnNlIGZhbGxiYWNrPXtudWxsfT5cbiAgICAgIDxWaXN1YWxFZGl0aW5nQ2xpZW50Q29tcG9uZW50IHsuLi5wcm9wc30gLz5cbiAgICA8L1N1c3BlbnNlPlxuICApXG59XG4iXSwibmFtZXMiOlsiVmlzdWFsRWRpdGluZ0NsaWVudENvbXBvbmVudCIsImxhenkiLCJWaXN1YWxFZGl0aW5nTGF6eUNsaWVudENvbXBvbmVudCIsInByb3BzIiwianN4IiwiU3VzcGVuc2UiLCJmYWxsYmFjayIsImNoaWxkcmVuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/dist/visual-editing/client-component.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/dist/visual-editing/server-actions.js":
/*!************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/server-actions.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   revalidateRootLayout: () => (/* binding */ revalidateRootLayout)
/* harmony export */ });
/* harmony import */ var next_dist_client_app_call_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/client/app-call-server */ "(ssr)/./node_modules/next/dist/client/app-call-server.js");
/* harmony import */ var private_next_rsc_action_client_wrapper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-client-wrapper */ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js");



function __build_action__(action, args) {
  return (0,next_dist_client_app_call_server__WEBPACK_IMPORTED_MODULE_0__.callServer)(action.$$id, args)
}

/* __next_internal_action_entry_do_not_use__ {"ff49dcf5d2c6ac001bfbd839f9208853e1c73848":"revalidateRootLayout"} */ var revalidateRootLayout = (0,private_next_rsc_action_client_wrapper__WEBPACK_IMPORTED_MODULE_1__.createServerReference)("ff49dcf5d2c6ac001bfbd839f9208853e1c73848");

 //# sourceMappingURL=server-actions.js.map



/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/isRecord.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/isRecord.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isRecord: () => (/* binding */ isRecord)\n/* harmony export */ });\nfunction isRecord(value) {\n  return typeof value == \"object\" && value !== null && !Array.isArray(value);\n}\n\n//# sourceMappingURL=isRecord.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvY2xpZW50L2Rpc3QvX2NodW5rcy1lcy9pc1JlY29yZC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBR0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvY2xpZW50L2Rpc3QvX2NodW5rcy1lcy9pc1JlY29yZC5qcz8zZTBhIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGlzUmVjb3JkKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5leHBvcnQge1xuICBpc1JlY29yZFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzUmVjb3JkLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/isRecord.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DRAFTS_FOLDER: () => (/* binding */ DRAFTS_FOLDER),\n/* harmony export */   VERSION_FOLDER: () => (/* binding */ VERSION_FOLDER),\n/* harmony export */   createEditUrl: () => (/* binding */ createEditUrl),\n/* harmony export */   get: () => (/* binding */ get),\n/* harmony export */   getDraftId: () => (/* binding */ getDraftId),\n/* harmony export */   getPublishedId: () => (/* binding */ getPublishedId),\n/* harmony export */   getVersionFromId: () => (/* binding */ getVersionFromId),\n/* harmony export */   getVersionId: () => (/* binding */ getVersionId),\n/* harmony export */   isDraftId: () => (/* binding */ isDraftId),\n/* harmony export */   isPublishedId: () => (/* binding */ isPublishedId),\n/* harmony export */   isVersionId: () => (/* binding */ isVersionId),\n/* harmony export */   jsonPath: () => (/* binding */ jsonPath),\n/* harmony export */   jsonPathToStudioPath: () => (/* binding */ jsonPathToStudioPath),\n/* harmony export */   parseJsonPath: () => (/* binding */ parseJsonPath),\n/* harmony export */   reKeySegment: () => (/* binding */ reKeySegment),\n/* harmony export */   resolveEditInfo: () => (/* binding */ resolveEditInfo),\n/* harmony export */   resolveMapping: () => (/* binding */ resolveMapping),\n/* harmony export */   resolveStudioBaseRoute: () => (/* binding */ resolveStudioBaseRoute),\n/* harmony export */   studioPath: () => (/* binding */ studioPath),\n/* harmony export */   studioPathToJsonPath: () => (/* binding */ studioPathToJsonPath),\n/* harmony export */   toString: () => (/* binding */ toString),\n/* harmony export */   walkMap: () => (/* binding */ walkMap)\n/* harmony export */ });\n/* harmony import */ var _isRecord_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isRecord.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/isRecord.js\");\n\nconst rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g, reKeySegment = /_key\\s*==\\s*['\"](.*)['\"]/, reIndexTuple = /^\\d*:\\d*$/;\nfunction isIndexSegment(segment) {\n  return typeof segment == \"number\" || typeof segment == \"string\" && /^\\[\\d+\\]$/.test(segment);\n}\nfunction isKeySegment(segment) {\n  return typeof segment == \"string\" ? reKeySegment.test(segment.trim()) : typeof segment == \"object\" && \"_key\" in segment;\n}\nfunction isIndexTuple(segment) {\n  if (typeof segment == \"string\" && reIndexTuple.test(segment))\n    return !0;\n  if (!Array.isArray(segment) || segment.length !== 2)\n    return !1;\n  const [from, to] = segment;\n  return (typeof from == \"number\" || from === \"\") && (typeof to == \"number\" || to === \"\");\n}\nfunction get(obj, path, defaultVal) {\n  const select = typeof path == \"string\" ? fromString(path) : path;\n  if (!Array.isArray(select))\n    throw new Error(\"Path must be an array or a string\");\n  let acc = obj;\n  for (let i = 0; i < select.length; i++) {\n    const segment = select[i];\n    if (isIndexSegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc[segment];\n    }\n    if (isKeySegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc.find((item) => item._key === segment._key);\n    }\n    if (typeof segment == \"string\" && (acc = typeof acc == \"object\" && acc !== null ? acc[segment] : void 0), typeof acc > \"u\")\n      return defaultVal;\n  }\n  return acc;\n}\nfunction toString(path) {\n  if (!Array.isArray(path))\n    throw new Error(\"Path is not an array\");\n  return path.reduce((target, segment, i) => {\n    const segmentType = typeof segment;\n    if (segmentType === \"number\")\n      return `${target}[${segment}]`;\n    if (segmentType === \"string\")\n      return `${target}${i === 0 ? \"\" : \".\"}${segment}`;\n    if (isKeySegment(segment) && segment._key)\n      return `${target}[_key==\"${segment._key}\"]`;\n    if (Array.isArray(segment)) {\n      const [from, to] = segment;\n      return `${target}[${from}:${to}]`;\n    }\n    throw new Error(`Unsupported path segment \\`${JSON.stringify(segment)}\\``);\n  }, \"\");\n}\nfunction fromString(path) {\n  if (typeof path != \"string\")\n    throw new Error(\"Path is not a string\");\n  const segments = path.match(rePropName);\n  if (!segments)\n    throw new Error(\"Invalid path string\");\n  return segments.map(parsePathSegment);\n}\nfunction parsePathSegment(segment) {\n  return isIndexSegment(segment) ? parseIndexSegment(segment) : isKeySegment(segment) ? parseKeySegment(segment) : isIndexTuple(segment) ? parseIndexTupleSegment(segment) : segment;\n}\nfunction parseIndexSegment(segment) {\n  return Number(segment.replace(/[^\\d]/g, \"\"));\n}\nfunction parseKeySegment(segment) {\n  return { _key: segment.match(reKeySegment)[1] };\n}\nfunction parseIndexTupleSegment(segment) {\n  const [from, to] = segment.split(\":\").map((seg) => seg === \"\" ? seg : Number(seg));\n  return [from, to];\n}\nvar studioPath = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  fromString,\n  get,\n  isIndexSegment,\n  isIndexTuple,\n  isKeySegment,\n  reKeySegment,\n  toString\n});\nconst DRAFTS_FOLDER = \"drafts\", VERSION_FOLDER = \"versions\", PATH_SEPARATOR = \".\", DRAFTS_PREFIX = `${DRAFTS_FOLDER}${PATH_SEPARATOR}`, VERSION_PREFIX = `${VERSION_FOLDER}${PATH_SEPARATOR}`;\nfunction isDraftId(id) {\n  return id.startsWith(DRAFTS_PREFIX);\n}\nfunction isVersionId(id) {\n  return id.startsWith(VERSION_PREFIX);\n}\nfunction isPublishedId(id) {\n  return !isDraftId(id) && !isVersionId(id);\n}\nfunction getDraftId(id) {\n  if (isVersionId(id)) {\n    const publishedId = getPublishedId(id);\n    return DRAFTS_PREFIX + publishedId;\n  }\n  return isDraftId(id) ? id : DRAFTS_PREFIX + id;\n}\nfunction getVersionId(id, version) {\n  if (version === \"drafts\" || version === \"published\")\n    throw new Error('Version can not be \"published\" or \"drafts\"');\n  return `${VERSION_PREFIX}${version}${PATH_SEPARATOR}${getPublishedId(id)}`;\n}\nfunction getVersionFromId(id) {\n  if (!isVersionId(id)) return;\n  const [_versionPrefix, versionId, ..._publishedId] = id.split(PATH_SEPARATOR);\n  return versionId;\n}\nfunction getPublishedId(id) {\n  return isVersionId(id) ? id.split(PATH_SEPARATOR).slice(2).join(PATH_SEPARATOR) : isDraftId(id) ? id.slice(DRAFTS_PREFIX.length) : id;\n}\nconst ESCAPE = {\n  \"\\f\": \"\\\\f\",\n  \"\\n\": \"\\\\n\",\n  \"\\r\": \"\\\\r\",\n  \"\t\": \"\\\\t\",\n  \"'\": \"\\\\'\",\n  \"\\\\\": \"\\\\\\\\\"\n}, UNESCAPE = {\n  \"\\\\f\": \"\\f\",\n  \"\\\\n\": `\n`,\n  \"\\\\r\": \"\\r\",\n  \"\\\\t\": \"\t\",\n  \"\\\\'\": \"'\",\n  \"\\\\\\\\\": \"\\\\\"\n};\nfunction jsonPath(path) {\n  return `$${path.map((segment) => typeof segment == \"string\" ? `['${segment.replace(/[\\f\\n\\r\\t'\\\\]/g, (match) => ESCAPE[match])}']` : typeof segment == \"number\" ? `[${segment}]` : segment._key !== \"\" ? `[?(@._key=='${segment._key.replace(/['\\\\]/g, (match) => ESCAPE[match])}')]` : `[${segment._index}]`).join(\"\")}`;\n}\nfunction jsonPathArray(path) {\n  return path.map((segment) => typeof segment == \"string\" ? `['${segment.replace(/[\\f\\n\\r\\t'\\\\]/g, (match) => ESCAPE[match])}']` : typeof segment == \"number\" ? `[${segment}]` : segment._key !== \"\" ? `[?(@._key=='${segment._key.replace(/['\\\\]/g, (match) => ESCAPE[match])}')]` : `[${segment._index}]`);\n}\nfunction parseJsonPath(path) {\n  const parsed = [], parseRe = /\\['(.*?)'\\]|\\[(\\d+)\\]|\\[\\?\\(@\\._key=='(.*?)'\\)\\]/g;\n  let match;\n  for (; (match = parseRe.exec(path)) !== null; ) {\n    if (match[1] !== void 0) {\n      const key = match[1].replace(/\\\\(\\\\|f|n|r|t|')/g, (m) => UNESCAPE[m]);\n      parsed.push(key);\n      continue;\n    }\n    if (match[2] !== void 0) {\n      parsed.push(parseInt(match[2], 10));\n      continue;\n    }\n    if (match[3] !== void 0) {\n      const _key = match[3].replace(/\\\\(\\\\')/g, (m) => UNESCAPE[m]);\n      parsed.push({\n        _key,\n        _index: -1\n      });\n      continue;\n    }\n  }\n  return parsed;\n}\nfunction jsonPathToStudioPath(path) {\n  return path.map((segment) => {\n    if (typeof segment == \"string\" || typeof segment == \"number\")\n      return segment;\n    if (segment._key !== \"\")\n      return { _key: segment._key };\n    if (segment._index !== -1)\n      return segment._index;\n    throw new Error(`invalid segment:${JSON.stringify(segment)}`);\n  });\n}\nfunction studioPathToJsonPath(path) {\n  return (typeof path == \"string\" ? fromString(path) : path).map((segment) => {\n    if (typeof segment == \"string\" || typeof segment == \"number\")\n      return segment;\n    if (Array.isArray(segment))\n      throw new Error(`IndexTuple segments aren't supported:${JSON.stringify(segment)}`);\n    if (isContentSourceMapParsedPathKeyedSegment(segment))\n      return segment;\n    if (segment._key)\n      return { _key: segment._key, _index: -1 };\n    throw new Error(`invalid segment:${JSON.stringify(segment)}`);\n  });\n}\nfunction isContentSourceMapParsedPathKeyedSegment(segment) {\n  return typeof segment == \"object\" && \"_key\" in segment && \"_index\" in segment;\n}\nfunction jsonPathToMappingPath(path) {\n  return path.map((segment) => {\n    if (typeof segment == \"string\" || typeof segment == \"number\")\n      return segment;\n    if (segment._index !== -1)\n      return segment._index;\n    throw new Error(`invalid segment:${JSON.stringify(segment)}`);\n  });\n}\nfunction resolveMapping(resultPath, csm) {\n  if (!csm?.mappings)\n    return;\n  const resultMappingPath = jsonPath(jsonPathToMappingPath(resultPath));\n  if (csm.mappings[resultMappingPath] !== void 0)\n    return {\n      mapping: csm.mappings[resultMappingPath],\n      matchedPath: resultMappingPath,\n      pathSuffix: \"\"\n    };\n  const resultMappingPathArray = jsonPathArray(jsonPathToMappingPath(resultPath));\n  for (let i = resultMappingPathArray.length - 1; i >= 0; i--) {\n    const key = `$${resultMappingPathArray.slice(0, i).join(\"\")}`, mappingFound = csm.mappings[key];\n    if (mappingFound) {\n      const pathSuffix = resultMappingPath.substring(key.length);\n      return { mapping: mappingFound, matchedPath: key, pathSuffix };\n    }\n  }\n}\nfunction isArray(value) {\n  return value !== null && Array.isArray(value);\n}\nfunction walkMap(value, mappingFn, path = []) {\n  if (isArray(value))\n    return value.map((v, idx) => {\n      if ((0,_isRecord_js__WEBPACK_IMPORTED_MODULE_0__.isRecord)(v)) {\n        const _key = v._key;\n        if (typeof _key == \"string\")\n          return walkMap(v, mappingFn, path.concat({ _key, _index: idx }));\n      }\n      return walkMap(v, mappingFn, path.concat(idx));\n    });\n  if ((0,_isRecord_js__WEBPACK_IMPORTED_MODULE_0__.isRecord)(value)) {\n    if (value._type === \"block\" || value._type === \"span\") {\n      const result = { ...value };\n      return value._type === \"block\" ? result.children = walkMap(value.children, mappingFn, path.concat(\"children\")) : value._type === \"span\" && (result.text = walkMap(value.text, mappingFn, path.concat(\"text\"))), result;\n    }\n    return Object.fromEntries(\n      Object.entries(value).map(([k, v]) => [k, walkMap(v, mappingFn, path.concat(k))])\n    );\n  }\n  return mappingFn(value, path);\n}\nfunction createEditUrl(options) {\n  const {\n    baseUrl,\n    workspace: _workspace = \"default\",\n    tool: _tool = \"default\",\n    id: _id,\n    type,\n    path,\n    projectId,\n    dataset\n  } = options;\n  if (!baseUrl)\n    throw new Error(\"baseUrl is required\");\n  if (!path)\n    throw new Error(\"path is required\");\n  if (!_id)\n    throw new Error(\"id is required\");\n  if (baseUrl !== \"/\" && baseUrl.endsWith(\"/\"))\n    throw new Error(\"baseUrl must not end with a slash\");\n  const workspace = _workspace === \"default\" ? void 0 : _workspace, tool = _tool === \"default\" ? void 0 : _tool, id = getPublishedId(_id), stringifiedPath = Array.isArray(path) ? toString(jsonPathToStudioPath(path)) : path, searchParams = new URLSearchParams({\n    baseUrl,\n    id,\n    type,\n    path: stringifiedPath\n  });\n  if (workspace && searchParams.set(\"workspace\", workspace), tool && searchParams.set(\"tool\", tool), projectId && searchParams.set(\"projectId\", projectId), dataset && searchParams.set(\"dataset\", dataset), isPublishedId(_id))\n    searchParams.set(\"perspective\", \"published\");\n  else if (isVersionId(_id)) {\n    const versionId = getVersionFromId(_id);\n    searchParams.set(\"perspective\", versionId);\n  }\n  const segments = [baseUrl === \"/\" ? \"\" : baseUrl];\n  workspace && segments.push(workspace);\n  const routerParams = [\n    \"mode=presentation\",\n    `id=${id}`,\n    `type=${type}`,\n    `path=${encodeURIComponent(stringifiedPath)}`\n  ];\n  return tool && routerParams.push(`tool=${tool}`), segments.push(\"intent\", \"edit\", `${routerParams.join(\";\")}?${searchParams}`), segments.join(\"/\");\n}\nfunction resolveEditInfo(options) {\n  const { resultSourceMap: csm, resultPath } = options, { mapping, pathSuffix } = resolveMapping(resultPath, csm) || {};\n  if (!mapping || mapping.source.type === \"literal\" || mapping.source.type === \"unknown\")\n    return;\n  const sourceDoc = csm.documents[mapping.source.document], sourcePath = csm.paths[mapping.source.path];\n  if (sourceDoc && sourcePath) {\n    const { baseUrl, workspace, tool } = resolveStudioBaseRoute(\n      typeof options.studioUrl == \"function\" ? options.studioUrl(sourceDoc) : options.studioUrl\n    );\n    if (!baseUrl) return;\n    const { _id, _type, _projectId, _dataset } = sourceDoc;\n    return {\n      baseUrl,\n      workspace,\n      tool,\n      id: _id,\n      type: _type,\n      path: parseJsonPath(sourcePath + pathSuffix),\n      projectId: _projectId,\n      dataset: _dataset\n    };\n  }\n}\nfunction resolveStudioBaseRoute(studioUrl) {\n  let baseUrl = typeof studioUrl == \"string\" ? studioUrl : studioUrl.baseUrl;\n  return baseUrl !== \"/\" && (baseUrl = baseUrl.replace(/\\/$/, \"\")), typeof studioUrl == \"string\" ? { baseUrl } : { ...studioUrl, baseUrl };\n}\n\n//# sourceMappingURL=resolveEditInfo.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvY2xpZW50L2Rpc3QvX2NodW5rcy1lcy9yZXNvbHZlRWRpdEluZm8uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtQkFBbUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTyxHQUFHLFFBQVE7QUFDbEM7QUFDQSxnQkFBZ0IsT0FBTyxFQUFFLG1CQUFtQixFQUFFLFFBQVE7QUFDdEQ7QUFDQSxnQkFBZ0IsT0FBTyxVQUFVLGFBQWE7QUFDOUM7QUFDQTtBQUNBLGdCQUFnQixPQUFPLEdBQUcsS0FBSyxHQUFHLEdBQUc7QUFDckM7QUFDQSxrREFBa0Qsd0JBQXdCO0FBQzFFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHNHQUFzRyxjQUFjLEVBQUUsZUFBZSx1QkFBdUIsZUFBZSxFQUFFLGVBQWU7QUFDNUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGVBQWUsRUFBRSxRQUFRLEVBQUUsZUFBZSxFQUFFLG1CQUFtQjtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHdEQUF3RCw0REFBNEQsdUNBQXVDLFFBQVEsMENBQTBDLHlEQUF5RCxXQUFXLGVBQWUsYUFBYTtBQUMxVDtBQUNBO0FBQ0EsaUVBQWlFLDREQUE0RCx1Q0FBdUMsUUFBUSwwQ0FBMEMseURBQXlELFdBQVcsZUFBZTtBQUN6UztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsdUNBQXVDO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLHVDQUF1Qyx3QkFBd0I7QUFDL0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCx3QkFBd0I7QUFDdEY7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLHVDQUF1Qyx3QkFBd0I7QUFDL0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHdCQUF3QjtBQUMvRCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELFFBQVE7QUFDMUQsb0JBQW9CLDRDQUE0QztBQUNoRTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsc0RBQVE7QUFDbEI7QUFDQTtBQUNBLHFEQUFxRCxtQkFBbUI7QUFDeEU7QUFDQTtBQUNBLEtBQUs7QUFDTCxNQUFNLHNEQUFRO0FBQ2Q7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxHQUFHO0FBQ2IsWUFBWSxLQUFLO0FBQ2pCLFlBQVksb0NBQW9DO0FBQ2hEO0FBQ0EsMkNBQTJDLEtBQUssdUNBQXVDLG9CQUFvQixHQUFHLEdBQUcsYUFBYTtBQUM5SDtBQUNBO0FBQ0EsVUFBVSxtQ0FBbUMsYUFBYSxzQkFBc0I7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDJCQUEyQjtBQUN2QztBQUNBO0FBQ0E7QUFDQSxZQUFZLG1DQUFtQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUdBQXFHLFVBQVUsSUFBSTtBQUNuSDtBQXdCRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9jbGllbnQvZGlzdC9fY2h1bmtzLWVzL3Jlc29sdmVFZGl0SW5mby5qcz81NTUwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzUmVjb3JkIH0gZnJvbSBcIi4vaXNSZWNvcmQuanNcIjtcbmNvbnN0IHJlUHJvcE5hbWUgPSAvW14uW1xcXV0rfFxcWyg/OigtP1xcZCsoPzpcXC5cXGQrKT8pfChbXCInXSkoKD86KD8hXFwyKVteXFxcXF18XFxcXC4pKj8pXFwyKVxcXXwoPz0oPzpcXC58XFxbXFxdKSg/OlxcLnxcXFtcXF18JCkpL2csIHJlS2V5U2VnbWVudCA9IC9fa2V5XFxzKj09XFxzKlsnXCJdKC4qKVsnXCJdLywgcmVJbmRleFR1cGxlID0gL15cXGQqOlxcZCokLztcbmZ1bmN0aW9uIGlzSW5kZXhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWdtZW50ID09IFwibnVtYmVyXCIgfHwgdHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiAmJiAvXlxcW1xcZCtcXF0kLy50ZXN0KHNlZ21lbnQpO1xufVxuZnVuY3Rpb24gaXNLZXlTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgPyByZUtleVNlZ21lbnQudGVzdChzZWdtZW50LnRyaW0oKSkgOiB0eXBlb2Ygc2VnbWVudCA9PSBcIm9iamVjdFwiICYmIFwiX2tleVwiIGluIHNlZ21lbnQ7XG59XG5mdW5jdGlvbiBpc0luZGV4VHVwbGUoc2VnbWVudCkge1xuICBpZiAodHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiAmJiByZUluZGV4VHVwbGUudGVzdChzZWdtZW50KSlcbiAgICByZXR1cm4gITA7XG4gIGlmICghQXJyYXkuaXNBcnJheShzZWdtZW50KSB8fCBzZWdtZW50Lmxlbmd0aCAhPT0gMilcbiAgICByZXR1cm4gITE7XG4gIGNvbnN0IFtmcm9tLCB0b10gPSBzZWdtZW50O1xuICByZXR1cm4gKHR5cGVvZiBmcm9tID09IFwibnVtYmVyXCIgfHwgZnJvbSA9PT0gXCJcIikgJiYgKHR5cGVvZiB0byA9PSBcIm51bWJlclwiIHx8IHRvID09PSBcIlwiKTtcbn1cbmZ1bmN0aW9uIGdldChvYmosIHBhdGgsIGRlZmF1bHRWYWwpIHtcbiAgY29uc3Qgc2VsZWN0ID0gdHlwZW9mIHBhdGggPT0gXCJzdHJpbmdcIiA/IGZyb21TdHJpbmcocGF0aCkgOiBwYXRoO1xuICBpZiAoIUFycmF5LmlzQXJyYXkoc2VsZWN0KSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXRoIG11c3QgYmUgYW4gYXJyYXkgb3IgYSBzdHJpbmdcIik7XG4gIGxldCBhY2MgPSBvYmo7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc2VnbWVudCA9IHNlbGVjdFtpXTtcbiAgICBpZiAoaXNJbmRleFNlZ21lbnQoc2VnbWVudCkpIHtcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShhY2MpKVxuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbDtcbiAgICAgIGFjYyA9IGFjY1tzZWdtZW50XTtcbiAgICB9XG4gICAgaWYgKGlzS2V5U2VnbWVudChzZWdtZW50KSkge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFjYykpXG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsO1xuICAgICAgYWNjID0gYWNjLmZpbmQoKGl0ZW0pID0+IGl0ZW0uX2tleSA9PT0gc2VnbWVudC5fa2V5KTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgJiYgKGFjYyA9IHR5cGVvZiBhY2MgPT0gXCJvYmplY3RcIiAmJiBhY2MgIT09IG51bGwgPyBhY2Nbc2VnbWVudF0gOiB2b2lkIDApLCB0eXBlb2YgYWNjID4gXCJ1XCIpXG4gICAgICByZXR1cm4gZGVmYXVsdFZhbDtcbiAgfVxuICByZXR1cm4gYWNjO1xufVxuZnVuY3Rpb24gdG9TdHJpbmcocGF0aCkge1xuICBpZiAoIUFycmF5LmlzQXJyYXkocGF0aCkpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUGF0aCBpcyBub3QgYW4gYXJyYXlcIik7XG4gIHJldHVybiBwYXRoLnJlZHVjZSgodGFyZ2V0LCBzZWdtZW50LCBpKSA9PiB7XG4gICAgY29uc3Qgc2VnbWVudFR5cGUgPSB0eXBlb2Ygc2VnbWVudDtcbiAgICBpZiAoc2VnbWVudFR5cGUgPT09IFwibnVtYmVyXCIpXG4gICAgICByZXR1cm4gYCR7dGFyZ2V0fVske3NlZ21lbnR9XWA7XG4gICAgaWYgKHNlZ21lbnRUeXBlID09PSBcInN0cmluZ1wiKVxuICAgICAgcmV0dXJuIGAke3RhcmdldH0ke2kgPT09IDAgPyBcIlwiIDogXCIuXCJ9JHtzZWdtZW50fWA7XG4gICAgaWYgKGlzS2V5U2VnbWVudChzZWdtZW50KSAmJiBzZWdtZW50Ll9rZXkpXG4gICAgICByZXR1cm4gYCR7dGFyZ2V0fVtfa2V5PT1cIiR7c2VnbWVudC5fa2V5fVwiXWA7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoc2VnbWVudCkpIHtcbiAgICAgIGNvbnN0IFtmcm9tLCB0b10gPSBzZWdtZW50O1xuICAgICAgcmV0dXJuIGAke3RhcmdldH1bJHtmcm9tfToke3RvfV1gO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHBhdGggc2VnbWVudCBcXGAke0pTT04uc3RyaW5naWZ5KHNlZ21lbnQpfVxcYGApO1xuICB9LCBcIlwiKTtcbn1cbmZ1bmN0aW9uIGZyb21TdHJpbmcocGF0aCkge1xuICBpZiAodHlwZW9mIHBhdGggIT0gXCJzdHJpbmdcIilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXRoIGlzIG5vdCBhIHN0cmluZ1wiKTtcbiAgY29uc3Qgc2VnbWVudHMgPSBwYXRoLm1hdGNoKHJlUHJvcE5hbWUpO1xuICBpZiAoIXNlZ21lbnRzKVxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGF0aCBzdHJpbmdcIik7XG4gIHJldHVybiBzZWdtZW50cy5tYXAocGFyc2VQYXRoU2VnbWVudCk7XG59XG5mdW5jdGlvbiBwYXJzZVBhdGhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIGlzSW5kZXhTZWdtZW50KHNlZ21lbnQpID8gcGFyc2VJbmRleFNlZ21lbnQoc2VnbWVudCkgOiBpc0tleVNlZ21lbnQoc2VnbWVudCkgPyBwYXJzZUtleVNlZ21lbnQoc2VnbWVudCkgOiBpc0luZGV4VHVwbGUoc2VnbWVudCkgPyBwYXJzZUluZGV4VHVwbGVTZWdtZW50KHNlZ21lbnQpIDogc2VnbWVudDtcbn1cbmZ1bmN0aW9uIHBhcnNlSW5kZXhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIE51bWJlcihzZWdtZW50LnJlcGxhY2UoL1teXFxkXS9nLCBcIlwiKSk7XG59XG5mdW5jdGlvbiBwYXJzZUtleVNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4geyBfa2V5OiBzZWdtZW50Lm1hdGNoKHJlS2V5U2VnbWVudClbMV0gfTtcbn1cbmZ1bmN0aW9uIHBhcnNlSW5kZXhUdXBsZVNlZ21lbnQoc2VnbWVudCkge1xuICBjb25zdCBbZnJvbSwgdG9dID0gc2VnbWVudC5zcGxpdChcIjpcIikubWFwKChzZWcpID0+IHNlZyA9PT0gXCJcIiA/IHNlZyA6IE51bWJlcihzZWcpKTtcbiAgcmV0dXJuIFtmcm9tLCB0b107XG59XG52YXIgc3R1ZGlvUGF0aCA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBmcm9tU3RyaW5nLFxuICBnZXQsXG4gIGlzSW5kZXhTZWdtZW50LFxuICBpc0luZGV4VHVwbGUsXG4gIGlzS2V5U2VnbWVudCxcbiAgcmVLZXlTZWdtZW50LFxuICB0b1N0cmluZ1xufSk7XG5jb25zdCBEUkFGVFNfRk9MREVSID0gXCJkcmFmdHNcIiwgVkVSU0lPTl9GT0xERVIgPSBcInZlcnNpb25zXCIsIFBBVEhfU0VQQVJBVE9SID0gXCIuXCIsIERSQUZUU19QUkVGSVggPSBgJHtEUkFGVFNfRk9MREVSfSR7UEFUSF9TRVBBUkFUT1J9YCwgVkVSU0lPTl9QUkVGSVggPSBgJHtWRVJTSU9OX0ZPTERFUn0ke1BBVEhfU0VQQVJBVE9SfWA7XG5mdW5jdGlvbiBpc0RyYWZ0SWQoaWQpIHtcbiAgcmV0dXJuIGlkLnN0YXJ0c1dpdGgoRFJBRlRTX1BSRUZJWCk7XG59XG5mdW5jdGlvbiBpc1ZlcnNpb25JZChpZCkge1xuICByZXR1cm4gaWQuc3RhcnRzV2l0aChWRVJTSU9OX1BSRUZJWCk7XG59XG5mdW5jdGlvbiBpc1B1Ymxpc2hlZElkKGlkKSB7XG4gIHJldHVybiAhaXNEcmFmdElkKGlkKSAmJiAhaXNWZXJzaW9uSWQoaWQpO1xufVxuZnVuY3Rpb24gZ2V0RHJhZnRJZChpZCkge1xuICBpZiAoaXNWZXJzaW9uSWQoaWQpKSB7XG4gICAgY29uc3QgcHVibGlzaGVkSWQgPSBnZXRQdWJsaXNoZWRJZChpZCk7XG4gICAgcmV0dXJuIERSQUZUU19QUkVGSVggKyBwdWJsaXNoZWRJZDtcbiAgfVxuICByZXR1cm4gaXNEcmFmdElkKGlkKSA/IGlkIDogRFJBRlRTX1BSRUZJWCArIGlkO1xufVxuZnVuY3Rpb24gZ2V0VmVyc2lvbklkKGlkLCB2ZXJzaW9uKSB7XG4gIGlmICh2ZXJzaW9uID09PSBcImRyYWZ0c1wiIHx8IHZlcnNpb24gPT09IFwicHVibGlzaGVkXCIpXG4gICAgdGhyb3cgbmV3IEVycm9yKCdWZXJzaW9uIGNhbiBub3QgYmUgXCJwdWJsaXNoZWRcIiBvciBcImRyYWZ0c1wiJyk7XG4gIHJldHVybiBgJHtWRVJTSU9OX1BSRUZJWH0ke3ZlcnNpb259JHtQQVRIX1NFUEFSQVRPUn0ke2dldFB1Ymxpc2hlZElkKGlkKX1gO1xufVxuZnVuY3Rpb24gZ2V0VmVyc2lvbkZyb21JZChpZCkge1xuICBpZiAoIWlzVmVyc2lvbklkKGlkKSkgcmV0dXJuO1xuICBjb25zdCBbX3ZlcnNpb25QcmVmaXgsIHZlcnNpb25JZCwgLi4uX3B1Ymxpc2hlZElkXSA9IGlkLnNwbGl0KFBBVEhfU0VQQVJBVE9SKTtcbiAgcmV0dXJuIHZlcnNpb25JZDtcbn1cbmZ1bmN0aW9uIGdldFB1Ymxpc2hlZElkKGlkKSB7XG4gIHJldHVybiBpc1ZlcnNpb25JZChpZCkgPyBpZC5zcGxpdChQQVRIX1NFUEFSQVRPUikuc2xpY2UoMikuam9pbihQQVRIX1NFUEFSQVRPUikgOiBpc0RyYWZ0SWQoaWQpID8gaWQuc2xpY2UoRFJBRlRTX1BSRUZJWC5sZW5ndGgpIDogaWQ7XG59XG5jb25zdCBFU0NBUEUgPSB7XG4gIFwiXFxmXCI6IFwiXFxcXGZcIixcbiAgXCJcXG5cIjogXCJcXFxcblwiLFxuICBcIlxcclwiOiBcIlxcXFxyXCIsXG4gIFwiXHRcIjogXCJcXFxcdFwiLFxuICBcIidcIjogXCJcXFxcJ1wiLFxuICBcIlxcXFxcIjogXCJcXFxcXFxcXFwiXG59LCBVTkVTQ0FQRSA9IHtcbiAgXCJcXFxcZlwiOiBcIlxcZlwiLFxuICBcIlxcXFxuXCI6IGBcbmAsXG4gIFwiXFxcXHJcIjogXCJcXHJcIixcbiAgXCJcXFxcdFwiOiBcIlx0XCIsXG4gIFwiXFxcXCdcIjogXCInXCIsXG4gIFwiXFxcXFxcXFxcIjogXCJcXFxcXCJcbn07XG5mdW5jdGlvbiBqc29uUGF0aChwYXRoKSB7XG4gIHJldHVybiBgJCR7cGF0aC5tYXAoKHNlZ21lbnQpID0+IHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgPyBgWycke3NlZ21lbnQucmVwbGFjZSgvW1xcZlxcblxcclxcdCdcXFxcXS9nLCAobWF0Y2gpID0+IEVTQ0FQRVttYXRjaF0pfSddYCA6IHR5cGVvZiBzZWdtZW50ID09IFwibnVtYmVyXCIgPyBgWyR7c2VnbWVudH1dYCA6IHNlZ21lbnQuX2tleSAhPT0gXCJcIiA/IGBbPyhALl9rZXk9PScke3NlZ21lbnQuX2tleS5yZXBsYWNlKC9bJ1xcXFxdL2csIChtYXRjaCkgPT4gRVNDQVBFW21hdGNoXSl9JyldYCA6IGBbJHtzZWdtZW50Ll9pbmRleH1dYCkuam9pbihcIlwiKX1gO1xufVxuZnVuY3Rpb24ganNvblBhdGhBcnJheShwYXRoKSB7XG4gIHJldHVybiBwYXRoLm1hcCgoc2VnbWVudCkgPT4gdHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiA/IGBbJyR7c2VnbWVudC5yZXBsYWNlKC9bXFxmXFxuXFxyXFx0J1xcXFxdL2csIChtYXRjaCkgPT4gRVNDQVBFW21hdGNoXSl9J11gIDogdHlwZW9mIHNlZ21lbnQgPT0gXCJudW1iZXJcIiA/IGBbJHtzZWdtZW50fV1gIDogc2VnbWVudC5fa2V5ICE9PSBcIlwiID8gYFs/KEAuX2tleT09JyR7c2VnbWVudC5fa2V5LnJlcGxhY2UoL1snXFxcXF0vZywgKG1hdGNoKSA9PiBFU0NBUEVbbWF0Y2hdKX0nKV1gIDogYFske3NlZ21lbnQuX2luZGV4fV1gKTtcbn1cbmZ1bmN0aW9uIHBhcnNlSnNvblBhdGgocGF0aCkge1xuICBjb25zdCBwYXJzZWQgPSBbXSwgcGFyc2VSZSA9IC9cXFsnKC4qPyknXFxdfFxcWyhcXGQrKVxcXXxcXFtcXD9cXChAXFwuX2tleT09JyguKj8pJ1xcKVxcXS9nO1xuICBsZXQgbWF0Y2g7XG4gIGZvciAoOyAobWF0Y2ggPSBwYXJzZVJlLmV4ZWMocGF0aCkpICE9PSBudWxsOyApIHtcbiAgICBpZiAobWF0Y2hbMV0gIT09IHZvaWQgMCkge1xuICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0ucmVwbGFjZSgvXFxcXChcXFxcfGZ8bnxyfHR8JykvZywgKG0pID0+IFVORVNDQVBFW21dKTtcbiAgICAgIHBhcnNlZC5wdXNoKGtleSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKG1hdGNoWzJdICE9PSB2b2lkIDApIHtcbiAgICAgIHBhcnNlZC5wdXNoKHBhcnNlSW50KG1hdGNoWzJdLCAxMCkpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChtYXRjaFszXSAhPT0gdm9pZCAwKSB7XG4gICAgICBjb25zdCBfa2V5ID0gbWF0Y2hbM10ucmVwbGFjZSgvXFxcXChcXFxcJykvZywgKG0pID0+IFVORVNDQVBFW21dKTtcbiAgICAgIHBhcnNlZC5wdXNoKHtcbiAgICAgICAgX2tleSxcbiAgICAgICAgX2luZGV4OiAtMVxuICAgICAgfSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcnNlZDtcbn1cbmZ1bmN0aW9uIGpzb25QYXRoVG9TdHVkaW9QYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGgubWFwKChzZWdtZW50KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHNlZ21lbnQgPT0gXCJudW1iZXJcIilcbiAgICAgIHJldHVybiBzZWdtZW50O1xuICAgIGlmIChzZWdtZW50Ll9rZXkgIT09IFwiXCIpXG4gICAgICByZXR1cm4geyBfa2V5OiBzZWdtZW50Ll9rZXkgfTtcbiAgICBpZiAoc2VnbWVudC5faW5kZXggIT09IC0xKVxuICAgICAgcmV0dXJuIHNlZ21lbnQuX2luZGV4O1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBzZWdtZW50OiR7SlNPTi5zdHJpbmdpZnkoc2VnbWVudCl9YCk7XG4gIH0pO1xufVxuZnVuY3Rpb24gc3R1ZGlvUGF0aFRvSnNvblBhdGgocGF0aCkge1xuICByZXR1cm4gKHR5cGVvZiBwYXRoID09IFwic3RyaW5nXCIgPyBmcm9tU3RyaW5nKHBhdGgpIDogcGF0aCkubWFwKChzZWdtZW50KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHNlZ21lbnQgPT0gXCJudW1iZXJcIilcbiAgICAgIHJldHVybiBzZWdtZW50O1xuICAgIGlmIChBcnJheS5pc0FycmF5KHNlZ21lbnQpKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmRleFR1cGxlIHNlZ21lbnRzIGFyZW4ndCBzdXBwb3J0ZWQ6JHtKU09OLnN0cmluZ2lmeShzZWdtZW50KX1gKTtcbiAgICBpZiAoaXNDb250ZW50U291cmNlTWFwUGFyc2VkUGF0aEtleWVkU2VnbWVudChzZWdtZW50KSlcbiAgICAgIHJldHVybiBzZWdtZW50O1xuICAgIGlmIChzZWdtZW50Ll9rZXkpXG4gICAgICByZXR1cm4geyBfa2V5OiBzZWdtZW50Ll9rZXksIF9pbmRleDogLTEgfTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgc2VnbWVudDoke0pTT04uc3RyaW5naWZ5KHNlZ21lbnQpfWApO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGlzQ29udGVudFNvdXJjZU1hcFBhcnNlZFBhdGhLZXllZFNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gdHlwZW9mIHNlZ21lbnQgPT0gXCJvYmplY3RcIiAmJiBcIl9rZXlcIiBpbiBzZWdtZW50ICYmIFwiX2luZGV4XCIgaW4gc2VnbWVudDtcbn1cbmZ1bmN0aW9uIGpzb25QYXRoVG9NYXBwaW5nUGF0aChwYXRoKSB7XG4gIHJldHVybiBwYXRoLm1hcCgoc2VnbWVudCkgPT4ge1xuICAgIGlmICh0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBzZWdtZW50ID09IFwibnVtYmVyXCIpXG4gICAgICByZXR1cm4gc2VnbWVudDtcbiAgICBpZiAoc2VnbWVudC5faW5kZXggIT09IC0xKVxuICAgICAgcmV0dXJuIHNlZ21lbnQuX2luZGV4O1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBzZWdtZW50OiR7SlNPTi5zdHJpbmdpZnkoc2VnbWVudCl9YCk7XG4gIH0pO1xufVxuZnVuY3Rpb24gcmVzb2x2ZU1hcHBpbmcocmVzdWx0UGF0aCwgY3NtKSB7XG4gIGlmICghY3NtPy5tYXBwaW5ncylcbiAgICByZXR1cm47XG4gIGNvbnN0IHJlc3VsdE1hcHBpbmdQYXRoID0ganNvblBhdGgoanNvblBhdGhUb01hcHBpbmdQYXRoKHJlc3VsdFBhdGgpKTtcbiAgaWYgKGNzbS5tYXBwaW5nc1tyZXN1bHRNYXBwaW5nUGF0aF0gIT09IHZvaWQgMClcbiAgICByZXR1cm4ge1xuICAgICAgbWFwcGluZzogY3NtLm1hcHBpbmdzW3Jlc3VsdE1hcHBpbmdQYXRoXSxcbiAgICAgIG1hdGNoZWRQYXRoOiByZXN1bHRNYXBwaW5nUGF0aCxcbiAgICAgIHBhdGhTdWZmaXg6IFwiXCJcbiAgICB9O1xuICBjb25zdCByZXN1bHRNYXBwaW5nUGF0aEFycmF5ID0ganNvblBhdGhBcnJheShqc29uUGF0aFRvTWFwcGluZ1BhdGgocmVzdWx0UGF0aCkpO1xuICBmb3IgKGxldCBpID0gcmVzdWx0TWFwcGluZ1BhdGhBcnJheS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGNvbnN0IGtleSA9IGAkJHtyZXN1bHRNYXBwaW5nUGF0aEFycmF5LnNsaWNlKDAsIGkpLmpvaW4oXCJcIil9YCwgbWFwcGluZ0ZvdW5kID0gY3NtLm1hcHBpbmdzW2tleV07XG4gICAgaWYgKG1hcHBpbmdGb3VuZCkge1xuICAgICAgY29uc3QgcGF0aFN1ZmZpeCA9IHJlc3VsdE1hcHBpbmdQYXRoLnN1YnN0cmluZyhrZXkubGVuZ3RoKTtcbiAgICAgIHJldHVybiB7IG1hcHBpbmc6IG1hcHBpbmdGb3VuZCwgbWF0Y2hlZFBhdGg6IGtleSwgcGF0aFN1ZmZpeCB9O1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gaXNBcnJheSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT09IG51bGwgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5mdW5jdGlvbiB3YWxrTWFwKHZhbHVlLCBtYXBwaW5nRm4sIHBhdGggPSBbXSkge1xuICBpZiAoaXNBcnJheSh2YWx1ZSkpXG4gICAgcmV0dXJuIHZhbHVlLm1hcCgodiwgaWR4KSA9PiB7XG4gICAgICBpZiAoaXNSZWNvcmQodikpIHtcbiAgICAgICAgY29uc3QgX2tleSA9IHYuX2tleTtcbiAgICAgICAgaWYgKHR5cGVvZiBfa2V5ID09IFwic3RyaW5nXCIpXG4gICAgICAgICAgcmV0dXJuIHdhbGtNYXAodiwgbWFwcGluZ0ZuLCBwYXRoLmNvbmNhdCh7IF9rZXksIF9pbmRleDogaWR4IH0pKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB3YWxrTWFwKHYsIG1hcHBpbmdGbiwgcGF0aC5jb25jYXQoaWR4KSk7XG4gICAgfSk7XG4gIGlmIChpc1JlY29yZCh2YWx1ZSkpIHtcbiAgICBpZiAodmFsdWUuX3R5cGUgPT09IFwiYmxvY2tcIiB8fCB2YWx1ZS5fdHlwZSA9PT0gXCJzcGFuXCIpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHsgLi4udmFsdWUgfTtcbiAgICAgIHJldHVybiB2YWx1ZS5fdHlwZSA9PT0gXCJibG9ja1wiID8gcmVzdWx0LmNoaWxkcmVuID0gd2Fsa01hcCh2YWx1ZS5jaGlsZHJlbiwgbWFwcGluZ0ZuLCBwYXRoLmNvbmNhdChcImNoaWxkcmVuXCIpKSA6IHZhbHVlLl90eXBlID09PSBcInNwYW5cIiAmJiAocmVzdWx0LnRleHQgPSB3YWxrTWFwKHZhbHVlLnRleHQsIG1hcHBpbmdGbiwgcGF0aC5jb25jYXQoXCJ0ZXh0XCIpKSksIHJlc3VsdDtcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgIE9iamVjdC5lbnRyaWVzKHZhbHVlKS5tYXAoKFtrLCB2XSkgPT4gW2ssIHdhbGtNYXAodiwgbWFwcGluZ0ZuLCBwYXRoLmNvbmNhdChrKSldKVxuICAgICk7XG4gIH1cbiAgcmV0dXJuIG1hcHBpbmdGbih2YWx1ZSwgcGF0aCk7XG59XG5mdW5jdGlvbiBjcmVhdGVFZGl0VXJsKG9wdGlvbnMpIHtcbiAgY29uc3Qge1xuICAgIGJhc2VVcmwsXG4gICAgd29ya3NwYWNlOiBfd29ya3NwYWNlID0gXCJkZWZhdWx0XCIsXG4gICAgdG9vbDogX3Rvb2wgPSBcImRlZmF1bHRcIixcbiAgICBpZDogX2lkLFxuICAgIHR5cGUsXG4gICAgcGF0aCxcbiAgICBwcm9qZWN0SWQsXG4gICAgZGF0YXNldFxuICB9ID0gb3B0aW9ucztcbiAgaWYgKCFiYXNlVXJsKVxuICAgIHRocm93IG5ldyBFcnJvcihcImJhc2VVcmwgaXMgcmVxdWlyZWRcIik7XG4gIGlmICghcGF0aClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJwYXRoIGlzIHJlcXVpcmVkXCIpO1xuICBpZiAoIV9pZClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJpZCBpcyByZXF1aXJlZFwiKTtcbiAgaWYgKGJhc2VVcmwgIT09IFwiL1wiICYmIGJhc2VVcmwuZW5kc1dpdGgoXCIvXCIpKVxuICAgIHRocm93IG5ldyBFcnJvcihcImJhc2VVcmwgbXVzdCBub3QgZW5kIHdpdGggYSBzbGFzaFwiKTtcbiAgY29uc3Qgd29ya3NwYWNlID0gX3dvcmtzcGFjZSA9PT0gXCJkZWZhdWx0XCIgPyB2b2lkIDAgOiBfd29ya3NwYWNlLCB0b29sID0gX3Rvb2wgPT09IFwiZGVmYXVsdFwiID8gdm9pZCAwIDogX3Rvb2wsIGlkID0gZ2V0UHVibGlzaGVkSWQoX2lkKSwgc3RyaW5naWZpZWRQYXRoID0gQXJyYXkuaXNBcnJheShwYXRoKSA/IHRvU3RyaW5nKGpzb25QYXRoVG9TdHVkaW9QYXRoKHBhdGgpKSA6IHBhdGgsIHNlYXJjaFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgIGJhc2VVcmwsXG4gICAgaWQsXG4gICAgdHlwZSxcbiAgICBwYXRoOiBzdHJpbmdpZmllZFBhdGhcbiAgfSk7XG4gIGlmICh3b3Jrc3BhY2UgJiYgc2VhcmNoUGFyYW1zLnNldChcIndvcmtzcGFjZVwiLCB3b3Jrc3BhY2UpLCB0b29sICYmIHNlYXJjaFBhcmFtcy5zZXQoXCJ0b29sXCIsIHRvb2wpLCBwcm9qZWN0SWQgJiYgc2VhcmNoUGFyYW1zLnNldChcInByb2plY3RJZFwiLCBwcm9qZWN0SWQpLCBkYXRhc2V0ICYmIHNlYXJjaFBhcmFtcy5zZXQoXCJkYXRhc2V0XCIsIGRhdGFzZXQpLCBpc1B1Ymxpc2hlZElkKF9pZCkpXG4gICAgc2VhcmNoUGFyYW1zLnNldChcInBlcnNwZWN0aXZlXCIsIFwicHVibGlzaGVkXCIpO1xuICBlbHNlIGlmIChpc1ZlcnNpb25JZChfaWQpKSB7XG4gICAgY29uc3QgdmVyc2lvbklkID0gZ2V0VmVyc2lvbkZyb21JZChfaWQpO1xuICAgIHNlYXJjaFBhcmFtcy5zZXQoXCJwZXJzcGVjdGl2ZVwiLCB2ZXJzaW9uSWQpO1xuICB9XG4gIGNvbnN0IHNlZ21lbnRzID0gW2Jhc2VVcmwgPT09IFwiL1wiID8gXCJcIiA6IGJhc2VVcmxdO1xuICB3b3Jrc3BhY2UgJiYgc2VnbWVudHMucHVzaCh3b3Jrc3BhY2UpO1xuICBjb25zdCByb3V0ZXJQYXJhbXMgPSBbXG4gICAgXCJtb2RlPXByZXNlbnRhdGlvblwiLFxuICAgIGBpZD0ke2lkfWAsXG4gICAgYHR5cGU9JHt0eXBlfWAsXG4gICAgYHBhdGg9JHtlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZpZWRQYXRoKX1gXG4gIF07XG4gIHJldHVybiB0b29sICYmIHJvdXRlclBhcmFtcy5wdXNoKGB0b29sPSR7dG9vbH1gKSwgc2VnbWVudHMucHVzaChcImludGVudFwiLCBcImVkaXRcIiwgYCR7cm91dGVyUGFyYW1zLmpvaW4oXCI7XCIpfT8ke3NlYXJjaFBhcmFtc31gKSwgc2VnbWVudHMuam9pbihcIi9cIik7XG59XG5mdW5jdGlvbiByZXNvbHZlRWRpdEluZm8ob3B0aW9ucykge1xuICBjb25zdCB7IHJlc3VsdFNvdXJjZU1hcDogY3NtLCByZXN1bHRQYXRoIH0gPSBvcHRpb25zLCB7IG1hcHBpbmcsIHBhdGhTdWZmaXggfSA9IHJlc29sdmVNYXBwaW5nKHJlc3VsdFBhdGgsIGNzbSkgfHwge307XG4gIGlmICghbWFwcGluZyB8fCBtYXBwaW5nLnNvdXJjZS50eXBlID09PSBcImxpdGVyYWxcIiB8fCBtYXBwaW5nLnNvdXJjZS50eXBlID09PSBcInVua25vd25cIilcbiAgICByZXR1cm47XG4gIGNvbnN0IHNvdXJjZURvYyA9IGNzbS5kb2N1bWVudHNbbWFwcGluZy5zb3VyY2UuZG9jdW1lbnRdLCBzb3VyY2VQYXRoID0gY3NtLnBhdGhzW21hcHBpbmcuc291cmNlLnBhdGhdO1xuICBpZiAoc291cmNlRG9jICYmIHNvdXJjZVBhdGgpIHtcbiAgICBjb25zdCB7IGJhc2VVcmwsIHdvcmtzcGFjZSwgdG9vbCB9ID0gcmVzb2x2ZVN0dWRpb0Jhc2VSb3V0ZShcbiAgICAgIHR5cGVvZiBvcHRpb25zLnN0dWRpb1VybCA9PSBcImZ1bmN0aW9uXCIgPyBvcHRpb25zLnN0dWRpb1VybChzb3VyY2VEb2MpIDogb3B0aW9ucy5zdHVkaW9VcmxcbiAgICApO1xuICAgIGlmICghYmFzZVVybCkgcmV0dXJuO1xuICAgIGNvbnN0IHsgX2lkLCBfdHlwZSwgX3Byb2plY3RJZCwgX2RhdGFzZXQgfSA9IHNvdXJjZURvYztcbiAgICByZXR1cm4ge1xuICAgICAgYmFzZVVybCxcbiAgICAgIHdvcmtzcGFjZSxcbiAgICAgIHRvb2wsXG4gICAgICBpZDogX2lkLFxuICAgICAgdHlwZTogX3R5cGUsXG4gICAgICBwYXRoOiBwYXJzZUpzb25QYXRoKHNvdXJjZVBhdGggKyBwYXRoU3VmZml4KSxcbiAgICAgIHByb2plY3RJZDogX3Byb2plY3RJZCxcbiAgICAgIGRhdGFzZXQ6IF9kYXRhc2V0XG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gcmVzb2x2ZVN0dWRpb0Jhc2VSb3V0ZShzdHVkaW9VcmwpIHtcbiAgbGV0IGJhc2VVcmwgPSB0eXBlb2Ygc3R1ZGlvVXJsID09IFwic3RyaW5nXCIgPyBzdHVkaW9VcmwgOiBzdHVkaW9VcmwuYmFzZVVybDtcbiAgcmV0dXJuIGJhc2VVcmwgIT09IFwiL1wiICYmIChiYXNlVXJsID0gYmFzZVVybC5yZXBsYWNlKC9cXC8kLywgXCJcIikpLCB0eXBlb2Ygc3R1ZGlvVXJsID09IFwic3RyaW5nXCIgPyB7IGJhc2VVcmwgfSA6IHsgLi4uc3R1ZGlvVXJsLCBiYXNlVXJsIH07XG59XG5leHBvcnQge1xuICBEUkFGVFNfRk9MREVSLFxuICBWRVJTSU9OX0ZPTERFUixcbiAgY3JlYXRlRWRpdFVybCxcbiAgZ2V0LFxuICBnZXREcmFmdElkLFxuICBnZXRQdWJsaXNoZWRJZCxcbiAgZ2V0VmVyc2lvbkZyb21JZCxcbiAgZ2V0VmVyc2lvbklkLFxuICBpc0RyYWZ0SWQsXG4gIGlzUHVibGlzaGVkSWQsXG4gIGlzVmVyc2lvbklkLFxuICBqc29uUGF0aCxcbiAganNvblBhdGhUb1N0dWRpb1BhdGgsXG4gIHBhcnNlSnNvblBhdGgsXG4gIHJlS2V5U2VnbWVudCxcbiAgcmVzb2x2ZUVkaXRJbmZvLFxuICByZXNvbHZlTWFwcGluZyxcbiAgcmVzb2x2ZVN0dWRpb0Jhc2VSb3V0ZSxcbiAgc3R1ZGlvUGF0aCxcbiAgc3R1ZGlvUGF0aFRvSnNvblBhdGgsXG4gIHRvU3RyaW5nLFxuICB3YWxrTWFwXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVzb2x2ZUVkaXRJbmZvLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   arrify: () => (/* binding */ arrify)\n/* harmony export */ });\nfunction arrify(val) {\n  return Array.isArray(val) ? val : [val];\n}\n\n//# sourceMappingURL=arrify.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9hcnJpZnkuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUdFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4vbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L211dGF0ZS9kaXN0L19jaHVua3MtZXMvYXJyaWZ5LmpzPzI5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gYXJyaWZ5KHZhbCkge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWwpID8gdmFsIDogW3ZhbF07XG59XG5leHBvcnQge1xuICBhcnJpZnlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcnJpZnkuanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   decodeAll: () => (/* binding */ decodeAll)\n/* harmony export */ });\n/* harmony import */ var _parse_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parse.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js\");\n\nfunction isCreateIfNotExistsMutation(sanityMutation) {\n  return \"createIfNotExists\" in sanityMutation;\n}\nfunction isCreateOrReplaceMutation(sanityMutation) {\n  return \"createOrReplace\" in sanityMutation;\n}\nfunction isCreateMutation(sanityMutation) {\n  return \"create\" in sanityMutation;\n}\nfunction isDeleteMutation(sanityMutation) {\n  return \"delete\" in sanityMutation;\n}\nfunction isPatchMutation(sanityMutation) {\n  return \"patch\" in sanityMutation;\n}\nfunction isSetPatch(sanityPatch) {\n  return \"set\" in sanityPatch;\n}\nfunction isSetIfMissingPatch(sanityPatch) {\n  return \"setIfMissing\" in sanityPatch;\n}\nfunction isUnsetPatch(sanityPatch) {\n  return \"unset\" in sanityPatch;\n}\nfunction isIncPatch(sanityPatch) {\n  return \"inc\" in sanityPatch;\n}\nfunction isDecPatch(sanityPatch) {\n  return \"inc\" in sanityPatch;\n}\nfunction isInsertPatch(sanityPatch) {\n  return \"insert\" in sanityPatch;\n}\nfunction decodeAll(sanityMutations) {\n  return sanityMutations.map(decodeMutation);\n}\nfunction decode(encodedMutation) {\n  return decodeMutation(encodedMutation);\n}\nfunction decodeMutation(encodedMutation) {\n  if (isCreateIfNotExistsMutation(encodedMutation))\n    return {\n      type: \"createIfNotExists\",\n      document: encodedMutation.createIfNotExists\n    };\n  if (isCreateOrReplaceMutation(encodedMutation))\n    return {\n      type: \"createOrReplace\",\n      document: encodedMutation.createOrReplace\n    };\n  if (isCreateMutation(encodedMutation))\n    return { type: \"create\", document: encodedMutation.create };\n  if (isDeleteMutation(encodedMutation))\n    return { id: encodedMutation.delete.id, type: \"delete\" };\n  if (isPatchMutation(encodedMutation))\n    return {\n      type: \"patch\",\n      id: encodedMutation.patch.id,\n      patches: decodeNodePatches(encodedMutation.patch)\n    };\n  throw new Error(`Unknown mutation: ${JSON.stringify(encodedMutation)}`);\n}\nconst POSITION_KEYS = [\"before\", \"replace\", \"after\"];\nfunction getInsertPosition(insert) {\n  const positions = POSITION_KEYS.filter((k) => k in insert);\n  if (positions.length > 1)\n    throw new Error(\n      `Insert patch is ambiguous. Should only contain one of: ${POSITION_KEYS.join(\n        \", \"\n      )}, instead found ${positions.join(\", \")}`\n    );\n  return positions[0];\n}\nfunction decodeNodePatches(patch) {\n  return [\n    ...getSetPatches(patch),\n    ...getSetIfMissingPatches(patch),\n    ...getUnsetPatches(patch),\n    ...getIncPatches(patch),\n    ...getDecPatches(patch),\n    ...getInsertPatches(patch)\n  ];\n}\nfunction getSetPatches(patch) {\n  return isSetPatch(patch) ? Object.keys(patch.set).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"set\", value: patch.set[path] }\n  })) : [];\n}\nfunction getSetIfMissingPatches(patch) {\n  return isSetIfMissingPatch(patch) ? Object.keys(patch.setIfMissing).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"setIfMissing\", value: patch.setIfMissing[path] }\n  })) : [];\n}\nfunction getUnsetPatches(patch) {\n  return isUnsetPatch(patch) ? patch.unset.map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"unset\" }\n  })) : [];\n}\nfunction getIncPatches(patch) {\n  return isIncPatch(patch) ? Object.keys(patch.inc).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"inc\", amount: patch.inc[path] }\n  })) : [];\n}\nfunction getDecPatches(patch) {\n  return isDecPatch(patch) ? Object.keys(patch.dec).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"dec\", amount: patch.dec[path] }\n  })) : [];\n}\nfunction getInsertPatches(patch) {\n  if (!isInsertPatch(patch))\n    return [];\n  const position = getInsertPosition(patch.insert);\n  if (!position)\n    throw new Error(\"Insert patch missing position\");\n  const path = (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(patch.insert[position]), referenceItem = path.pop(), op = position === \"replace\" ? {\n    type: \"insert\",\n    position,\n    referenceItem,\n    items: patch.insert.items\n  } : {\n    type: \"insert\",\n    position,\n    referenceItem,\n    items: patch.insert.items\n  };\n  return [{ path, op }];\n}\n\n//# sourceMappingURL=decode.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9kZWNvZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsZ0NBQWdDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRTtBQUNoRTtBQUNBLFFBQVEsa0JBQWtCLHFCQUFxQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0RBQUs7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksVUFBVTtBQUN0QjtBQUlFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4vbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L211dGF0ZS9kaXN0L19jaHVua3MtZXMvZGVjb2RlLmpzP2VjZGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9wYXJzZS5qc1wiO1xuZnVuY3Rpb24gaXNDcmVhdGVJZk5vdEV4aXN0c011dGF0aW9uKHNhbml0eU11dGF0aW9uKSB7XG4gIHJldHVybiBcImNyZWF0ZUlmTm90RXhpc3RzXCIgaW4gc2FuaXR5TXV0YXRpb247XG59XG5mdW5jdGlvbiBpc0NyZWF0ZU9yUmVwbGFjZU11dGF0aW9uKHNhbml0eU11dGF0aW9uKSB7XG4gIHJldHVybiBcImNyZWF0ZU9yUmVwbGFjZVwiIGluIHNhbml0eU11dGF0aW9uO1xufVxuZnVuY3Rpb24gaXNDcmVhdGVNdXRhdGlvbihzYW5pdHlNdXRhdGlvbikge1xuICByZXR1cm4gXCJjcmVhdGVcIiBpbiBzYW5pdHlNdXRhdGlvbjtcbn1cbmZ1bmN0aW9uIGlzRGVsZXRlTXV0YXRpb24oc2FuaXR5TXV0YXRpb24pIHtcbiAgcmV0dXJuIFwiZGVsZXRlXCIgaW4gc2FuaXR5TXV0YXRpb247XG59XG5mdW5jdGlvbiBpc1BhdGNoTXV0YXRpb24oc2FuaXR5TXV0YXRpb24pIHtcbiAgcmV0dXJuIFwicGF0Y2hcIiBpbiBzYW5pdHlNdXRhdGlvbjtcbn1cbmZ1bmN0aW9uIGlzU2V0UGF0Y2goc2FuaXR5UGF0Y2gpIHtcbiAgcmV0dXJuIFwic2V0XCIgaW4gc2FuaXR5UGF0Y2g7XG59XG5mdW5jdGlvbiBpc1NldElmTWlzc2luZ1BhdGNoKHNhbml0eVBhdGNoKSB7XG4gIHJldHVybiBcInNldElmTWlzc2luZ1wiIGluIHNhbml0eVBhdGNoO1xufVxuZnVuY3Rpb24gaXNVbnNldFBhdGNoKHNhbml0eVBhdGNoKSB7XG4gIHJldHVybiBcInVuc2V0XCIgaW4gc2FuaXR5UGF0Y2g7XG59XG5mdW5jdGlvbiBpc0luY1BhdGNoKHNhbml0eVBhdGNoKSB7XG4gIHJldHVybiBcImluY1wiIGluIHNhbml0eVBhdGNoO1xufVxuZnVuY3Rpb24gaXNEZWNQYXRjaChzYW5pdHlQYXRjaCkge1xuICByZXR1cm4gXCJpbmNcIiBpbiBzYW5pdHlQYXRjaDtcbn1cbmZ1bmN0aW9uIGlzSW5zZXJ0UGF0Y2goc2FuaXR5UGF0Y2gpIHtcbiAgcmV0dXJuIFwiaW5zZXJ0XCIgaW4gc2FuaXR5UGF0Y2g7XG59XG5mdW5jdGlvbiBkZWNvZGVBbGwoc2FuaXR5TXV0YXRpb25zKSB7XG4gIHJldHVybiBzYW5pdHlNdXRhdGlvbnMubWFwKGRlY29kZU11dGF0aW9uKTtcbn1cbmZ1bmN0aW9uIGRlY29kZShlbmNvZGVkTXV0YXRpb24pIHtcbiAgcmV0dXJuIGRlY29kZU11dGF0aW9uKGVuY29kZWRNdXRhdGlvbik7XG59XG5mdW5jdGlvbiBkZWNvZGVNdXRhdGlvbihlbmNvZGVkTXV0YXRpb24pIHtcbiAgaWYgKGlzQ3JlYXRlSWZOb3RFeGlzdHNNdXRhdGlvbihlbmNvZGVkTXV0YXRpb24pKVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcImNyZWF0ZUlmTm90RXhpc3RzXCIsXG4gICAgICBkb2N1bWVudDogZW5jb2RlZE11dGF0aW9uLmNyZWF0ZUlmTm90RXhpc3RzXG4gICAgfTtcbiAgaWYgKGlzQ3JlYXRlT3JSZXBsYWNlTXV0YXRpb24oZW5jb2RlZE11dGF0aW9uKSlcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJjcmVhdGVPclJlcGxhY2VcIixcbiAgICAgIGRvY3VtZW50OiBlbmNvZGVkTXV0YXRpb24uY3JlYXRlT3JSZXBsYWNlXG4gICAgfTtcbiAgaWYgKGlzQ3JlYXRlTXV0YXRpb24oZW5jb2RlZE11dGF0aW9uKSlcbiAgICByZXR1cm4geyB0eXBlOiBcImNyZWF0ZVwiLCBkb2N1bWVudDogZW5jb2RlZE11dGF0aW9uLmNyZWF0ZSB9O1xuICBpZiAoaXNEZWxldGVNdXRhdGlvbihlbmNvZGVkTXV0YXRpb24pKVxuICAgIHJldHVybiB7IGlkOiBlbmNvZGVkTXV0YXRpb24uZGVsZXRlLmlkLCB0eXBlOiBcImRlbGV0ZVwiIH07XG4gIGlmIChpc1BhdGNoTXV0YXRpb24oZW5jb2RlZE11dGF0aW9uKSlcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJwYXRjaFwiLFxuICAgICAgaWQ6IGVuY29kZWRNdXRhdGlvbi5wYXRjaC5pZCxcbiAgICAgIHBhdGNoZXM6IGRlY29kZU5vZGVQYXRjaGVzKGVuY29kZWRNdXRhdGlvbi5wYXRjaClcbiAgICB9O1xuICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gbXV0YXRpb246ICR7SlNPTi5zdHJpbmdpZnkoZW5jb2RlZE11dGF0aW9uKX1gKTtcbn1cbmNvbnN0IFBPU0lUSU9OX0tFWVMgPSBbXCJiZWZvcmVcIiwgXCJyZXBsYWNlXCIsIFwiYWZ0ZXJcIl07XG5mdW5jdGlvbiBnZXRJbnNlcnRQb3NpdGlvbihpbnNlcnQpIHtcbiAgY29uc3QgcG9zaXRpb25zID0gUE9TSVRJT05fS0VZUy5maWx0ZXIoKGspID0+IGsgaW4gaW5zZXJ0KTtcbiAgaWYgKHBvc2l0aW9ucy5sZW5ndGggPiAxKVxuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBJbnNlcnQgcGF0Y2ggaXMgYW1iaWd1b3VzLiBTaG91bGQgb25seSBjb250YWluIG9uZSBvZjogJHtQT1NJVElPTl9LRVlTLmpvaW4oXG4gICAgICAgIFwiLCBcIlxuICAgICAgKX0sIGluc3RlYWQgZm91bmQgJHtwb3NpdGlvbnMuam9pbihcIiwgXCIpfWBcbiAgICApO1xuICByZXR1cm4gcG9zaXRpb25zWzBdO1xufVxuZnVuY3Rpb24gZGVjb2RlTm9kZVBhdGNoZXMocGF0Y2gpIHtcbiAgcmV0dXJuIFtcbiAgICAuLi5nZXRTZXRQYXRjaGVzKHBhdGNoKSxcbiAgICAuLi5nZXRTZXRJZk1pc3NpbmdQYXRjaGVzKHBhdGNoKSxcbiAgICAuLi5nZXRVbnNldFBhdGNoZXMocGF0Y2gpLFxuICAgIC4uLmdldEluY1BhdGNoZXMocGF0Y2gpLFxuICAgIC4uLmdldERlY1BhdGNoZXMocGF0Y2gpLFxuICAgIC4uLmdldEluc2VydFBhdGNoZXMocGF0Y2gpXG4gIF07XG59XG5mdW5jdGlvbiBnZXRTZXRQYXRjaGVzKHBhdGNoKSB7XG4gIHJldHVybiBpc1NldFBhdGNoKHBhdGNoKSA/IE9iamVjdC5rZXlzKHBhdGNoLnNldCkubWFwKChwYXRoKSA9PiAoe1xuICAgIHBhdGg6IHBhcnNlKHBhdGgpLFxuICAgIG9wOiB7IHR5cGU6IFwic2V0XCIsIHZhbHVlOiBwYXRjaC5zZXRbcGF0aF0gfVxuICB9KSkgOiBbXTtcbn1cbmZ1bmN0aW9uIGdldFNldElmTWlzc2luZ1BhdGNoZXMocGF0Y2gpIHtcbiAgcmV0dXJuIGlzU2V0SWZNaXNzaW5nUGF0Y2gocGF0Y2gpID8gT2JqZWN0LmtleXMocGF0Y2guc2V0SWZNaXNzaW5nKS5tYXAoKHBhdGgpID0+ICh7XG4gICAgcGF0aDogcGFyc2UocGF0aCksXG4gICAgb3A6IHsgdHlwZTogXCJzZXRJZk1pc3NpbmdcIiwgdmFsdWU6IHBhdGNoLnNldElmTWlzc2luZ1twYXRoXSB9XG4gIH0pKSA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0VW5zZXRQYXRjaGVzKHBhdGNoKSB7XG4gIHJldHVybiBpc1Vuc2V0UGF0Y2gocGF0Y2gpID8gcGF0Y2gudW5zZXQubWFwKChwYXRoKSA9PiAoe1xuICAgIHBhdGg6IHBhcnNlKHBhdGgpLFxuICAgIG9wOiB7IHR5cGU6IFwidW5zZXRcIiB9XG4gIH0pKSA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0SW5jUGF0Y2hlcyhwYXRjaCkge1xuICByZXR1cm4gaXNJbmNQYXRjaChwYXRjaCkgPyBPYmplY3Qua2V5cyhwYXRjaC5pbmMpLm1hcCgocGF0aCkgPT4gKHtcbiAgICBwYXRoOiBwYXJzZShwYXRoKSxcbiAgICBvcDogeyB0eXBlOiBcImluY1wiLCBhbW91bnQ6IHBhdGNoLmluY1twYXRoXSB9XG4gIH0pKSA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0RGVjUGF0Y2hlcyhwYXRjaCkge1xuICByZXR1cm4gaXNEZWNQYXRjaChwYXRjaCkgPyBPYmplY3Qua2V5cyhwYXRjaC5kZWMpLm1hcCgocGF0aCkgPT4gKHtcbiAgICBwYXRoOiBwYXJzZShwYXRoKSxcbiAgICBvcDogeyB0eXBlOiBcImRlY1wiLCBhbW91bnQ6IHBhdGNoLmRlY1twYXRoXSB9XG4gIH0pKSA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0SW5zZXJ0UGF0Y2hlcyhwYXRjaCkge1xuICBpZiAoIWlzSW5zZXJ0UGF0Y2gocGF0Y2gpKVxuICAgIHJldHVybiBbXTtcbiAgY29uc3QgcG9zaXRpb24gPSBnZXRJbnNlcnRQb3NpdGlvbihwYXRjaC5pbnNlcnQpO1xuICBpZiAoIXBvc2l0aW9uKVxuICAgIHRocm93IG5ldyBFcnJvcihcIkluc2VydCBwYXRjaCBtaXNzaW5nIHBvc2l0aW9uXCIpO1xuICBjb25zdCBwYXRoID0gcGFyc2UocGF0Y2guaW5zZXJ0W3Bvc2l0aW9uXSksIHJlZmVyZW5jZUl0ZW0gPSBwYXRoLnBvcCgpLCBvcCA9IHBvc2l0aW9uID09PSBcInJlcGxhY2VcIiA/IHtcbiAgICB0eXBlOiBcImluc2VydFwiLFxuICAgIHBvc2l0aW9uLFxuICAgIHJlZmVyZW5jZUl0ZW0sXG4gICAgaXRlbXM6IHBhdGNoLmluc2VydC5pdGVtc1xuICB9IDoge1xuICAgIHR5cGU6IFwiaW5zZXJ0XCIsXG4gICAgcG9zaXRpb24sXG4gICAgcmVmZXJlbmNlSXRlbSxcbiAgICBpdGVtczogcGF0Y2guaW5zZXJ0Lml0ZW1zXG4gIH07XG4gIHJldHVybiBbeyBwYXRoLCBvcCB9XTtcbn1cbmV4cG9ydCB7XG4gIGRlY29kZSxcbiAgZGVjb2RlQWxsXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVjb2RlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encode: () => (/* binding */ encode),\n/* harmony export */   encodeAll: () => (/* binding */ encodeAll),\n/* harmony export */   encodeMutation: () => (/* binding */ encodeMutation),\n/* harmony export */   encodeTransaction: () => (/* binding */ encodeTransaction)\n/* harmony export */ });\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n\nfunction encode(mutation) {\n  return encodeMutation(mutation);\n}\nfunction encodeAll(mutations) {\n  return mutations.flatMap(encode);\n}\nfunction encodeTransaction(transaction) {\n  return {\n    transactionId: transaction.id,\n    mutations: encodeAll(transaction.mutations)\n  };\n}\nfunction encodeMutation(mutation) {\n  if (mutation.type === \"create\" || mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return { [mutation.type]: mutation.document };\n  if (mutation.type === \"delete\")\n    return {\n      delete: { id: mutation.id }\n    };\n  const ifRevisionID = mutation.options?.ifRevision;\n  return mutation.patches.map((patch) => ({\n    patch: {\n      id: mutation.id,\n      ...ifRevisionID && { ifRevisionID },\n      ...patchToSanity(patch)\n    }\n  }));\n}\nfunction patchToSanity(patch) {\n  const { path, op } = patch;\n  if (op.type === \"unset\")\n    return { unset: [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)] };\n  if (op.type === \"insert\")\n    return {\n      insert: {\n        [op.position]: (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)([...path, op.referenceItem]),\n        items: op.items\n      }\n    };\n  if (op.type === \"diffMatchPatch\")\n    return { diffMatchPatch: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.value } };\n  if (op.type === \"inc\")\n    return { inc: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.amount } };\n  if (op.type === \"dec\")\n    return { dec: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.amount } };\n  if (op.type === \"set\" || op.type === \"setIfMissing\")\n    return { [op.type]: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.value } };\n  if (op.type === \"truncate\") {\n    const range = [\n      op.startIndex,\n      typeof op.endIndex == \"number\" ? op.endIndex : \"\"\n    ].join(\":\");\n    return { unset: [`${(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)}[${range}]`] };\n  }\n  if (op.type === \"upsert\")\n    return {\n      unset: op.items.map(\n        (item) => (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)([...path, { _key: item._key }])\n      ),\n      insert: {\n        [op.position]: (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)([...path, op.referenceItem]),\n        items: op.items\n      }\n    };\n  if (op.type === \"assign\")\n    return {\n      set: Object.fromEntries(\n        Object.keys(op.value).map((key) => [\n          (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(key)),\n          op.value[key]\n        ])\n      )\n    };\n  if (op.type === \"unassign\")\n    return {\n      unset: op.keys.map((key) => (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(key)))\n    };\n  if (op.type === \"replace\")\n    return {\n      insert: {\n        replace: (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(op.referenceItem)),\n        items: op.items\n      }\n    };\n  if (op.type === \"remove\")\n    return {\n      unset: [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(op.referenceItem))]\n    };\n  throw new Error(`Unknown operation type ${op.type}`);\n}\n\n//# sourceMappingURL=encode.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9lbmNvZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsY0FBYztBQUN6QztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxVQUFVLFdBQVc7QUFDckI7QUFDQSxhQUFhLFFBQVEsd0RBQVM7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdEQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxrQkFBa0IsQ0FBQyx3REFBUztBQUN6QztBQUNBLGFBQWEsT0FBTyxDQUFDLHdEQUFTO0FBQzlCO0FBQ0EsYUFBYSxPQUFPLENBQUMsd0RBQVM7QUFDOUI7QUFDQSxhQUFhLGFBQWEsQ0FBQyx3REFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxXQUFXLHdEQUFTLE9BQU8sR0FBRyxNQUFNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHdEQUFTLGFBQWEsaUJBQWlCO0FBQ3pEO0FBQ0E7QUFDQSx1QkFBdUIsd0RBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHdEQUFTO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyx3REFBUztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix3REFBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx3REFBUztBQUN2QjtBQUNBLDRDQUE0QyxRQUFRO0FBQ3BEO0FBTUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9lbmNvZGUuanM/OGRlMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdHJpbmdpZnkgfSBmcm9tIFwiLi9zdHJpbmdpZnkuanNcIjtcbmZ1bmN0aW9uIGVuY29kZShtdXRhdGlvbikge1xuICByZXR1cm4gZW5jb2RlTXV0YXRpb24obXV0YXRpb24pO1xufVxuZnVuY3Rpb24gZW5jb2RlQWxsKG11dGF0aW9ucykge1xuICByZXR1cm4gbXV0YXRpb25zLmZsYXRNYXAoZW5jb2RlKTtcbn1cbmZ1bmN0aW9uIGVuY29kZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7XG4gIHJldHVybiB7XG4gICAgdHJhbnNhY3Rpb25JZDogdHJhbnNhY3Rpb24uaWQsXG4gICAgbXV0YXRpb25zOiBlbmNvZGVBbGwodHJhbnNhY3Rpb24ubXV0YXRpb25zKVxuICB9O1xufVxuZnVuY3Rpb24gZW5jb2RlTXV0YXRpb24obXV0YXRpb24pIHtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlXCIgfHwgbXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiIHx8IG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlT3JSZXBsYWNlXCIpXG4gICAgcmV0dXJuIHsgW211dGF0aW9uLnR5cGVdOiBtdXRhdGlvbi5kb2N1bWVudCB9O1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJkZWxldGVcIilcbiAgICByZXR1cm4ge1xuICAgICAgZGVsZXRlOiB7IGlkOiBtdXRhdGlvbi5pZCB9XG4gICAgfTtcbiAgY29uc3QgaWZSZXZpc2lvbklEID0gbXV0YXRpb24ub3B0aW9ucz8uaWZSZXZpc2lvbjtcbiAgcmV0dXJuIG11dGF0aW9uLnBhdGNoZXMubWFwKChwYXRjaCkgPT4gKHtcbiAgICBwYXRjaDoge1xuICAgICAgaWQ6IG11dGF0aW9uLmlkLFxuICAgICAgLi4uaWZSZXZpc2lvbklEICYmIHsgaWZSZXZpc2lvbklEIH0sXG4gICAgICAuLi5wYXRjaFRvU2FuaXR5KHBhdGNoKVxuICAgIH1cbiAgfSkpO1xufVxuZnVuY3Rpb24gcGF0Y2hUb1Nhbml0eShwYXRjaCkge1xuICBjb25zdCB7IHBhdGgsIG9wIH0gPSBwYXRjaDtcbiAgaWYgKG9wLnR5cGUgPT09IFwidW5zZXRcIilcbiAgICByZXR1cm4geyB1bnNldDogW3N0cmluZ2lmeShwYXRoKV0gfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiaW5zZXJ0XCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIGluc2VydDoge1xuICAgICAgICBbb3AucG9zaXRpb25dOiBzdHJpbmdpZnkoWy4uLnBhdGgsIG9wLnJlZmVyZW5jZUl0ZW1dKSxcbiAgICAgICAgaXRlbXM6IG9wLml0ZW1zXG4gICAgICB9XG4gICAgfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiZGlmZk1hdGNoUGF0Y2hcIilcbiAgICByZXR1cm4geyBkaWZmTWF0Y2hQYXRjaDogeyBbc3RyaW5naWZ5KHBhdGgpXTogb3AudmFsdWUgfSB9O1xuICBpZiAob3AudHlwZSA9PT0gXCJpbmNcIilcbiAgICByZXR1cm4geyBpbmM6IHsgW3N0cmluZ2lmeShwYXRoKV06IG9wLmFtb3VudCB9IH07XG4gIGlmIChvcC50eXBlID09PSBcImRlY1wiKVxuICAgIHJldHVybiB7IGRlYzogeyBbc3RyaW5naWZ5KHBhdGgpXTogb3AuYW1vdW50IH0gfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwic2V0XCIgfHwgb3AudHlwZSA9PT0gXCJzZXRJZk1pc3NpbmdcIilcbiAgICByZXR1cm4geyBbb3AudHlwZV06IHsgW3N0cmluZ2lmeShwYXRoKV06IG9wLnZhbHVlIH0gfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwidHJ1bmNhdGVcIikge1xuICAgIGNvbnN0IHJhbmdlID0gW1xuICAgICAgb3Auc3RhcnRJbmRleCxcbiAgICAgIHR5cGVvZiBvcC5lbmRJbmRleCA9PSBcIm51bWJlclwiID8gb3AuZW5kSW5kZXggOiBcIlwiXG4gICAgXS5qb2luKFwiOlwiKTtcbiAgICByZXR1cm4geyB1bnNldDogW2Ake3N0cmluZ2lmeShwYXRoKX1bJHtyYW5nZX1dYF0gfTtcbiAgfVxuICBpZiAob3AudHlwZSA9PT0gXCJ1cHNlcnRcIilcbiAgICByZXR1cm4ge1xuICAgICAgdW5zZXQ6IG9wLml0ZW1zLm1hcChcbiAgICAgICAgKGl0ZW0pID0+IHN0cmluZ2lmeShbLi4ucGF0aCwgeyBfa2V5OiBpdGVtLl9rZXkgfV0pXG4gICAgICApLFxuICAgICAgaW5zZXJ0OiB7XG4gICAgICAgIFtvcC5wb3NpdGlvbl06IHN0cmluZ2lmeShbLi4ucGF0aCwgb3AucmVmZXJlbmNlSXRlbV0pLFxuICAgICAgICBpdGVtczogb3AuaXRlbXNcbiAgICAgIH1cbiAgICB9O1xuICBpZiAob3AudHlwZSA9PT0gXCJhc3NpZ25cIilcbiAgICByZXR1cm4ge1xuICAgICAgc2V0OiBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICAgIE9iamVjdC5rZXlzKG9wLnZhbHVlKS5tYXAoKGtleSkgPT4gW1xuICAgICAgICAgIHN0cmluZ2lmeShwYXRoLmNvbmNhdChrZXkpKSxcbiAgICAgICAgICBvcC52YWx1ZVtrZXldXG4gICAgICAgIF0pXG4gICAgICApXG4gICAgfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwidW5hc3NpZ25cIilcbiAgICByZXR1cm4ge1xuICAgICAgdW5zZXQ6IG9wLmtleXMubWFwKChrZXkpID0+IHN0cmluZ2lmeShwYXRoLmNvbmNhdChrZXkpKSlcbiAgICB9O1xuICBpZiAob3AudHlwZSA9PT0gXCJyZXBsYWNlXCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIGluc2VydDoge1xuICAgICAgICByZXBsYWNlOiBzdHJpbmdpZnkocGF0aC5jb25jYXQob3AucmVmZXJlbmNlSXRlbSkpLFxuICAgICAgICBpdGVtczogb3AuaXRlbXNcbiAgICAgIH1cbiAgICB9O1xuICBpZiAob3AudHlwZSA9PT0gXCJyZW1vdmVcIilcbiAgICByZXR1cm4ge1xuICAgICAgdW5zZXQ6IFtzdHJpbmdpZnkocGF0aC5jb25jYXQob3AucmVmZXJlbmNlSXRlbSkpXVxuICAgIH07XG4gIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBvcGVyYXRpb24gdHlwZSAke29wLnR5cGV9YCk7XG59XG5leHBvcnQge1xuICBlbmNvZGUsXG4gIGVuY29kZUFsbCxcbiAgZW5jb2RlTXV0YXRpb24sXG4gIGVuY29kZVRyYW5zYWN0aW9uXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZW5jb2RlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAtPath: () => (/* binding */ getAtPath)\n/* harmony export */ });\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n\nfunction getAtPath(path, value) {\n  if (path.length === 0)\n    return value;\n  let current = value;\n  for (const head of path) {\n    if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.isArrayElement)(head)) {\n      if (!Array.isArray(current))\n        return;\n      if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.isKeyedElement)(head)) {\n        current = current.find((item) => item._key === head._key);\n        continue;\n      }\n      current = current[head];\n      continue;\n    }\n    current = current[head];\n  }\n  return current;\n}\n\n//# sourceMappingURL=getAtPath.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9nZXRBdFBhdGguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBZ0U7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkRBQWM7QUFDdEI7QUFDQTtBQUNBLFVBQVUsNkRBQWM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9fY2h1bmtzLWVzL2dldEF0UGF0aC5qcz9kYTM3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzQXJyYXlFbGVtZW50LCBpc0tleWVkRWxlbWVudCB9IGZyb20gXCIuL3N0cmluZ2lmeS5qc1wiO1xuZnVuY3Rpb24gZ2V0QXRQYXRoKHBhdGgsIHZhbHVlKSB7XG4gIGlmIChwYXRoLmxlbmd0aCA9PT0gMClcbiAgICByZXR1cm4gdmFsdWU7XG4gIGxldCBjdXJyZW50ID0gdmFsdWU7XG4gIGZvciAoY29uc3QgaGVhZCBvZiBwYXRoKSB7XG4gICAgaWYgKGlzQXJyYXlFbGVtZW50KGhlYWQpKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudCkpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGlmIChpc0tleWVkRWxlbWVudChoZWFkKSkge1xuICAgICAgICBjdXJyZW50ID0gY3VycmVudC5maW5kKChpdGVtKSA9PiBpdGVtLl9rZXkgPT09IGhlYWQuX2tleSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY3VycmVudCA9IGN1cnJlbnRbaGVhZF07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY3VycmVudCA9IGN1cnJlbnRbaGVhZF07XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnQ7XG59XG5leHBvcnQge1xuICBnZXRBdFBhdGhcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXRBdFBhdGguanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isObject: () => (/* binding */ isObject)\n/* harmony export */ });\nfunction isObject(val) {\n  return val !== null && typeof val == \"object\" && !Array.isArray(val);\n}\n\n//# sourceMappingURL=isObject.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9pc09iamVjdC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBR0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9pc09iamVjdC5qcz81MmM2Il0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGlzT2JqZWN0KHZhbCkge1xuICByZXR1cm4gdmFsICE9PSBudWxsICYmIHR5cGVvZiB2YWwgPT0gXCJvYmplY3RcIiAmJiAhQXJyYXkuaXNBcnJheSh2YWwpO1xufVxuZXhwb3J0IHtcbiAgaXNPYmplY3Rcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc09iamVjdC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parse: () => (/* binding */ parse)\n/* harmony export */ });\nfunction parse(path) {\n  return path.split(/[[.\\]]/g).filter(Boolean).map((seg) => seg.includes(\"==\") ? parseSegment(seg) : coerce(seg));\n}\nconst IS_NUMERIC = /^-?\\d+$/;\nfunction unquote(str) {\n  return str.replace(/^['\"]/, \"\").replace(/['\"]$/, \"\");\n}\nfunction parseSegment(segment) {\n  const [key, value] = segment.split(\"==\");\n  if (key !== \"_key\")\n    throw new Error(\n      `Currently only \"_key\" is supported as path segment. Found ${key}`\n    );\n  if (typeof value > \"u\")\n    throw new Error('Invalid path segment, expected `key==\"value\"`');\n  return { _key: unquote(value) };\n}\nfunction coerce(segment) {\n  return IS_NUMERIC.test(segment) ? Number(segment) : segment;\n}\n\n//# sourceMappingURL=parse.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9wYXJzZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSxJQUFJO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUdFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4vbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L211dGF0ZS9kaXN0L19jaHVua3MtZXMvcGFyc2UuanM/OGZmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBwYXJzZShwYXRoKSB7XG4gIHJldHVybiBwYXRoLnNwbGl0KC9bWy5cXF1dL2cpLmZpbHRlcihCb29sZWFuKS5tYXAoKHNlZykgPT4gc2VnLmluY2x1ZGVzKFwiPT1cIikgPyBwYXJzZVNlZ21lbnQoc2VnKSA6IGNvZXJjZShzZWcpKTtcbn1cbmNvbnN0IElTX05VTUVSSUMgPSAvXi0/XFxkKyQvO1xuZnVuY3Rpb24gdW5xdW90ZShzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eWydcIl0vLCBcIlwiKS5yZXBsYWNlKC9bJ1wiXSQvLCBcIlwiKTtcbn1cbmZ1bmN0aW9uIHBhcnNlU2VnbWVudChzZWdtZW50KSB7XG4gIGNvbnN0IFtrZXksIHZhbHVlXSA9IHNlZ21lbnQuc3BsaXQoXCI9PVwiKTtcbiAgaWYgKGtleSAhPT0gXCJfa2V5XCIpXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEN1cnJlbnRseSBvbmx5IFwiX2tleVwiIGlzIHN1cHBvcnRlZCBhcyBwYXRoIHNlZ21lbnQuIEZvdW5kICR7a2V5fWBcbiAgICApO1xuICBpZiAodHlwZW9mIHZhbHVlID4gXCJ1XCIpXG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBhdGggc2VnbWVudCwgZXhwZWN0ZWQgYGtleT09XCJ2YWx1ZVwiYCcpO1xuICByZXR1cm4geyBfa2V5OiB1bnF1b3RlKHZhbHVlKSB9O1xufVxuZnVuY3Rpb24gY29lcmNlKHNlZ21lbnQpIHtcbiAgcmV0dXJuIElTX05VTUVSSUMudGVzdChzZWdtZW50KSA/IE51bWJlcihzZWdtZW50KSA6IHNlZ21lbnQ7XG59XG5leHBvcnQge1xuICBwYXJzZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhcnNlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isArrayElement: () => (/* binding */ isArrayElement),\n/* harmony export */   isElementEqual: () => (/* binding */ isElementEqual),\n/* harmony export */   isEqual: () => (/* binding */ isEqual),\n/* harmony export */   isIndexElement: () => (/* binding */ isIndexElement),\n/* harmony export */   isKeyElement: () => (/* binding */ isKeyElement),\n/* harmony export */   isKeyedElement: () => (/* binding */ isKeyedElement),\n/* harmony export */   isPropertyElement: () => (/* binding */ isPropertyElement),\n/* harmony export */   startsWith: () => (/* binding */ startsWith),\n/* harmony export */   stringify: () => (/* binding */ stringify)\n/* harmony export */ });\nfunction safeGetElementAt(array, index) {\n  if (index < 0 || index >= array.length)\n    throw new Error(\"Index out of bounds\");\n  return array[index];\n}\nfunction startsWith(parentPath, path) {\n  return parentPath.length <= path.length && parentPath.every(\n    (segment, i) => isElementEqual(segment, safeGetElementAt(path, i))\n  );\n}\nfunction isEqual(path, otherPath) {\n  return path.length === otherPath.length && path.every(\n    (segment, i) => isElementEqual(segment, safeGetElementAt(path, i))\n  );\n}\nfunction isElementEqual(segmentA, segmentB) {\n  return isKeyElement(segmentA) && isKeyElement(segmentB) ? segmentA._key === segmentB._key : isIndexElement(segmentA) ? Number(segmentA) === Number(segmentB) : segmentA === segmentB;\n}\nfunction isKeyElement(segment) {\n  return typeof segment?._key == \"string\";\n}\nfunction isIndexElement(segment) {\n  return typeof segment == \"number\";\n}\nfunction isKeyedElement(element) {\n  return typeof element == \"object\" && \"_key\" in element && typeof element._key == \"string\";\n}\nfunction isArrayElement(element) {\n  return typeof element == \"number\" || isKeyedElement(element);\n}\nfunction isPropertyElement(element) {\n  return typeof element == \"string\";\n}\nconst IS_DOTTABLE = /^[a-z_$]+/;\nfunction stringifySegment(segment, hasLeading) {\n  return Array.isArray(segment) ? `[${segment[0]}:${segment[1] || \"\"}]` : typeof segment == \"number\" ? `[${segment}]` : isKeyedElement(segment) ? `[_key==${JSON.stringify(segment._key)}]` : typeof segment == \"string\" && IS_DOTTABLE.test(segment) ? hasLeading ? segment : `.${segment}` : `['${segment}']`;\n}\nfunction stringify(pathArray) {\n  return pathArray.map((segment, i) => stringifySegment(segment, i === 0)).join(\"\");\n}\n\n//# sourceMappingURL=stringify.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9zdHJpbmdpZnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxXQUFXLEdBQUcsaUJBQWlCLHNDQUFzQyxRQUFRLHlDQUF5Qyw2QkFBNkIsMEZBQTBGLFFBQVEsU0FBUyxRQUFRO0FBQzVTO0FBQ0E7QUFDQTtBQUNBO0FBV0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9zdHJpbmdpZnkuanM/NjlmYyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzYWZlR2V0RWxlbWVudEF0KGFycmF5LCBpbmRleCkge1xuICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGFycmF5Lmxlbmd0aClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO1xuICByZXR1cm4gYXJyYXlbaW5kZXhdO1xufVxuZnVuY3Rpb24gc3RhcnRzV2l0aChwYXJlbnRQYXRoLCBwYXRoKSB7XG4gIHJldHVybiBwYXJlbnRQYXRoLmxlbmd0aCA8PSBwYXRoLmxlbmd0aCAmJiBwYXJlbnRQYXRoLmV2ZXJ5KFxuICAgIChzZWdtZW50LCBpKSA9PiBpc0VsZW1lbnRFcXVhbChzZWdtZW50LCBzYWZlR2V0RWxlbWVudEF0KHBhdGgsIGkpKVxuICApO1xufVxuZnVuY3Rpb24gaXNFcXVhbChwYXRoLCBvdGhlclBhdGgpIHtcbiAgcmV0dXJuIHBhdGgubGVuZ3RoID09PSBvdGhlclBhdGgubGVuZ3RoICYmIHBhdGguZXZlcnkoXG4gICAgKHNlZ21lbnQsIGkpID0+IGlzRWxlbWVudEVxdWFsKHNlZ21lbnQsIHNhZmVHZXRFbGVtZW50QXQocGF0aCwgaSkpXG4gICk7XG59XG5mdW5jdGlvbiBpc0VsZW1lbnRFcXVhbChzZWdtZW50QSwgc2VnbWVudEIpIHtcbiAgcmV0dXJuIGlzS2V5RWxlbWVudChzZWdtZW50QSkgJiYgaXNLZXlFbGVtZW50KHNlZ21lbnRCKSA/IHNlZ21lbnRBLl9rZXkgPT09IHNlZ21lbnRCLl9rZXkgOiBpc0luZGV4RWxlbWVudChzZWdtZW50QSkgPyBOdW1iZXIoc2VnbWVudEEpID09PSBOdW1iZXIoc2VnbWVudEIpIDogc2VnbWVudEEgPT09IHNlZ21lbnRCO1xufVxuZnVuY3Rpb24gaXNLZXlFbGVtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWdtZW50Py5fa2V5ID09IFwic3RyaW5nXCI7XG59XG5mdW5jdGlvbiBpc0luZGV4RWxlbWVudChzZWdtZW50KSB7XG4gIHJldHVybiB0eXBlb2Ygc2VnbWVudCA9PSBcIm51bWJlclwiO1xufVxuZnVuY3Rpb24gaXNLZXllZEVsZW1lbnQoZWxlbWVudCkge1xuICByZXR1cm4gdHlwZW9mIGVsZW1lbnQgPT0gXCJvYmplY3RcIiAmJiBcIl9rZXlcIiBpbiBlbGVtZW50ICYmIHR5cGVvZiBlbGVtZW50Ll9rZXkgPT0gXCJzdHJpbmdcIjtcbn1cbmZ1bmN0aW9uIGlzQXJyYXlFbGVtZW50KGVsZW1lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBlbGVtZW50ID09IFwibnVtYmVyXCIgfHwgaXNLZXllZEVsZW1lbnQoZWxlbWVudCk7XG59XG5mdW5jdGlvbiBpc1Byb3BlcnR5RWxlbWVudChlbGVtZW50KSB7XG4gIHJldHVybiB0eXBlb2YgZWxlbWVudCA9PSBcInN0cmluZ1wiO1xufVxuY29uc3QgSVNfRE9UVEFCTEUgPSAvXlthLXpfJF0rLztcbmZ1bmN0aW9uIHN0cmluZ2lmeVNlZ21lbnQoc2VnbWVudCwgaGFzTGVhZGluZykge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheShzZWdtZW50KSA/IGBbJHtzZWdtZW50WzBdfToke3NlZ21lbnRbMV0gfHwgXCJcIn1dYCA6IHR5cGVvZiBzZWdtZW50ID09IFwibnVtYmVyXCIgPyBgWyR7c2VnbWVudH1dYCA6IGlzS2V5ZWRFbGVtZW50KHNlZ21lbnQpID8gYFtfa2V5PT0ke0pTT04uc3RyaW5naWZ5KHNlZ21lbnQuX2tleSl9XWAgOiB0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiICYmIElTX0RPVFRBQkxFLnRlc3Qoc2VnbWVudCkgPyBoYXNMZWFkaW5nID8gc2VnbWVudCA6IGAuJHtzZWdtZW50fWAgOiBgWycke3NlZ21lbnR9J11gO1xufVxuZnVuY3Rpb24gc3RyaW5naWZ5KHBhdGhBcnJheSkge1xuICByZXR1cm4gcGF0aEFycmF5Lm1hcCgoc2VnbWVudCwgaSkgPT4gc3RyaW5naWZ5U2VnbWVudChzZWdtZW50LCBpID09PSAwKSkuam9pbihcIlwiKTtcbn1cbmV4cG9ydCB7XG4gIGlzQXJyYXlFbGVtZW50LFxuICBpc0VsZW1lbnRFcXVhbCxcbiAgaXNFcXVhbCxcbiAgaXNJbmRleEVsZW1lbnQsXG4gIGlzS2V5RWxlbWVudCxcbiAgaXNLZXllZEVsZW1lbnQsXG4gIGlzUHJvcGVydHlFbGVtZW50LFxuICBzdGFydHNXaXRoLFxuICBzdHJpbmdpZnlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdHJpbmdpZnkuanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyMutations: () => (/* binding */ applyMutations),\n/* harmony export */   commit: () => (/* binding */ commit),\n/* harmony export */   getMutationDocumentId: () => (/* binding */ getMutationDocumentId),\n/* harmony export */   rebase: () => (/* binding */ rebase),\n/* harmony export */   squashDMPStrings: () => (/* binding */ squashDMPStrings),\n/* harmony export */   squashMutationGroups: () => (/* binding */ squashMutationGroups),\n/* harmony export */   toTransactions: () => (/* binding */ toTransactions)\n/* harmony export */ });\n/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash-es */ \"(ssr)/./node_modules/lodash-es/groupBy.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js\");\n/* harmony import */ var _getAtPath_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./getAtPath.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js\");\n/* harmony import */ var _sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/diff-match-patch */ \"(ssr)/./node_modules/@sanity/diff-match-patch/dist/index.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n\n\n\n\n\nfunction getMutationDocumentId(mutation) {\n  if (mutation.type === \"patch\")\n    return mutation.id;\n  if (mutation.type === \"create\")\n    return mutation.document._id;\n  if (mutation.type === \"delete\")\n    return mutation.id;\n  if (mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return mutation.document._id;\n  throw new Error(\"Invalid mutation type\");\n}\nfunction applyAll(current, mutation) {\n  return mutation.reduce((doc, m) => {\n    const res = applyDocumentMutation(doc, m);\n    if (res.status === \"error\")\n      throw new Error(res.message);\n    return res.status === \"noop\" ? doc : res.after;\n  }, current);\n}\nfunction applyDocumentMutation(document, mutation) {\n  if (mutation.type === \"create\")\n    return create(document, mutation);\n  if (mutation.type === \"createIfNotExists\")\n    return createIfNotExists(document, mutation);\n  if (mutation.type === \"delete\")\n    return del(document, mutation);\n  if (mutation.type === \"createOrReplace\")\n    return createOrReplace(document, mutation);\n  if (mutation.type === \"patch\")\n    return patch(document, mutation);\n  throw new Error(`Invalid mutation type: ${mutation.type}`);\n}\nfunction create(document, mutation) {\n  if (document)\n    return { status: \"error\", message: \"Document already exist\" };\n  const result = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.assignId)(mutation.document, _utils_js__WEBPACK_IMPORTED_MODULE_0__.nanoid);\n  return { status: \"created\", id: result._id, after: result };\n}\nfunction createIfNotExists(document, mutation) {\n  return (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasId)(mutation.document) ? document ? { status: \"noop\" } : { status: \"created\", id: mutation.document._id, after: mutation.document } : {\n    status: \"error\",\n    message: \"Cannot createIfNotExists on document without _id\"\n  };\n}\nfunction createOrReplace(document, mutation) {\n  return (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasId)(mutation.document) ? document ? {\n    status: \"updated\",\n    id: mutation.document._id,\n    before: document,\n    after: mutation.document\n  } : { status: \"created\", id: mutation.document._id, after: mutation.document } : {\n    status: \"error\",\n    message: \"Cannot createIfNotExists on document without _id\"\n  };\n}\nfunction del(document, mutation) {\n  return document ? mutation.id !== document._id ? { status: \"error\", message: \"Delete mutation targeted wrong document\" } : {\n    status: \"deleted\",\n    id: mutation.id,\n    before: document,\n    after: void 0\n  } : { status: \"noop\" };\n}\nfunction patch(document, mutation) {\n  if (!document)\n    return {\n      status: \"error\",\n      message: \"Cannot apply patch on nonexistent document\"\n    };\n  const next = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyPatchMutation)(mutation, document);\n  return document === next ? { status: \"noop\" } : { status: \"updated\", id: mutation.id, before: document, after: next };\n}\nfunction applyMutations(mutations, dataset) {\n  const updatedDocs = /* @__PURE__ */ Object.create(null);\n  for (const mutation of mutations) {\n    const documentId = getMutationDocumentId(mutation);\n    if (!documentId)\n      throw new Error(\"Unable to get document id from mutation\");\n    const before = updatedDocs[documentId]?.after || dataset.get(documentId), res = applyDocumentMutation(before, mutation);\n    if (res.status === \"error\")\n      throw new Error(res.message);\n    res.status !== \"noop\" && (res.status === \"updated\" || res.status === \"created\" || res.status === \"deleted\") && (documentId in updatedDocs || (updatedDocs[documentId] = { before, after: void 0, muts: [] }), updatedDocs[documentId].after = res.after);\n  }\n  return Object.entries(updatedDocs).map(\n    // eslint-disable-next-line no-shadow\n    ([id, { before, after, muts }]) => ({\n      id,\n      status: after ? before ? \"updated\" : \"created\" : \"deleted\",\n      mutations: muts,\n      before,\n      after\n    })\n  );\n}\nfunction commit(results, dataset) {\n  results.forEach((result) => {\n    (result.status === \"created\" || result.status === \"updated\") && dataset.set(result.id, result.after), result.status === \"deleted\" && dataset.delete(result.id);\n  });\n}\nfunction takeUntilRight(arr, predicate, opts) {\n  const result = [];\n  for (const item of arr.slice().reverse()) {\n    if (predicate(item))\n      return result;\n    result.push(item);\n  }\n  return result.reverse();\n}\nfunction isEqualPath(p1, p2) {\n  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(p1) === (0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(p2);\n}\nfunction supersedes(later, earlier) {\n  return (earlier.type === \"set\" || earlier.type === \"unset\") && (later.type === \"set\" || later.type === \"unset\");\n}\nfunction squashNodePatches(patches) {\n  return compactSetIfMissingPatches(\n    compactSetPatches(compactUnsetPatches(patches))\n  );\n}\nfunction compactUnsetPatches(patches) {\n  return patches.reduce(\n    (earlierPatches, laterPatch) => {\n      if (laterPatch.op.type !== \"unset\")\n        return earlierPatches.push(laterPatch), earlierPatches;\n      const unaffected = earlierPatches.filter(\n        (earlierPatch) => !(0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.startsWith)(laterPatch.path, earlierPatch.path)\n      );\n      return unaffected.push(laterPatch), unaffected;\n    },\n    []\n  );\n}\nfunction compactSetPatches(patches) {\n  return patches.reduceRight(\n    (laterPatches, earlierPatch) => (laterPatches.find(\n      (later) => supersedes(later.op, earlierPatch.op) && isEqualPath(later.path, earlierPatch.path)\n    ) || laterPatches.unshift(earlierPatch), laterPatches),\n    []\n  );\n}\nfunction compactSetIfMissingPatches(patches) {\n  return patches.reduce(\n    (previousPatches, laterPatch) => laterPatch.op.type !== \"setIfMissing\" ? (previousPatches.push(laterPatch), previousPatches) : (takeUntilRight(\n      previousPatches,\n      (patch2) => patch2.op.type === \"unset\"\n    ).find(\n      (precedingPatch) => precedingPatch.op.type === \"setIfMissing\" && isEqualPath(precedingPatch.path, laterPatch.path)\n    ) || previousPatches.push(laterPatch), previousPatches),\n    []\n  );\n}\nfunction compactDMPSetPatches(base, patches) {\n  let edge = base;\n  return patches.reduce(\n    (earlierPatches, laterPatch) => {\n      const before = edge;\n      if (edge = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyNodePatch)(laterPatch, edge), laterPatch.op.type === \"set\" && typeof laterPatch.op.value == \"string\") {\n        const current = (0,_getAtPath_js__WEBPACK_IMPORTED_MODULE_2__.getAtPath)(laterPatch.path, before);\n        if (typeof current == \"string\") {\n          const replaced = {\n            ...laterPatch,\n            op: {\n              type: \"diffMatchPatch\",\n              value: (0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.stringifyPatches)(\n                (0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.makePatches)(current, laterPatch.op.value)\n              )\n            }\n          };\n          return earlierPatches.flatMap((ep) => isEqualPath(ep.path, laterPatch.path) && ep.op.type === \"diffMatchPatch\" ? [] : ep).concat(replaced);\n        }\n      }\n      return earlierPatches.push(laterPatch), earlierPatches;\n    },\n    []\n  );\n}\nfunction squashDMPStrings(remote, mutationGroups) {\n  return mutationGroups.map((mutationGroup) => ({\n    ...mutationGroup,\n    mutations: dmpIfyMutations(remote, mutationGroup.mutations)\n  }));\n}\nfunction dmpIfyMutations(store, mutations) {\n  return mutations.map((mutation, i) => mutation.type === \"patch\" ? dmpifyPatchMutation(store.get(mutation.id), mutation) : mutation);\n}\nfunction dmpifyPatchMutation(base, mutation) {\n  return base ? {\n    ...mutation,\n    patches: compactDMPSetPatches(base, mutation.patches)\n  } : mutation;\n}\nfunction mergeMutationGroups(mutationGroups) {\n  return chunkWhile(mutationGroups, (group) => !group.transaction).flatMap(\n    (chunk) => ({\n      ...chunk[0],\n      mutations: chunk.flatMap((c) => c.mutations)\n    })\n  );\n}\nfunction chunkWhile(arr, predicate) {\n  const res = [];\n  let currentChunk = [];\n  return arr.forEach((item) => {\n    predicate(item) ? currentChunk.push(item) : (currentChunk.length > 0 && res.push(currentChunk), currentChunk = [], res.push([item]));\n  }), currentChunk.length > 0 && res.push(currentChunk), res;\n}\nfunction squashMutationGroups(staged) {\n  return mergeMutationGroups(staged).map((transaction) => ({\n    ...transaction,\n    mutations: squashMutations(transaction.mutations)\n  })).map((transaction) => ({\n    ...transaction,\n    mutations: transaction.mutations.map((mutation) => mutation.type !== \"patch\" ? mutation : {\n      ...mutation,\n      patches: squashNodePatches(mutation.patches)\n    })\n  }));\n}\nfunction squashMutations(mutations) {\n  const byDocument = (0,lodash_es__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(mutations, getMutationDocumentId);\n  return Object.values(byDocument).flatMap((documentMutations) => squashCreateIfNotExists(squashDelete(documentMutations)).flat().reduce((acc, docMutation) => {\n    const prev = acc[acc.length - 1];\n    return (!prev || prev.type === \"patch\") && docMutation.type === \"patch\" ? acc.slice(0, -1).concat({\n      ...docMutation,\n      patches: (prev?.patches || []).concat(docMutation.patches)\n    }) : acc.concat(docMutation);\n  }, []));\n}\nfunction squashCreateIfNotExists(mutations) {\n  return mutations.length === 0 ? mutations : mutations.reduce((previousMuts, laterMut) => laterMut.type !== \"createIfNotExists\" ? (previousMuts.push(laterMut), previousMuts) : (takeUntilRight(previousMuts, (m) => m.type === \"delete\").find(\n    (precedingPatch) => precedingPatch.type === \"createIfNotExists\"\n  ) || previousMuts.push(laterMut), previousMuts), []);\n}\nfunction squashDelete(mutations) {\n  return mutations.length === 0 ? mutations : mutations.reduce((previousMuts, laterMut) => laterMut.type === \"delete\" ? [laterMut] : (previousMuts.push(laterMut), previousMuts), []);\n}\nfunction rebase(documentId, oldBase, newBase, stagedMutations) {\n  let edge = oldBase;\n  const dmpified = stagedMutations.map((transaction) => {\n    const mutations = transaction.mutations.flatMap((mut) => {\n      if (getMutationDocumentId(mut) !== documentId)\n        return [];\n      const before = edge;\n      return edge = applyAll(edge, [mut]), !before || mut.type !== \"patch\" ? mut : {\n        type: \"dmpified\",\n        mutation: {\n          ...mut,\n          // Todo: make compactDMPSetPatches return pairs of patches that was dmpified with their\n          //  original as dmpPatches and original is not 1:1 (e..g some of the original may not be dmpified)\n          dmpPatches: compactDMPSetPatches(before, mut.patches),\n          original: mut.patches\n        }\n      };\n    });\n    return { ...transaction, mutations };\n  });\n  let newBaseWithDMPForOldBaseApplied = newBase;\n  return dmpified.map((transaction) => {\n    const applied = [];\n    return transaction.mutations.forEach((mut) => {\n      if (mut.type === \"dmpified\")\n        try {\n          newBaseWithDMPForOldBaseApplied = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyPatches)(\n            mut.mutation.dmpPatches,\n            newBaseWithDMPForOldBaseApplied\n          ), applied.push(mut);\n        } catch {\n          console.warn(\"Failed to apply dmp patch, falling back to original\");\n          try {\n            newBaseWithDMPForOldBaseApplied = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyPatches)(\n              mut.mutation.original,\n              newBaseWithDMPForOldBaseApplied\n            ), applied.push(mut);\n          } catch (second) {\n            throw new Error(\n              `Failed to apply patch for document \"${documentId}\": ${second.message}`\n            );\n          }\n        }\n      else\n        newBaseWithDMPForOldBaseApplied = applyAll(\n          newBaseWithDMPForOldBaseApplied,\n          [mut]\n        );\n    });\n  }), [stagedMutations.map((transaction) => ({\n    ...transaction,\n    mutations: transaction.mutations.map((mut) => mut.type !== \"patch\" || getMutationDocumentId(mut) !== documentId ? mut : {\n      ...mut,\n      patches: mut.patches.map((patch2) => patch2.op.type !== \"set\" ? patch2 : {\n        ...patch2,\n        op: {\n          ...patch2.op,\n          value: (0,_getAtPath_js__WEBPACK_IMPORTED_MODULE_2__.getAtPath)(patch2.path, newBaseWithDMPForOldBaseApplied)\n        }\n      })\n    })\n  })), newBaseWithDMPForOldBaseApplied];\n}\nfunction toTransactions(groups) {\n  return groups.map((group) => group.transaction && group.id !== void 0 ? { id: group.id, mutations: group.mutations } : { mutations: group.mutations });\n}\n\n//# sourceMappingURL=toTransactions.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy90b1RyYW5zYWN0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBb0M7QUFDbUU7QUFDNUQ7QUFDOEI7QUFDbEI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsY0FBYztBQUMxRDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsaUJBQWlCLG1EQUFRLG9CQUFvQiw2Q0FBTTtBQUNuRCxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVMsZ0RBQUssbUNBQW1DLGlCQUFpQixJQUFJLHlFQUF5RTtBQUMvSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxnREFBSztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxJQUFJLHlFQUF5RTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELHNFQUFzRTtBQUMzSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksSUFBSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSw2REFBa0I7QUFDakMsK0JBQStCLGlCQUFpQixJQUFJO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEtBQThLLGlDQUFpQztBQUMvTTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHFCQUFxQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsd0RBQVMsU0FBUyx3REFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIseURBQVU7QUFDckM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIseURBQWM7QUFDL0Isd0JBQXdCLHdEQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsMEVBQWdCO0FBQ3JDLGdCQUFnQixxRUFBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EscUJBQXFCLHFEQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsYUFBYTtBQUNiLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsdURBQVk7QUFDeEQ7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSw4Q0FBOEMsdURBQVk7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0EscURBQXFELFdBQVcsS0FBSyxlQUFlO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdEQUFTO0FBQzFCO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLDRFQUE0RSwyQ0FBMkMsSUFBSSw0QkFBNEI7QUFDdko7QUFTRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9fY2h1bmtzLWVzL3RvVHJhbnNhY3Rpb25zLmpzPzIyYzMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gXCJsb2Rhc2gtZXNcIjtcbmltcG9ydCB7IGFzc2lnbklkLCBuYW5vaWQsIGhhc0lkLCBhcHBseVBhdGNoTXV0YXRpb24sIGFwcGx5Tm9kZVBhdGNoLCBhcHBseVBhdGNoZXMgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgZ2V0QXRQYXRoIH0gZnJvbSBcIi4vZ2V0QXRQYXRoLmpzXCI7XG5pbXBvcnQgeyBzdHJpbmdpZnlQYXRjaGVzLCBtYWtlUGF0Y2hlcyB9IGZyb20gXCJAc2FuaXR5L2RpZmYtbWF0Y2gtcGF0Y2hcIjtcbmltcG9ydCB7IHN0YXJ0c1dpdGgsIHN0cmluZ2lmeSB9IGZyb20gXCIuL3N0cmluZ2lmeS5qc1wiO1xuZnVuY3Rpb24gZ2V0TXV0YXRpb25Eb2N1bWVudElkKG11dGF0aW9uKSB7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcInBhdGNoXCIpXG4gICAgcmV0dXJuIG11dGF0aW9uLmlkO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVcIilcbiAgICByZXR1cm4gbXV0YXRpb24uZG9jdW1lbnQuX2lkO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJkZWxldGVcIilcbiAgICByZXR1cm4gbXV0YXRpb24uaWQ7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZUlmTm90RXhpc3RzXCIgfHwgbXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVPclJlcGxhY2VcIilcbiAgICByZXR1cm4gbXV0YXRpb24uZG9jdW1lbnQuX2lkO1xuICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIG11dGF0aW9uIHR5cGVcIik7XG59XG5mdW5jdGlvbiBhcHBseUFsbChjdXJyZW50LCBtdXRhdGlvbikge1xuICByZXR1cm4gbXV0YXRpb24ucmVkdWNlKChkb2MsIG0pID0+IHtcbiAgICBjb25zdCByZXMgPSBhcHBseURvY3VtZW50TXV0YXRpb24oZG9jLCBtKTtcbiAgICBpZiAocmVzLnN0YXR1cyA9PT0gXCJlcnJvclwiKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5tZXNzYWdlKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyA9PT0gXCJub29wXCIgPyBkb2MgOiByZXMuYWZ0ZXI7XG4gIH0sIGN1cnJlbnQpO1xufVxuZnVuY3Rpb24gYXBwbHlEb2N1bWVudE11dGF0aW9uKGRvY3VtZW50LCBtdXRhdGlvbikge1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVcIilcbiAgICByZXR1cm4gY3JlYXRlKGRvY3VtZW50LCBtdXRhdGlvbik7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZUlmTm90RXhpc3RzXCIpXG4gICAgcmV0dXJuIGNyZWF0ZUlmTm90RXhpc3RzKGRvY3VtZW50LCBtdXRhdGlvbik7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImRlbGV0ZVwiKVxuICAgIHJldHVybiBkZWwoZG9jdW1lbnQsIG11dGF0aW9uKTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlT3JSZXBsYWNlXCIpXG4gICAgcmV0dXJuIGNyZWF0ZU9yUmVwbGFjZShkb2N1bWVudCwgbXV0YXRpb24pO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJwYXRjaFwiKVxuICAgIHJldHVybiBwYXRjaChkb2N1bWVudCwgbXV0YXRpb24pO1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbXV0YXRpb24gdHlwZTogJHttdXRhdGlvbi50eXBlfWApO1xufVxuZnVuY3Rpb24gY3JlYXRlKGRvY3VtZW50LCBtdXRhdGlvbikge1xuICBpZiAoZG9jdW1lbnQpXG4gICAgcmV0dXJuIHsgc3RhdHVzOiBcImVycm9yXCIsIG1lc3NhZ2U6IFwiRG9jdW1lbnQgYWxyZWFkeSBleGlzdFwiIH07XG4gIGNvbnN0IHJlc3VsdCA9IGFzc2lnbklkKG11dGF0aW9uLmRvY3VtZW50LCBuYW5vaWQpO1xuICByZXR1cm4geyBzdGF0dXM6IFwiY3JlYXRlZFwiLCBpZDogcmVzdWx0Ll9pZCwgYWZ0ZXI6IHJlc3VsdCB9O1xufVxuZnVuY3Rpb24gY3JlYXRlSWZOb3RFeGlzdHMoZG9jdW1lbnQsIG11dGF0aW9uKSB7XG4gIHJldHVybiBoYXNJZChtdXRhdGlvbi5kb2N1bWVudCkgPyBkb2N1bWVudCA/IHsgc3RhdHVzOiBcIm5vb3BcIiB9IDogeyBzdGF0dXM6IFwiY3JlYXRlZFwiLCBpZDogbXV0YXRpb24uZG9jdW1lbnQuX2lkLCBhZnRlcjogbXV0YXRpb24uZG9jdW1lbnQgfSA6IHtcbiAgICBzdGF0dXM6IFwiZXJyb3JcIixcbiAgICBtZXNzYWdlOiBcIkNhbm5vdCBjcmVhdGVJZk5vdEV4aXN0cyBvbiBkb2N1bWVudCB3aXRob3V0IF9pZFwiXG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVPclJlcGxhY2UoZG9jdW1lbnQsIG11dGF0aW9uKSB7XG4gIHJldHVybiBoYXNJZChtdXRhdGlvbi5kb2N1bWVudCkgPyBkb2N1bWVudCA/IHtcbiAgICBzdGF0dXM6IFwidXBkYXRlZFwiLFxuICAgIGlkOiBtdXRhdGlvbi5kb2N1bWVudC5faWQsXG4gICAgYmVmb3JlOiBkb2N1bWVudCxcbiAgICBhZnRlcjogbXV0YXRpb24uZG9jdW1lbnRcbiAgfSA6IHsgc3RhdHVzOiBcImNyZWF0ZWRcIiwgaWQ6IG11dGF0aW9uLmRvY3VtZW50Ll9pZCwgYWZ0ZXI6IG11dGF0aW9uLmRvY3VtZW50IH0gOiB7XG4gICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgbWVzc2FnZTogXCJDYW5ub3QgY3JlYXRlSWZOb3RFeGlzdHMgb24gZG9jdW1lbnQgd2l0aG91dCBfaWRcIlxuICB9O1xufVxuZnVuY3Rpb24gZGVsKGRvY3VtZW50LCBtdXRhdGlvbikge1xuICByZXR1cm4gZG9jdW1lbnQgPyBtdXRhdGlvbi5pZCAhPT0gZG9jdW1lbnQuX2lkID8geyBzdGF0dXM6IFwiZXJyb3JcIiwgbWVzc2FnZTogXCJEZWxldGUgbXV0YXRpb24gdGFyZ2V0ZWQgd3JvbmcgZG9jdW1lbnRcIiB9IDoge1xuICAgIHN0YXR1czogXCJkZWxldGVkXCIsXG4gICAgaWQ6IG11dGF0aW9uLmlkLFxuICAgIGJlZm9yZTogZG9jdW1lbnQsXG4gICAgYWZ0ZXI6IHZvaWQgMFxuICB9IDogeyBzdGF0dXM6IFwibm9vcFwiIH07XG59XG5mdW5jdGlvbiBwYXRjaChkb2N1bWVudCwgbXV0YXRpb24pIHtcbiAgaWYgKCFkb2N1bWVudClcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgICBtZXNzYWdlOiBcIkNhbm5vdCBhcHBseSBwYXRjaCBvbiBub25leGlzdGVudCBkb2N1bWVudFwiXG4gICAgfTtcbiAgY29uc3QgbmV4dCA9IGFwcGx5UGF0Y2hNdXRhdGlvbihtdXRhdGlvbiwgZG9jdW1lbnQpO1xuICByZXR1cm4gZG9jdW1lbnQgPT09IG5leHQgPyB7IHN0YXR1czogXCJub29wXCIgfSA6IHsgc3RhdHVzOiBcInVwZGF0ZWRcIiwgaWQ6IG11dGF0aW9uLmlkLCBiZWZvcmU6IGRvY3VtZW50LCBhZnRlcjogbmV4dCB9O1xufVxuZnVuY3Rpb24gYXBwbHlNdXRhdGlvbnMobXV0YXRpb25zLCBkYXRhc2V0KSB7XG4gIGNvbnN0IHVwZGF0ZWREb2NzID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XG4gICAgY29uc3QgZG9jdW1lbnRJZCA9IGdldE11dGF0aW9uRG9jdW1lbnRJZChtdXRhdGlvbik7XG4gICAgaWYgKCFkb2N1bWVudElkKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGdldCBkb2N1bWVudCBpZCBmcm9tIG11dGF0aW9uXCIpO1xuICAgIGNvbnN0IGJlZm9yZSA9IHVwZGF0ZWREb2NzW2RvY3VtZW50SWRdPy5hZnRlciB8fCBkYXRhc2V0LmdldChkb2N1bWVudElkKSwgcmVzID0gYXBwbHlEb2N1bWVudE11dGF0aW9uKGJlZm9yZSwgbXV0YXRpb24pO1xuICAgIGlmIChyZXMuc3RhdHVzID09PSBcImVycm9yXCIpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLm1lc3NhZ2UpO1xuICAgIHJlcy5zdGF0dXMgIT09IFwibm9vcFwiICYmIChyZXMuc3RhdHVzID09PSBcInVwZGF0ZWRcIiB8fCByZXMuc3RhdHVzID09PSBcImNyZWF0ZWRcIiB8fCByZXMuc3RhdHVzID09PSBcImRlbGV0ZWRcIikgJiYgKGRvY3VtZW50SWQgaW4gdXBkYXRlZERvY3MgfHwgKHVwZGF0ZWREb2NzW2RvY3VtZW50SWRdID0geyBiZWZvcmUsIGFmdGVyOiB2b2lkIDAsIG11dHM6IFtdIH0pLCB1cGRhdGVkRG9jc1tkb2N1bWVudElkXS5hZnRlciA9IHJlcy5hZnRlcik7XG4gIH1cbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHVwZGF0ZWREb2NzKS5tYXAoXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xuICAgIChbaWQsIHsgYmVmb3JlLCBhZnRlciwgbXV0cyB9XSkgPT4gKHtcbiAgICAgIGlkLFxuICAgICAgc3RhdHVzOiBhZnRlciA/IGJlZm9yZSA/IFwidXBkYXRlZFwiIDogXCJjcmVhdGVkXCIgOiBcImRlbGV0ZWRcIixcbiAgICAgIG11dGF0aW9uczogbXV0cyxcbiAgICAgIGJlZm9yZSxcbiAgICAgIGFmdGVyXG4gICAgfSlcbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbW1pdChyZXN1bHRzLCBkYXRhc2V0KSB7XG4gIHJlc3VsdHMuZm9yRWFjaCgocmVzdWx0KSA9PiB7XG4gICAgKHJlc3VsdC5zdGF0dXMgPT09IFwiY3JlYXRlZFwiIHx8IHJlc3VsdC5zdGF0dXMgPT09IFwidXBkYXRlZFwiKSAmJiBkYXRhc2V0LnNldChyZXN1bHQuaWQsIHJlc3VsdC5hZnRlciksIHJlc3VsdC5zdGF0dXMgPT09IFwiZGVsZXRlZFwiICYmIGRhdGFzZXQuZGVsZXRlKHJlc3VsdC5pZCk7XG4gIH0pO1xufVxuZnVuY3Rpb24gdGFrZVVudGlsUmlnaHQoYXJyLCBwcmVkaWNhdGUsIG9wdHMpIHtcbiAgY29uc3QgcmVzdWx0ID0gW107XG4gIGZvciAoY29uc3QgaXRlbSBvZiBhcnIuc2xpY2UoKS5yZXZlcnNlKCkpIHtcbiAgICBpZiAocHJlZGljYXRlKGl0ZW0pKVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICByZXN1bHQucHVzaChpdGVtKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0LnJldmVyc2UoKTtcbn1cbmZ1bmN0aW9uIGlzRXF1YWxQYXRoKHAxLCBwMikge1xuICByZXR1cm4gc3RyaW5naWZ5KHAxKSA9PT0gc3RyaW5naWZ5KHAyKTtcbn1cbmZ1bmN0aW9uIHN1cGVyc2VkZXMobGF0ZXIsIGVhcmxpZXIpIHtcbiAgcmV0dXJuIChlYXJsaWVyLnR5cGUgPT09IFwic2V0XCIgfHwgZWFybGllci50eXBlID09PSBcInVuc2V0XCIpICYmIChsYXRlci50eXBlID09PSBcInNldFwiIHx8IGxhdGVyLnR5cGUgPT09IFwidW5zZXRcIik7XG59XG5mdW5jdGlvbiBzcXVhc2hOb2RlUGF0Y2hlcyhwYXRjaGVzKSB7XG4gIHJldHVybiBjb21wYWN0U2V0SWZNaXNzaW5nUGF0Y2hlcyhcbiAgICBjb21wYWN0U2V0UGF0Y2hlcyhjb21wYWN0VW5zZXRQYXRjaGVzKHBhdGNoZXMpKVxuICApO1xufVxuZnVuY3Rpb24gY29tcGFjdFVuc2V0UGF0Y2hlcyhwYXRjaGVzKSB7XG4gIHJldHVybiBwYXRjaGVzLnJlZHVjZShcbiAgICAoZWFybGllclBhdGNoZXMsIGxhdGVyUGF0Y2gpID0+IHtcbiAgICAgIGlmIChsYXRlclBhdGNoLm9wLnR5cGUgIT09IFwidW5zZXRcIilcbiAgICAgICAgcmV0dXJuIGVhcmxpZXJQYXRjaGVzLnB1c2gobGF0ZXJQYXRjaCksIGVhcmxpZXJQYXRjaGVzO1xuICAgICAgY29uc3QgdW5hZmZlY3RlZCA9IGVhcmxpZXJQYXRjaGVzLmZpbHRlcihcbiAgICAgICAgKGVhcmxpZXJQYXRjaCkgPT4gIXN0YXJ0c1dpdGgobGF0ZXJQYXRjaC5wYXRoLCBlYXJsaWVyUGF0Y2gucGF0aClcbiAgICAgICk7XG4gICAgICByZXR1cm4gdW5hZmZlY3RlZC5wdXNoKGxhdGVyUGF0Y2gpLCB1bmFmZmVjdGVkO1xuICAgIH0sXG4gICAgW11cbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbXBhY3RTZXRQYXRjaGVzKHBhdGNoZXMpIHtcbiAgcmV0dXJuIHBhdGNoZXMucmVkdWNlUmlnaHQoXG4gICAgKGxhdGVyUGF0Y2hlcywgZWFybGllclBhdGNoKSA9PiAobGF0ZXJQYXRjaGVzLmZpbmQoXG4gICAgICAobGF0ZXIpID0+IHN1cGVyc2VkZXMobGF0ZXIub3AsIGVhcmxpZXJQYXRjaC5vcCkgJiYgaXNFcXVhbFBhdGgobGF0ZXIucGF0aCwgZWFybGllclBhdGNoLnBhdGgpXG4gICAgKSB8fCBsYXRlclBhdGNoZXMudW5zaGlmdChlYXJsaWVyUGF0Y2gpLCBsYXRlclBhdGNoZXMpLFxuICAgIFtdXG4gICk7XG59XG5mdW5jdGlvbiBjb21wYWN0U2V0SWZNaXNzaW5nUGF0Y2hlcyhwYXRjaGVzKSB7XG4gIHJldHVybiBwYXRjaGVzLnJlZHVjZShcbiAgICAocHJldmlvdXNQYXRjaGVzLCBsYXRlclBhdGNoKSA9PiBsYXRlclBhdGNoLm9wLnR5cGUgIT09IFwic2V0SWZNaXNzaW5nXCIgPyAocHJldmlvdXNQYXRjaGVzLnB1c2gobGF0ZXJQYXRjaCksIHByZXZpb3VzUGF0Y2hlcykgOiAodGFrZVVudGlsUmlnaHQoXG4gICAgICBwcmV2aW91c1BhdGNoZXMsXG4gICAgICAocGF0Y2gyKSA9PiBwYXRjaDIub3AudHlwZSA9PT0gXCJ1bnNldFwiXG4gICAgKS5maW5kKFxuICAgICAgKHByZWNlZGluZ1BhdGNoKSA9PiBwcmVjZWRpbmdQYXRjaC5vcC50eXBlID09PSBcInNldElmTWlzc2luZ1wiICYmIGlzRXF1YWxQYXRoKHByZWNlZGluZ1BhdGNoLnBhdGgsIGxhdGVyUGF0Y2gucGF0aClcbiAgICApIHx8IHByZXZpb3VzUGF0Y2hlcy5wdXNoKGxhdGVyUGF0Y2gpLCBwcmV2aW91c1BhdGNoZXMpLFxuICAgIFtdXG4gICk7XG59XG5mdW5jdGlvbiBjb21wYWN0RE1QU2V0UGF0Y2hlcyhiYXNlLCBwYXRjaGVzKSB7XG4gIGxldCBlZGdlID0gYmFzZTtcbiAgcmV0dXJuIHBhdGNoZXMucmVkdWNlKFxuICAgIChlYXJsaWVyUGF0Y2hlcywgbGF0ZXJQYXRjaCkgPT4ge1xuICAgICAgY29uc3QgYmVmb3JlID0gZWRnZTtcbiAgICAgIGlmIChlZGdlID0gYXBwbHlOb2RlUGF0Y2gobGF0ZXJQYXRjaCwgZWRnZSksIGxhdGVyUGF0Y2gub3AudHlwZSA9PT0gXCJzZXRcIiAmJiB0eXBlb2YgbGF0ZXJQYXRjaC5vcC52YWx1ZSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBnZXRBdFBhdGgobGF0ZXJQYXRjaC5wYXRoLCBiZWZvcmUpO1xuICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnQgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGNvbnN0IHJlcGxhY2VkID0ge1xuICAgICAgICAgICAgLi4ubGF0ZXJQYXRjaCxcbiAgICAgICAgICAgIG9wOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZGlmZk1hdGNoUGF0Y2hcIixcbiAgICAgICAgICAgICAgdmFsdWU6IHN0cmluZ2lmeVBhdGNoZXMoXG4gICAgICAgICAgICAgICAgbWFrZVBhdGNoZXMoY3VycmVudCwgbGF0ZXJQYXRjaC5vcC52YWx1ZSlcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgcmV0dXJuIGVhcmxpZXJQYXRjaGVzLmZsYXRNYXAoKGVwKSA9PiBpc0VxdWFsUGF0aChlcC5wYXRoLCBsYXRlclBhdGNoLnBhdGgpICYmIGVwLm9wLnR5cGUgPT09IFwiZGlmZk1hdGNoUGF0Y2hcIiA/IFtdIDogZXApLmNvbmNhdChyZXBsYWNlZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBlYXJsaWVyUGF0Y2hlcy5wdXNoKGxhdGVyUGF0Y2gpLCBlYXJsaWVyUGF0Y2hlcztcbiAgICB9LFxuICAgIFtdXG4gICk7XG59XG5mdW5jdGlvbiBzcXVhc2hETVBTdHJpbmdzKHJlbW90ZSwgbXV0YXRpb25Hcm91cHMpIHtcbiAgcmV0dXJuIG11dGF0aW9uR3JvdXBzLm1hcCgobXV0YXRpb25Hcm91cCkgPT4gKHtcbiAgICAuLi5tdXRhdGlvbkdyb3VwLFxuICAgIG11dGF0aW9uczogZG1wSWZ5TXV0YXRpb25zKHJlbW90ZSwgbXV0YXRpb25Hcm91cC5tdXRhdGlvbnMpXG4gIH0pKTtcbn1cbmZ1bmN0aW9uIGRtcElmeU11dGF0aW9ucyhzdG9yZSwgbXV0YXRpb25zKSB7XG4gIHJldHVybiBtdXRhdGlvbnMubWFwKChtdXRhdGlvbiwgaSkgPT4gbXV0YXRpb24udHlwZSA9PT0gXCJwYXRjaFwiID8gZG1waWZ5UGF0Y2hNdXRhdGlvbihzdG9yZS5nZXQobXV0YXRpb24uaWQpLCBtdXRhdGlvbikgOiBtdXRhdGlvbik7XG59XG5mdW5jdGlvbiBkbXBpZnlQYXRjaE11dGF0aW9uKGJhc2UsIG11dGF0aW9uKSB7XG4gIHJldHVybiBiYXNlID8ge1xuICAgIC4uLm11dGF0aW9uLFxuICAgIHBhdGNoZXM6IGNvbXBhY3RETVBTZXRQYXRjaGVzKGJhc2UsIG11dGF0aW9uLnBhdGNoZXMpXG4gIH0gOiBtdXRhdGlvbjtcbn1cbmZ1bmN0aW9uIG1lcmdlTXV0YXRpb25Hcm91cHMobXV0YXRpb25Hcm91cHMpIHtcbiAgcmV0dXJuIGNodW5rV2hpbGUobXV0YXRpb25Hcm91cHMsIChncm91cCkgPT4gIWdyb3VwLnRyYW5zYWN0aW9uKS5mbGF0TWFwKFxuICAgIChjaHVuaykgPT4gKHtcbiAgICAgIC4uLmNodW5rWzBdLFxuICAgICAgbXV0YXRpb25zOiBjaHVuay5mbGF0TWFwKChjKSA9PiBjLm11dGF0aW9ucylcbiAgICB9KVxuICApO1xufVxuZnVuY3Rpb24gY2h1bmtXaGlsZShhcnIsIHByZWRpY2F0ZSkge1xuICBjb25zdCByZXMgPSBbXTtcbiAgbGV0IGN1cnJlbnRDaHVuayA9IFtdO1xuICByZXR1cm4gYXJyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBwcmVkaWNhdGUoaXRlbSkgPyBjdXJyZW50Q2h1bmsucHVzaChpdGVtKSA6IChjdXJyZW50Q2h1bmsubGVuZ3RoID4gMCAmJiByZXMucHVzaChjdXJyZW50Q2h1bmspLCBjdXJyZW50Q2h1bmsgPSBbXSwgcmVzLnB1c2goW2l0ZW1dKSk7XG4gIH0pLCBjdXJyZW50Q2h1bmsubGVuZ3RoID4gMCAmJiByZXMucHVzaChjdXJyZW50Q2h1bmspLCByZXM7XG59XG5mdW5jdGlvbiBzcXVhc2hNdXRhdGlvbkdyb3VwcyhzdGFnZWQpIHtcbiAgcmV0dXJuIG1lcmdlTXV0YXRpb25Hcm91cHMoc3RhZ2VkKS5tYXAoKHRyYW5zYWN0aW9uKSA9PiAoe1xuICAgIC4uLnRyYW5zYWN0aW9uLFxuICAgIG11dGF0aW9uczogc3F1YXNoTXV0YXRpb25zKHRyYW5zYWN0aW9uLm11dGF0aW9ucylcbiAgfSkpLm1hcCgodHJhbnNhY3Rpb24pID0+ICh7XG4gICAgLi4udHJhbnNhY3Rpb24sXG4gICAgbXV0YXRpb25zOiB0cmFuc2FjdGlvbi5tdXRhdGlvbnMubWFwKChtdXRhdGlvbikgPT4gbXV0YXRpb24udHlwZSAhPT0gXCJwYXRjaFwiID8gbXV0YXRpb24gOiB7XG4gICAgICAuLi5tdXRhdGlvbixcbiAgICAgIHBhdGNoZXM6IHNxdWFzaE5vZGVQYXRjaGVzKG11dGF0aW9uLnBhdGNoZXMpXG4gICAgfSlcbiAgfSkpO1xufVxuZnVuY3Rpb24gc3F1YXNoTXV0YXRpb25zKG11dGF0aW9ucykge1xuICBjb25zdCBieURvY3VtZW50ID0gZ3JvdXBCeShtdXRhdGlvbnMsIGdldE11dGF0aW9uRG9jdW1lbnRJZCk7XG4gIHJldHVybiBPYmplY3QudmFsdWVzKGJ5RG9jdW1lbnQpLmZsYXRNYXAoKGRvY3VtZW50TXV0YXRpb25zKSA9PiBzcXVhc2hDcmVhdGVJZk5vdEV4aXN0cyhzcXVhc2hEZWxldGUoZG9jdW1lbnRNdXRhdGlvbnMpKS5mbGF0KCkucmVkdWNlKChhY2MsIGRvY011dGF0aW9uKSA9PiB7XG4gICAgY29uc3QgcHJldiA9IGFjY1thY2MubGVuZ3RoIC0gMV07XG4gICAgcmV0dXJuICghcHJldiB8fCBwcmV2LnR5cGUgPT09IFwicGF0Y2hcIikgJiYgZG9jTXV0YXRpb24udHlwZSA9PT0gXCJwYXRjaFwiID8gYWNjLnNsaWNlKDAsIC0xKS5jb25jYXQoe1xuICAgICAgLi4uZG9jTXV0YXRpb24sXG4gICAgICBwYXRjaGVzOiAocHJldj8ucGF0Y2hlcyB8fCBbXSkuY29uY2F0KGRvY011dGF0aW9uLnBhdGNoZXMpXG4gICAgfSkgOiBhY2MuY29uY2F0KGRvY011dGF0aW9uKTtcbiAgfSwgW10pKTtcbn1cbmZ1bmN0aW9uIHNxdWFzaENyZWF0ZUlmTm90RXhpc3RzKG11dGF0aW9ucykge1xuICByZXR1cm4gbXV0YXRpb25zLmxlbmd0aCA9PT0gMCA/IG11dGF0aW9ucyA6IG11dGF0aW9ucy5yZWR1Y2UoKHByZXZpb3VzTXV0cywgbGF0ZXJNdXQpID0+IGxhdGVyTXV0LnR5cGUgIT09IFwiY3JlYXRlSWZOb3RFeGlzdHNcIiA/IChwcmV2aW91c011dHMucHVzaChsYXRlck11dCksIHByZXZpb3VzTXV0cykgOiAodGFrZVVudGlsUmlnaHQocHJldmlvdXNNdXRzLCAobSkgPT4gbS50eXBlID09PSBcImRlbGV0ZVwiKS5maW5kKFxuICAgIChwcmVjZWRpbmdQYXRjaCkgPT4gcHJlY2VkaW5nUGF0Y2gudHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiXG4gICkgfHwgcHJldmlvdXNNdXRzLnB1c2gobGF0ZXJNdXQpLCBwcmV2aW91c011dHMpLCBbXSk7XG59XG5mdW5jdGlvbiBzcXVhc2hEZWxldGUobXV0YXRpb25zKSB7XG4gIHJldHVybiBtdXRhdGlvbnMubGVuZ3RoID09PSAwID8gbXV0YXRpb25zIDogbXV0YXRpb25zLnJlZHVjZSgocHJldmlvdXNNdXRzLCBsYXRlck11dCkgPT4gbGF0ZXJNdXQudHlwZSA9PT0gXCJkZWxldGVcIiA/IFtsYXRlck11dF0gOiAocHJldmlvdXNNdXRzLnB1c2gobGF0ZXJNdXQpLCBwcmV2aW91c011dHMpLCBbXSk7XG59XG5mdW5jdGlvbiByZWJhc2UoZG9jdW1lbnRJZCwgb2xkQmFzZSwgbmV3QmFzZSwgc3RhZ2VkTXV0YXRpb25zKSB7XG4gIGxldCBlZGdlID0gb2xkQmFzZTtcbiAgY29uc3QgZG1waWZpZWQgPSBzdGFnZWRNdXRhdGlvbnMubWFwKCh0cmFuc2FjdGlvbikgPT4ge1xuICAgIGNvbnN0IG11dGF0aW9ucyA9IHRyYW5zYWN0aW9uLm11dGF0aW9ucy5mbGF0TWFwKChtdXQpID0+IHtcbiAgICAgIGlmIChnZXRNdXRhdGlvbkRvY3VtZW50SWQobXV0KSAhPT0gZG9jdW1lbnRJZClcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgY29uc3QgYmVmb3JlID0gZWRnZTtcbiAgICAgIHJldHVybiBlZGdlID0gYXBwbHlBbGwoZWRnZSwgW211dF0pLCAhYmVmb3JlIHx8IG11dC50eXBlICE9PSBcInBhdGNoXCIgPyBtdXQgOiB7XG4gICAgICAgIHR5cGU6IFwiZG1waWZpZWRcIixcbiAgICAgICAgbXV0YXRpb246IHtcbiAgICAgICAgICAuLi5tdXQsXG4gICAgICAgICAgLy8gVG9kbzogbWFrZSBjb21wYWN0RE1QU2V0UGF0Y2hlcyByZXR1cm4gcGFpcnMgb2YgcGF0Y2hlcyB0aGF0IHdhcyBkbXBpZmllZCB3aXRoIHRoZWlyXG4gICAgICAgICAgLy8gIG9yaWdpbmFsIGFzIGRtcFBhdGNoZXMgYW5kIG9yaWdpbmFsIGlzIG5vdCAxOjEgKGUuLmcgc29tZSBvZiB0aGUgb3JpZ2luYWwgbWF5IG5vdCBiZSBkbXBpZmllZClcbiAgICAgICAgICBkbXBQYXRjaGVzOiBjb21wYWN0RE1QU2V0UGF0Y2hlcyhiZWZvcmUsIG11dC5wYXRjaGVzKSxcbiAgICAgICAgICBvcmlnaW5hbDogbXV0LnBhdGNoZXNcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbiAgICByZXR1cm4geyAuLi50cmFuc2FjdGlvbiwgbXV0YXRpb25zIH07XG4gIH0pO1xuICBsZXQgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZCA9IG5ld0Jhc2U7XG4gIHJldHVybiBkbXBpZmllZC5tYXAoKHRyYW5zYWN0aW9uKSA9PiB7XG4gICAgY29uc3QgYXBwbGllZCA9IFtdO1xuICAgIHJldHVybiB0cmFuc2FjdGlvbi5tdXRhdGlvbnMuZm9yRWFjaCgobXV0KSA9PiB7XG4gICAgICBpZiAobXV0LnR5cGUgPT09IFwiZG1waWZpZWRcIilcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBuZXdCYXNlV2l0aERNUEZvck9sZEJhc2VBcHBsaWVkID0gYXBwbHlQYXRjaGVzKFxuICAgICAgICAgICAgbXV0Lm11dGF0aW9uLmRtcFBhdGNoZXMsXG4gICAgICAgICAgICBuZXdCYXNlV2l0aERNUEZvck9sZEJhc2VBcHBsaWVkXG4gICAgICAgICAgKSwgYXBwbGllZC5wdXNoKG11dCk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBhcHBseSBkbXAgcGF0Y2gsIGZhbGxpbmcgYmFjayB0byBvcmlnaW5hbFwiKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZCA9IGFwcGx5UGF0Y2hlcyhcbiAgICAgICAgICAgICAgbXV0Lm11dGF0aW9uLm9yaWdpbmFsLFxuICAgICAgICAgICAgICBuZXdCYXNlV2l0aERNUEZvck9sZEJhc2VBcHBsaWVkXG4gICAgICAgICAgICApLCBhcHBsaWVkLnB1c2gobXV0KTtcbiAgICAgICAgICB9IGNhdGNoIChzZWNvbmQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgYEZhaWxlZCB0byBhcHBseSBwYXRjaCBmb3IgZG9jdW1lbnQgXCIke2RvY3VtZW50SWR9XCI6ICR7c2Vjb25kLm1lc3NhZ2V9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIGVsc2VcbiAgICAgICAgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZCA9IGFwcGx5QWxsKFxuICAgICAgICAgIG5ld0Jhc2VXaXRoRE1QRm9yT2xkQmFzZUFwcGxpZWQsXG4gICAgICAgICAgW211dF1cbiAgICAgICAgKTtcbiAgICB9KTtcbiAgfSksIFtzdGFnZWRNdXRhdGlvbnMubWFwKCh0cmFuc2FjdGlvbikgPT4gKHtcbiAgICAuLi50cmFuc2FjdGlvbixcbiAgICBtdXRhdGlvbnM6IHRyYW5zYWN0aW9uLm11dGF0aW9ucy5tYXAoKG11dCkgPT4gbXV0LnR5cGUgIT09IFwicGF0Y2hcIiB8fCBnZXRNdXRhdGlvbkRvY3VtZW50SWQobXV0KSAhPT0gZG9jdW1lbnRJZCA/IG11dCA6IHtcbiAgICAgIC4uLm11dCxcbiAgICAgIHBhdGNoZXM6IG11dC5wYXRjaGVzLm1hcCgocGF0Y2gyKSA9PiBwYXRjaDIub3AudHlwZSAhPT0gXCJzZXRcIiA/IHBhdGNoMiA6IHtcbiAgICAgICAgLi4ucGF0Y2gyLFxuICAgICAgICBvcDoge1xuICAgICAgICAgIC4uLnBhdGNoMi5vcCxcbiAgICAgICAgICB2YWx1ZTogZ2V0QXRQYXRoKHBhdGNoMi5wYXRoLCBuZXdCYXNlV2l0aERNUEZvck9sZEJhc2VBcHBsaWVkKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gIH0pKSwgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZF07XG59XG5mdW5jdGlvbiB0b1RyYW5zYWN0aW9ucyhncm91cHMpIHtcbiAgcmV0dXJuIGdyb3Vwcy5tYXAoKGdyb3VwKSA9PiBncm91cC50cmFuc2FjdGlvbiAmJiBncm91cC5pZCAhPT0gdm9pZCAwID8geyBpZDogZ3JvdXAuaWQsIG11dGF0aW9uczogZ3JvdXAubXV0YXRpb25zIH0gOiB7IG11dGF0aW9uczogZ3JvdXAubXV0YXRpb25zIH0pO1xufVxuZXhwb3J0IHtcbiAgYXBwbHlNdXRhdGlvbnMsXG4gIGNvbW1pdCxcbiAgZ2V0TXV0YXRpb25Eb2N1bWVudElkLFxuICByZWJhc2UsXG4gIHNxdWFzaERNUFN0cmluZ3MsXG4gIHNxdWFzaE11dGF0aW9uR3JvdXBzLFxuICB0b1RyYW5zYWN0aW9uc1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRvVHJhbnNhY3Rpb25zLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyNodePatch: () => (/* binding */ applyNodePatch),\n/* harmony export */   applyOp: () => (/* binding */ applyOp),\n/* harmony export */   applyPatchMutation: () => (/* binding */ applyPatchMutation),\n/* harmony export */   applyPatches: () => (/* binding */ applyPatches),\n/* harmony export */   assignId: () => (/* binding */ assignId),\n/* harmony export */   hasId: () => (/* binding */ hasId),\n/* harmony export */   nanoid: () => (/* binding */ nanoid),\n/* harmony export */   splice: () => (/* binding */ splice)\n/* harmony export */ });\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n/* harmony import */ var _isObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./isObject.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js\");\n/* harmony import */ var _sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/diff-match-patch */ \"(ssr)/./node_modules/@sanity/diff-match-patch/dist/index.js\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n\n\n\n\nfunction keyOf(value) {\n  return value !== null && typeof value == \"object\" && typeof value._key == \"string\" && value._key || null;\n}\nfunction findTargetIndex(array, pathSegment) {\n  if (typeof pathSegment == \"number\")\n    return normalizeIndex(array.length, pathSegment);\n  if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.isKeyedElement)(pathSegment)) {\n    const idx = array.findIndex((value) => keyOf(value) === pathSegment._key);\n    return idx === -1 ? null : idx;\n  }\n  throw new Error(\n    `Expected path segment to be addressing a single array item either by numeric index or by '_key'. Instead saw ${JSON.stringify(\n      pathSegment\n    )}`\n  );\n}\nfunction getTargetIdx(position, index) {\n  return position === \"before\" ? index : index + 1;\n}\nfunction normalizeIndex(length, index) {\n  if (length === 0 && (index === -1 || index === 0))\n    return 0;\n  const normalized = index < 0 ? length + index : index;\n  return normalized >= length || normalized < 0 ? null : normalized;\n}\nfunction splice(arr, start, deleteCount, items) {\n  const copy = arr.slice();\n  return copy.splice(start, deleteCount, ...items || []), copy;\n}\nfunction insert(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"insert()\" on non-array value');\n  const index = findTargetIndex(currentValue, op.referenceItem);\n  if (index === null)\n    throw new Error(`Found no matching array element to insert ${op.position}`);\n  return currentValue.length === 0 ? op.items : splice(currentValue, getTargetIdx(op.position, index), 0, op.items);\n}\nfunction upsert(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"upsert()\" on non-array value');\n  if (op.items.length === 0)\n    return currentValue;\n  const replaceItemsMap = [], insertItems = [];\n  if (op.items.forEach((itemToBeUpserted, i) => {\n    const existingIndex = currentValue.findIndex(\n      (existingItem) => existingItem?._key === itemToBeUpserted._key\n    );\n    existingIndex >= 0 ? replaceItemsMap[existingIndex] = i : insertItems.push(itemToBeUpserted);\n  }), replaceItemsMap.length === 0 && insertItems.length == 0)\n    return currentValue;\n  const next = [...currentValue];\n  for (const i of replaceItemsMap)\n    next[i] = op.items[replaceItemsMap[i]];\n  return insert(\n    {\n      type: \"insert\",\n      items: insertItems,\n      referenceItem: op.referenceItem,\n      position: op.position\n    },\n    next\n  );\n}\nfunction replace(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"replace()\" on non-array value');\n  const index = findTargetIndex(currentValue, op.referenceItem);\n  if (index === null)\n    throw new Error(\"Found no matching array element to replace\");\n  return splice(currentValue, index, op.items.length, op.items);\n}\nfunction remove(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"remove()\" on non-array value');\n  const index = findTargetIndex(currentValue, op.referenceItem);\n  if (index === null)\n    throw new Error(\"Found no matching array element to replace\");\n  return splice(currentValue, index, 1, []);\n}\nfunction truncate(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"truncate()\" on non-array value');\n  return typeof op.endIndex == \"number\" ? currentValue.slice(0, op.startIndex).concat(currentValue.slice(op.endIndex)) : currentValue.slice(0, op.startIndex);\n}\nfunction set(op, currentValue) {\n  return op.value;\n}\nfunction setIfMissing(op, currentValue) {\n  return currentValue ?? op.value;\n}\nfunction unset(op) {\n}\nfunction inc(op, currentValue) {\n  if (typeof currentValue != \"number\")\n    throw new TypeError('Cannot apply \"inc()\" on non-numeric value');\n  return currentValue + op.amount;\n}\nfunction dec(op, currentValue) {\n  if (typeof currentValue != \"number\")\n    throw new TypeError('Cannot apply \"dec()\" on non-numeric value');\n  return currentValue - op.amount;\n}\nconst hasOwn = Object.prototype.hasOwnProperty.call.bind(\n  Object.prototype.hasOwnProperty\n);\nfunction isEmpty(v) {\n  for (const key in v)\n    if (hasOwn(v, key))\n      return !1;\n  return !0;\n}\nfunction omit(val, props) {\n  const copy = { ...val };\n  for (const prop of props)\n    delete copy[prop];\n  return copy;\n}\nfunction unassign(op, currentValue) {\n  if (!(0,_isObject_js__WEBPACK_IMPORTED_MODULE_2__.isObject)(currentValue))\n    throw new TypeError('Cannot apply \"unassign()\" on non-object value');\n  return op.keys.length === 0 ? currentValue : omit(currentValue, op.keys);\n}\nfunction assign(op, currentValue) {\n  if (!(0,_isObject_js__WEBPACK_IMPORTED_MODULE_2__.isObject)(currentValue))\n    throw new TypeError('Cannot apply \"assign()\" on non-object value');\n  return isEmpty(op.value) ? currentValue : { ...currentValue, ...op.value };\n}\nfunction diffMatchPatch(op, currentValue) {\n  if (typeof currentValue != \"string\")\n    throw new TypeError('Cannot apply \"diffMatchPatch()\" on non-string value');\n  return (0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.applyPatches)((0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.parsePatch)(op.value), currentValue)[0];\n}\nvar operations = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  assign,\n  dec,\n  diffMatchPatch,\n  inc,\n  insert,\n  remove,\n  replace,\n  set,\n  setIfMissing,\n  truncate,\n  unassign,\n  unset,\n  upsert\n});\nfunction applyOp(op, currentValue) {\n  if (!(op.type in operations))\n    throw new Error(`Invalid operation type: \"${op.type}\"`);\n  return operations[op.type](op, currentValue);\n}\nfunction applyPatches(patches, document) {\n  return patches.reduce(\n    (prev, patch) => applyNodePatch(patch, prev),\n    document\n  );\n}\nfunction applyNodePatch(patch, document) {\n  return applyAtPath(patch.path, patch.op, document);\n}\nfunction applyAtPath(path, op, value) {\n  if (!isNonEmptyArray(path))\n    return applyOp(op, value);\n  const [head, ...tail] = path;\n  if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.isArrayElement)(head) && Array.isArray(value))\n    return applyInArray(head, tail, op, value);\n  if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.isPropertyElement)(head) && (0,_isObject_js__WEBPACK_IMPORTED_MODULE_2__.isObject)(value))\n    return applyInObject(head, tail, op, value);\n  throw new Error(\n    `Cannot apply operation of type \"${op.type}\" to path ${(0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(\n      path\n    )} on ${typeof value} value`\n  );\n}\nfunction applyInObject(head, tail, op, object) {\n  const current = object[head];\n  if (current === void 0 && tail.length > 0)\n    return object;\n  const patchedValue = applyAtPath(tail, op, current);\n  return patchedValue === current ? object : { ...object, [head]: patchedValue };\n}\nfunction applyInArray(head, tail, op, value) {\n  const index = findTargetIndex(value, head);\n  if (index === null || index === -1)\n    return value;\n  const current = value[index], patchedItem = applyAtPath(tail, op, current);\n  return patchedItem === current ? value : splice(value, index, 1, [patchedItem]);\n}\nfunction isNonEmptyArray(a) {\n  return a.length > 0;\n}\nfunction applyPatchMutation(mutation, document) {\n  if (mutation.options?.ifRevision && document._rev !== mutation.options.ifRevision)\n    throw new Error(\"Revision mismatch\");\n  if (mutation.id !== document._id)\n    throw new Error(\n      `Document id mismatch. Refusing to apply mutation for document with id=\"${mutation.id}\" on the given document with id=\"${document._id}\"`\n    );\n  return applyPatches(mutation.patches, document);\n}\nconst urlAlphabet = \"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict\", POOL_SIZE_MULTIPLIER = 128;\nlet pool, poolOffset;\nfunction fillPool(bytes) {\n  !pool || pool.length < bytes ? (pool = Buffer.allocUnsafe(bytes * POOL_SIZE_MULTIPLIER), node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto.getRandomValues(pool), poolOffset = 0) : poolOffset + bytes > pool.length && (node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto.getRandomValues(pool), poolOffset = 0), poolOffset += bytes;\n}\nfunction nanoid(size = 21) {\n  fillPool(size -= 0);\n  let id = \"\";\n  for (let i = poolOffset - size; i < poolOffset; i++)\n    id += urlAlphabet[pool[i] & 63];\n  return id;\n}\nfunction hasId(doc) {\n  return \"_id\" in doc;\n}\nfunction assignId(doc, generateId) {\n  return hasId(doc) ? doc : { ...doc, _id: generateId() };\n}\n\n//# sourceMappingURL=utils.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy91dGlscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBOEY7QUFDckQ7QUFDNkM7QUFDOUM7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSw2REFBYztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9IQUFvSDtBQUNwSDtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLFlBQVk7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sc0RBQVE7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sc0RBQVE7QUFDZjtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsc0VBQWMsQ0FBQyxvRUFBVTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsZ0RBQWdELFFBQVE7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSw2REFBYztBQUNwQjtBQUNBLE1BQU0sZ0VBQWlCLFVBQVUsc0RBQVE7QUFDekM7QUFDQTtBQUNBLHVDQUF1QyxRQUFRLFlBQVksd0RBQVM7QUFDcEU7QUFDQSxPQUFPLEtBQUssY0FBYztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdGQUFnRixZQUFZLG1DQUFtQyxhQUFhO0FBQzVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJGQUEyRixrREFBUywrRUFBK0Usa0RBQVM7QUFDNUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0JBQWdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBVUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy91dGlscy5qcz8yMmE5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzS2V5ZWRFbGVtZW50LCBpc0FycmF5RWxlbWVudCwgaXNQcm9wZXJ0eUVsZW1lbnQsIHN0cmluZ2lmeSB9IGZyb20gXCIuL3N0cmluZ2lmeS5qc1wiO1xuaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tIFwiLi9pc09iamVjdC5qc1wiO1xuaW1wb3J0IHsgYXBwbHlQYXRjaGVzIGFzIGFwcGx5UGF0Y2hlcyQxLCBwYXJzZVBhdGNoIH0gZnJvbSBcIkBzYW5pdHkvZGlmZi1tYXRjaC1wYXRjaFwiO1xuaW1wb3J0IHsgd2ViY3J5cHRvIH0gZnJvbSBcIm5vZGU6Y3J5cHRvXCI7XG5mdW5jdGlvbiBrZXlPZih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHZhbHVlLl9rZXkgPT0gXCJzdHJpbmdcIiAmJiB2YWx1ZS5fa2V5IHx8IG51bGw7XG59XG5mdW5jdGlvbiBmaW5kVGFyZ2V0SW5kZXgoYXJyYXksIHBhdGhTZWdtZW50KSB7XG4gIGlmICh0eXBlb2YgcGF0aFNlZ21lbnQgPT0gXCJudW1iZXJcIilcbiAgICByZXR1cm4gbm9ybWFsaXplSW5kZXgoYXJyYXkubGVuZ3RoLCBwYXRoU2VnbWVudCk7XG4gIGlmIChpc0tleWVkRWxlbWVudChwYXRoU2VnbWVudCkpIHtcbiAgICBjb25zdCBpZHggPSBhcnJheS5maW5kSW5kZXgoKHZhbHVlKSA9PiBrZXlPZih2YWx1ZSkgPT09IHBhdGhTZWdtZW50Ll9rZXkpO1xuICAgIHJldHVybiBpZHggPT09IC0xID8gbnVsbCA6IGlkeDtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgYEV4cGVjdGVkIHBhdGggc2VnbWVudCB0byBiZSBhZGRyZXNzaW5nIGEgc2luZ2xlIGFycmF5IGl0ZW0gZWl0aGVyIGJ5IG51bWVyaWMgaW5kZXggb3IgYnkgJ19rZXknLiBJbnN0ZWFkIHNhdyAke0pTT04uc3RyaW5naWZ5KFxuICAgICAgcGF0aFNlZ21lbnRcbiAgICApfWBcbiAgKTtcbn1cbmZ1bmN0aW9uIGdldFRhcmdldElkeChwb3NpdGlvbiwgaW5kZXgpIHtcbiAgcmV0dXJuIHBvc2l0aW9uID09PSBcImJlZm9yZVwiID8gaW5kZXggOiBpbmRleCArIDE7XG59XG5mdW5jdGlvbiBub3JtYWxpemVJbmRleChsZW5ndGgsIGluZGV4KSB7XG4gIGlmIChsZW5ndGggPT09IDAgJiYgKGluZGV4ID09PSAtMSB8fCBpbmRleCA9PT0gMCkpXG4gICAgcmV0dXJuIDA7XG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSBpbmRleCA8IDAgPyBsZW5ndGggKyBpbmRleCA6IGluZGV4O1xuICByZXR1cm4gbm9ybWFsaXplZCA+PSBsZW5ndGggfHwgbm9ybWFsaXplZCA8IDAgPyBudWxsIDogbm9ybWFsaXplZDtcbn1cbmZ1bmN0aW9uIHNwbGljZShhcnIsIHN0YXJ0LCBkZWxldGVDb3VudCwgaXRlbXMpIHtcbiAgY29uc3QgY29weSA9IGFyci5zbGljZSgpO1xuICByZXR1cm4gY29weS5zcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50LCAuLi5pdGVtcyB8fCBbXSksIGNvcHk7XG59XG5mdW5jdGlvbiBpbnNlcnQob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudFZhbHVlKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJpbnNlcnQoKVwiIG9uIG5vbi1hcnJheSB2YWx1ZScpO1xuICBjb25zdCBpbmRleCA9IGZpbmRUYXJnZXRJbmRleChjdXJyZW50VmFsdWUsIG9wLnJlZmVyZW5jZUl0ZW0pO1xuICBpZiAoaW5kZXggPT09IG51bGwpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBGb3VuZCBubyBtYXRjaGluZyBhcnJheSBlbGVtZW50IHRvIGluc2VydCAke29wLnBvc2l0aW9ufWApO1xuICByZXR1cm4gY3VycmVudFZhbHVlLmxlbmd0aCA9PT0gMCA/IG9wLml0ZW1zIDogc3BsaWNlKGN1cnJlbnRWYWx1ZSwgZ2V0VGFyZ2V0SWR4KG9wLnBvc2l0aW9uLCBpbmRleCksIDAsIG9wLml0ZW1zKTtcbn1cbmZ1bmN0aW9uIHVwc2VydChvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShjdXJyZW50VmFsdWUpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcInVwc2VydCgpXCIgb24gbm9uLWFycmF5IHZhbHVlJyk7XG4gIGlmIChvcC5pdGVtcy5sZW5ndGggPT09IDApXG4gICAgcmV0dXJuIGN1cnJlbnRWYWx1ZTtcbiAgY29uc3QgcmVwbGFjZUl0ZW1zTWFwID0gW10sIGluc2VydEl0ZW1zID0gW107XG4gIGlmIChvcC5pdGVtcy5mb3JFYWNoKChpdGVtVG9CZVVwc2VydGVkLCBpKSA9PiB7XG4gICAgY29uc3QgZXhpc3RpbmdJbmRleCA9IGN1cnJlbnRWYWx1ZS5maW5kSW5kZXgoXG4gICAgICAoZXhpc3RpbmdJdGVtKSA9PiBleGlzdGluZ0l0ZW0/Ll9rZXkgPT09IGl0ZW1Ub0JlVXBzZXJ0ZWQuX2tleVxuICAgICk7XG4gICAgZXhpc3RpbmdJbmRleCA+PSAwID8gcmVwbGFjZUl0ZW1zTWFwW2V4aXN0aW5nSW5kZXhdID0gaSA6IGluc2VydEl0ZW1zLnB1c2goaXRlbVRvQmVVcHNlcnRlZCk7XG4gIH0pLCByZXBsYWNlSXRlbXNNYXAubGVuZ3RoID09PSAwICYmIGluc2VydEl0ZW1zLmxlbmd0aCA9PSAwKVxuICAgIHJldHVybiBjdXJyZW50VmFsdWU7XG4gIGNvbnN0IG5leHQgPSBbLi4uY3VycmVudFZhbHVlXTtcbiAgZm9yIChjb25zdCBpIG9mIHJlcGxhY2VJdGVtc01hcClcbiAgICBuZXh0W2ldID0gb3AuaXRlbXNbcmVwbGFjZUl0ZW1zTWFwW2ldXTtcbiAgcmV0dXJuIGluc2VydChcbiAgICB7XG4gICAgICB0eXBlOiBcImluc2VydFwiLFxuICAgICAgaXRlbXM6IGluc2VydEl0ZW1zLFxuICAgICAgcmVmZXJlbmNlSXRlbTogb3AucmVmZXJlbmNlSXRlbSxcbiAgICAgIHBvc2l0aW9uOiBvcC5wb3NpdGlvblxuICAgIH0sXG4gICAgbmV4dFxuICApO1xufVxuZnVuY3Rpb24gcmVwbGFjZShvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShjdXJyZW50VmFsdWUpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcInJlcGxhY2UoKVwiIG9uIG5vbi1hcnJheSB2YWx1ZScpO1xuICBjb25zdCBpbmRleCA9IGZpbmRUYXJnZXRJbmRleChjdXJyZW50VmFsdWUsIG9wLnJlZmVyZW5jZUl0ZW0pO1xuICBpZiAoaW5kZXggPT09IG51bGwpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRm91bmQgbm8gbWF0Y2hpbmcgYXJyYXkgZWxlbWVudCB0byByZXBsYWNlXCIpO1xuICByZXR1cm4gc3BsaWNlKGN1cnJlbnRWYWx1ZSwgaW5kZXgsIG9wLml0ZW1zLmxlbmd0aCwgb3AuaXRlbXMpO1xufVxuZnVuY3Rpb24gcmVtb3ZlKG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KGN1cnJlbnRWYWx1ZSkpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGFwcGx5IFwicmVtb3ZlKClcIiBvbiBub24tYXJyYXkgdmFsdWUnKTtcbiAgY29uc3QgaW5kZXggPSBmaW5kVGFyZ2V0SW5kZXgoY3VycmVudFZhbHVlLCBvcC5yZWZlcmVuY2VJdGVtKTtcbiAgaWYgKGluZGV4ID09PSBudWxsKVxuICAgIHRocm93IG5ldyBFcnJvcihcIkZvdW5kIG5vIG1hdGNoaW5nIGFycmF5IGVsZW1lbnQgdG8gcmVwbGFjZVwiKTtcbiAgcmV0dXJuIHNwbGljZShjdXJyZW50VmFsdWUsIGluZGV4LCAxLCBbXSk7XG59XG5mdW5jdGlvbiB0cnVuY2F0ZShvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShjdXJyZW50VmFsdWUpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcInRydW5jYXRlKClcIiBvbiBub24tYXJyYXkgdmFsdWUnKTtcbiAgcmV0dXJuIHR5cGVvZiBvcC5lbmRJbmRleCA9PSBcIm51bWJlclwiID8gY3VycmVudFZhbHVlLnNsaWNlKDAsIG9wLnN0YXJ0SW5kZXgpLmNvbmNhdChjdXJyZW50VmFsdWUuc2xpY2Uob3AuZW5kSW5kZXgpKSA6IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBvcC5zdGFydEluZGV4KTtcbn1cbmZ1bmN0aW9uIHNldChvcCwgY3VycmVudFZhbHVlKSB7XG4gIHJldHVybiBvcC52YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldElmTWlzc2luZyhvcCwgY3VycmVudFZhbHVlKSB7XG4gIHJldHVybiBjdXJyZW50VmFsdWUgPz8gb3AudmFsdWU7XG59XG5mdW5jdGlvbiB1bnNldChvcCkge1xufVxuZnVuY3Rpb24gaW5jKG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKHR5cGVvZiBjdXJyZW50VmFsdWUgIT0gXCJudW1iZXJcIilcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJpbmMoKVwiIG9uIG5vbi1udW1lcmljIHZhbHVlJyk7XG4gIHJldHVybiBjdXJyZW50VmFsdWUgKyBvcC5hbW91bnQ7XG59XG5mdW5jdGlvbiBkZWMob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAodHlwZW9mIGN1cnJlbnRWYWx1ZSAhPSBcIm51bWJlclwiKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcImRlYygpXCIgb24gbm9uLW51bWVyaWMgdmFsdWUnKTtcbiAgcmV0dXJuIGN1cnJlbnRWYWx1ZSAtIG9wLmFtb3VudDtcbn1cbmNvbnN0IGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbC5iaW5kKFxuICBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5XG4pO1xuZnVuY3Rpb24gaXNFbXB0eSh2KSB7XG4gIGZvciAoY29uc3Qga2V5IGluIHYpXG4gICAgaWYgKGhhc093bih2LCBrZXkpKVxuICAgICAgcmV0dXJuICExO1xuICByZXR1cm4gITA7XG59XG5mdW5jdGlvbiBvbWl0KHZhbCwgcHJvcHMpIHtcbiAgY29uc3QgY29weSA9IHsgLi4udmFsIH07XG4gIGZvciAoY29uc3QgcHJvcCBvZiBwcm9wcylcbiAgICBkZWxldGUgY29weVtwcm9wXTtcbiAgcmV0dXJuIGNvcHk7XG59XG5mdW5jdGlvbiB1bmFzc2lnbihvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICghaXNPYmplY3QoY3VycmVudFZhbHVlKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJ1bmFzc2lnbigpXCIgb24gbm9uLW9iamVjdCB2YWx1ZScpO1xuICByZXR1cm4gb3Aua2V5cy5sZW5ndGggPT09IDAgPyBjdXJyZW50VmFsdWUgOiBvbWl0KGN1cnJlbnRWYWx1ZSwgb3Aua2V5cyk7XG59XG5mdW5jdGlvbiBhc3NpZ24ob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAoIWlzT2JqZWN0KGN1cnJlbnRWYWx1ZSkpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGFwcGx5IFwiYXNzaWduKClcIiBvbiBub24tb2JqZWN0IHZhbHVlJyk7XG4gIHJldHVybiBpc0VtcHR5KG9wLnZhbHVlKSA/IGN1cnJlbnRWYWx1ZSA6IHsgLi4uY3VycmVudFZhbHVlLCAuLi5vcC52YWx1ZSB9O1xufVxuZnVuY3Rpb24gZGlmZk1hdGNoUGF0Y2gob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAodHlwZW9mIGN1cnJlbnRWYWx1ZSAhPSBcInN0cmluZ1wiKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcImRpZmZNYXRjaFBhdGNoKClcIiBvbiBub24tc3RyaW5nIHZhbHVlJyk7XG4gIHJldHVybiBhcHBseVBhdGNoZXMkMShwYXJzZVBhdGNoKG9wLnZhbHVlKSwgY3VycmVudFZhbHVlKVswXTtcbn1cbnZhciBvcGVyYXRpb25zID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIGFzc2lnbixcbiAgZGVjLFxuICBkaWZmTWF0Y2hQYXRjaCxcbiAgaW5jLFxuICBpbnNlcnQsXG4gIHJlbW92ZSxcbiAgcmVwbGFjZSxcbiAgc2V0LFxuICBzZXRJZk1pc3NpbmcsXG4gIHRydW5jYXRlLFxuICB1bmFzc2lnbixcbiAgdW5zZXQsXG4gIHVwc2VydFxufSk7XG5mdW5jdGlvbiBhcHBseU9wKG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKCEob3AudHlwZSBpbiBvcGVyYXRpb25zKSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgb3BlcmF0aW9uIHR5cGU6IFwiJHtvcC50eXBlfVwiYCk7XG4gIHJldHVybiBvcGVyYXRpb25zW29wLnR5cGVdKG9wLCBjdXJyZW50VmFsdWUpO1xufVxuZnVuY3Rpb24gYXBwbHlQYXRjaGVzKHBhdGNoZXMsIGRvY3VtZW50KSB7XG4gIHJldHVybiBwYXRjaGVzLnJlZHVjZShcbiAgICAocHJldiwgcGF0Y2gpID0+IGFwcGx5Tm9kZVBhdGNoKHBhdGNoLCBwcmV2KSxcbiAgICBkb2N1bWVudFxuICApO1xufVxuZnVuY3Rpb24gYXBwbHlOb2RlUGF0Y2gocGF0Y2gsIGRvY3VtZW50KSB7XG4gIHJldHVybiBhcHBseUF0UGF0aChwYXRjaC5wYXRoLCBwYXRjaC5vcCwgZG9jdW1lbnQpO1xufVxuZnVuY3Rpb24gYXBwbHlBdFBhdGgocGF0aCwgb3AsIHZhbHVlKSB7XG4gIGlmICghaXNOb25FbXB0eUFycmF5KHBhdGgpKVxuICAgIHJldHVybiBhcHBseU9wKG9wLCB2YWx1ZSk7XG4gIGNvbnN0IFtoZWFkLCAuLi50YWlsXSA9IHBhdGg7XG4gIGlmIChpc0FycmF5RWxlbWVudChoZWFkKSAmJiBBcnJheS5pc0FycmF5KHZhbHVlKSlcbiAgICByZXR1cm4gYXBwbHlJbkFycmF5KGhlYWQsIHRhaWwsIG9wLCB2YWx1ZSk7XG4gIGlmIChpc1Byb3BlcnR5RWxlbWVudChoZWFkKSAmJiBpc09iamVjdCh2YWx1ZSkpXG4gICAgcmV0dXJuIGFwcGx5SW5PYmplY3QoaGVhZCwgdGFpbCwgb3AsIHZhbHVlKTtcbiAgdGhyb3cgbmV3IEVycm9yKFxuICAgIGBDYW5ub3QgYXBwbHkgb3BlcmF0aW9uIG9mIHR5cGUgXCIke29wLnR5cGV9XCIgdG8gcGF0aCAke3N0cmluZ2lmeShcbiAgICAgIHBhdGhcbiAgICApfSBvbiAke3R5cGVvZiB2YWx1ZX0gdmFsdWVgXG4gICk7XG59XG5mdW5jdGlvbiBhcHBseUluT2JqZWN0KGhlYWQsIHRhaWwsIG9wLCBvYmplY3QpIHtcbiAgY29uc3QgY3VycmVudCA9IG9iamVjdFtoZWFkXTtcbiAgaWYgKGN1cnJlbnQgPT09IHZvaWQgMCAmJiB0YWlsLmxlbmd0aCA+IDApXG4gICAgcmV0dXJuIG9iamVjdDtcbiAgY29uc3QgcGF0Y2hlZFZhbHVlID0gYXBwbHlBdFBhdGgodGFpbCwgb3AsIGN1cnJlbnQpO1xuICByZXR1cm4gcGF0Y2hlZFZhbHVlID09PSBjdXJyZW50ID8gb2JqZWN0IDogeyAuLi5vYmplY3QsIFtoZWFkXTogcGF0Y2hlZFZhbHVlIH07XG59XG5mdW5jdGlvbiBhcHBseUluQXJyYXkoaGVhZCwgdGFpbCwgb3AsIHZhbHVlKSB7XG4gIGNvbnN0IGluZGV4ID0gZmluZFRhcmdldEluZGV4KHZhbHVlLCBoZWFkKTtcbiAgaWYgKGluZGV4ID09PSBudWxsIHx8IGluZGV4ID09PSAtMSlcbiAgICByZXR1cm4gdmFsdWU7XG4gIGNvbnN0IGN1cnJlbnQgPSB2YWx1ZVtpbmRleF0sIHBhdGNoZWRJdGVtID0gYXBwbHlBdFBhdGgodGFpbCwgb3AsIGN1cnJlbnQpO1xuICByZXR1cm4gcGF0Y2hlZEl0ZW0gPT09IGN1cnJlbnQgPyB2YWx1ZSA6IHNwbGljZSh2YWx1ZSwgaW5kZXgsIDEsIFtwYXRjaGVkSXRlbV0pO1xufVxuZnVuY3Rpb24gaXNOb25FbXB0eUFycmF5KGEpIHtcbiAgcmV0dXJuIGEubGVuZ3RoID4gMDtcbn1cbmZ1bmN0aW9uIGFwcGx5UGF0Y2hNdXRhdGlvbihtdXRhdGlvbiwgZG9jdW1lbnQpIHtcbiAgaWYgKG11dGF0aW9uLm9wdGlvbnM/LmlmUmV2aXNpb24gJiYgZG9jdW1lbnQuX3JldiAhPT0gbXV0YXRpb24ub3B0aW9ucy5pZlJldmlzaW9uKVxuICAgIHRocm93IG5ldyBFcnJvcihcIlJldmlzaW9uIG1pc21hdGNoXCIpO1xuICBpZiAobXV0YXRpb24uaWQgIT09IGRvY3VtZW50Ll9pZClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgRG9jdW1lbnQgaWQgbWlzbWF0Y2guIFJlZnVzaW5nIHRvIGFwcGx5IG11dGF0aW9uIGZvciBkb2N1bWVudCB3aXRoIGlkPVwiJHttdXRhdGlvbi5pZH1cIiBvbiB0aGUgZ2l2ZW4gZG9jdW1lbnQgd2l0aCBpZD1cIiR7ZG9jdW1lbnQuX2lkfVwiYFxuICAgICk7XG4gIHJldHVybiBhcHBseVBhdGNoZXMobXV0YXRpb24ucGF0Y2hlcywgZG9jdW1lbnQpO1xufVxuY29uc3QgdXJsQWxwaGFiZXQgPSBcInVzZWFuZG9tLTI2VDE5ODM0MFBYNzVweEpBQ0tWRVJZTUlOREJVU0hXT0xGX0dRWmJmZ2hqa2xxdnd5enJpY3RcIiwgUE9PTF9TSVpFX01VTFRJUExJRVIgPSAxMjg7XG5sZXQgcG9vbCwgcG9vbE9mZnNldDtcbmZ1bmN0aW9uIGZpbGxQb29sKGJ5dGVzKSB7XG4gICFwb29sIHx8IHBvb2wubGVuZ3RoIDwgYnl0ZXMgPyAocG9vbCA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShieXRlcyAqIFBPT0xfU0laRV9NVUxUSVBMSUVSKSwgd2ViY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhwb29sKSwgcG9vbE9mZnNldCA9IDApIDogcG9vbE9mZnNldCArIGJ5dGVzID4gcG9vbC5sZW5ndGggJiYgKHdlYmNyeXB0by5nZXRSYW5kb21WYWx1ZXMocG9vbCksIHBvb2xPZmZzZXQgPSAwKSwgcG9vbE9mZnNldCArPSBieXRlcztcbn1cbmZ1bmN0aW9uIG5hbm9pZChzaXplID0gMjEpIHtcbiAgZmlsbFBvb2woc2l6ZSAtPSAwKTtcbiAgbGV0IGlkID0gXCJcIjtcbiAgZm9yIChsZXQgaSA9IHBvb2xPZmZzZXQgLSBzaXplOyBpIDwgcG9vbE9mZnNldDsgaSsrKVxuICAgIGlkICs9IHVybEFscGhhYmV0W3Bvb2xbaV0gJiA2M107XG4gIHJldHVybiBpZDtcbn1cbmZ1bmN0aW9uIGhhc0lkKGRvYykge1xuICByZXR1cm4gXCJfaWRcIiBpbiBkb2M7XG59XG5mdW5jdGlvbiBhc3NpZ25JZChkb2MsIGdlbmVyYXRlSWQpIHtcbiAgcmV0dXJuIGhhc0lkKGRvYykgPyBkb2MgOiB7IC4uLmRvYywgX2lkOiBnZW5lcmF0ZUlkKCkgfTtcbn1cbmV4cG9ydCB7XG4gIGFwcGx5Tm9kZVBhdGNoLFxuICBhcHBseU9wLFxuICBhcHBseVBhdGNoTXV0YXRpb24sXG4gIGFwcGx5UGF0Y2hlcyxcbiAgYXNzaWduSWQsXG4gIGhhc0lkLFxuICBuYW5vaWQsXG4gIHNwbGljZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyMutations: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.applyMutations),\n/* harmony export */   commit: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.commit),\n/* harmony export */   createSharedListener: () => (/* binding */ createSharedListener),\n/* harmony export */   documentMutatorMachine: () => (/* binding */ documentMutatorMachine),\n/* harmony export */   rebase: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.rebase),\n/* harmony export */   squashDMPStrings: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.squashDMPStrings),\n/* harmony export */   squashMutationGroups: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.squashMutationGroups),\n/* harmony export */   toTransactions: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.toTransactions)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./_chunks-es/toTransactions.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js\");\n/* harmony import */ var mendoza__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! mendoza */ \"(ssr)/./node_modules/mendoza/dist/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/share.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/filter.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/observable/merge.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/observable/defer.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/observeOn.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/scheduler/asap.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/xstate.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/assign-541a432d.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/raise-13a60c49.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/log-b8ca474e.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n/* harmony import */ var _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./_chunks-es/encode.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js\");\n\n\n\n\n\nfunction createSharedListener(client) {\n  const allEvents$ = client.listen(\n    '*[!(_id in path(\"_.**\"))]',\n    {},\n    {\n      events: [\"welcome\", \"mutation\", \"reconnect\"],\n      includeResult: !1,\n      includePreviousRevision: !1,\n      visibility: \"transaction\",\n      effectFormat: \"mendoza\",\n      includeMutations: !1\n    }\n  ).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_0__.share)({ resetOnRefCountZero: !0 })), reconnect = allEvents$.pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((event) => event.type === \"reconnect\")\n  ), welcome = allEvents$.pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((event) => event.type === \"welcome\")\n  ), mutations = allEvents$.pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((event) => event.type === \"mutation\")\n  ), replayWelcome = (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.merge)(welcome, reconnect).pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.shareReplay)({ bufferSize: 1, refCount: !0 })\n  ).pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((latestConnectionEvent) => latestConnectionEvent.type === \"welcome\")\n  );\n  return (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.merge)(replayWelcome, mutations, reconnect);\n}\nconst documentMutatorMachine = (0,xstate__WEBPACK_IMPORTED_MODULE_4__.setup)({\n  types: {},\n  actions: {\n    \"assign error to context\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({ error: ({ event }) => event }),\n    \"clear error from context\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({ error: void 0 }),\n    \"connect to server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.r)({ type: \"connect\" }),\n    \"listen to server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.b)(\"server-sent events\", {\n      id: \"listener\",\n      input: ({ context }) => ({\n        listener: context.sharedListener || createSharedListener(context.client),\n        id: context.id\n      })\n    }),\n    \"stop listening to server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.s)(\"listener\"),\n    \"buffer remote mutation events\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      mutationEvents: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), [...context.mutationEvents, event])\n    }),\n    \"restore stashed changes\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      stagedChanges: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"xstate.done.actor.submitTransactions\"), context.stashedChanges),\n      stashedChanges: []\n    }),\n    \"rebase fetched remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_7__.e)(({ enqueue }) => {\n      enqueue.assign(({ event, context }) => {\n        (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"xstate.done.actor.getDocument\");\n        const previousRemote = context.remote;\n        let nextRemote = event.output, seenCurrentRev = !1;\n        for (const patch of context.mutationEvents)\n          !patch.effects?.apply || !patch.previousRev && patch.transition !== \"appear\" || (!seenCurrentRev && patch.previousRev === nextRemote?._rev && (seenCurrentRev = !0), seenCurrentRev && (nextRemote = applyMendozaPatch(\n            nextRemote,\n            patch.effects.apply,\n            patch.resultRev\n          )));\n        context.cache && // If the shared cache don't have the document already we can just set it\n        (!context.cache.has(context.id) || // But when it's in the cache, make sure it's necessary to update it\n        context.cache.get(context.id)._rev !== nextRemote?._rev) && context.cache.set(context.id, nextRemote);\n        const [stagedChanges, local] = (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.rebase)(\n          context.id,\n          // It's annoying to convert between null and undefined, reach consensus\n          previousRemote === null ? void 0 : previousRemote,\n          nextRemote === null ? void 0 : nextRemote,\n          context.stagedChanges\n        );\n        return {\n          remote: nextRemote,\n          local,\n          stagedChanges,\n          // Since the snapshot handler applies all the patches they are no longer needed, allow GC\n          mutationEvents: []\n        };\n      }), enqueue.sendParent(\n        ({ context }) => ({\n          type: \"rebased.remote\",\n          id: context.id,\n          document: context.remote\n        })\n      );\n    }),\n    \"apply mendoza patch\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)(({ event, context }) => {\n      (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\");\n      const previousRemote = context.remote;\n      if (event.transactionId === previousRemote?._rev)\n        return {};\n      const nextRemote = applyMendozaPatch(\n        previousRemote,\n        event.effects.apply,\n        event.resultRev\n      );\n      context.cache && // If the shared cache don't have the document already we can just set it\n      (!context.cache.has(context.id) || // But when it's in the cache, make sure it's necessary to update it\n      context.cache.get(context.id)._rev !== nextRemote?._rev) && context.cache.set(context.id, nextRemote);\n      const [stagedChanges, local] = (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.rebase)(\n        context.id,\n        // It's annoying to convert between null and undefined, reach consensus\n        previousRemote === null ? void 0 : previousRemote,\n        nextRemote === null ? void 0 : nextRemote,\n        context.stagedChanges\n      );\n      return {\n        remote: nextRemote,\n        local,\n        stagedChanges\n      };\n    }),\n    \"increment fetch attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      fetchRemoteSnapshotAttempts: ({ context }) => context.fetchRemoteSnapshotAttempts + 1\n    }),\n    \"reset fetch attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      fetchRemoteSnapshotAttempts: 0\n    }),\n    \"increment submit attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      submitTransactionsAttempts: ({ context }) => context.submitTransactionsAttempts + 1\n    }),\n    \"reset submit attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      submitTransactionsAttempts: 0\n    }),\n    \"stage mutation\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      stagedChanges: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutate\"), [\n        ...context.stagedChanges,\n        { transaction: !1, mutations: event.mutations }\n      ])\n    }),\n    \"stash mutation\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      stashedChanges: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutate\"), [\n        ...context.stashedChanges,\n        { transaction: !1, mutations: event.mutations }\n      ])\n    }),\n    \"rebase local snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_7__.e)(({ enqueue }) => {\n      enqueue.assign({\n        local: ({ event, context }) => {\n          (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutate\");\n          const localDataset = /* @__PURE__ */ new Map();\n          context.local && localDataset.set(context.id, context.local);\n          const results = (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.applyMutations)(event.mutations, localDataset);\n          return (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.commit)(results, localDataset), localDataset.get(context.id);\n        }\n      }), enqueue.sendParent(\n        ({ context }) => ({\n          type: \"rebased.local\",\n          id: context.id,\n          document: context.local\n        })\n      );\n    }),\n    \"send pristine event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_7__.b)(\n      ({ context }) => ({\n        type: \"pristine\",\n        id: context.id\n      })\n    ),\n    \"send sync event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_7__.b)(\n      ({ context }) => ({\n        type: \"sync\",\n        id: context.id,\n        document: context.remote\n      })\n    ),\n    \"send mutation event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_7__.b)(({ context, event }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), {\n      type: \"mutation\",\n      id: context.id,\n      previousRev: event.previousRev,\n      resultRev: event.resultRev,\n      effects: event.effects\n    }))\n  },\n  actors: {\n    \"server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_9__.fromEventObservable)(\n      ({\n        input\n      }) => {\n        const { listener, id } = input;\n        return (0,rxjs__WEBPACK_IMPORTED_MODULE_10__.defer)(() => listener).pipe(\n          (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)(\n            (event) => event.type === \"welcome\" || event.type === \"reconnect\" || event.type === \"mutation\" && event.documentId === id\n          ),\n          // This is necessary to avoid sync emitted events from `shareReplay` from happening before the actor is ready to receive them\n          (0,rxjs__WEBPACK_IMPORTED_MODULE_11__.observeOn)(rxjs__WEBPACK_IMPORTED_MODULE_12__.asapScheduler)\n        );\n      }\n    ),\n    \"fetch remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_9__.fromPromise)(\n      async ({\n        input,\n        signal\n      }) => {\n        const { client, id } = input;\n        return await client.getDocument(id, {\n          signal\n        }).catch((e) => {\n          if (!(e instanceof Error && e.name === \"AbortError\"))\n            throw e;\n        });\n      }\n    ),\n    \"submit mutations as transactions\": (0,xstate__WEBPACK_IMPORTED_MODULE_9__.fromPromise)(\n      async ({\n        input,\n        signal\n      }) => {\n        const { client, transactions } = input;\n        for (const transaction of transactions) {\n          if (signal.aborted) return;\n          await client.dataRequest(\"mutate\", (0,_chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_13__.encodeTransaction)(transaction), {\n            visibility: \"async\",\n            returnDocuments: !1,\n            signal\n          }).catch((e) => {\n            if (!(e instanceof Error && e.name === \"AbortError\"))\n              throw e;\n          });\n        }\n      }\n    )\n  },\n  delays: {\n    // Exponential backoff delay function\n    fetchRemoteSnapshotTimeout: ({ context }) => Math.pow(2, context.fetchRemoteSnapshotAttempts) * 1e3,\n    submitTransactionsTimeout: ({ context }) => Math.pow(2, context.submitTransactionsAttempts) * 1e3\n  }\n}).createMachine({\n  /** @xstate-layout N4IgpgJg5mDOIC5QQPYGMCuBbMA7ALgLRYb4CG+KATgMQnn5gDaADALqKgAOKsAlvj4pcnEAA9EADhYAWAHQA2GSwUBmAKwBOaQEZJkhQBoQAT0Q6ATAF8rx1JhwFipCtTkQ+sNMNxg0jCBpvXF9-Vg4kEB5+QWFRCQQLFhY5PQB2dRU1SQsdGSVjMwRlHTkWNM00nR1VKryKmzt0bDwielcqOWDQwVwoGgB3MAAbbxxw0WiBIRFIhPUKuQ1NVU0tTU0WFdVCxAt1dTlNhX2WdRltGUk061sQexandspO7r9e-qo-H3eJyKnYrNQPNJJollpVutNttdghVCo5MoTgoMpo8jIkqpGvdmo42i4Xl0fv4+H0aGAqFRqH9uLxpnE5ogFrCLFd5CtNBYFJkdOpuaosXcHnjnAw3G9-AAxMh8YYYL5BYn4GlROmA+KIFEs1R6ORpZYWHIXGR6bHC1qijpyL4Sj6DEZjZjsSZqmYaxK1ORcvlc-ZqSoyNKwnRpGTyK4WDK5BQ6BQ5BRm3EW55uG1K0n9ClUqgqgFuxketJe7nIv2rUNB0x7LmSL2qGMsSySevcmSJhzJgnipWQOgEma510M4HmcqHZYyWqaOMqTQyWGh0osVSGiwC5uGyftx74sWvHuBNMhX7O-5DoHiPae72lvnlwPBydFlRVS7qPIl7cilP74-+SByMMKBkB4ZKoL4cikgAbigADWYByDA+AACJJgQg4xPmI7FHkZQrKGsjqKcCiaMG9YpJOxySBiCiyPoX6dnuRJ-gEgHAaBmaUm4XDDBQABm1BYIhYAoWhyqnrSmHDpeCAKCicjUbU6g6nkFichYsJrLWVxaPsk7KdICZCmJlqEraAFASBvbPAOEmqlJF4JJURbVDcy4Yvk1GVkUsabApMjKZGqjNg2kgMU8Xa-j0FnsQBXBUJ4vRgH2DBOhEkn0o5TLKV6y6WDG6lhkYVYIDoKzyBkeR8pUDZqOFu5WuZEBsVZzUeFQ+AmDQsAYAARlgAgYZl7o6I2tYLJINSSO+3JaMGlQpGkhFhryo2jW2xkdhFTFNS1EAAT1-UCHa4EIdBcEIYdA34AAKlQZC4LAZAksIsBDeqBbrdpym8iuByxlcLK5BYqQLBUZyTcFvL1aZ3YsTFrVyFdx0ZuSXGdDx-GCUjfXXXdD1PS9j3vVhMnrWCFRxtNaRLdcfIsiwuS5fkgZaOUlhpDDP7MdFzWWftzXI-gdrPGlLoOSNyiHFstRySisjcgzahyFoUYBbRsac5tO6w1F7wIwLONHfg0qyvKyVfPgVAmCT0kJGt41pJD02xgcpElUkcZ6rI+q5JcckbU0W0NWZB57QduMCKbcoKmIsCpXIZB8YwVAABRC-jj3PYCsA3XwOAoKQACUNDmttjVh-zEfG9H5u21lpVjSrTtTTNbsstUYJJAFWgA37XORTz+t8+xtcKpb1v1+6KJFopGQqRi6nBlstYcqNK5riusYDztlejzKMfJXHCdJynqd8SJaAABYAEpgFgKCMAAyrgZBcLAV+P3nBfF6XJnc7tfmY8xZnglgWGe-klILzUhYDSJVRpnCONNOcWxWRKBRDYO4uAUD7XgJEMuIdqDi2GgWQgOhgxMyRKyFc8IuQkXUDvK0HgvAHmIR9bCD4SoeSWCoLkoZpxrmXIw0OLEMxsNJgkSc418KhnrHyG4oZYTcPhMifhJx4SCiDjrABSpgHiLtogAUhwW77DRIGXkk55wexKCrJQsg1jBTnPsYRqZviiL6PohuORgyhhBhGKMsZYzxhcXrf8EBPHulUJOPCtRlABWIu7IoORVBIIhMpNYGJyghKHmEvaYjQEkOwhkxQrJtBES0JDOBPlkgKD1JYZSjZORyTXNkwBsVwkFPYTJVYS58JxPKbOYM0gUj7FjGcEMOpciaJxMHXWOTWJV2avFRKpIwARILJRGJBF4mZBIkDE0KtIxLSSDkDYGhWl70Ru1Tq6zsLURBkoLyWRmz8PmlUZmcY1zXDKdMghcy2mIyFh8W5ZN4RFmOFyKaZwiLeT2GVJcy5pBrguCiMK2tvyDwBYbIWejOkSMQBkeQORJq0RNCUDIDNondxuGpPQmRqIXPhiPECuKMpdMkbILZ-SEnLxyjqOJMZsj1jRTYIAA */\n  id: \"document-mutator\",\n  context: ({ input }) => ({\n    client: input.client.withConfig({ allowReconfigure: !1 }),\n    sharedListener: input.sharedListener,\n    id: input.id,\n    remote: void 0,\n    local: void 0,\n    mutationEvents: [],\n    stagedChanges: [],\n    stashedChanges: [],\n    error: void 0,\n    fetchRemoteSnapshotAttempts: 0,\n    submitTransactionsAttempts: 0,\n    cache: input.cache\n  }),\n  // Auto start the connection by default\n  entry: [\"connect to server-sent events\"],\n  on: {\n    mutate: {\n      actions: [\"rebase local snapshot\", \"stage mutation\"]\n    }\n  },\n  initial: \"disconnected\",\n  states: {\n    disconnected: {\n      on: {\n        connect: {\n          target: \"connecting\",\n          actions: [\"listen to server-sent events\"]\n        }\n      }\n    },\n    connecting: {\n      on: {\n        welcome: \"connected\",\n        reconnect: \"reconnecting\",\n        error: \"connectFailure\"\n      },\n      tags: [\"busy\"]\n    },\n    connectFailure: {\n      on: {\n        connect: {\n          target: \"connecting\",\n          actions: [\"listen to server-sent events\"]\n        }\n      },\n      entry: [\n        \"stop listening to server-sent events\",\n        \"assign error to context\"\n      ],\n      exit: [\"clear error from context\"],\n      tags: [\"error\"]\n    },\n    reconnecting: {\n      on: {\n        welcome: {\n          target: \"connected\"\n        },\n        error: {\n          target: \"connectFailure\"\n        }\n      },\n      tags: [\"busy\", \"error\"]\n    },\n    connected: {\n      on: {\n        mutation: {\n          actions: [\"buffer remote mutation events\"]\n        },\n        reconnect: \"reconnecting\"\n      },\n      entry: [\"clear error from context\"],\n      initial: \"loading\",\n      states: {\n        loading: {\n          invoke: {\n            src: \"fetch remote snapshot\",\n            id: \"getDocument\",\n            input: ({ context }) => ({\n              client: context.client,\n              id: context.id\n            }),\n            onError: {\n              target: \"loadFailure\"\n            },\n            onDone: {\n              target: \"loaded\",\n              actions: [\n                \"rebase fetched remote snapshot\",\n                \"reset fetch attempts\"\n              ]\n            }\n          },\n          tags: [\"busy\"]\n        },\n        loaded: {\n          entry: [\"send sync event to parent\"],\n          on: {\n            mutation: {\n              actions: [\"apply mendoza patch\", \"send mutation event to parent\"]\n            }\n          },\n          initial: \"pristine\",\n          states: {\n            pristine: {\n              on: {\n                mutate: {\n                  actions: [\"rebase local snapshot\", \"stage mutation\"],\n                  target: \"dirty\"\n                }\n              },\n              tags: [\"ready\"]\n            },\n            dirty: {\n              on: {\n                submit: \"submitting\"\n              },\n              tags: [\"ready\"]\n            },\n            submitting: {\n              on: {\n                mutate: {\n                  actions: [\"rebase local snapshot\", \"stash mutation\"]\n                }\n              },\n              invoke: {\n                src: \"submit mutations as transactions\",\n                id: \"submitTransactions\",\n                input: ({ context }) => {\n                  const remoteDataset = /* @__PURE__ */ new Map();\n                  return remoteDataset.set(context.id, context.remote), {\n                    client: context.client,\n                    transactions: (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.toTransactions)(\n                      // Squashing DMP strings is the last thing we do before submitting\n                      (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.squashDMPStrings)(\n                        remoteDataset,\n                        (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_8__.squashMutationGroups)(context.stagedChanges)\n                      )\n                    )\n                  };\n                },\n                onError: {\n                  target: \"submitFailure\"\n                },\n                onDone: {\n                  target: \"pristine\",\n                  actions: [\n                    \"restore stashed changes\",\n                    \"reset submit attempts\",\n                    \"send pristine event to parent\"\n                  ]\n                }\n              },\n              /**\n               * 'busy' means we should show a spinner, 'ready' means we can still accept mutations, they'll be applied optimistically right away, and queued for submissions after the current submission settles\n               */\n              tags: [\"busy\", \"ready\"]\n            },\n            submitFailure: {\n              exit: [\"clear error from context\"],\n              after: {\n                submitTransactionsTimeout: {\n                  actions: [\"increment submit attempts\"],\n                  target: \"submitting\"\n                }\n              },\n              on: {\n                retry: \"submitting\"\n              },\n              /**\n               * How can it be both `ready` and `error`? `ready` means it can receive mutations, optimistically apply them, and queue them for submission. `error` means it failed to submit previously applied mutations.\n               * It's completely fine to keep queueing up more mutations and applying them optimistically, while showing UI that notifies that mutations didn't submit, and show a count down until the next automatic retry.\n               */\n              tags: [\"error\", \"ready\"]\n            }\n          }\n        },\n        loadFailure: {\n          exit: [\"clear error from context\"],\n          after: {\n            fetchRemoteSnapshotTimeout: {\n              actions: [\"increment fetch attempts\"],\n              target: \"loading\"\n            }\n          },\n          on: {\n            retry: \"loading\"\n          },\n          tags: [\"error\"]\n        }\n      }\n    }\n  }\n});\nfunction applyMendozaPatch(document, patch, nextRevision) {\n  const next = (0,mendoza__WEBPACK_IMPORTED_MODULE_14__.applyPatch)(omitRev(document), patch);\n  return next ? Object.assign(next, { _rev: nextRevision }) : null;\n}\nfunction omitRev(document) {\n  if (!document)\n    return null;\n  const { _rev, ...doc } = document;\n  return doc;\n}\n\n//# sourceMappingURL=_unstable_machine.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX3Vuc3RhYmxlX21hY2hpbmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0k7QUFDbkc7QUFDcUQ7QUFDc0Q7QUFDckY7QUFDM0Q7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJDQUFLLEdBQUcseUJBQXlCO0FBQzFDLElBQUksNENBQU07QUFDVjtBQUNBLElBQUksNENBQU07QUFDVjtBQUNBLElBQUksNENBQU07QUFDVixxQkFBcUIsMkNBQUs7QUFDMUIsSUFBSSxpREFBVyxHQUFHLDZCQUE2QjtBQUMvQztBQUNBLElBQUksNENBQU07QUFDVjtBQUNBLFNBQVMsMkNBQUs7QUFDZDtBQUNBLCtCQUErQiw2Q0FBSztBQUNwQyxXQUFXO0FBQ1g7QUFDQSwrQkFBK0IseUNBQU0sR0FBRyxVQUFVLE9BQU8sWUFBWTtBQUNyRSxnQ0FBZ0MseUNBQU0sR0FBRyxlQUFlO0FBQ3hELHFDQUFxQyx5Q0FBSyxHQUFHLGlCQUFpQjtBQUM5RCxvQ0FBb0MseUNBQVU7QUFDOUM7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCw0Q0FBNEMseUNBQVM7QUFDckQscUNBQXFDLHlDQUFNO0FBQzNDLHlCQUF5QixnQkFBZ0IsTUFBTSxtREFBVztBQUMxRCxLQUFLO0FBQ0wsK0JBQStCLHlDQUFNO0FBQ3JDLHdCQUF3QixnQkFBZ0IsTUFBTSxtREFBVztBQUN6RDtBQUNBLEtBQUs7QUFDTCxzQ0FBc0MseUNBQWMsSUFBSSxTQUFTO0FBQ2pFLHdCQUF3QixnQkFBZ0I7QUFDeEMsUUFBUSxtREFBVztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Es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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGVBQWUsb0RBQVU7QUFDekIsc0NBQXNDLG9CQUFvQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsZUFBZTtBQUN6QjtBQUNBO0FBVUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX3Vuc3RhYmxlX21hY2hpbmUuanM/M2ZhOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWJhc2UsIGFwcGx5TXV0YXRpb25zLCBjb21taXQsIHRvVHJhbnNhY3Rpb25zLCBzcXVhc2hETVBTdHJpbmdzLCBzcXVhc2hNdXRhdGlvbkdyb3VwcyB9IGZyb20gXCIuL19jaHVua3MtZXMvdG9UcmFuc2FjdGlvbnMuanNcIjtcbmltcG9ydCB7IGFwcGx5UGF0Y2ggfSBmcm9tIFwibWVuZG96YVwiO1xuaW1wb3J0IHsgc2hhcmUsIGZpbHRlciwgbWVyZ2UsIHNoYXJlUmVwbGF5LCBkZWZlciwgb2JzZXJ2ZU9uLCBhc2FwU2NoZWR1bGVyIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IHNldHVwLCBhc3NpZ24sIHJhaXNlLCBzcGF3bkNoaWxkLCBzdG9wQ2hpbGQsIGFzc2VydEV2ZW50LCBlbnF1ZXVlQWN0aW9ucywgc2VuZFBhcmVudCwgZnJvbUV2ZW50T2JzZXJ2YWJsZSwgZnJvbVByb21pc2UgfSBmcm9tIFwieHN0YXRlXCI7XG5pbXBvcnQgeyBlbmNvZGVUcmFuc2FjdGlvbiB9IGZyb20gXCIuL19jaHVua3MtZXMvZW5jb2RlLmpzXCI7XG5mdW5jdGlvbiBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjbGllbnQpIHtcbiAgY29uc3QgYWxsRXZlbnRzJCA9IGNsaWVudC5saXN0ZW4oXG4gICAgJypbIShfaWQgaW4gcGF0aChcIl8uKipcIikpXScsXG4gICAge30sXG4gICAge1xuICAgICAgZXZlbnRzOiBbXCJ3ZWxjb21lXCIsIFwibXV0YXRpb25cIiwgXCJyZWNvbm5lY3RcIl0sXG4gICAgICBpbmNsdWRlUmVzdWx0OiAhMSxcbiAgICAgIGluY2x1ZGVQcmV2aW91c1JldmlzaW9uOiAhMSxcbiAgICAgIHZpc2liaWxpdHk6IFwidHJhbnNhY3Rpb25cIixcbiAgICAgIGVmZmVjdEZvcm1hdDogXCJtZW5kb3phXCIsXG4gICAgICBpbmNsdWRlTXV0YXRpb25zOiAhMVxuICAgIH1cbiAgKS5waXBlKHNoYXJlKHsgcmVzZXRPblJlZkNvdW50WmVybzogITAgfSkpLCByZWNvbm5lY3QgPSBhbGxFdmVudHMkLnBpcGUoXG4gICAgZmlsdGVyKChldmVudCkgPT4gZXZlbnQudHlwZSA9PT0gXCJyZWNvbm5lY3RcIilcbiAgKSwgd2VsY29tZSA9IGFsbEV2ZW50cyQucGlwZShcbiAgICBmaWx0ZXIoKGV2ZW50KSA9PiBldmVudC50eXBlID09PSBcIndlbGNvbWVcIilcbiAgKSwgbXV0YXRpb25zID0gYWxsRXZlbnRzJC5waXBlKFxuICAgIGZpbHRlcigoZXZlbnQpID0+IGV2ZW50LnR5cGUgPT09IFwibXV0YXRpb25cIilcbiAgKSwgcmVwbGF5V2VsY29tZSA9IG1lcmdlKHdlbGNvbWUsIHJlY29ubmVjdCkucGlwZShcbiAgICBzaGFyZVJlcGxheSh7IGJ1ZmZlclNpemU6IDEsIHJlZkNvdW50OiAhMCB9KVxuICApLnBpcGUoXG4gICAgZmlsdGVyKChsYXRlc3RDb25uZWN0aW9uRXZlbnQpID0+IGxhdGVzdENvbm5lY3Rpb25FdmVudC50eXBlID09PSBcIndlbGNvbWVcIilcbiAgKTtcbiAgcmV0dXJuIG1lcmdlKHJlcGxheVdlbGNvbWUsIG11dGF0aW9ucywgcmVjb25uZWN0KTtcbn1cbmNvbnN0IGRvY3VtZW50TXV0YXRvck1hY2hpbmUgPSBzZXR1cCh7XG4gIHR5cGVzOiB7fSxcbiAgYWN0aW9uczoge1xuICAgIFwiYXNzaWduIGVycm9yIHRvIGNvbnRleHRcIjogYXNzaWduKHsgZXJyb3I6ICh7IGV2ZW50IH0pID0+IGV2ZW50IH0pLFxuICAgIFwiY2xlYXIgZXJyb3IgZnJvbSBjb250ZXh0XCI6IGFzc2lnbih7IGVycm9yOiB2b2lkIDAgfSksXG4gICAgXCJjb25uZWN0IHRvIHNlcnZlci1zZW50IGV2ZW50c1wiOiByYWlzZSh7IHR5cGU6IFwiY29ubmVjdFwiIH0pLFxuICAgIFwibGlzdGVuIHRvIHNlcnZlci1zZW50IGV2ZW50c1wiOiBzcGF3bkNoaWxkKFwic2VydmVyLXNlbnQgZXZlbnRzXCIsIHtcbiAgICAgIGlkOiBcImxpc3RlbmVyXCIsXG4gICAgICBpbnB1dDogKHsgY29udGV4dCB9KSA9PiAoe1xuICAgICAgICBsaXN0ZW5lcjogY29udGV4dC5zaGFyZWRMaXN0ZW5lciB8fCBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjb250ZXh0LmNsaWVudCksXG4gICAgICAgIGlkOiBjb250ZXh0LmlkXG4gICAgICB9KVxuICAgIH0pLFxuICAgIFwic3RvcCBsaXN0ZW5pbmcgdG8gc2VydmVyLXNlbnQgZXZlbnRzXCI6IHN0b3BDaGlsZChcImxpc3RlbmVyXCIpLFxuICAgIFwiYnVmZmVyIHJlbW90ZSBtdXRhdGlvbiBldmVudHNcIjogYXNzaWduKHtcbiAgICAgIG11dGF0aW9uRXZlbnRzOiAoeyBldmVudCwgY29udGV4dCB9KSA9PiAoYXNzZXJ0RXZlbnQoZXZlbnQsIFwibXV0YXRpb25cIiksIFsuLi5jb250ZXh0Lm11dGF0aW9uRXZlbnRzLCBldmVudF0pXG4gICAgfSksXG4gICAgXCJyZXN0b3JlIHN0YXNoZWQgY2hhbmdlc1wiOiBhc3NpZ24oe1xuICAgICAgc3RhZ2VkQ2hhbmdlczogKHsgZXZlbnQsIGNvbnRleHQgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcInhzdGF0ZS5kb25lLmFjdG9yLnN1Ym1pdFRyYW5zYWN0aW9uc1wiKSwgY29udGV4dC5zdGFzaGVkQ2hhbmdlcyksXG4gICAgICBzdGFzaGVkQ2hhbmdlczogW11cbiAgICB9KSxcbiAgICBcInJlYmFzZSBmZXRjaGVkIHJlbW90ZSBzbmFwc2hvdFwiOiBlbnF1ZXVlQWN0aW9ucygoeyBlbnF1ZXVlIH0pID0+IHtcbiAgICAgIGVucXVldWUuYXNzaWduKCh7IGV2ZW50LCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgYXNzZXJ0RXZlbnQoZXZlbnQsIFwieHN0YXRlLmRvbmUuYWN0b3IuZ2V0RG9jdW1lbnRcIik7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzUmVtb3RlID0gY29udGV4dC5yZW1vdGU7XG4gICAgICAgIGxldCBuZXh0UmVtb3RlID0gZXZlbnQub3V0cHV0LCBzZWVuQ3VycmVudFJldiA9ICExO1xuICAgICAgICBmb3IgKGNvbnN0IHBhdGNoIG9mIGNvbnRleHQubXV0YXRpb25FdmVudHMpXG4gICAgICAgICAgIXBhdGNoLmVmZmVjdHM/LmFwcGx5IHx8ICFwYXRjaC5wcmV2aW91c1JldiAmJiBwYXRjaC50cmFuc2l0aW9uICE9PSBcImFwcGVhclwiIHx8ICghc2VlbkN1cnJlbnRSZXYgJiYgcGF0Y2gucHJldmlvdXNSZXYgPT09IG5leHRSZW1vdGU/Ll9yZXYgJiYgKHNlZW5DdXJyZW50UmV2ID0gITApLCBzZWVuQ3VycmVudFJldiAmJiAobmV4dFJlbW90ZSA9IGFwcGx5TWVuZG96YVBhdGNoKFxuICAgICAgICAgICAgbmV4dFJlbW90ZSxcbiAgICAgICAgICAgIHBhdGNoLmVmZmVjdHMuYXBwbHksXG4gICAgICAgICAgICBwYXRjaC5yZXN1bHRSZXZcbiAgICAgICAgICApKSk7XG4gICAgICAgIGNvbnRleHQuY2FjaGUgJiYgLy8gSWYgdGhlIHNoYXJlZCBjYWNoZSBkb24ndCBoYXZlIHRoZSBkb2N1bWVudCBhbHJlYWR5IHdlIGNhbiBqdXN0IHNldCBpdFxuICAgICAgICAoIWNvbnRleHQuY2FjaGUuaGFzKGNvbnRleHQuaWQpIHx8IC8vIEJ1dCB3aGVuIGl0J3MgaW4gdGhlIGNhY2hlLCBtYWtlIHN1cmUgaXQncyBuZWNlc3NhcnkgdG8gdXBkYXRlIGl0XG4gICAgICAgIGNvbnRleHQuY2FjaGUuZ2V0KGNvbnRleHQuaWQpLl9yZXYgIT09IG5leHRSZW1vdGU/Ll9yZXYpICYmIGNvbnRleHQuY2FjaGUuc2V0KGNvbnRleHQuaWQsIG5leHRSZW1vdGUpO1xuICAgICAgICBjb25zdCBbc3RhZ2VkQ2hhbmdlcywgbG9jYWxdID0gcmViYXNlKFxuICAgICAgICAgIGNvbnRleHQuaWQsXG4gICAgICAgICAgLy8gSXQncyBhbm5veWluZyB0byBjb252ZXJ0IGJldHdlZW4gbnVsbCBhbmQgdW5kZWZpbmVkLCByZWFjaCBjb25zZW5zdXNcbiAgICAgICAgICBwcmV2aW91c1JlbW90ZSA9PT0gbnVsbCA/IHZvaWQgMCA6IHByZXZpb3VzUmVtb3RlLFxuICAgICAgICAgIG5leHRSZW1vdGUgPT09IG51bGwgPyB2b2lkIDAgOiBuZXh0UmVtb3RlLFxuICAgICAgICAgIGNvbnRleHQuc3RhZ2VkQ2hhbmdlc1xuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlbW90ZTogbmV4dFJlbW90ZSxcbiAgICAgICAgICBsb2NhbCxcbiAgICAgICAgICBzdGFnZWRDaGFuZ2VzLFxuICAgICAgICAgIC8vIFNpbmNlIHRoZSBzbmFwc2hvdCBoYW5kbGVyIGFwcGxpZXMgYWxsIHRoZSBwYXRjaGVzIHRoZXkgYXJlIG5vIGxvbmdlciBuZWVkZWQsIGFsbG93IEdDXG4gICAgICAgICAgbXV0YXRpb25FdmVudHM6IFtdXG4gICAgICAgIH07XG4gICAgICB9KSwgZW5xdWV1ZS5zZW5kUGFyZW50KFxuICAgICAgICAoeyBjb250ZXh0IH0pID0+ICh7XG4gICAgICAgICAgdHlwZTogXCJyZWJhc2VkLnJlbW90ZVwiLFxuICAgICAgICAgIGlkOiBjb250ZXh0LmlkLFxuICAgICAgICAgIGRvY3VtZW50OiBjb250ZXh0LnJlbW90ZVxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KSxcbiAgICBcImFwcGx5IG1lbmRvemEgcGF0Y2hcIjogYXNzaWduKCh7IGV2ZW50LCBjb250ZXh0IH0pID0+IHtcbiAgICAgIGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0aW9uXCIpO1xuICAgICAgY29uc3QgcHJldmlvdXNSZW1vdGUgPSBjb250ZXh0LnJlbW90ZTtcbiAgICAgIGlmIChldmVudC50cmFuc2FjdGlvbklkID09PSBwcmV2aW91c1JlbW90ZT8uX3JldilcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgY29uc3QgbmV4dFJlbW90ZSA9IGFwcGx5TWVuZG96YVBhdGNoKFxuICAgICAgICBwcmV2aW91c1JlbW90ZSxcbiAgICAgICAgZXZlbnQuZWZmZWN0cy5hcHBseSxcbiAgICAgICAgZXZlbnQucmVzdWx0UmV2XG4gICAgICApO1xuICAgICAgY29udGV4dC5jYWNoZSAmJiAvLyBJZiB0aGUgc2hhcmVkIGNhY2hlIGRvbid0IGhhdmUgdGhlIGRvY3VtZW50IGFscmVhZHkgd2UgY2FuIGp1c3Qgc2V0IGl0XG4gICAgICAoIWNvbnRleHQuY2FjaGUuaGFzKGNvbnRleHQuaWQpIHx8IC8vIEJ1dCB3aGVuIGl0J3MgaW4gdGhlIGNhY2hlLCBtYWtlIHN1cmUgaXQncyBuZWNlc3NhcnkgdG8gdXBkYXRlIGl0XG4gICAgICBjb250ZXh0LmNhY2hlLmdldChjb250ZXh0LmlkKS5fcmV2ICE9PSBuZXh0UmVtb3RlPy5fcmV2KSAmJiBjb250ZXh0LmNhY2hlLnNldChjb250ZXh0LmlkLCBuZXh0UmVtb3RlKTtcbiAgICAgIGNvbnN0IFtzdGFnZWRDaGFuZ2VzLCBsb2NhbF0gPSByZWJhc2UoXG4gICAgICAgIGNvbnRleHQuaWQsXG4gICAgICAgIC8vIEl0J3MgYW5ub3lpbmcgdG8gY29udmVydCBiZXR3ZWVuIG51bGwgYW5kIHVuZGVmaW5lZCwgcmVhY2ggY29uc2Vuc3VzXG4gICAgICAgIHByZXZpb3VzUmVtb3RlID09PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNSZW1vdGUsXG4gICAgICAgIG5leHRSZW1vdGUgPT09IG51bGwgPyB2b2lkIDAgOiBuZXh0UmVtb3RlLFxuICAgICAgICBjb250ZXh0LnN0YWdlZENoYW5nZXNcbiAgICAgICk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZW1vdGU6IG5leHRSZW1vdGUsXG4gICAgICAgIGxvY2FsLFxuICAgICAgICBzdGFnZWRDaGFuZ2VzXG4gICAgICB9O1xuICAgIH0pLFxuICAgIFwiaW5jcmVtZW50IGZldGNoIGF0dGVtcHRzXCI6IGFzc2lnbih7XG4gICAgICBmZXRjaFJlbW90ZVNuYXBzaG90QXR0ZW1wdHM6ICh7IGNvbnRleHQgfSkgPT4gY29udGV4dC5mZXRjaFJlbW90ZVNuYXBzaG90QXR0ZW1wdHMgKyAxXG4gICAgfSksXG4gICAgXCJyZXNldCBmZXRjaCBhdHRlbXB0c1wiOiBhc3NpZ24oe1xuICAgICAgZmV0Y2hSZW1vdGVTbmFwc2hvdEF0dGVtcHRzOiAwXG4gICAgfSksXG4gICAgXCJpbmNyZW1lbnQgc3VibWl0IGF0dGVtcHRzXCI6IGFzc2lnbih7XG4gICAgICBzdWJtaXRUcmFuc2FjdGlvbnNBdHRlbXB0czogKHsgY29udGV4dCB9KSA9PiBjb250ZXh0LnN1Ym1pdFRyYW5zYWN0aW9uc0F0dGVtcHRzICsgMVxuICAgIH0pLFxuICAgIFwicmVzZXQgc3VibWl0IGF0dGVtcHRzXCI6IGFzc2lnbih7XG4gICAgICBzdWJtaXRUcmFuc2FjdGlvbnNBdHRlbXB0czogMFxuICAgIH0pLFxuICAgIFwic3RhZ2UgbXV0YXRpb25cIjogYXNzaWduKHtcbiAgICAgIHN0YWdlZENoYW5nZXM6ICh7IGV2ZW50LCBjb250ZXh0IH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJtdXRhdGVcIiksIFtcbiAgICAgICAgLi4uY29udGV4dC5zdGFnZWRDaGFuZ2VzLFxuICAgICAgICB7IHRyYW5zYWN0aW9uOiAhMSwgbXV0YXRpb25zOiBldmVudC5tdXRhdGlvbnMgfVxuICAgICAgXSlcbiAgICB9KSxcbiAgICBcInN0YXNoIG11dGF0aW9uXCI6IGFzc2lnbih7XG4gICAgICBzdGFzaGVkQ2hhbmdlczogKHsgZXZlbnQsIGNvbnRleHQgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0ZVwiKSwgW1xuICAgICAgICAuLi5jb250ZXh0LnN0YXNoZWRDaGFuZ2VzLFxuICAgICAgICB7IHRyYW5zYWN0aW9uOiAhMSwgbXV0YXRpb25zOiBldmVudC5tdXRhdGlvbnMgfVxuICAgICAgXSlcbiAgICB9KSxcbiAgICBcInJlYmFzZSBsb2NhbCBzbmFwc2hvdFwiOiBlbnF1ZXVlQWN0aW9ucygoeyBlbnF1ZXVlIH0pID0+IHtcbiAgICAgIGVucXVldWUuYXNzaWduKHtcbiAgICAgICAgbG9jYWw6ICh7IGV2ZW50LCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgICBhc3NlcnRFdmVudChldmVudCwgXCJtdXRhdGVcIik7XG4gICAgICAgICAgY29uc3QgbG9jYWxEYXRhc2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAgICAgICBjb250ZXh0LmxvY2FsICYmIGxvY2FsRGF0YXNldC5zZXQoY29udGV4dC5pZCwgY29udGV4dC5sb2NhbCk7XG4gICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGFwcGx5TXV0YXRpb25zKGV2ZW50Lm11dGF0aW9ucywgbG9jYWxEYXRhc2V0KTtcbiAgICAgICAgICByZXR1cm4gY29tbWl0KHJlc3VsdHMsIGxvY2FsRGF0YXNldCksIGxvY2FsRGF0YXNldC5nZXQoY29udGV4dC5pZCk7XG4gICAgICAgIH1cbiAgICAgIH0pLCBlbnF1ZXVlLnNlbmRQYXJlbnQoXG4gICAgICAgICh7IGNvbnRleHQgfSkgPT4gKHtcbiAgICAgICAgICB0eXBlOiBcInJlYmFzZWQubG9jYWxcIixcbiAgICAgICAgICBpZDogY29udGV4dC5pZCxcbiAgICAgICAgICBkb2N1bWVudDogY29udGV4dC5sb2NhbFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KSxcbiAgICBcInNlbmQgcHJpc3RpbmUgZXZlbnQgdG8gcGFyZW50XCI6IHNlbmRQYXJlbnQoXG4gICAgICAoeyBjb250ZXh0IH0pID0+ICh7XG4gICAgICAgIHR5cGU6IFwicHJpc3RpbmVcIixcbiAgICAgICAgaWQ6IGNvbnRleHQuaWRcbiAgICAgIH0pXG4gICAgKSxcbiAgICBcInNlbmQgc3luYyBldmVudCB0byBwYXJlbnRcIjogc2VuZFBhcmVudChcbiAgICAgICh7IGNvbnRleHQgfSkgPT4gKHtcbiAgICAgICAgdHlwZTogXCJzeW5jXCIsXG4gICAgICAgIGlkOiBjb250ZXh0LmlkLFxuICAgICAgICBkb2N1bWVudDogY29udGV4dC5yZW1vdGVcbiAgICAgIH0pXG4gICAgKSxcbiAgICBcInNlbmQgbXV0YXRpb24gZXZlbnQgdG8gcGFyZW50XCI6IHNlbmRQYXJlbnQoKHsgY29udGV4dCwgZXZlbnQgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0aW9uXCIpLCB7XG4gICAgICB0eXBlOiBcIm11dGF0aW9uXCIsXG4gICAgICBpZDogY29udGV4dC5pZCxcbiAgICAgIHByZXZpb3VzUmV2OiBldmVudC5wcmV2aW91c1JldixcbiAgICAgIHJlc3VsdFJldjogZXZlbnQucmVzdWx0UmV2LFxuICAgICAgZWZmZWN0czogZXZlbnQuZWZmZWN0c1xuICAgIH0pKVxuICB9LFxuICBhY3RvcnM6IHtcbiAgICBcInNlcnZlci1zZW50IGV2ZW50c1wiOiBmcm9tRXZlbnRPYnNlcnZhYmxlKFxuICAgICAgKHtcbiAgICAgICAgaW5wdXRcbiAgICAgIH0pID0+IHtcbiAgICAgICAgY29uc3QgeyBsaXN0ZW5lciwgaWQgfSA9IGlucHV0O1xuICAgICAgICByZXR1cm4gZGVmZXIoKCkgPT4gbGlzdGVuZXIpLnBpcGUoXG4gICAgICAgICAgZmlsdGVyKFxuICAgICAgICAgICAgKGV2ZW50KSA9PiBldmVudC50eXBlID09PSBcIndlbGNvbWVcIiB8fCBldmVudC50eXBlID09PSBcInJlY29ubmVjdFwiIHx8IGV2ZW50LnR5cGUgPT09IFwibXV0YXRpb25cIiAmJiBldmVudC5kb2N1bWVudElkID09PSBpZFxuICAgICAgICAgICksXG4gICAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gYXZvaWQgc3luYyBlbWl0dGVkIGV2ZW50cyBmcm9tIGBzaGFyZVJlcGxheWAgZnJvbSBoYXBwZW5pbmcgYmVmb3JlIHRoZSBhY3RvciBpcyByZWFkeSB0byByZWNlaXZlIHRoZW1cbiAgICAgICAgICBvYnNlcnZlT24oYXNhcFNjaGVkdWxlcilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICApLFxuICAgIFwiZmV0Y2ggcmVtb3RlIHNuYXBzaG90XCI6IGZyb21Qcm9taXNlKFxuICAgICAgYXN5bmMgKHtcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIHNpZ25hbFxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB7IGNsaWVudCwgaWQgfSA9IGlucHV0O1xuICAgICAgICByZXR1cm4gYXdhaXQgY2xpZW50LmdldERvY3VtZW50KGlkLCB7XG4gICAgICAgICAgc2lnbmFsXG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIEVycm9yICYmIGUubmFtZSA9PT0gXCJBYm9ydEVycm9yXCIpKVxuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgKSxcbiAgICBcInN1Ym1pdCBtdXRhdGlvbnMgYXMgdHJhbnNhY3Rpb25zXCI6IGZyb21Qcm9taXNlKFxuICAgICAgYXN5bmMgKHtcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIHNpZ25hbFxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB7IGNsaWVudCwgdHJhbnNhY3Rpb25zIH0gPSBpbnB1dDtcbiAgICAgICAgZm9yIChjb25zdCB0cmFuc2FjdGlvbiBvZiB0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgICBpZiAoc2lnbmFsLmFib3J0ZWQpIHJldHVybjtcbiAgICAgICAgICBhd2FpdCBjbGllbnQuZGF0YVJlcXVlc3QoXCJtdXRhdGVcIiwgZW5jb2RlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pLCB7XG4gICAgICAgICAgICB2aXNpYmlsaXR5OiBcImFzeW5jXCIsXG4gICAgICAgICAgICByZXR1cm5Eb2N1bWVudHM6ICExLFxuICAgICAgICAgICAgc2lnbmFsXG4gICAgICAgICAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBFcnJvciAmJiBlLm5hbWUgPT09IFwiQWJvcnRFcnJvclwiKSlcbiAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIClcbiAgfSxcbiAgZGVsYXlzOiB7XG4gICAgLy8gRXhwb25lbnRpYWwgYmFja29mZiBkZWxheSBmdW5jdGlvblxuICAgIGZldGNoUmVtb3RlU25hcHNob3RUaW1lb3V0OiAoeyBjb250ZXh0IH0pID0+IE1hdGgucG93KDIsIGNvbnRleHQuZmV0Y2hSZW1vdGVTbmFwc2hvdEF0dGVtcHRzKSAqIDFlMyxcbiAgICBzdWJtaXRUcmFuc2FjdGlvbnNUaW1lb3V0OiAoeyBjb250ZXh0IH0pID0+IE1hdGgucG93KDIsIGNvbnRleHQuc3VibWl0VHJhbnNhY3Rpb25zQXR0ZW1wdHMpICogMWUzXG4gIH1cbn0pLmNyZWF0ZU1hY2hpbmUoe1xuICAvKiogQHhzdGF0ZS1sYXlvdXQgTjRJZ3BnSmc1bURPSUM1UVFQWUdNQ3VCYk1BN0FMZ0xSWWI0Q0crS0FUZ01Rbm41Z0RhQURBTHFLZ0FPS3NBbHZqNHBjbkVBQTlFQURoWUFXQUhRQTJHU3dVQm1BS3dCT2FRRVpKa2hRQm9RQVQwUTZBVEFGOHJ4MUpod0ZpcEN0VGtRK3NOTU54ZzBqQ0JwdlhGOS1WZzRrRUI1K1FXRlJDUVFMRmhZNVBRQjJkUlUxU1FzZEdTVmpNd1JsSFRrV05NMDBuUjFWS3J5S216dDBiRHdpZWxjcU9XRFF3VndvR2dCM01BQWJieHh3MFdpQklSRkloUFVLdVExTlZVMHRUVTBXRmRWQ3hBdDFkVGxOaFgyV2RSbHRHVWswNjFzUWV4YW5kc3BPN3I5ZS1xby1IM2VKeUtuWXJOUVBOSkpvbGxwVnV0TnR0ZGdoVkNvNU1vVGdvTXBvOGpJa3FwR3ZkbW80Mmk0WGwwZnY0K0gwYUdBcUZScUg5dUx4cG5FNW9nRnJDTEZkNUN0TkJZRkprZE9wdWFvc1hjSG5qbkF3M0c5LUFBeE1oOFlZWUw1QlluNEdsUk9tQStLSUZFczFSNk9ScFpZV0hJWEdSNmJIQzFxaWpweUw0U2o2REVaalpqc1NacW1ZYXhLMU9SY3ZsYy1acVNveU5Ld25ScEdUeUs0V0RLNUJRNkJRNUJSbTNFVzU1dUcxSzBuOUNsVXFncWdGdXhrZXRKZTduSXYyclVOQjB4N0xtU0wycUdNc1N5U2V2Y21TSmh6SmduaXBXUU9nRW1hNTEwTTRIbWNxSFpZeVdxYU9NcVRReVdHaDBvc1ZTR2l3QzV1R3lmdHg3NHNXdkh1Qk5NaFg3Ty01RG9IaVBhZTcybHZubHdQQnlkRmxSVlM3cVBJbDdjaWxQNzQtK1NCeU1NS0JrQjRaS29MNGNpa2dBYmlnQURXWUJ5REErQUFDSkpnUWc0eFBtSTdGSGtaUXJLR3NqcUtjQ2lhTUc5WXBKT3h5U0JpQ2l5UG9YNmRudVJKLWdFZ0hBYUJtYVVtNFhEREJRQUJtMUJZSWhZQW9XaHlxbnJTbUhEcGVDQUtDaWNqVWJVNmc2bmtGaWNoWXNKckxXVnhhUHNrN0tkSUNaQ21KbHFFcmFBRkFTQnZiUEFPRW1xbEpGNEpKVVJiVkRjeTRZdmsxR1ZrVXNhYkFwTWpLWkdxak5nMmtnTVU4WGEtajBGbnNRQlhCVUo0dlJnSDJEQk9oRWtuMG81VExLVjZ5NldERzZsaGtZVllJRG9LenlCa2VSOHBVRFpxT0Z1NVd1WkVCc1ZaelVlRlErQW1EUXNBWUFBUmxnQWdZWmw3bzZJMnRZTEpJTlNTTyszSmFNR2xRcEdraEZocnlvMmpXMnhrZGhGVEZOUzFFQUFUMS1VQ0hhNEVJZEJjRUlZZEEzNEFBS2xRWkM0TEFaQWtzSXNCRGVxQmJyZHB5bThpdUJ5eGxjTEs1QllxUUxCVVp5VGNGdkwxYVozWXNURnJWeUZkeDBadVNYR2REeC1HQ1VqZlhYWGREMVBTOWozdlZoTW5yV0NGUnh0TmFSTGRjZklzaXd1UzVma2daYU9VbGhwRERQN01kRnpXV2Z0elhJLWdkclBHbExvT1NOeWlIRnN0UnlTaXNqY2d6YWh5Rm9VWUJiUnNhYzV0TzZ3MUY3d0l3TE9OSGZnMHF5dkt5VmZQZ1ZBbUNUMGtKR3Q0MXBKRDAyeGdjcEVsVWtjWjZySStxNUpjY2tiVTBXME5XWkI1N1FkdU1DS2Jjb0ttSXNDcFhJWkI4WXdWQUFCUkMtamozUFlDc0EzWHdPQW9LUUFDVU5EbXR0alZoLXpFZkc5SDV1MjFscFZqU3JUdFRUTmJzc3RVWUpKQUZXZ0EzN1hPUlR6K3Q4K3h0Y0twYjF2MSs2S0pGb3BHUXFSaTZuQmxzdFljcU5LNXJpdXNZRHp0bGVqektNZkpYSENkSnlucWQ4U0phQUFCWUFFcGdGZ0tDTUFBeXJnWkJjTEFWK1AzbkJmRjZYSm5jN3RmbVk4eFpuZ2xnV0dlLWtsSUx6VWhZRFNKVlJwbkNPTk5PY1d4V1JLQlJEWU80dUFVRDdYZ0pFTXVJZHFEaTJHZ1dRZ09oZ3hNeVJLeUZjOEl1UWtYVUR2SzBIZ3ZBSG1JUjliQ0Q0U29lU1dDb0xrb1pweHJtWEl3ME9MRU14c05KZ2tTYzQxOEtobnJIeUc0b1pZVGNQaE1pZmhKeDRTQ2lEanJBQlNwZ0hpTHRvZ0FVaHdXNzdEUklHWGtrNTV3ZXhLQ3JKUXNnMWpCVG5Qc1lScVp2aWlMNlBvaHVPUmd5aGhCaEdLTXNaWXp4aGNYcmY4RUJQSHVsVUpPUEN0UmxBQldJdTdJb09SVkJJSWhNcE5ZR0p5Z2hLSG1FdmFZalFFa093aGt4UXJKdEJFUzBKRE9CUGxrZ0tEMUpZWlNqWk9SeVRYTmt3QnNWd2tGUFlUSlZZUzU4SnhQS2JPWU0wZ1VqN0ZqR2NFTU9wY2lhSnhNSFhXT1RXSlYyYXZGUktwSXdBUklMSlJHSkJGNG1aQklrREUwS3RJeExTU0RrRFlHaFdsNzBSdTFUcTZ6c0xVUkJrb0x5V1JtejhQbWxVWm1jWTF6WERLZE1naGN5Mm1JeUZoOFc1Wk40UkZtT0Z5S2Fad2lMZVQyR1ZKY3k1cEJyZ3VDaU1LMnR2eUR3QlliSVdlak9rU01RQmtlUU9SSnEwUk5DVURJRE5vbmR4dUdwUFFtUnFJWFBoaVBFQ3VLTXBkTWtiSUxaLVNFbkx4eWpxT0pNWnNqMWpSVFlJQUEgKi9cbiAgaWQ6IFwiZG9jdW1lbnQtbXV0YXRvclwiLFxuICBjb250ZXh0OiAoeyBpbnB1dCB9KSA9PiAoe1xuICAgIGNsaWVudDogaW5wdXQuY2xpZW50LndpdGhDb25maWcoeyBhbGxvd1JlY29uZmlndXJlOiAhMSB9KSxcbiAgICBzaGFyZWRMaXN0ZW5lcjogaW5wdXQuc2hhcmVkTGlzdGVuZXIsXG4gICAgaWQ6IGlucHV0LmlkLFxuICAgIHJlbW90ZTogdm9pZCAwLFxuICAgIGxvY2FsOiB2b2lkIDAsXG4gICAgbXV0YXRpb25FdmVudHM6IFtdLFxuICAgIHN0YWdlZENoYW5nZXM6IFtdLFxuICAgIHN0YXNoZWRDaGFuZ2VzOiBbXSxcbiAgICBlcnJvcjogdm9pZCAwLFxuICAgIGZldGNoUmVtb3RlU25hcHNob3RBdHRlbXB0czogMCxcbiAgICBzdWJtaXRUcmFuc2FjdGlvbnNBdHRlbXB0czogMCxcbiAgICBjYWNoZTogaW5wdXQuY2FjaGVcbiAgfSksXG4gIC8vIEF1dG8gc3RhcnQgdGhlIGNvbm5lY3Rpb24gYnkgZGVmYXVsdFxuICBlbnRyeTogW1wiY29ubmVjdCB0byBzZXJ2ZXItc2VudCBldmVudHNcIl0sXG4gIG9uOiB7XG4gICAgbXV0YXRlOiB7XG4gICAgICBhY3Rpb25zOiBbXCJyZWJhc2UgbG9jYWwgc25hcHNob3RcIiwgXCJzdGFnZSBtdXRhdGlvblwiXVxuICAgIH1cbiAgfSxcbiAgaW5pdGlhbDogXCJkaXNjb25uZWN0ZWRcIixcbiAgc3RhdGVzOiB7XG4gICAgZGlzY29ubmVjdGVkOiB7XG4gICAgICBvbjoge1xuICAgICAgICBjb25uZWN0OiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RpbmdcIixcbiAgICAgICAgICBhY3Rpb25zOiBbXCJsaXN0ZW4gdG8gc2VydmVyLXNlbnQgZXZlbnRzXCJdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbm5lY3Rpbmc6IHtcbiAgICAgIG9uOiB7XG4gICAgICAgIHdlbGNvbWU6IFwiY29ubmVjdGVkXCIsXG4gICAgICAgIHJlY29ubmVjdDogXCJyZWNvbm5lY3RpbmdcIixcbiAgICAgICAgZXJyb3I6IFwiY29ubmVjdEZhaWx1cmVcIlxuICAgICAgfSxcbiAgICAgIHRhZ3M6IFtcImJ1c3lcIl1cbiAgICB9LFxuICAgIGNvbm5lY3RGYWlsdXJlOiB7XG4gICAgICBvbjoge1xuICAgICAgICBjb25uZWN0OiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RpbmdcIixcbiAgICAgICAgICBhY3Rpb25zOiBbXCJsaXN0ZW4gdG8gc2VydmVyLXNlbnQgZXZlbnRzXCJdXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlbnRyeTogW1xuICAgICAgICBcInN0b3AgbGlzdGVuaW5nIHRvIHNlcnZlci1zZW50IGV2ZW50c1wiLFxuICAgICAgICBcImFzc2lnbiBlcnJvciB0byBjb250ZXh0XCJcbiAgICAgIF0sXG4gICAgICBleGl0OiBbXCJjbGVhciBlcnJvciBmcm9tIGNvbnRleHRcIl0sXG4gICAgICB0YWdzOiBbXCJlcnJvclwiXVxuICAgIH0sXG4gICAgcmVjb25uZWN0aW5nOiB7XG4gICAgICBvbjoge1xuICAgICAgICB3ZWxjb21lOiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RlZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RGYWlsdXJlXCJcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRhZ3M6IFtcImJ1c3lcIiwgXCJlcnJvclwiXVxuICAgIH0sXG4gICAgY29ubmVjdGVkOiB7XG4gICAgICBvbjoge1xuICAgICAgICBtdXRhdGlvbjoge1xuICAgICAgICAgIGFjdGlvbnM6IFtcImJ1ZmZlciByZW1vdGUgbXV0YXRpb24gZXZlbnRzXCJdXG4gICAgICAgIH0sXG4gICAgICAgIHJlY29ubmVjdDogXCJyZWNvbm5lY3RpbmdcIlxuICAgICAgfSxcbiAgICAgIGVudHJ5OiBbXCJjbGVhciBlcnJvciBmcm9tIGNvbnRleHRcIl0sXG4gICAgICBpbml0aWFsOiBcImxvYWRpbmdcIixcbiAgICAgIHN0YXRlczoge1xuICAgICAgICBsb2FkaW5nOiB7XG4gICAgICAgICAgaW52b2tlOiB7XG4gICAgICAgICAgICBzcmM6IFwiZmV0Y2ggcmVtb3RlIHNuYXBzaG90XCIsXG4gICAgICAgICAgICBpZDogXCJnZXREb2N1bWVudFwiLFxuICAgICAgICAgICAgaW5wdXQ6ICh7IGNvbnRleHQgfSkgPT4gKHtcbiAgICAgICAgICAgICAgY2xpZW50OiBjb250ZXh0LmNsaWVudCxcbiAgICAgICAgICAgICAgaWQ6IGNvbnRleHQuaWRcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb25FcnJvcjoge1xuICAgICAgICAgICAgICB0YXJnZXQ6IFwibG9hZEZhaWx1cmVcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uRG9uZToge1xuICAgICAgICAgICAgICB0YXJnZXQ6IFwibG9hZGVkXCIsXG4gICAgICAgICAgICAgIGFjdGlvbnM6IFtcbiAgICAgICAgICAgICAgICBcInJlYmFzZSBmZXRjaGVkIHJlbW90ZSBzbmFwc2hvdFwiLFxuICAgICAgICAgICAgICAgIFwicmVzZXQgZmV0Y2ggYXR0ZW1wdHNcIlxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0YWdzOiBbXCJidXN5XCJdXG4gICAgICAgIH0sXG4gICAgICAgIGxvYWRlZDoge1xuICAgICAgICAgIGVudHJ5OiBbXCJzZW5kIHN5bmMgZXZlbnQgdG8gcGFyZW50XCJdLFxuICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICBtdXRhdGlvbjoge1xuICAgICAgICAgICAgICBhY3Rpb25zOiBbXCJhcHBseSBtZW5kb3phIHBhdGNoXCIsIFwic2VuZCBtdXRhdGlvbiBldmVudCB0byBwYXJlbnRcIl1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGluaXRpYWw6IFwicHJpc3RpbmVcIixcbiAgICAgICAgICBzdGF0ZXM6IHtcbiAgICAgICAgICAgIHByaXN0aW5lOiB7XG4gICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgbXV0YXRlOiB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb25zOiBbXCJyZWJhc2UgbG9jYWwgc25hcHNob3RcIiwgXCJzdGFnZSBtdXRhdGlvblwiXSxcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogXCJkaXJ0eVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWdzOiBbXCJyZWFkeVwiXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRpcnR5OiB7XG4gICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgc3VibWl0OiBcInN1Ym1pdHRpbmdcIlxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWdzOiBbXCJyZWFkeVwiXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Ym1pdHRpbmc6IHtcbiAgICAgICAgICAgICAgb246IHtcbiAgICAgICAgICAgICAgICBtdXRhdGU6IHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IFtcInJlYmFzZSBsb2NhbCBzbmFwc2hvdFwiLCBcInN0YXNoIG11dGF0aW9uXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpbnZva2U6IHtcbiAgICAgICAgICAgICAgICBzcmM6IFwic3VibWl0IG11dGF0aW9ucyBhcyB0cmFuc2FjdGlvbnNcIixcbiAgICAgICAgICAgICAgICBpZDogXCJzdWJtaXRUcmFuc2FjdGlvbnNcIixcbiAgICAgICAgICAgICAgICBpbnB1dDogKHsgY29udGV4dCB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCByZW1vdGVEYXRhc2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGVEYXRhc2V0LnNldChjb250ZXh0LmlkLCBjb250ZXh0LnJlbW90ZSksIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50OiBjb250ZXh0LmNsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25zOiB0b1RyYW5zYWN0aW9ucyhcbiAgICAgICAgICAgICAgICAgICAgICAvLyBTcXVhc2hpbmcgRE1QIHN0cmluZ3MgaXMgdGhlIGxhc3QgdGhpbmcgd2UgZG8gYmVmb3JlIHN1Ym1pdHRpbmdcbiAgICAgICAgICAgICAgICAgICAgICBzcXVhc2hETVBTdHJpbmdzKFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRGF0YXNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNxdWFzaE11dGF0aW9uR3JvdXBzKGNvbnRleHQuc3RhZ2VkQ2hhbmdlcylcbiAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiB7XG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IFwic3VibWl0RmFpbHVyZVwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkRvbmU6IHtcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogXCJwcmlzdGluZVwiLFxuICAgICAgICAgICAgICAgICAgYWN0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICBcInJlc3RvcmUgc3Rhc2hlZCBjaGFuZ2VzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwicmVzZXQgc3VibWl0IGF0dGVtcHRzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic2VuZCBwcmlzdGluZSBldmVudCB0byBwYXJlbnRcIlxuICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqICdidXN5JyBtZWFucyB3ZSBzaG91bGQgc2hvdyBhIHNwaW5uZXIsICdyZWFkeScgbWVhbnMgd2UgY2FuIHN0aWxsIGFjY2VwdCBtdXRhdGlvbnMsIHRoZXknbGwgYmUgYXBwbGllZCBvcHRpbWlzdGljYWxseSByaWdodCBhd2F5LCBhbmQgcXVldWVkIGZvciBzdWJtaXNzaW9ucyBhZnRlciB0aGUgY3VycmVudCBzdWJtaXNzaW9uIHNldHRsZXNcbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIHRhZ3M6IFtcImJ1c3lcIiwgXCJyZWFkeVwiXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Ym1pdEZhaWx1cmU6IHtcbiAgICAgICAgICAgICAgZXhpdDogW1wiY2xlYXIgZXJyb3IgZnJvbSBjb250ZXh0XCJdLFxuICAgICAgICAgICAgICBhZnRlcjoge1xuICAgICAgICAgICAgICAgIHN1Ym1pdFRyYW5zYWN0aW9uc1RpbWVvdXQ6IHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IFtcImluY3JlbWVudCBzdWJtaXQgYXR0ZW1wdHNcIl0sXG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IFwic3VibWl0dGluZ1wiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgICAgIHJldHJ5OiBcInN1Ym1pdHRpbmdcIlxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogSG93IGNhbiBpdCBiZSBib3RoIGByZWFkeWAgYW5kIGBlcnJvcmA/IGByZWFkeWAgbWVhbnMgaXQgY2FuIHJlY2VpdmUgbXV0YXRpb25zLCBvcHRpbWlzdGljYWxseSBhcHBseSB0aGVtLCBhbmQgcXVldWUgdGhlbSBmb3Igc3VibWlzc2lvbi4gYGVycm9yYCBtZWFucyBpdCBmYWlsZWQgdG8gc3VibWl0IHByZXZpb3VzbHkgYXBwbGllZCBtdXRhdGlvbnMuXG4gICAgICAgICAgICAgICAqIEl0J3MgY29tcGxldGVseSBmaW5lIHRvIGtlZXAgcXVldWVpbmcgdXAgbW9yZSBtdXRhdGlvbnMgYW5kIGFwcGx5aW5nIHRoZW0gb3B0aW1pc3RpY2FsbHksIHdoaWxlIHNob3dpbmcgVUkgdGhhdCBub3RpZmllcyB0aGF0IG11dGF0aW9ucyBkaWRuJ3Qgc3VibWl0LCBhbmQgc2hvdyBhIGNvdW50IGRvd24gdW50aWwgdGhlIG5leHQgYXV0b21hdGljIHJldHJ5LlxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgdGFnczogW1wiZXJyb3JcIiwgXCJyZWFkeVwiXVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbG9hZEZhaWx1cmU6IHtcbiAgICAgICAgICBleGl0OiBbXCJjbGVhciBlcnJvciBmcm9tIGNvbnRleHRcIl0sXG4gICAgICAgICAgYWZ0ZXI6IHtcbiAgICAgICAgICAgIGZldGNoUmVtb3RlU25hcHNob3RUaW1lb3V0OiB7XG4gICAgICAgICAgICAgIGFjdGlvbnM6IFtcImluY3JlbWVudCBmZXRjaCBhdHRlbXB0c1wiXSxcbiAgICAgICAgICAgICAgdGFyZ2V0OiBcImxvYWRpbmdcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgb246IHtcbiAgICAgICAgICAgIHJldHJ5OiBcImxvYWRpbmdcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnczogW1wiZXJyb3JcIl1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG5mdW5jdGlvbiBhcHBseU1lbmRvemFQYXRjaChkb2N1bWVudCwgcGF0Y2gsIG5leHRSZXZpc2lvbikge1xuICBjb25zdCBuZXh0ID0gYXBwbHlQYXRjaChvbWl0UmV2KGRvY3VtZW50KSwgcGF0Y2gpO1xuICByZXR1cm4gbmV4dCA/IE9iamVjdC5hc3NpZ24obmV4dCwgeyBfcmV2OiBuZXh0UmV2aXNpb24gfSkgOiBudWxsO1xufVxuZnVuY3Rpb24gb21pdFJldihkb2N1bWVudCkge1xuICBpZiAoIWRvY3VtZW50KVxuICAgIHJldHVybiBudWxsO1xuICBjb25zdCB7IF9yZXYsIC4uLmRvYyB9ID0gZG9jdW1lbnQ7XG4gIHJldHVybiBkb2M7XG59XG5leHBvcnQge1xuICBhcHBseU11dGF0aW9ucyxcbiAgY29tbWl0LFxuICBjcmVhdGVTaGFyZWRMaXN0ZW5lcixcbiAgZG9jdW1lbnRNdXRhdG9yTWFjaGluZSxcbiAgcmViYXNlLFxuICBzcXVhc2hETVBTdHJpbmdzLFxuICBzcXVhc2hNdXRhdGlvbkdyb3VwcyxcbiAgdG9UcmFuc2FjdGlvbnNcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1fdW5zdGFibGVfbWFjaGluZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js":
/*!****************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CompactEncoder: () => (/* binding */ index$1),\n/* harmony export */   CompactFormatter: () => (/* binding */ compact),\n/* harmony export */   SanityEncoder: () => (/* binding */ index),\n/* harmony export */   append: () => (/* binding */ append),\n/* harmony export */   assign: () => (/* binding */ assign),\n/* harmony export */   at: () => (/* binding */ at),\n/* harmony export */   autoKeys: () => (/* binding */ autoKeys),\n/* harmony export */   create: () => (/* binding */ create),\n/* harmony export */   createIfNotExists: () => (/* binding */ createIfNotExists),\n/* harmony export */   createOrReplace: () => (/* binding */ createOrReplace),\n/* harmony export */   dec: () => (/* binding */ dec),\n/* harmony export */   del: () => (/* binding */ del),\n/* harmony export */   delete_: () => (/* binding */ delete_),\n/* harmony export */   destroy: () => (/* binding */ destroy),\n/* harmony export */   diffMatchPatch: () => (/* binding */ diffMatchPatch),\n/* harmony export */   inc: () => (/* binding */ inc),\n/* harmony export */   insert: () => (/* binding */ insert),\n/* harmony export */   insertAfter: () => (/* binding */ insertAfter),\n/* harmony export */   insertBefore: () => (/* binding */ insertBefore),\n/* harmony export */   patch: () => (/* binding */ patch),\n/* harmony export */   prepend: () => (/* binding */ prepend),\n/* harmony export */   remove: () => (/* binding */ remove),\n/* harmony export */   replace: () => (/* binding */ replace),\n/* harmony export */   set: () => (/* binding */ set),\n/* harmony export */   setIfMissing: () => (/* binding */ setIfMissing),\n/* harmony export */   truncate: () => (/* binding */ truncate),\n/* harmony export */   unassign: () => (/* binding */ unassign),\n/* harmony export */   unset: () => (/* binding */ unset),\n/* harmony export */   upsert: () => (/* binding */ upsert)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_parse_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_chunks-es/parse.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js\");\n/* harmony import */ var _chunks_es_stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_chunks-es/stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n/* harmony import */ var _chunks_es_decode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_chunks-es/decode.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js\");\n/* harmony import */ var _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./_chunks-es/encode.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js\");\n/* harmony import */ var _chunks_es_isObject_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_chunks-es/isObject.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js\");\n/* harmony import */ var _chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_chunks-es/arrify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js\");\n\n\n\n\n\n\nfunction decode(mutations) {\n  return mutations.map(decodeMutation);\n}\nfunction decodeMutation(mutation) {\n  const [type] = mutation;\n  if (type === \"delete\") {\n    const [, id] = mutation;\n    return { id, type };\n  } else if (type === \"create\") {\n    const [, document] = mutation;\n    return { type, document };\n  } else if (type === \"createIfNotExists\") {\n    const [, document] = mutation;\n    return { type, document };\n  } else if (type === \"createOrReplace\") {\n    const [, document] = mutation;\n    return { type, document };\n  } else if (type === \"patch\")\n    return decodePatchMutation(mutation);\n  throw new Error(`Unrecognized mutation: ${JSON.stringify(mutation)}`);\n}\nfunction decodePatchMutation(mutation) {\n  const [, type, id, serializedPath, , revisionId] = mutation, path = (0,_chunks_es_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(serializedPath);\n  if (type === \"dec\" || type === \"inc\") {\n    const [, , , , [amount]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"inc\", amount } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"unset\")\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"unset\" } }],\n      ...createOpts(revisionId)\n    };\n  if (type === \"insert\") {\n    const [, , , , [position, ref, items]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [\n        {\n          path,\n          op: {\n            type: \"insert\",\n            position,\n            items,\n            referenceItem: typeof ref == \"string\" ? { _key: ref } : ref\n          }\n        }\n      ],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"set\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"set\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"setIfMissing\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"setIfMissing\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"diffMatchPatch\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"diffMatchPatch\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"truncate\") {\n    const [, , , , [startIndex, endIndex]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"truncate\", startIndex, endIndex } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"assign\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"assign\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"replace\") {\n    const [, , , , [ref, items]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [\n        { path, op: { type: \"replace\", items, referenceItem: decodeItemRef(ref) } }\n      ],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"upsert\") {\n    const [, , , , [position, referenceItem, items]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [\n        {\n          path,\n          op: {\n            type: \"upsert\",\n            items,\n            referenceItem: decodeItemRef(referenceItem),\n            position\n          }\n        }\n      ],\n      ...createOpts(revisionId)\n    };\n  }\n  throw new Error(`Invalid mutation type: ${type}`);\n}\nfunction decodeItemRef(ref) {\n  return typeof ref == \"string\" ? { _key: ref } : ref;\n}\nfunction createOpts(revisionId) {\n  return revisionId ? { options: { ifRevision: revisionId } } : null;\n}\nfunction encode(mutations) {\n  return mutations.flatMap((m) => encodeMutation$1(m));\n}\nfunction encodeItemRef$1(ref) {\n  return typeof ref == \"number\" ? ref : ref._key;\n}\nfunction encodeMutation$1(mutation) {\n  if (mutation.type === \"create\" || mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return [[mutation.type, mutation.document]];\n  if (mutation.type === \"delete\")\n    return [[\"delete\", mutation.id]];\n  if (mutation.type === \"patch\")\n    return mutation.patches.map(\n      (patch2) => maybeAddRevision(\n        mutation.options?.ifRevision,\n        encodePatchMutation(mutation.id, patch2)\n      )\n    );\n  throw new Error(`Invalid mutation type: ${mutation.type}`);\n}\nfunction encodePatchMutation(id, patch2) {\n  const { op } = patch2, path = (0,_chunks_es_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(patch2.path);\n  if (op.type === \"unset\")\n    return [\"patch\", \"unset\", id, path, []];\n  if (op.type === \"diffMatchPatch\")\n    return [\"patch\", \"diffMatchPatch\", id, path, [op.value]];\n  if (op.type === \"inc\" || op.type === \"dec\")\n    return [\"patch\", op.type, id, path, [op.amount]];\n  if (op.type === \"set\")\n    return [\"patch\", op.type, id, path, [op.value]];\n  if (op.type === \"setIfMissing\")\n    return [\"patch\", op.type, id, path, [op.value]];\n  if (op.type === \"insert\")\n    return [\n      \"patch\",\n      \"insert\",\n      id,\n      path,\n      [op.position, encodeItemRef$1(op.referenceItem), op.items]\n    ];\n  if (op.type === \"upsert\")\n    return [\n      \"patch\",\n      \"upsert\",\n      id,\n      path,\n      [op.position, encodeItemRef$1(op.referenceItem), op.items]\n    ];\n  if (op.type === \"assign\")\n    return [\"patch\", \"assign\", id, path, [op.value]];\n  if (op.type === \"unassign\")\n    return [\"patch\", \"assign\", id, path, [op.keys]];\n  if (op.type === \"replace\")\n    return [\n      \"patch\",\n      \"replace\",\n      id,\n      path,\n      [encodeItemRef$1(op.referenceItem), op.items]\n    ];\n  if (op.type === \"truncate\")\n    return [\"patch\", \"truncate\", id, path, [op.startIndex, op.endIndex]];\n  if (op.type === \"remove\")\n    return [\"patch\", \"remove\", id, path, [encodeItemRef$1(op.referenceItem)]];\n  throw new Error(`Invalid operation type: ${op.type}`);\n}\nfunction maybeAddRevision(revision, mut) {\n  const [mutType, patchType, id, path, args] = mut;\n  return revision ? [mutType, patchType, id, path, args, revision] : mut;\n}\nvar index$1 = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  decode,\n  encode\n}), index = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  decode: _chunks_es_decode_js__WEBPACK_IMPORTED_MODULE_2__.decode,\n  decodeAll: _chunks_es_decode_js__WEBPACK_IMPORTED_MODULE_2__.decodeAll,\n  encode: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encode,\n  encodeAll: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encodeAll,\n  encodeMutation: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encodeMutation,\n  encodeTransaction: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encodeTransaction\n});\nfunction format(mutations) {\n  return mutations.flatMap((m) => encodeMutation(m)).join(`\n`);\n}\nfunction encodeItemRef(ref) {\n  return typeof ref == \"number\" ? ref : ref._key;\n}\nfunction encodeMutation(mutation) {\n  if (mutation.type === \"create\" || mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return [mutation.type, \": \", JSON.stringify(mutation.document)].join(\"\");\n  if (mutation.type === \"delete\")\n    return [\"delete \", mutation.id].join(\": \");\n  if (mutation.type === \"patch\") {\n    const ifRevision = mutation.options?.ifRevision;\n    return [\n      \"patch\",\n      \" \",\n      `id=${mutation.id}`,\n      ifRevision ? ` (if revision==${ifRevision})` : \"\",\n      `:\n`,\n      mutation.patches.map((nodePatch) => `  ${formatPatchMutation(nodePatch)}`).join(`\n`)\n    ].join(\"\");\n  }\n  throw new Error(`Invalid mutation type: ${mutation.type}`);\n}\nfunction formatPatchMutation(patch2) {\n  const { op } = patch2, path = (0,_chunks_es_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(patch2.path);\n  if (op.type === \"unset\")\n    return [path, \"unset()\"].join(\": \");\n  if (op.type === \"diffMatchPatch\")\n    return [path, `diffMatchPatch(${op.value})`].join(\": \");\n  if (op.type === \"inc\" || op.type === \"dec\")\n    return [path, `${op.type}(${op.amount})`].join(\": \");\n  if (op.type === \"set\" || op.type === \"setIfMissing\")\n    return [path, `${op.type}(${JSON.stringify(op.value)})`].join(\": \");\n  if (op.type === \"assign\")\n    return [path, `${op.type}(${JSON.stringify(op.value)})`].join(\": \");\n  if (op.type === \"unassign\")\n    return [path, `${op.type}(${JSON.stringify(op.keys)})`].join(\": \");\n  if (op.type === \"insert\" || op.type === \"upsert\")\n    return [\n      path,\n      `${op.type}(${op.position}, ${encodeItemRef(\n        op.referenceItem\n      )}, ${JSON.stringify(op.items)})`\n    ].join(\": \");\n  if (op.type === \"replace\")\n    return [\n      path,\n      `replace(${encodeItemRef(op.referenceItem)}, ${JSON.stringify(\n        op.items\n      )})`\n    ].join(\": \");\n  if (op.type === \"truncate\")\n    return [path, `truncate(${op.startIndex}, ${op.endIndex}`].join(\": \");\n  if (op.type === \"remove\")\n    return [path, `remove(${encodeItemRef(op.referenceItem)})`].join(\": \");\n  throw new Error(`Invalid operation type: ${op.type}`);\n}\nvar compact = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  format\n});\nconst set = (value) => ({ type: \"set\", value }), assign = (value) => ({\n  type: \"assign\",\n  value\n}), unassign = (keys) => ({\n  type: \"unassign\",\n  keys\n}), setIfMissing = (value) => ({\n  type: \"setIfMissing\",\n  value\n}), unset = () => ({ type: \"unset\" }), inc = (amount = 1) => ({\n  type: \"inc\",\n  amount\n}), dec = (amount = 1) => ({\n  type: \"dec\",\n  amount\n}), diffMatchPatch = (value) => ({\n  type: \"diffMatchPatch\",\n  value\n});\nfunction insert(items, position, indexOrReferenceItem) {\n  return {\n    type: \"insert\",\n    referenceItem: indexOrReferenceItem,\n    position,\n    items: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(items)\n  };\n}\nfunction append(items) {\n  return insert(items, \"after\", -1);\n}\nfunction prepend(items) {\n  return insert(items, \"before\", 0);\n}\nfunction insertBefore(items, indexOrReferenceItem) {\n  return insert(items, \"before\", indexOrReferenceItem);\n}\nconst insertAfter = (items, indexOrReferenceItem) => insert(items, \"after\", indexOrReferenceItem);\nfunction truncate(startIndex, endIndex) {\n  return {\n    type: \"truncate\",\n    startIndex,\n    endIndex\n  };\n}\nfunction replace(items, referenceItem) {\n  return {\n    type: \"replace\",\n    referenceItem,\n    items: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(items)\n  };\n}\nfunction remove(referenceItem) {\n  return {\n    type: \"remove\",\n    referenceItem\n  };\n}\nfunction upsert(items, position, referenceItem) {\n  return {\n    type: \"upsert\",\n    items: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(items),\n    referenceItem,\n    position\n  };\n}\nfunction autoKeys(generateKey) {\n  const ensureKeys = createEnsureKeys(generateKey), insert$1 = (position, referenceItem, items) => insert(ensureKeys(items), position, referenceItem), upsert$1 = (items, position, referenceItem) => upsert(ensureKeys(items), position, referenceItem), replace$1 = (items, position, referenceItem) => replace(ensureKeys(items), referenceItem), insertBefore2 = (ref, items) => insert$1(\"before\", ref, items);\n  return { insert: insert$1, upsert: upsert$1, replace: replace$1, insertBefore: insertBefore2, prepend: (items) => insertBefore2(0, items), insertAfter: (ref, items) => insert$1(\"after\", ref, items), append: (items) => insert$1(\"after\", -1, items) };\n}\nfunction hasKey(item) {\n  return \"_key\" in item;\n}\nfunction createEnsureKeys(generateKey) {\n  return (array) => {\n    let didModify = !1;\n    const withKeys = array.map((item) => needsKey(item) ? (didModify = !0, { ...item, _key: generateKey(item) }) : item);\n    return didModify ? withKeys : array;\n  };\n}\nfunction needsKey(arrayItem) {\n  return (0,_chunks_es_isObject_js__WEBPACK_IMPORTED_MODULE_5__.isObject)(arrayItem) && !hasKey(arrayItem);\n}\nfunction create(document) {\n  return { type: \"create\", document };\n}\nfunction patch(id, patches, options) {\n  return {\n    type: \"patch\",\n    id,\n    patches: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(patches),\n    ...options ? { options } : {}\n  };\n}\nfunction at(path, operation) {\n  return {\n    path: typeof path == \"string\" ? (0,_chunks_es_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path) : path,\n    op: operation\n  };\n}\nfunction createIfNotExists(document) {\n  return { type: \"createIfNotExists\", document };\n}\nfunction createOrReplace(document) {\n  return { type: \"createOrReplace\", document };\n}\nfunction delete_(id) {\n  return { type: \"delete\", id };\n}\nconst del = delete_, destroy = delete_;\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBOEM7QUFDUTtBQUNpQjtBQUN1RDtBQUMxRTtBQUNKO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLElBQUk7QUFDSjtBQUNBLGFBQWE7QUFDYixJQUFJO0FBQ0o7QUFDQSxhQUFhO0FBQ2IsSUFBSTtBQUNKO0FBQ0EsYUFBYTtBQUNiLElBQUk7QUFDSjtBQUNBLDRDQUE0Qyx5QkFBeUI7QUFDckU7QUFDQTtBQUNBLHNFQUFzRSwwREFBSztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksdUJBQXVCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksaUJBQWlCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsWUFBWTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksc0JBQXNCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWSwrQkFBK0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixZQUFZLGlDQUFpQztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksMENBQTBDO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWSx5QkFB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsNERBQU07QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLGtDQUFrQztBQUMvRztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsZ0VBQVE7QUFDakI7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw0REFBTTtBQUNuQixtQkFBbUIsVUFBVTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywwREFBSztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQStCRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9pbmRleC5qcz85Y2JlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSBcIi4vX2NodW5rcy1lcy9wYXJzZS5qc1wiO1xuaW1wb3J0IHsgc3RyaW5naWZ5IH0gZnJvbSBcIi4vX2NodW5rcy1lcy9zdHJpbmdpZnkuanNcIjtcbmltcG9ydCB7IGRlY29kZSBhcyBkZWNvZGUkMSwgZGVjb2RlQWxsIH0gZnJvbSBcIi4vX2NodW5rcy1lcy9kZWNvZGUuanNcIjtcbmltcG9ydCB7IGVuY29kZSBhcyBlbmNvZGUkMSwgZW5jb2RlQWxsLCBlbmNvZGVNdXRhdGlvbiBhcyBlbmNvZGVNdXRhdGlvbiQyLCBlbmNvZGVUcmFuc2FjdGlvbiB9IGZyb20gXCIuL19jaHVua3MtZXMvZW5jb2RlLmpzXCI7XG5pbXBvcnQgeyBpc09iamVjdCB9IGZyb20gXCIuL19jaHVua3MtZXMvaXNPYmplY3QuanNcIjtcbmltcG9ydCB7IGFycmlmeSB9IGZyb20gXCIuL19jaHVua3MtZXMvYXJyaWZ5LmpzXCI7XG5mdW5jdGlvbiBkZWNvZGUobXV0YXRpb25zKSB7XG4gIHJldHVybiBtdXRhdGlvbnMubWFwKGRlY29kZU11dGF0aW9uKTtcbn1cbmZ1bmN0aW9uIGRlY29kZU11dGF0aW9uKG11dGF0aW9uKSB7XG4gIGNvbnN0IFt0eXBlXSA9IG11dGF0aW9uO1xuICBpZiAodHlwZSA9PT0gXCJkZWxldGVcIikge1xuICAgIGNvbnN0IFssIGlkXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7IGlkLCB0eXBlIH07XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJjcmVhdGVcIikge1xuICAgIGNvbnN0IFssIGRvY3VtZW50XSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7IHR5cGUsIGRvY3VtZW50IH07XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiKSB7XG4gICAgY29uc3QgWywgZG9jdW1lbnRdID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHsgdHlwZSwgZG9jdW1lbnQgfTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcImNyZWF0ZU9yUmVwbGFjZVwiKSB7XG4gICAgY29uc3QgWywgZG9jdW1lbnRdID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHsgdHlwZSwgZG9jdW1lbnQgfTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcInBhdGNoXCIpXG4gICAgcmV0dXJuIGRlY29kZVBhdGNoTXV0YXRpb24obXV0YXRpb24pO1xuICB0aHJvdyBuZXcgRXJyb3IoYFVucmVjb2duaXplZCBtdXRhdGlvbjogJHtKU09OLnN0cmluZ2lmeShtdXRhdGlvbil9YCk7XG59XG5mdW5jdGlvbiBkZWNvZGVQYXRjaE11dGF0aW9uKG11dGF0aW9uKSB7XG4gIGNvbnN0IFssIHR5cGUsIGlkLCBzZXJpYWxpemVkUGF0aCwgLCByZXZpc2lvbklkXSA9IG11dGF0aW9uLCBwYXRoID0gcGFyc2Uoc2VyaWFsaXplZFBhdGgpO1xuICBpZiAodHlwZSA9PT0gXCJkZWNcIiB8fCB0eXBlID09PSBcImluY1wiKSB7XG4gICAgY29uc3QgWywgLCAsICwgW2Ftb3VudF1dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW3sgcGF0aCwgb3A6IHsgdHlwZTogXCJpbmNcIiwgYW1vdW50IH0gfV0sXG4gICAgICAuLi5jcmVhdGVPcHRzKHJldmlzaW9uSWQpXG4gICAgfTtcbiAgfVxuICBpZiAodHlwZSA9PT0gXCJ1bnNldFwiKVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFt7IHBhdGgsIG9wOiB7IHR5cGU6IFwidW5zZXRcIiB9IH1dLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIGlmICh0eXBlID09PSBcImluc2VydFwiKSB7XG4gICAgY29uc3QgWywgLCAsICwgW3Bvc2l0aW9uLCByZWYsIGl0ZW1zXV0gPSBtdXRhdGlvbjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJwYXRjaFwiLFxuICAgICAgaWQsXG4gICAgICBwYXRjaGVzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwYXRoLFxuICAgICAgICAgIG9wOiB7XG4gICAgICAgICAgICB0eXBlOiBcImluc2VydFwiLFxuICAgICAgICAgICAgcG9zaXRpb24sXG4gICAgICAgICAgICBpdGVtcyxcbiAgICAgICAgICAgIHJlZmVyZW5jZUl0ZW06IHR5cGVvZiByZWYgPT0gXCJzdHJpbmdcIiA/IHsgX2tleTogcmVmIH0gOiByZWZcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICAuLi5jcmVhdGVPcHRzKHJldmlzaW9uSWQpXG4gICAgfTtcbiAgfVxuICBpZiAodHlwZSA9PT0gXCJzZXRcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFt2YWx1ZV1dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW3sgcGF0aCwgb3A6IHsgdHlwZTogXCJzZXRcIiwgdmFsdWUgfSB9XSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlID09PSBcInNldElmTWlzc2luZ1wiKSB7XG4gICAgY29uc3QgWywgLCAsICwgW3ZhbHVlXV0gPSBtdXRhdGlvbjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJwYXRjaFwiLFxuICAgICAgaWQsXG4gICAgICBwYXRjaGVzOiBbeyBwYXRoLCBvcDogeyB0eXBlOiBcInNldElmTWlzc2luZ1wiLCB2YWx1ZSB9IH1dLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGUgPT09IFwiZGlmZk1hdGNoUGF0Y2hcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFt2YWx1ZV1dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW3sgcGF0aCwgb3A6IHsgdHlwZTogXCJkaWZmTWF0Y2hQYXRjaFwiLCB2YWx1ZSB9IH1dLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGUgPT09IFwidHJ1bmNhdGVcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFtzdGFydEluZGV4LCBlbmRJbmRleF1dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW3sgcGF0aCwgb3A6IHsgdHlwZTogXCJ0cnVuY2F0ZVwiLCBzdGFydEluZGV4LCBlbmRJbmRleCB9IH1dLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGUgPT09IFwiYXNzaWduXCIpIHtcbiAgICBjb25zdCBbLCAsICwgLCBbdmFsdWVdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFt7IHBhdGgsIG9wOiB7IHR5cGU6IFwiYXNzaWduXCIsIHZhbHVlIH0gfV0sXG4gICAgICAuLi5jcmVhdGVPcHRzKHJldmlzaW9uSWQpXG4gICAgfTtcbiAgfVxuICBpZiAodHlwZSA9PT0gXCJyZXBsYWNlXCIpIHtcbiAgICBjb25zdCBbLCAsICwgLCBbcmVmLCBpdGVtc11dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW1xuICAgICAgICB7IHBhdGgsIG9wOiB7IHR5cGU6IFwicmVwbGFjZVwiLCBpdGVtcywgcmVmZXJlbmNlSXRlbTogZGVjb2RlSXRlbVJlZihyZWYpIH0gfVxuICAgICAgXSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlID09PSBcInVwc2VydFwiKSB7XG4gICAgY29uc3QgWywgLCAsICwgW3Bvc2l0aW9uLCByZWZlcmVuY2VJdGVtLCBpdGVtc11dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcGF0aCxcbiAgICAgICAgICBvcDoge1xuICAgICAgICAgICAgdHlwZTogXCJ1cHNlcnRcIixcbiAgICAgICAgICAgIGl0ZW1zLFxuICAgICAgICAgICAgcmVmZXJlbmNlSXRlbTogZGVjb2RlSXRlbVJlZihyZWZlcmVuY2VJdGVtKSxcbiAgICAgICAgICAgIHBvc2l0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG11dGF0aW9uIHR5cGU6ICR7dHlwZX1gKTtcbn1cbmZ1bmN0aW9uIGRlY29kZUl0ZW1SZWYocmVmKSB7XG4gIHJldHVybiB0eXBlb2YgcmVmID09IFwic3RyaW5nXCIgPyB7IF9rZXk6IHJlZiB9IDogcmVmO1xufVxuZnVuY3Rpb24gY3JlYXRlT3B0cyhyZXZpc2lvbklkKSB7XG4gIHJldHVybiByZXZpc2lvbklkID8geyBvcHRpb25zOiB7IGlmUmV2aXNpb246IHJldmlzaW9uSWQgfSB9IDogbnVsbDtcbn1cbmZ1bmN0aW9uIGVuY29kZShtdXRhdGlvbnMpIHtcbiAgcmV0dXJuIG11dGF0aW9ucy5mbGF0TWFwKChtKSA9PiBlbmNvZGVNdXRhdGlvbiQxKG0pKTtcbn1cbmZ1bmN0aW9uIGVuY29kZUl0ZW1SZWYkMShyZWYpIHtcbiAgcmV0dXJuIHR5cGVvZiByZWYgPT0gXCJudW1iZXJcIiA/IHJlZiA6IHJlZi5fa2V5O1xufVxuZnVuY3Rpb24gZW5jb2RlTXV0YXRpb24kMShtdXRhdGlvbikge1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVcIiB8fCBtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZUlmTm90RXhpc3RzXCIgfHwgbXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVPclJlcGxhY2VcIilcbiAgICByZXR1cm4gW1ttdXRhdGlvbi50eXBlLCBtdXRhdGlvbi5kb2N1bWVudF1dO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJkZWxldGVcIilcbiAgICByZXR1cm4gW1tcImRlbGV0ZVwiLCBtdXRhdGlvbi5pZF1dO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJwYXRjaFwiKVxuICAgIHJldHVybiBtdXRhdGlvbi5wYXRjaGVzLm1hcChcbiAgICAgIChwYXRjaDIpID0+IG1heWJlQWRkUmV2aXNpb24oXG4gICAgICAgIG11dGF0aW9uLm9wdGlvbnM/LmlmUmV2aXNpb24sXG4gICAgICAgIGVuY29kZVBhdGNoTXV0YXRpb24obXV0YXRpb24uaWQsIHBhdGNoMilcbiAgICAgIClcbiAgICApO1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbXV0YXRpb24gdHlwZTogJHttdXRhdGlvbi50eXBlfWApO1xufVxuZnVuY3Rpb24gZW5jb2RlUGF0Y2hNdXRhdGlvbihpZCwgcGF0Y2gyKSB7XG4gIGNvbnN0IHsgb3AgfSA9IHBhdGNoMiwgcGF0aCA9IHN0cmluZ2lmeShwYXRjaDIucGF0aCk7XG4gIGlmIChvcC50eXBlID09PSBcInVuc2V0XCIpXG4gICAgcmV0dXJuIFtcInBhdGNoXCIsIFwidW5zZXRcIiwgaWQsIHBhdGgsIFtdXTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiZGlmZk1hdGNoUGF0Y2hcIilcbiAgICByZXR1cm4gW1wicGF0Y2hcIiwgXCJkaWZmTWF0Y2hQYXRjaFwiLCBpZCwgcGF0aCwgW29wLnZhbHVlXV07XG4gIGlmIChvcC50eXBlID09PSBcImluY1wiIHx8IG9wLnR5cGUgPT09IFwiZGVjXCIpXG4gICAgcmV0dXJuIFtcInBhdGNoXCIsIG9wLnR5cGUsIGlkLCBwYXRoLCBbb3AuYW1vdW50XV07XG4gIGlmIChvcC50eXBlID09PSBcInNldFwiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBvcC50eXBlLCBpZCwgcGF0aCwgW29wLnZhbHVlXV07XG4gIGlmIChvcC50eXBlID09PSBcInNldElmTWlzc2luZ1wiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBvcC50eXBlLCBpZCwgcGF0aCwgW29wLnZhbHVlXV07XG4gIGlmIChvcC50eXBlID09PSBcImluc2VydFwiKVxuICAgIHJldHVybiBbXG4gICAgICBcInBhdGNoXCIsXG4gICAgICBcImluc2VydFwiLFxuICAgICAgaWQsXG4gICAgICBwYXRoLFxuICAgICAgW29wLnBvc2l0aW9uLCBlbmNvZGVJdGVtUmVmJDEob3AucmVmZXJlbmNlSXRlbSksIG9wLml0ZW1zXVxuICAgIF07XG4gIGlmIChvcC50eXBlID09PSBcInVwc2VydFwiKVxuICAgIHJldHVybiBbXG4gICAgICBcInBhdGNoXCIsXG4gICAgICBcInVwc2VydFwiLFxuICAgICAgaWQsXG4gICAgICBwYXRoLFxuICAgICAgW29wLnBvc2l0aW9uLCBlbmNvZGVJdGVtUmVmJDEob3AucmVmZXJlbmNlSXRlbSksIG9wLml0ZW1zXVxuICAgIF07XG4gIGlmIChvcC50eXBlID09PSBcImFzc2lnblwiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBcImFzc2lnblwiLCBpZCwgcGF0aCwgW29wLnZhbHVlXV07XG4gIGlmIChvcC50eXBlID09PSBcInVuYXNzaWduXCIpXG4gICAgcmV0dXJuIFtcInBhdGNoXCIsIFwiYXNzaWduXCIsIGlkLCBwYXRoLCBbb3Aua2V5c11dO1xuICBpZiAob3AudHlwZSA9PT0gXCJyZXBsYWNlXCIpXG4gICAgcmV0dXJuIFtcbiAgICAgIFwicGF0Y2hcIixcbiAgICAgIFwicmVwbGFjZVwiLFxuICAgICAgaWQsXG4gICAgICBwYXRoLFxuICAgICAgW2VuY29kZUl0ZW1SZWYkMShvcC5yZWZlcmVuY2VJdGVtKSwgb3AuaXRlbXNdXG4gICAgXTtcbiAgaWYgKG9wLnR5cGUgPT09IFwidHJ1bmNhdGVcIilcbiAgICByZXR1cm4gW1wicGF0Y2hcIiwgXCJ0cnVuY2F0ZVwiLCBpZCwgcGF0aCwgW29wLnN0YXJ0SW5kZXgsIG9wLmVuZEluZGV4XV07XG4gIGlmIChvcC50eXBlID09PSBcInJlbW92ZVwiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBcInJlbW92ZVwiLCBpZCwgcGF0aCwgW2VuY29kZUl0ZW1SZWYkMShvcC5yZWZlcmVuY2VJdGVtKV1dO1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgb3BlcmF0aW9uIHR5cGU6ICR7b3AudHlwZX1gKTtcbn1cbmZ1bmN0aW9uIG1heWJlQWRkUmV2aXNpb24ocmV2aXNpb24sIG11dCkge1xuICBjb25zdCBbbXV0VHlwZSwgcGF0Y2hUeXBlLCBpZCwgcGF0aCwgYXJnc10gPSBtdXQ7XG4gIHJldHVybiByZXZpc2lvbiA/IFttdXRUeXBlLCBwYXRjaFR5cGUsIGlkLCBwYXRoLCBhcmdzLCByZXZpc2lvbl0gOiBtdXQ7XG59XG52YXIgaW5kZXgkMSA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBkZWNvZGUsXG4gIGVuY29kZVxufSksIGluZGV4ID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIGRlY29kZTogZGVjb2RlJDEsXG4gIGRlY29kZUFsbCxcbiAgZW5jb2RlOiBlbmNvZGUkMSxcbiAgZW5jb2RlQWxsLFxuICBlbmNvZGVNdXRhdGlvbjogZW5jb2RlTXV0YXRpb24kMixcbiAgZW5jb2RlVHJhbnNhY3Rpb25cbn0pO1xuZnVuY3Rpb24gZm9ybWF0KG11dGF0aW9ucykge1xuICByZXR1cm4gbXV0YXRpb25zLmZsYXRNYXAoKG0pID0+IGVuY29kZU11dGF0aW9uKG0pKS5qb2luKGBcbmApO1xufVxuZnVuY3Rpb24gZW5jb2RlSXRlbVJlZihyZWYpIHtcbiAgcmV0dXJuIHR5cGVvZiByZWYgPT0gXCJudW1iZXJcIiA/IHJlZiA6IHJlZi5fa2V5O1xufVxuZnVuY3Rpb24gZW5jb2RlTXV0YXRpb24obXV0YXRpb24pIHtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlXCIgfHwgbXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiIHx8IG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlT3JSZXBsYWNlXCIpXG4gICAgcmV0dXJuIFttdXRhdGlvbi50eXBlLCBcIjogXCIsIEpTT04uc3RyaW5naWZ5KG11dGF0aW9uLmRvY3VtZW50KV0uam9pbihcIlwiKTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiZGVsZXRlXCIpXG4gICAgcmV0dXJuIFtcImRlbGV0ZSBcIiwgbXV0YXRpb24uaWRdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwicGF0Y2hcIikge1xuICAgIGNvbnN0IGlmUmV2aXNpb24gPSBtdXRhdGlvbi5vcHRpb25zPy5pZlJldmlzaW9uO1xuICAgIHJldHVybiBbXG4gICAgICBcInBhdGNoXCIsXG4gICAgICBcIiBcIixcbiAgICAgIGBpZD0ke211dGF0aW9uLmlkfWAsXG4gICAgICBpZlJldmlzaW9uID8gYCAoaWYgcmV2aXNpb249PSR7aWZSZXZpc2lvbn0pYCA6IFwiXCIsXG4gICAgICBgOlxuYCxcbiAgICAgIG11dGF0aW9uLnBhdGNoZXMubWFwKChub2RlUGF0Y2gpID0+IGAgICR7Zm9ybWF0UGF0Y2hNdXRhdGlvbihub2RlUGF0Y2gpfWApLmpvaW4oYFxuYClcbiAgICBdLmpvaW4oXCJcIik7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG11dGF0aW9uIHR5cGU6ICR7bXV0YXRpb24udHlwZX1gKTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFBhdGNoTXV0YXRpb24ocGF0Y2gyKSB7XG4gIGNvbnN0IHsgb3AgfSA9IHBhdGNoMiwgcGF0aCA9IHN0cmluZ2lmeShwYXRjaDIucGF0aCk7XG4gIGlmIChvcC50eXBlID09PSBcInVuc2V0XCIpXG4gICAgcmV0dXJuIFtwYXRoLCBcInVuc2V0KClcIl0uam9pbihcIjogXCIpO1xuICBpZiAob3AudHlwZSA9PT0gXCJkaWZmTWF0Y2hQYXRjaFwiKVxuICAgIHJldHVybiBbcGF0aCwgYGRpZmZNYXRjaFBhdGNoKCR7b3AudmFsdWV9KWBdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiaW5jXCIgfHwgb3AudHlwZSA9PT0gXCJkZWNcIilcbiAgICByZXR1cm4gW3BhdGgsIGAke29wLnR5cGV9KCR7b3AuYW1vdW50fSlgXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcInNldFwiIHx8IG9wLnR5cGUgPT09IFwic2V0SWZNaXNzaW5nXCIpXG4gICAgcmV0dXJuIFtwYXRoLCBgJHtvcC50eXBlfSgke0pTT04uc3RyaW5naWZ5KG9wLnZhbHVlKX0pYF0uam9pbihcIjogXCIpO1xuICBpZiAob3AudHlwZSA9PT0gXCJhc3NpZ25cIilcbiAgICByZXR1cm4gW3BhdGgsIGAke29wLnR5cGV9KCR7SlNPTi5zdHJpbmdpZnkob3AudmFsdWUpfSlgXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcInVuYXNzaWduXCIpXG4gICAgcmV0dXJuIFtwYXRoLCBgJHtvcC50eXBlfSgke0pTT04uc3RyaW5naWZ5KG9wLmtleXMpfSlgXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcImluc2VydFwiIHx8IG9wLnR5cGUgPT09IFwidXBzZXJ0XCIpXG4gICAgcmV0dXJuIFtcbiAgICAgIHBhdGgsXG4gICAgICBgJHtvcC50eXBlfSgke29wLnBvc2l0aW9ufSwgJHtlbmNvZGVJdGVtUmVmKFxuICAgICAgICBvcC5yZWZlcmVuY2VJdGVtXG4gICAgICApfSwgJHtKU09OLnN0cmluZ2lmeShvcC5pdGVtcyl9KWBcbiAgICBdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG9wLnR5cGUgPT09IFwicmVwbGFjZVwiKVxuICAgIHJldHVybiBbXG4gICAgICBwYXRoLFxuICAgICAgYHJlcGxhY2UoJHtlbmNvZGVJdGVtUmVmKG9wLnJlZmVyZW5jZUl0ZW0pfSwgJHtKU09OLnN0cmluZ2lmeShcbiAgICAgICAgb3AuaXRlbXNcbiAgICAgICl9KWBcbiAgICBdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG9wLnR5cGUgPT09IFwidHJ1bmNhdGVcIilcbiAgICByZXR1cm4gW3BhdGgsIGB0cnVuY2F0ZSgke29wLnN0YXJ0SW5kZXh9LCAke29wLmVuZEluZGV4fWBdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG9wLnR5cGUgPT09IFwicmVtb3ZlXCIpXG4gICAgcmV0dXJuIFtwYXRoLCBgcmVtb3ZlKCR7ZW5jb2RlSXRlbVJlZihvcC5yZWZlcmVuY2VJdGVtKX0pYF0uam9pbihcIjogXCIpO1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgb3BlcmF0aW9uIHR5cGU6ICR7b3AudHlwZX1gKTtcbn1cbnZhciBjb21wYWN0ID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIGZvcm1hdFxufSk7XG5jb25zdCBzZXQgPSAodmFsdWUpID0+ICh7IHR5cGU6IFwic2V0XCIsIHZhbHVlIH0pLCBhc3NpZ24gPSAodmFsdWUpID0+ICh7XG4gIHR5cGU6IFwiYXNzaWduXCIsXG4gIHZhbHVlXG59KSwgdW5hc3NpZ24gPSAoa2V5cykgPT4gKHtcbiAgdHlwZTogXCJ1bmFzc2lnblwiLFxuICBrZXlzXG59KSwgc2V0SWZNaXNzaW5nID0gKHZhbHVlKSA9PiAoe1xuICB0eXBlOiBcInNldElmTWlzc2luZ1wiLFxuICB2YWx1ZVxufSksIHVuc2V0ID0gKCkgPT4gKHsgdHlwZTogXCJ1bnNldFwiIH0pLCBpbmMgPSAoYW1vdW50ID0gMSkgPT4gKHtcbiAgdHlwZTogXCJpbmNcIixcbiAgYW1vdW50XG59KSwgZGVjID0gKGFtb3VudCA9IDEpID0+ICh7XG4gIHR5cGU6IFwiZGVjXCIsXG4gIGFtb3VudFxufSksIGRpZmZNYXRjaFBhdGNoID0gKHZhbHVlKSA9PiAoe1xuICB0eXBlOiBcImRpZmZNYXRjaFBhdGNoXCIsXG4gIHZhbHVlXG59KTtcbmZ1bmN0aW9uIGluc2VydChpdGVtcywgcG9zaXRpb24sIGluZGV4T3JSZWZlcmVuY2VJdGVtKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJpbnNlcnRcIixcbiAgICByZWZlcmVuY2VJdGVtOiBpbmRleE9yUmVmZXJlbmNlSXRlbSxcbiAgICBwb3NpdGlvbixcbiAgICBpdGVtczogYXJyaWZ5KGl0ZW1zKVxuICB9O1xufVxuZnVuY3Rpb24gYXBwZW5kKGl0ZW1zKSB7XG4gIHJldHVybiBpbnNlcnQoaXRlbXMsIFwiYWZ0ZXJcIiwgLTEpO1xufVxuZnVuY3Rpb24gcHJlcGVuZChpdGVtcykge1xuICByZXR1cm4gaW5zZXJ0KGl0ZW1zLCBcImJlZm9yZVwiLCAwKTtcbn1cbmZ1bmN0aW9uIGluc2VydEJlZm9yZShpdGVtcywgaW5kZXhPclJlZmVyZW5jZUl0ZW0pIHtcbiAgcmV0dXJuIGluc2VydChpdGVtcywgXCJiZWZvcmVcIiwgaW5kZXhPclJlZmVyZW5jZUl0ZW0pO1xufVxuY29uc3QgaW5zZXJ0QWZ0ZXIgPSAoaXRlbXMsIGluZGV4T3JSZWZlcmVuY2VJdGVtKSA9PiBpbnNlcnQoaXRlbXMsIFwiYWZ0ZXJcIiwgaW5kZXhPclJlZmVyZW5jZUl0ZW0pO1xuZnVuY3Rpb24gdHJ1bmNhdGUoc3RhcnRJbmRleCwgZW5kSW5kZXgpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBcInRydW5jYXRlXCIsXG4gICAgc3RhcnRJbmRleCxcbiAgICBlbmRJbmRleFxuICB9O1xufVxuZnVuY3Rpb24gcmVwbGFjZShpdGVtcywgcmVmZXJlbmNlSXRlbSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwicmVwbGFjZVwiLFxuICAgIHJlZmVyZW5jZUl0ZW0sXG4gICAgaXRlbXM6IGFycmlmeShpdGVtcylcbiAgfTtcbn1cbmZ1bmN0aW9uIHJlbW92ZShyZWZlcmVuY2VJdGVtKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJyZW1vdmVcIixcbiAgICByZWZlcmVuY2VJdGVtXG4gIH07XG59XG5mdW5jdGlvbiB1cHNlcnQoaXRlbXMsIHBvc2l0aW9uLCByZWZlcmVuY2VJdGVtKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJ1cHNlcnRcIixcbiAgICBpdGVtczogYXJyaWZ5KGl0ZW1zKSxcbiAgICByZWZlcmVuY2VJdGVtLFxuICAgIHBvc2l0aW9uXG4gIH07XG59XG5mdW5jdGlvbiBhdXRvS2V5cyhnZW5lcmF0ZUtleSkge1xuICBjb25zdCBlbnN1cmVLZXlzID0gY3JlYXRlRW5zdXJlS2V5cyhnZW5lcmF0ZUtleSksIGluc2VydCQxID0gKHBvc2l0aW9uLCByZWZlcmVuY2VJdGVtLCBpdGVtcykgPT4gaW5zZXJ0KGVuc3VyZUtleXMoaXRlbXMpLCBwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbSksIHVwc2VydCQxID0gKGl0ZW1zLCBwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbSkgPT4gdXBzZXJ0KGVuc3VyZUtleXMoaXRlbXMpLCBwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbSksIHJlcGxhY2UkMSA9IChpdGVtcywgcG9zaXRpb24sIHJlZmVyZW5jZUl0ZW0pID0+IHJlcGxhY2UoZW5zdXJlS2V5cyhpdGVtcyksIHJlZmVyZW5jZUl0ZW0pLCBpbnNlcnRCZWZvcmUyID0gKHJlZiwgaXRlbXMpID0+IGluc2VydCQxKFwiYmVmb3JlXCIsIHJlZiwgaXRlbXMpO1xuICByZXR1cm4geyBpbnNlcnQ6IGluc2VydCQxLCB1cHNlcnQ6IHVwc2VydCQxLCByZXBsYWNlOiByZXBsYWNlJDEsIGluc2VydEJlZm9yZTogaW5zZXJ0QmVmb3JlMiwgcHJlcGVuZDogKGl0ZW1zKSA9PiBpbnNlcnRCZWZvcmUyKDAsIGl0ZW1zKSwgaW5zZXJ0QWZ0ZXI6IChyZWYsIGl0ZW1zKSA9PiBpbnNlcnQkMShcImFmdGVyXCIsIHJlZiwgaXRlbXMpLCBhcHBlbmQ6IChpdGVtcykgPT4gaW5zZXJ0JDEoXCJhZnRlclwiLCAtMSwgaXRlbXMpIH07XG59XG5mdW5jdGlvbiBoYXNLZXkoaXRlbSkge1xuICByZXR1cm4gXCJfa2V5XCIgaW4gaXRlbTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUVuc3VyZUtleXMoZ2VuZXJhdGVLZXkpIHtcbiAgcmV0dXJuIChhcnJheSkgPT4ge1xuICAgIGxldCBkaWRNb2RpZnkgPSAhMTtcbiAgICBjb25zdCB3aXRoS2V5cyA9IGFycmF5Lm1hcCgoaXRlbSkgPT4gbmVlZHNLZXkoaXRlbSkgPyAoZGlkTW9kaWZ5ID0gITAsIHsgLi4uaXRlbSwgX2tleTogZ2VuZXJhdGVLZXkoaXRlbSkgfSkgOiBpdGVtKTtcbiAgICByZXR1cm4gZGlkTW9kaWZ5ID8gd2l0aEtleXMgOiBhcnJheTtcbiAgfTtcbn1cbmZ1bmN0aW9uIG5lZWRzS2V5KGFycmF5SXRlbSkge1xuICByZXR1cm4gaXNPYmplY3QoYXJyYXlJdGVtKSAmJiAhaGFzS2V5KGFycmF5SXRlbSk7XG59XG5mdW5jdGlvbiBjcmVhdGUoZG9jdW1lbnQpIHtcbiAgcmV0dXJuIHsgdHlwZTogXCJjcmVhdGVcIiwgZG9jdW1lbnQgfTtcbn1cbmZ1bmN0aW9uIHBhdGNoKGlkLCBwYXRjaGVzLCBvcHRpb25zKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJwYXRjaFwiLFxuICAgIGlkLFxuICAgIHBhdGNoZXM6IGFycmlmeShwYXRjaGVzKSxcbiAgICAuLi5vcHRpb25zID8geyBvcHRpb25zIH0gOiB7fVxuICB9O1xufVxuZnVuY3Rpb24gYXQocGF0aCwgb3BlcmF0aW9uKSB7XG4gIHJldHVybiB7XG4gICAgcGF0aDogdHlwZW9mIHBhdGggPT0gXCJzdHJpbmdcIiA/IHBhcnNlKHBhdGgpIDogcGF0aCxcbiAgICBvcDogb3BlcmF0aW9uXG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVJZk5vdEV4aXN0cyhkb2N1bWVudCkge1xuICByZXR1cm4geyB0eXBlOiBcImNyZWF0ZUlmTm90RXhpc3RzXCIsIGRvY3VtZW50IH07XG59XG5mdW5jdGlvbiBjcmVhdGVPclJlcGxhY2UoZG9jdW1lbnQpIHtcbiAgcmV0dXJuIHsgdHlwZTogXCJjcmVhdGVPclJlcGxhY2VcIiwgZG9jdW1lbnQgfTtcbn1cbmZ1bmN0aW9uIGRlbGV0ZV8oaWQpIHtcbiAgcmV0dXJuIHsgdHlwZTogXCJkZWxldGVcIiwgaWQgfTtcbn1cbmNvbnN0IGRlbCA9IGRlbGV0ZV8sIGRlc3Ryb3kgPSBkZWxldGVfO1xuZXhwb3J0IHtcbiAgaW5kZXgkMSBhcyBDb21wYWN0RW5jb2RlcixcbiAgY29tcGFjdCBhcyBDb21wYWN0Rm9ybWF0dGVyLFxuICBpbmRleCBhcyBTYW5pdHlFbmNvZGVyLFxuICBhcHBlbmQsXG4gIGFzc2lnbixcbiAgYXQsXG4gIGF1dG9LZXlzLFxuICBjcmVhdGUsXG4gIGNyZWF0ZUlmTm90RXhpc3RzLFxuICBjcmVhdGVPclJlcGxhY2UsXG4gIGRlYyxcbiAgZGVsLFxuICBkZWxldGVfLFxuICBkZXN0cm95LFxuICBkaWZmTWF0Y2hQYXRjaCxcbiAgaW5jLFxuICBpbnNlcnQsXG4gIGluc2VydEFmdGVyLFxuICBpbnNlcnRCZWZvcmUsXG4gIHBhdGNoLFxuICBwcmVwZW5kLFxuICByZW1vdmUsXG4gIHJlcGxhY2UsXG4gIHNldCxcbiAgc2V0SWZNaXNzaW5nLFxuICB0cnVuY2F0ZSxcbiAgdW5hc3NpZ24sXG4gIHVuc2V0LFxuICB1cHNlcnRcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing-csm/dist/index.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing-csm/dist/index.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDataAttribute: () => (/* binding */ createDataAttribute),\n/* harmony export */   decodeSanityNodeData: () => (/* binding */ decodeSanityNodeData),\n/* harmony export */   encodeSanityNodeData: () => (/* binding */ encodeSanityNodeData),\n/* harmony export */   pathToUrlString: () => (/* binding */ pathToUrlString),\n/* harmony export */   urlStringToPath: () => (/* binding */ urlStringToPath)\n/* harmony export */ });\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var valibot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! valibot */ \"(ssr)/./node_modules/valibot/dist/index.mjs\");\n\n\nconst lengthyStr$1 = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.pipe)((0,valibot__WEBPACK_IMPORTED_MODULE_0__.string)(), (0,valibot__WEBPACK_IMPORTED_MODULE_0__.minLength)(1)), optionalLengthyStr = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.optional)(lengthyStr$1), sanityNodeSchema = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.object)({\n  baseUrl: lengthyStr$1,\n  dataset: optionalLengthyStr,\n  id: lengthyStr$1,\n  path: lengthyStr$1,\n  projectId: optionalLengthyStr,\n  tool: optionalLengthyStr,\n  type: optionalLengthyStr,\n  workspace: optionalLengthyStr,\n  perspective: (0,valibot__WEBPACK_IMPORTED_MODULE_0__.fallback)((0,valibot__WEBPACK_IMPORTED_MODULE_0__.string)(), \"drafts\")\n});\nfunction isValidSanityNode(node) {\n  return (0,valibot__WEBPACK_IMPORTED_MODULE_0__.is)(sanityNodeSchema, node);\n}\nfunction isArray(value) {\n  return value !== null && Array.isArray(value);\n}\nfunction pathToUrlString(path) {\n  let str = \"\";\n  for (const segment of path) {\n    if (typeof segment == \"string\") {\n      str && (str += \".\"), str += segment;\n      continue;\n    }\n    if (typeof segment == \"number\") {\n      str && (str += \":\"), str += `${segment}`;\n      continue;\n    }\n    if (isArray(segment)) {\n      str && (str += \":\"), str += `${segment.join(\",\")}}`;\n      continue;\n    }\n    if (segment._key) {\n      str && (str += \":\"), str += `${segment._key}`;\n      continue;\n    }\n  }\n  return str;\n}\nfunction encodeSanityNodeData(node) {\n  const { id: _id, path, baseUrl, tool, workspace, type } = node;\n  return isValidSanityNode(node) ? [\n    [\"id\", (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_1__.getPublishedId)(_id)],\n    [\"type\", type],\n    [\"path\", pathToUrlString(_sanity_client_csm__WEBPACK_IMPORTED_MODULE_1__.studioPath.fromString(path))],\n    [\"base\", encodeURIComponent(baseUrl)],\n    [\"workspace\", workspace],\n    [\"tool\", tool]\n  ].filter(([, value]) => !!value).map((part) => part.join(\"=\")).join(\";\") : void 0;\n}\nfunction createDataAttribute(props) {\n  function normalizePath(path) {\n    return path ? typeof path == \"string\" ? _sanity_client_csm__WEBPACK_IMPORTED_MODULE_1__.studioPath.fromString(path) : path : [];\n  }\n  function toString(props2) {\n    if (!props2.id) throw new Error(\"`id` is required to create a data attribute\");\n    if (!props2.type) throw new Error(\"`type` is required to create a data attribute\");\n    if (!props2.path || !props2.path.length)\n      throw new Error(\"`path` is required to create a data attribute\");\n    const attrs = {\n      baseUrl: props2.baseUrl || \"/\",\n      workspace: props2.workspace,\n      tool: props2.tool,\n      type: props2.type,\n      id: props2.id,\n      path: typeof props2.path == \"string\" ? props2.path : _sanity_client_csm__WEBPACK_IMPORTED_MODULE_1__.studioPath.toString(props2.path),\n      perspective: props2.perspective\n    };\n    return encodeSanityNodeData(attrs);\n  }\n  const DataAttribute = (path) => toString({\n    ...props,\n    path: [...normalizePath(props.path), ...normalizePath(path)]\n  });\n  return DataAttribute.toString = function() {\n    return toString(props);\n  }, DataAttribute.combine = function(attrs) {\n    return createDataAttribute({\n      ...props,\n      ...attrs\n    });\n  }, DataAttribute.scope = function(path) {\n    return createDataAttribute({\n      ...props,\n      path: [...normalizePath(props.path), ...normalizePath(path)]\n    });\n  }, DataAttribute;\n}\nconst RE_SEGMENT_WITH_INDEX = /^([\\w-]+):(0|[1-9][0-9]*)$/, RE_SEGMENT_WITH_TUPLE = /^([\\w-]+):([0-9]+),([0-9]+)$/, RE_SEGMENT_WITH_KEY = /^([\\w-]+):([\\w-]+)$/;\nfunction urlStringToPath(str) {\n  const path = [];\n  for (const segment of str.split(\".\")) {\n    const withIndex = RE_SEGMENT_WITH_INDEX.exec(segment);\n    if (withIndex) {\n      path.push(withIndex[1], Number(withIndex[2]));\n      continue;\n    }\n    const withTuple = RE_SEGMENT_WITH_TUPLE.exec(segment);\n    if (withTuple) {\n      path.push(withTuple[1], [Number(withTuple[2]), Number(withTuple[3])]);\n      continue;\n    }\n    const withKey = RE_SEGMENT_WITH_KEY.exec(segment);\n    if (withKey) {\n      path.push(withKey[1], { _key: withKey[2] });\n      continue;\n    }\n    path.push(segment);\n  }\n  return path;\n}\nconst lengthyStr = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.pipe)((0,valibot__WEBPACK_IMPORTED_MODULE_0__.string)(), (0,valibot__WEBPACK_IMPORTED_MODULE_0__.minLength)(1)), sanityLegacyNodeSchema = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.object)({\n  origin: lengthyStr,\n  href: lengthyStr,\n  data: (0,valibot__WEBPACK_IMPORTED_MODULE_0__.optional)((0,valibot__WEBPACK_IMPORTED_MODULE_0__.record)((0,valibot__WEBPACK_IMPORTED_MODULE_0__.string)(), (0,valibot__WEBPACK_IMPORTED_MODULE_0__.unknown)()))\n});\nfunction decodeSanityString(str) {\n  const data = str.split(\";\").reduce((acc, segment) => {\n    const [key, value] = segment.split(\"=\");\n    if (!key || segment.includes(\"=\") && !value) return acc;\n    switch (key) {\n      case \"id\":\n        acc.id = value;\n        break;\n      case \"type\":\n        acc.type = value;\n        break;\n      case \"path\":\n        acc.path = _sanity_client_csm__WEBPACK_IMPORTED_MODULE_1__.studioPath.toString(urlStringToPath(value));\n        break;\n      case \"base\":\n        acc.baseUrl = decodeURIComponent(value);\n        break;\n      case \"perspective\":\n        acc.perspective = value;\n        break;\n      case \"tool\":\n        acc.tool = value;\n        break;\n      case \"workspace\":\n        acc.workspace = value;\n        break;\n      case \"projectId\":\n        acc.projectId = value;\n        break;\n      case \"dataset\":\n        acc.dataset = value;\n        break;\n    }\n    return acc;\n  }, {});\n  if (isValidSanityNode(data))\n    return data;\n}\nfunction decodeSanityObject(data) {\n  const sanityNode = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.safeParse)(sanityNodeSchema, data);\n  if (sanityNode.success)\n    return sanityNode.output;\n  const sanityLegacyNode = (0,valibot__WEBPACK_IMPORTED_MODULE_0__.safeParse)(sanityLegacyNodeSchema, data);\n  if (sanityLegacyNode.success)\n    try {\n      const url = new URL(\n        sanityLegacyNode.output.href,\n        typeof document > \"u\" ? \"https://example.com\" : location.origin\n      );\n      return url.searchParams.size > 0 ? (0,valibot__WEBPACK_IMPORTED_MODULE_0__.parse)(sanityNodeSchema, Object.fromEntries(url.searchParams.entries())) : sanityLegacyNode.output;\n    } catch (err) {\n      return console.error(\"Failed to parse sanity node\", err), sanityLegacyNode.output;\n    }\n}\nfunction decodeSanityNodeData(data) {\n  if (typeof data == \"object\" && data !== null)\n    return decodeSanityObject(data);\n  try {\n    const obj = JSON.parse(data);\n    return decodeSanityObject(obj);\n  } catch {\n    return decodeSanityString(data);\n  }\n}\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmctY3NtL2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFnRTtBQUNxRDtBQUNySCxxQkFBcUIsNkNBQUksQ0FBQywrQ0FBTSxJQUFJLGtEQUFTLDJCQUEyQixpREFBUSxtQ0FBbUMsK0NBQU07QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaURBQVEsQ0FBQywrQ0FBTTtBQUM5QixDQUFDO0FBQ0Q7QUFDQSxTQUFTLDJDQUFFO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFFBQVE7QUFDN0M7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG1CQUFtQjtBQUN4RDtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsYUFBYTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFnRDtBQUMxRDtBQUNBLFdBQVcsa0VBQWM7QUFDekI7QUFDQSw2QkFBNkIsMERBQVU7QUFDdkM7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QywwREFBVTtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsMERBQVU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixrQkFBa0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDZDQUFJLENBQUMsK0NBQU0sSUFBSSxrREFBUywrQkFBK0IsK0NBQU07QUFDaEY7QUFDQTtBQUNBLFFBQVEsaURBQVEsQ0FBQywrQ0FBTSxDQUFDLCtDQUFNLElBQUksZ0RBQU87QUFDekMsQ0FBQztBQUNEO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDBEQUFVO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsSUFBSTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLGtEQUFTO0FBQzlCO0FBQ0E7QUFDQSwyQkFBMkIsa0RBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLDhDQUFLO0FBQzlDLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBT0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmctY3NtL2Rpc3QvaW5kZXguanM/NmZkYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRQdWJsaXNoZWRJZCwgc3R1ZGlvUGF0aCB9IGZyb20gXCJAc2FuaXR5L2NsaWVudC9jc21cIjtcbmltcG9ydCB7IHBpcGUsIHN0cmluZywgbWluTGVuZ3RoLCBvcHRpb25hbCwgb2JqZWN0LCBmYWxsYmFjaywgaXMsIHJlY29yZCwgdW5rbm93biwgc2FmZVBhcnNlLCBwYXJzZSB9IGZyb20gXCJ2YWxpYm90XCI7XG5jb25zdCBsZW5ndGh5U3RyJDEgPSBwaXBlKHN0cmluZygpLCBtaW5MZW5ndGgoMSkpLCBvcHRpb25hbExlbmd0aHlTdHIgPSBvcHRpb25hbChsZW5ndGh5U3RyJDEpLCBzYW5pdHlOb2RlU2NoZW1hID0gb2JqZWN0KHtcbiAgYmFzZVVybDogbGVuZ3RoeVN0ciQxLFxuICBkYXRhc2V0OiBvcHRpb25hbExlbmd0aHlTdHIsXG4gIGlkOiBsZW5ndGh5U3RyJDEsXG4gIHBhdGg6IGxlbmd0aHlTdHIkMSxcbiAgcHJvamVjdElkOiBvcHRpb25hbExlbmd0aHlTdHIsXG4gIHRvb2w6IG9wdGlvbmFsTGVuZ3RoeVN0cixcbiAgdHlwZTogb3B0aW9uYWxMZW5ndGh5U3RyLFxuICB3b3Jrc3BhY2U6IG9wdGlvbmFsTGVuZ3RoeVN0cixcbiAgcGVyc3BlY3RpdmU6IGZhbGxiYWNrKHN0cmluZygpLCBcImRyYWZ0c1wiKVxufSk7XG5mdW5jdGlvbiBpc1ZhbGlkU2FuaXR5Tm9kZShub2RlKSB7XG4gIHJldHVybiBpcyhzYW5pdHlOb2RlU2NoZW1hLCBub2RlKTtcbn1cbmZ1bmN0aW9uIGlzQXJyYXkodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIEFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuZnVuY3Rpb24gcGF0aFRvVXJsU3RyaW5nKHBhdGgpIHtcbiAgbGV0IHN0ciA9IFwiXCI7XG4gIGZvciAoY29uc3Qgc2VnbWVudCBvZiBwYXRoKSB7XG4gICAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIpIHtcbiAgICAgIHN0ciAmJiAoc3RyICs9IFwiLlwiKSwgc3RyICs9IHNlZ21lbnQ7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwibnVtYmVyXCIpIHtcbiAgICAgIHN0ciAmJiAoc3RyICs9IFwiOlwiKSwgc3RyICs9IGAke3NlZ21lbnR9YDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoaXNBcnJheShzZWdtZW50KSkge1xuICAgICAgc3RyICYmIChzdHIgKz0gXCI6XCIpLCBzdHIgKz0gYCR7c2VnbWVudC5qb2luKFwiLFwiKX19YDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoc2VnbWVudC5fa2V5KSB7XG4gICAgICBzdHIgJiYgKHN0ciArPSBcIjpcIiksIHN0ciArPSBgJHtzZWdtZW50Ll9rZXl9YDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc3RyO1xufVxuZnVuY3Rpb24gZW5jb2RlU2FuaXR5Tm9kZURhdGEobm9kZSkge1xuICBjb25zdCB7IGlkOiBfaWQsIHBhdGgsIGJhc2VVcmwsIHRvb2wsIHdvcmtzcGFjZSwgdHlwZSB9ID0gbm9kZTtcbiAgcmV0dXJuIGlzVmFsaWRTYW5pdHlOb2RlKG5vZGUpID8gW1xuICAgIFtcImlkXCIsIGdldFB1Ymxpc2hlZElkKF9pZCldLFxuICAgIFtcInR5cGVcIiwgdHlwZV0sXG4gICAgW1wicGF0aFwiLCBwYXRoVG9VcmxTdHJpbmcoc3R1ZGlvUGF0aC5mcm9tU3RyaW5nKHBhdGgpKV0sXG4gICAgW1wiYmFzZVwiLCBlbmNvZGVVUklDb21wb25lbnQoYmFzZVVybCldLFxuICAgIFtcIndvcmtzcGFjZVwiLCB3b3Jrc3BhY2VdLFxuICAgIFtcInRvb2xcIiwgdG9vbF1cbiAgXS5maWx0ZXIoKFssIHZhbHVlXSkgPT4gISF2YWx1ZSkubWFwKChwYXJ0KSA9PiBwYXJ0LmpvaW4oXCI9XCIpKS5qb2luKFwiO1wiKSA6IHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURhdGFBdHRyaWJ1dGUocHJvcHMpIHtcbiAgZnVuY3Rpb24gbm9ybWFsaXplUGF0aChwYXRoKSB7XG4gICAgcmV0dXJuIHBhdGggPyB0eXBlb2YgcGF0aCA9PSBcInN0cmluZ1wiID8gc3R1ZGlvUGF0aC5mcm9tU3RyaW5nKHBhdGgpIDogcGF0aCA6IFtdO1xuICB9XG4gIGZ1bmN0aW9uIHRvU3RyaW5nKHByb3BzMikge1xuICAgIGlmICghcHJvcHMyLmlkKSB0aHJvdyBuZXcgRXJyb3IoXCJgaWRgIGlzIHJlcXVpcmVkIHRvIGNyZWF0ZSBhIGRhdGEgYXR0cmlidXRlXCIpO1xuICAgIGlmICghcHJvcHMyLnR5cGUpIHRocm93IG5ldyBFcnJvcihcImB0eXBlYCBpcyByZXF1aXJlZCB0byBjcmVhdGUgYSBkYXRhIGF0dHJpYnV0ZVwiKTtcbiAgICBpZiAoIXByb3BzMi5wYXRoIHx8ICFwcm9wczIucGF0aC5sZW5ndGgpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJgcGF0aGAgaXMgcmVxdWlyZWQgdG8gY3JlYXRlIGEgZGF0YSBhdHRyaWJ1dGVcIik7XG4gICAgY29uc3QgYXR0cnMgPSB7XG4gICAgICBiYXNlVXJsOiBwcm9wczIuYmFzZVVybCB8fCBcIi9cIixcbiAgICAgIHdvcmtzcGFjZTogcHJvcHMyLndvcmtzcGFjZSxcbiAgICAgIHRvb2w6IHByb3BzMi50b29sLFxuICAgICAgdHlwZTogcHJvcHMyLnR5cGUsXG4gICAgICBpZDogcHJvcHMyLmlkLFxuICAgICAgcGF0aDogdHlwZW9mIHByb3BzMi5wYXRoID09IFwic3RyaW5nXCIgPyBwcm9wczIucGF0aCA6IHN0dWRpb1BhdGgudG9TdHJpbmcocHJvcHMyLnBhdGgpLFxuICAgICAgcGVyc3BlY3RpdmU6IHByb3BzMi5wZXJzcGVjdGl2ZVxuICAgIH07XG4gICAgcmV0dXJuIGVuY29kZVNhbml0eU5vZGVEYXRhKGF0dHJzKTtcbiAgfVxuICBjb25zdCBEYXRhQXR0cmlidXRlID0gKHBhdGgpID0+IHRvU3RyaW5nKHtcbiAgICAuLi5wcm9wcyxcbiAgICBwYXRoOiBbLi4ubm9ybWFsaXplUGF0aChwcm9wcy5wYXRoKSwgLi4ubm9ybWFsaXplUGF0aChwYXRoKV1cbiAgfSk7XG4gIHJldHVybiBEYXRhQXR0cmlidXRlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRvU3RyaW5nKHByb3BzKTtcbiAgfSwgRGF0YUF0dHJpYnV0ZS5jb21iaW5lID0gZnVuY3Rpb24oYXR0cnMpIHtcbiAgICByZXR1cm4gY3JlYXRlRGF0YUF0dHJpYnV0ZSh7XG4gICAgICAuLi5wcm9wcyxcbiAgICAgIC4uLmF0dHJzXG4gICAgfSk7XG4gIH0sIERhdGFBdHRyaWJ1dGUuc2NvcGUgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZURhdGFBdHRyaWJ1dGUoe1xuICAgICAgLi4ucHJvcHMsXG4gICAgICBwYXRoOiBbLi4ubm9ybWFsaXplUGF0aChwcm9wcy5wYXRoKSwgLi4ubm9ybWFsaXplUGF0aChwYXRoKV1cbiAgICB9KTtcbiAgfSwgRGF0YUF0dHJpYnV0ZTtcbn1cbmNvbnN0IFJFX1NFR01FTlRfV0lUSF9JTkRFWCA9IC9eKFtcXHctXSspOigwfFsxLTldWzAtOV0qKSQvLCBSRV9TRUdNRU5UX1dJVEhfVFVQTEUgPSAvXihbXFx3LV0rKTooWzAtOV0rKSwoWzAtOV0rKSQvLCBSRV9TRUdNRU5UX1dJVEhfS0VZID0gL14oW1xcdy1dKyk6KFtcXHctXSspJC87XG5mdW5jdGlvbiB1cmxTdHJpbmdUb1BhdGgoc3RyKSB7XG4gIGNvbnN0IHBhdGggPSBbXTtcbiAgZm9yIChjb25zdCBzZWdtZW50IG9mIHN0ci5zcGxpdChcIi5cIikpIHtcbiAgICBjb25zdCB3aXRoSW5kZXggPSBSRV9TRUdNRU5UX1dJVEhfSU5ERVguZXhlYyhzZWdtZW50KTtcbiAgICBpZiAod2l0aEluZGV4KSB7XG4gICAgICBwYXRoLnB1c2god2l0aEluZGV4WzFdLCBOdW1iZXIod2l0aEluZGV4WzJdKSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3Qgd2l0aFR1cGxlID0gUkVfU0VHTUVOVF9XSVRIX1RVUExFLmV4ZWMoc2VnbWVudCk7XG4gICAgaWYgKHdpdGhUdXBsZSkge1xuICAgICAgcGF0aC5wdXNoKHdpdGhUdXBsZVsxXSwgW051bWJlcih3aXRoVHVwbGVbMl0pLCBOdW1iZXIod2l0aFR1cGxlWzNdKV0pO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHdpdGhLZXkgPSBSRV9TRUdNRU5UX1dJVEhfS0VZLmV4ZWMoc2VnbWVudCk7XG4gICAgaWYgKHdpdGhLZXkpIHtcbiAgICAgIHBhdGgucHVzaCh3aXRoS2V5WzFdLCB7IF9rZXk6IHdpdGhLZXlbMl0gfSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgcGF0aC5wdXNoKHNlZ21lbnQpO1xuICB9XG4gIHJldHVybiBwYXRoO1xufVxuY29uc3QgbGVuZ3RoeVN0ciA9IHBpcGUoc3RyaW5nKCksIG1pbkxlbmd0aCgxKSksIHNhbml0eUxlZ2FjeU5vZGVTY2hlbWEgPSBvYmplY3Qoe1xuICBvcmlnaW46IGxlbmd0aHlTdHIsXG4gIGhyZWY6IGxlbmd0aHlTdHIsXG4gIGRhdGE6IG9wdGlvbmFsKHJlY29yZChzdHJpbmcoKSwgdW5rbm93bigpKSlcbn0pO1xuZnVuY3Rpb24gZGVjb2RlU2FuaXR5U3RyaW5nKHN0cikge1xuICBjb25zdCBkYXRhID0gc3RyLnNwbGl0KFwiO1wiKS5yZWR1Y2UoKGFjYywgc2VnbWVudCkgPT4ge1xuICAgIGNvbnN0IFtrZXksIHZhbHVlXSA9IHNlZ21lbnQuc3BsaXQoXCI9XCIpO1xuICAgIGlmICgha2V5IHx8IHNlZ21lbnQuaW5jbHVkZXMoXCI9XCIpICYmICF2YWx1ZSkgcmV0dXJuIGFjYztcbiAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgY2FzZSBcImlkXCI6XG4gICAgICAgIGFjYy5pZCA9IHZhbHVlO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJ0eXBlXCI6XG4gICAgICAgIGFjYy50eXBlID0gdmFsdWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInBhdGhcIjpcbiAgICAgICAgYWNjLnBhdGggPSBzdHVkaW9QYXRoLnRvU3RyaW5nKHVybFN0cmluZ1RvUGF0aCh2YWx1ZSkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJiYXNlXCI6XG4gICAgICAgIGFjYy5iYXNlVXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicGVyc3BlY3RpdmVcIjpcbiAgICAgICAgYWNjLnBlcnNwZWN0aXZlID0gdmFsdWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInRvb2xcIjpcbiAgICAgICAgYWNjLnRvb2wgPSB2YWx1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwid29ya3NwYWNlXCI6XG4gICAgICAgIGFjYy53b3Jrc3BhY2UgPSB2YWx1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicHJvamVjdElkXCI6XG4gICAgICAgIGFjYy5wcm9qZWN0SWQgPSB2YWx1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiZGF0YXNldFwiOlxuICAgICAgICBhY2MuZGF0YXNldCA9IHZhbHVlO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuICBpZiAoaXNWYWxpZFNhbml0eU5vZGUoZGF0YSkpXG4gICAgcmV0dXJuIGRhdGE7XG59XG5mdW5jdGlvbiBkZWNvZGVTYW5pdHlPYmplY3QoZGF0YSkge1xuICBjb25zdCBzYW5pdHlOb2RlID0gc2FmZVBhcnNlKHNhbml0eU5vZGVTY2hlbWEsIGRhdGEpO1xuICBpZiAoc2FuaXR5Tm9kZS5zdWNjZXNzKVxuICAgIHJldHVybiBzYW5pdHlOb2RlLm91dHB1dDtcbiAgY29uc3Qgc2FuaXR5TGVnYWN5Tm9kZSA9IHNhZmVQYXJzZShzYW5pdHlMZWdhY3lOb2RlU2NoZW1hLCBkYXRhKTtcbiAgaWYgKHNhbml0eUxlZ2FjeU5vZGUuc3VjY2VzcylcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChcbiAgICAgICAgc2FuaXR5TGVnYWN5Tm9kZS5vdXRwdXQuaHJlZixcbiAgICAgICAgdHlwZW9mIGRvY3VtZW50ID4gXCJ1XCIgPyBcImh0dHBzOi8vZXhhbXBsZS5jb21cIiA6IGxvY2F0aW9uLm9yaWdpblxuICAgICAgKTtcbiAgICAgIHJldHVybiB1cmwuc2VhcmNoUGFyYW1zLnNpemUgPiAwID8gcGFyc2Uoc2FuaXR5Tm9kZVNjaGVtYSwgT2JqZWN0LmZyb21FbnRyaWVzKHVybC5zZWFyY2hQYXJhbXMuZW50cmllcygpKSkgOiBzYW5pdHlMZWdhY3lOb2RlLm91dHB1dDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBhcnNlIHNhbml0eSBub2RlXCIsIGVyciksIHNhbml0eUxlZ2FjeU5vZGUub3V0cHV0O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRlY29kZVNhbml0eU5vZGVEYXRhKGRhdGEpIHtcbiAgaWYgKHR5cGVvZiBkYXRhID09IFwib2JqZWN0XCIgJiYgZGF0YSAhPT0gbnVsbClcbiAgICByZXR1cm4gZGVjb2RlU2FuaXR5T2JqZWN0KGRhdGEpO1xuICB0cnkge1xuICAgIGNvbnN0IG9iaiA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgcmV0dXJuIGRlY29kZVNhbml0eU9iamVjdChvYmopO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZGVjb2RlU2FuaXR5U3RyaW5nKGRhdGEpO1xuICB9XG59XG5leHBvcnQge1xuICBjcmVhdGVEYXRhQXR0cmlidXRlLFxuICBkZWNvZGVTYW5pdHlOb2RlRGF0YSxcbiAgZW5jb2RlU2FuaXR5Tm9kZURhdGEsXG4gIHBhdGhUb1VybFN0cmluZyxcbiAgdXJsU3RyaW5nVG9QYXRoXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing-csm/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InsertMenu: () => (/* binding */ InsertMenu),\n/* harmony export */   InsertMenuPopover: () => (/* binding */ InsertMenuPopover),\n/* harmony export */   PointerEvents: () => (/* binding */ PointerEvents),\n/* harmony export */   PopoverBackground: () => (/* binding */ PopoverBackground),\n/* harmony export */   PopoverPortal: () => (/* binding */ PopoverPortal),\n/* harmony export */   TelemetryContext: () => (/* binding */ TelemetryContext),\n/* harmony export */   events: () => (/* binding */ events),\n/* harmony export */   getNodeIcon: () => (/* binding */ getNodeIcon),\n/* harmony export */   useTelemetry: () => (/* binding */ useTelemetry)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_insert_menu__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/insert-menu */ \"(ssr)/./node_modules/@sanity/insert-menu/dist/index.js\");\n/* harmony import */ var _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/ui/_visual-editing */ \"(ssr)/./node_modules/@sanity/ui/dist/_chunks-es/_visual-editing.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! styled-components */ \"(ssr)/./node_modules/styled-components/dist/styled-components.esm.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/icons */ \"(ssr)/./node_modules/@sanity/icons/dist/index.js\");\n\n\n\n\n\n\n\nfunction getNodeIcon(option) {\n  if (!option) return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CubeIcon, {});\n  if (option.type === \"string\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  if (option.type === \"number\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.NumberIcon, {});\n  const {\n    value: node\n  } = option;\n  if (\"icon\" in option && option.icon)\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n      __html: option.icon\n    } });\n  const {\n    type\n  } = node;\n  if (type === \"string\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  if (type === \"boolean\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CheckmarkCircleIcon, {});\n  if (type === \"number\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.NumberIcon, {});\n  if (type === \"array\" || type === \"union\")\n    return (Array.isArray(node.of) ? node.of : [node.of]).some((n) => \"name\" in n && n.name === \"block\") ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.BlockContentIcon, {}) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.ThListIcon, {});\n  if (type === \"object\") {\n    if (option.name === \"image\")\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.ImageIcon, {});\n    if (option.name === \"block\")\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CubeIcon, {});\n}\nconst scrollBlockStyles = (0,styled_components__WEBPACK_IMPORTED_MODULE_4__.css)`\n  overflow-y: scroll;\n  overscroll-behavior: contain;\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n\n  &:before {\n    content: '';\n    display: block;\n    height: calc(100% + 1px);\n    position: absolute;\n    top: 0;\n    width: 100%;\n    z-index: -1;\n  }\n`, PortalContainer = styled_components__WEBPACK_IMPORTED_MODULE_4__.styled.div`\n  height: 100%;\n  inset: 0;\n  pointer-events: all;\n  position: fixed;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  ${(props) => props.$blockScroll && scrollBlockStyles}\n`, PortalBackground = styled_components__WEBPACK_IMPORTED_MODULE_4__.styled.div`\n  background: transparent;\n  height: 100%;\n  inset: 0;\n  position: absolute;\n  width: 100%;\n`, PopoverPortal = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(2);\n  let t0;\n  return $[0] !== props ? (t0 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__.Portal, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PopoverBackground, { ...props }) }), $[0] = props, $[1] = t0) : t0 = $[1], t0;\n}, PopoverBackground = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(7), {\n    children,\n    onDismiss,\n    setBoundaryElement,\n    blockScroll: t0\n  } = props, blockScroll = t0 === void 0 ? !0 : t0, handleClick = _temp$1;\n  let t1;\n  $[0] !== onDismiss ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PortalBackground, { onMouseDownCapture: () => {\n    onDismiss?.();\n  } }), $[0] = onDismiss, $[1] = t1) : t1 = $[1];\n  let t2;\n  return $[2] !== blockScroll || $[3] !== children || $[4] !== setBoundaryElement || $[5] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(PortalContainer, { \"data-sanity-overlay-element\": !0, ref: setBoundaryElement, onClick: handleClick, $blockScroll: blockScroll, children: [\n    t1,\n    children\n  ] }), $[2] = blockScroll, $[3] = children, $[4] = setBoundaryElement, $[5] = t1, $[6] = t2) : t2 = $[6], t2;\n};\nfunction _temp$1(event) {\n  event.stopPropagation();\n}\nfunction defineEvent(options) {\n  return {\n    type: \"log\",\n    name: options.name,\n    version: options.version,\n    description: options.description,\n    maxSampleRate: options.maxSampleRate,\n    schema: void 0\n  };\n}\nconst events = {\n  \"Visual Editing Drag Sequence Completed\": defineEvent({\n    name: \"Visual Editing Drag Sequence Completed\",\n    description: \"An array is successfully reordered using drag and drop.\",\n    version: 1\n  }),\n  \"Visual Editing Drag Minimap Enabled\": defineEvent({\n    name: \"Visual Editing Drag Minimap Enabled\",\n    description: \"The zoomed-out minimap view is enabled during a drag sequence.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Removed\": defineEvent({\n    name: \"Visual Editing Context Menu Item Removed\",\n    description: \"An item is removed using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Duplicated\": defineEvent({\n    name: \"Visual Editing Context Menu Item Duplicated\",\n    description: \"An item is duplicated using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Moved\": defineEvent({\n    name: \"Visual Editing Context Menu Item Moved\",\n    description: \"An item is moved using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Inserted\": defineEvent({\n    name: \"Visual Editing Context Menu Item Inserted\",\n    description: \"An item is inserted using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Insert Menu Item Inserted\": defineEvent({\n    name: \"Visual Editing Insert Menu Item Inserted\",\n    description: \"An item is inserted using the Insert Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Overlay Clicked\": defineEvent({\n    name: \"Visual Editing Overlay Clicked\",\n    description: \"An Overlay is clicked.\",\n    version: 1\n  })\n}, TelemetryContext = (0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(void 0);\nfunction useTelemetry() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(TelemetryContext);\n  if (!context)\n    throw new Error(\"Telemetry context is missing\");\n  return context;\n}\nconst labels = {\n  \"insert-menu.filter.all-items\": \"All\",\n  \"insert-menu.search.no-results\": \"No results\",\n  \"insert-menu.search.placeholder\": \"Filter types\\u2026\",\n  \"insert-menu.toggle-grid-view.tooltip\": \"Toggle grid view\",\n  \"insert-menu.toggle-list-view.tooltip\": \"Toggle list view\"\n}, InsertMenu = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(11), {\n    node,\n    onSelect\n  } = props;\n  let t0;\n  $[0] !== node.options?.insertMenu ? (t0 = node.options?.insertMenu || {}, $[0] = node.options?.insertMenu, $[1] = t0) : t0 = $[1];\n  const insertMenuOptions = t0;\n  let t1;\n  $[2] !== insertMenuOptions.views ? (t1 = insertMenuOptions.views?.map(_temp), $[2] = insertMenuOptions.views, $[3] = t1) : t1 = $[3];\n  const views = t1;\n  let t2;\n  $[4] !== node.of ? (t2 = node.of.map(_temp2), $[4] = node.of, $[5] = t2) : t2 = $[5];\n  let t3;\n  return $[6] !== insertMenuOptions || $[7] !== onSelect || $[8] !== t2 || $[9] !== views ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_insert_menu__WEBPACK_IMPORTED_MODULE_6__.InsertMenu, { ...insertMenuOptions, labels, schemaTypes: t2, onSelect, views }), $[6] = insertMenuOptions, $[7] = onSelect, $[8] = t2, $[9] = views, $[10] = t3) : t3 = $[10], t3;\n}, InsertMenuPopover = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(11), {\n    node,\n    onDismiss,\n    onSelect,\n    referenceElement\n  } = props;\n  let t0;\n  $[0] !== node || $[1] !== onSelect ? (t0 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(InsertMenu, { node, onSelect }), $[0] = node, $[1] = onSelect, $[2] = t0) : t0 = $[2];\n  const popoverContent = t0, width = (node.options?.insertMenu || {}).views?.some(_temp3) ? 0 : void 0;\n  let t1;\n  $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = [\"bottom\"], $[3] = t1) : t1 = $[3];\n  let t2;\n  $[4] !== popoverContent || $[5] !== referenceElement || $[6] !== width ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__.Popover, { animate: !0, constrainSize: !0, content: popoverContent, fallbackPlacements: t1, open: !0, placement: \"top\", preventOverflow: !0, referenceElement, width }), $[4] = popoverContent, $[5] = referenceElement, $[6] = width, $[7] = t2) : t2 = $[7];\n  let t3;\n  return $[8] !== onDismiss || $[9] !== t2 ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PopoverPortal, { onDismiss, children: t2 }), $[8] = onDismiss, $[9] = t2, $[10] = t3) : t3 = $[10], t3;\n};\nfunction _temp(view) {\n  return view.name === \"grid\" ? {\n    ...view,\n    previewImageUrl: (name) => view.previewImageUrls?.[name]\n  } : view;\n}\nfunction _temp2(type) {\n  return {\n    ...type,\n    icon: getNodeIcon(type)\n  };\n}\nfunction _temp3(view) {\n  return view.name === \"grid\";\n}\nconst PointerEvents = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(10);\n  let children, rest, style;\n  $[0] !== t0 ? ({\n    children,\n    style,\n    ...rest\n  } = t0, $[0] = t0, $[1] = children, $[2] = rest, $[3] = style) : (children = $[1], rest = $[2], style = $[3]);\n  let t1;\n  $[4] !== style ? (t1 = {\n    ...style,\n    pointerEvents: \"all\"\n  }, $[4] = style, $[5] = t1) : t1 = $[5];\n  let t2;\n  return $[6] !== children || $[7] !== rest || $[8] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { style: t1, \"data-sanity-overlay-element\": !0, ...rest, children }), $[6] = children, $[7] = rest, $[8] = t1, $[9] = t2) : t2 = $[9], t2;\n};\n\n//# sourceMappingURL=PointerEvents.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL1BvaW50ZXJFdmVudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFrRDtBQUNKO0FBQ0g7QUFDc0I7QUFDSjtBQUNiO0FBQytFO0FBQy9IO0FBQ0Esc0NBQXNDLHNEQUFHLENBQUMsbURBQVEsSUFBSTtBQUN0RDtBQUNBLDJCQUEyQixzREFBRyxDQUFDLHFEQUFVLElBQUk7QUFDN0M7QUFDQSwyQkFBMkIsc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQzdDO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSwyQkFBMkIsc0RBQUcsVUFBVTtBQUN4QztBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsMkJBQTJCLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUM3QztBQUNBLDJCQUEyQixzREFBRyxDQUFDLDhEQUFtQixJQUFJO0FBQ3REO0FBQ0EsMkJBQTJCLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUM3QztBQUNBLDJIQUEySCxzREFBRyxDQUFDLDJEQUFnQixJQUFJLG9CQUFvQixzREFBRyxDQUFDLHFEQUFVLElBQUk7QUFDekw7QUFDQTtBQUNBLDZCQUE2QixzREFBRyxDQUFDLG9EQUFTLElBQUk7QUFDOUM7QUFDQSw2QkFBNkIsc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQy9DO0FBQ0EseUJBQXlCLHNEQUFHLENBQUMsbURBQVEsSUFBSTtBQUN6QztBQUNBLDBCQUEwQixzREFBRztBQUM3QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIscURBQU07QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxJQUFJO0FBQ0osc0JBQXNCLHFEQUFNO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBLGdEQUFnRCxzREFBRyxDQUFDLDZEQUFNLElBQUksMEJBQTBCLHNEQUFHLHNCQUFzQixVQUFVLEdBQUc7QUFDOUgsQ0FBQztBQUNELFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLDZDQUE2QyxzREFBRyxxQkFBcUI7QUFDckU7QUFDQSxLQUFLO0FBQ0w7QUFDQSx5SEFBeUgsdURBQUksb0JBQW9CO0FBQ2pKO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQ0FBQyxxQkFBcUIsb0RBQWE7QUFDbkM7QUFDQSxrQkFBa0IsaURBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrSEFBa0gsc0RBQUcsQ0FBQywyREFBWSxJQUFJLGdFQUFnRTtBQUN0TSxDQUFDO0FBQ0QsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsNkRBQTZELHNEQUFHLGVBQWUsZ0JBQWdCO0FBQy9GLG9FQUFvRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQSxpR0FBaUcsc0RBQUcsQ0FBQyw4REFBTyxJQUFJLDJKQUEySjtBQUMzUTtBQUNBLG1FQUFtRSxzREFBRyxrQkFBa0IseUJBQXlCO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsbUZBQW1GLHNEQUFHLFVBQVUsaUVBQWlFO0FBQ2pLO0FBV0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2ZWRpYW4tbmV3c3Jvb20vLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL1BvaW50ZXJFdmVudHMuanM/ODU3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBqc3gsIGpzeHMgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbmltcG9ydCB7IGMgfSBmcm9tIFwicmVhY3QtY29tcGlsZXItcnVudGltZVwiO1xuaW1wb3J0IHsgSW5zZXJ0TWVudSBhcyBJbnNlcnRNZW51JDEgfSBmcm9tIFwiQHNhbml0eS9pbnNlcnQtbWVudVwiO1xuaW1wb3J0IHsgUG9ydGFsLCBQb3BvdmVyIH0gZnJvbSBcIkBzYW5pdHkvdWkvX3Zpc3VhbC1lZGl0aW5nXCI7XG5pbXBvcnQgeyBjc3MsIHN0eWxlZCB9IGZyb20gXCJzdHlsZWQtY29tcG9uZW50c1wiO1xuaW1wb3J0IHsgQ3ViZUljb24sIFN0cmluZ0ljb24sIE51bWJlckljb24sIENoZWNrbWFya0NpcmNsZUljb24sIEJsb2NrQ29udGVudEljb24sIFRoTGlzdEljb24sIEltYWdlSWNvbiB9IGZyb20gXCJAc2FuaXR5L2ljb25zXCI7XG5mdW5jdGlvbiBnZXROb2RlSWNvbihvcHRpb24pIHtcbiAgaWYgKCFvcHRpb24pIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KEN1YmVJY29uLCB7fSk7XG4gIGlmIChvcHRpb24udHlwZSA9PT0gXCJzdHJpbmdcIilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChTdHJpbmdJY29uLCB7fSk7XG4gIGlmIChvcHRpb24udHlwZSA9PT0gXCJudW1iZXJcIilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChOdW1iZXJJY29uLCB7fSk7XG4gIGNvbnN0IHtcbiAgICB2YWx1ZTogbm9kZVxuICB9ID0gb3B0aW9uO1xuICBpZiAoXCJpY29uXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5pY29uKVxuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICAgIF9faHRtbDogb3B0aW9uLmljb25cbiAgICB9IH0pO1xuICBjb25zdCB7XG4gICAgdHlwZVxuICB9ID0gbm9kZTtcbiAgaWYgKHR5cGUgPT09IFwic3RyaW5nXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goU3RyaW5nSWNvbiwge30pO1xuICBpZiAodHlwZSA9PT0gXCJib29sZWFuXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goQ2hlY2ttYXJrQ2lyY2xlSWNvbiwge30pO1xuICBpZiAodHlwZSA9PT0gXCJudW1iZXJcIilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChOdW1iZXJJY29uLCB7fSk7XG4gIGlmICh0eXBlID09PSBcImFycmF5XCIgfHwgdHlwZSA9PT0gXCJ1bmlvblwiKVxuICAgIHJldHVybiAoQXJyYXkuaXNBcnJheShub2RlLm9mKSA/IG5vZGUub2YgOiBbbm9kZS5vZl0pLnNvbWUoKG4pID0+IFwibmFtZVwiIGluIG4gJiYgbi5uYW1lID09PSBcImJsb2NrXCIpID8gLyogQF9fUFVSRV9fICovIGpzeChCbG9ja0NvbnRlbnRJY29uLCB7fSkgOiAvKiBAX19QVVJFX18gKi8ganN4KFRoTGlzdEljb24sIHt9KTtcbiAgaWYgKHR5cGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICBpZiAob3B0aW9uLm5hbWUgPT09IFwiaW1hZ2VcIilcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KEltYWdlSWNvbiwge30pO1xuICAgIGlmIChvcHRpb24ubmFtZSA9PT0gXCJibG9ja1wiKVxuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goU3RyaW5nSWNvbiwge30pO1xuICB9XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KEN1YmVJY29uLCB7fSk7XG59XG5jb25zdCBzY3JvbGxCbG9ja1N0eWxlcyA9IGNzc2BcbiAgb3ZlcmZsb3cteTogc2Nyb2xsO1xuICBvdmVyc2Nyb2xsLWJlaGF2aW9yOiBjb250YWluO1xuICAtbXMtb3ZlcmZsb3ctc3R5bGU6IG5vbmU7XG4gIHNjcm9sbGJhci13aWR0aDogbm9uZTtcblxuICAmOmJlZm9yZSB7XG4gICAgY29udGVudDogJyc7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgaGVpZ2h0OiBjYWxjKDEwMCUgKyAxcHgpO1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB0b3A6IDA7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgei1pbmRleDogLTE7XG4gIH1cbmAsIFBvcnRhbENvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGhlaWdodDogMTAwJTtcbiAgaW5zZXQ6IDA7XG4gIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgd2lkdGg6IDEwMCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gICR7KHByb3BzKSA9PiBwcm9wcy4kYmxvY2tTY3JvbGwgJiYgc2Nyb2xsQmxvY2tTdHlsZXN9XG5gLCBQb3J0YWxCYWNrZ3JvdW5kID0gc3R5bGVkLmRpdmBcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gIGhlaWdodDogMTAwJTtcbiAgaW5zZXQ6IDA7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDEwMCU7XG5gLCBQb3BvdmVyUG9ydGFsID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDIpO1xuICBsZXQgdDA7XG4gIHJldHVybiAkWzBdICE9PSBwcm9wcyA/ICh0MCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9ydGFsLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFBvcG92ZXJCYWNrZ3JvdW5kLCB7IC4uLnByb3BzIH0pIH0pLCAkWzBdID0gcHJvcHMsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV0sIHQwO1xufSwgUG9wb3ZlckJhY2tncm91bmQgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoNyksIHtcbiAgICBjaGlsZHJlbixcbiAgICBvbkRpc21pc3MsXG4gICAgc2V0Qm91bmRhcnlFbGVtZW50LFxuICAgIGJsb2NrU2Nyb2xsOiB0MFxuICB9ID0gcHJvcHMsIGJsb2NrU2Nyb2xsID0gdDAgPT09IHZvaWQgMCA/ICEwIDogdDAsIGhhbmRsZUNsaWNrID0gX3RlbXAkMTtcbiAgbGV0IHQxO1xuICAkWzBdICE9PSBvbkRpc21pc3MgPyAodDEgPSAvKiBAX19QVVJFX18gKi8ganN4KFBvcnRhbEJhY2tncm91bmQsIHsgb25Nb3VzZURvd25DYXB0dXJlOiAoKSA9PiB7XG4gICAgb25EaXNtaXNzPy4oKTtcbiAgfSB9KSwgJFswXSA9IG9uRGlzbWlzcywgJFsxXSA9IHQxKSA6IHQxID0gJFsxXTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFsyXSAhPT0gYmxvY2tTY3JvbGwgfHwgJFszXSAhPT0gY2hpbGRyZW4gfHwgJFs0XSAhPT0gc2V0Qm91bmRhcnlFbGVtZW50IHx8ICRbNV0gIT09IHQxID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeHMoUG9ydGFsQ29udGFpbmVyLCB7IFwiZGF0YS1zYW5pdHktb3ZlcmxheS1lbGVtZW50XCI6ICEwLCByZWY6IHNldEJvdW5kYXJ5RWxlbWVudCwgb25DbGljazogaGFuZGxlQ2xpY2ssICRibG9ja1Njcm9sbDogYmxvY2tTY3JvbGwsIGNoaWxkcmVuOiBbXG4gICAgdDEsXG4gICAgY2hpbGRyZW5cbiAgXSB9KSwgJFsyXSA9IGJsb2NrU2Nyb2xsLCAkWzNdID0gY2hpbGRyZW4sICRbNF0gPSBzZXRCb3VuZGFyeUVsZW1lbnQsICRbNV0gPSB0MSwgJFs2XSA9IHQyKSA6IHQyID0gJFs2XSwgdDI7XG59O1xuZnVuY3Rpb24gX3RlbXAkMShldmVudCkge1xuICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbn1cbmZ1bmN0aW9uIGRlZmluZUV2ZW50KG9wdGlvbnMpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBcImxvZ1wiLFxuICAgIG5hbWU6IG9wdGlvbnMubmFtZSxcbiAgICB2ZXJzaW9uOiBvcHRpb25zLnZlcnNpb24sXG4gICAgZGVzY3JpcHRpb246IG9wdGlvbnMuZGVzY3JpcHRpb24sXG4gICAgbWF4U2FtcGxlUmF0ZTogb3B0aW9ucy5tYXhTYW1wbGVSYXRlLFxuICAgIHNjaGVtYTogdm9pZCAwXG4gIH07XG59XG5jb25zdCBldmVudHMgPSB7XG4gIFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBTZXF1ZW5jZSBDb21wbGV0ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBTZXF1ZW5jZSBDb21wbGV0ZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJBbiBhcnJheSBpcyBzdWNjZXNzZnVsbHkgcmVvcmRlcmVkIHVzaW5nIGRyYWcgYW5kIGRyb3AuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBEcmFnIE1pbmltYXAgRW5hYmxlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBEcmFnIE1pbmltYXAgRW5hYmxlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB6b29tZWQtb3V0IG1pbmltYXAgdmlldyBpcyBlbmFibGVkIGR1cmluZyBhIGRyYWcgc2VxdWVuY2UuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBSZW1vdmVkXCI6IGRlZmluZUV2ZW50KHtcbiAgICBuYW1lOiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIFJlbW92ZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJBbiBpdGVtIGlzIHJlbW92ZWQgdXNpbmcgdGhlIENvbnRleHQgTWVudS5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIER1cGxpY2F0ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gRHVwbGljYXRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgZHVwbGljYXRlZCB1c2luZyB0aGUgQ29udGV4dCBNZW51LlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSksXG4gIFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJBbiBpdGVtIGlzIG1vdmVkIHVzaW5nIHRoZSBDb250ZXh0IE1lbnUuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgaW5zZXJ0ZWQgdXNpbmcgdGhlIENvbnRleHQgTWVudS5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIEluc2VydCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgSW5zZXJ0IE1lbnUgSXRlbSBJbnNlcnRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgaW5zZXJ0ZWQgdXNpbmcgdGhlIEluc2VydCBNZW51LlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSksXG4gIFwiVmlzdWFsIEVkaXRpbmcgT3ZlcmxheSBDbGlja2VkXCI6IGRlZmluZUV2ZW50KHtcbiAgICBuYW1lOiBcIlZpc3VhbCBFZGl0aW5nIE92ZXJsYXkgQ2xpY2tlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIE92ZXJsYXkgaXMgY2xpY2tlZC5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pXG59LCBUZWxlbWV0cnlDb250ZXh0ID0gY3JlYXRlQ29udGV4dCh2b2lkIDApO1xuZnVuY3Rpb24gdXNlVGVsZW1ldHJ5KCkge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChUZWxlbWV0cnlDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KVxuICAgIHRocm93IG5ldyBFcnJvcihcIlRlbGVtZXRyeSBjb250ZXh0IGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiBjb250ZXh0O1xufVxuY29uc3QgbGFiZWxzID0ge1xuICBcImluc2VydC1tZW51LmZpbHRlci5hbGwtaXRlbXNcIjogXCJBbGxcIixcbiAgXCJpbnNlcnQtbWVudS5zZWFyY2gubm8tcmVzdWx0c1wiOiBcIk5vIHJlc3VsdHNcIixcbiAgXCJpbnNlcnQtbWVudS5zZWFyY2gucGxhY2Vob2xkZXJcIjogXCJGaWx0ZXIgdHlwZXNcXHUyMDI2XCIsXG4gIFwiaW5zZXJ0LW1lbnUudG9nZ2xlLWdyaWQtdmlldy50b29sdGlwXCI6IFwiVG9nZ2xlIGdyaWQgdmlld1wiLFxuICBcImluc2VydC1tZW51LnRvZ2dsZS1saXN0LXZpZXcudG9vbHRpcFwiOiBcIlRvZ2dsZSBsaXN0IHZpZXdcIlxufSwgSW5zZXJ0TWVudSA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMSksIHtcbiAgICBub2RlLFxuICAgIG9uU2VsZWN0XG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUgPyAodDAgPSBub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUgfHwge30sICRbMF0gPSBub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IGluc2VydE1lbnVPcHRpb25zID0gdDA7XG4gIGxldCB0MTtcbiAgJFsyXSAhPT0gaW5zZXJ0TWVudU9wdGlvbnMudmlld3MgPyAodDEgPSBpbnNlcnRNZW51T3B0aW9ucy52aWV3cz8ubWFwKF90ZW1wKSwgJFsyXSA9IGluc2VydE1lbnVPcHRpb25zLnZpZXdzLCAkWzNdID0gdDEpIDogdDEgPSAkWzNdO1xuICBjb25zdCB2aWV3cyA9IHQxO1xuICBsZXQgdDI7XG4gICRbNF0gIT09IG5vZGUub2YgPyAodDIgPSBub2RlLm9mLm1hcChfdGVtcDIpLCAkWzRdID0gbm9kZS5vZiwgJFs1XSA9IHQyKSA6IHQyID0gJFs1XTtcbiAgbGV0IHQzO1xuICByZXR1cm4gJFs2XSAhPT0gaW5zZXJ0TWVudU9wdGlvbnMgfHwgJFs3XSAhPT0gb25TZWxlY3QgfHwgJFs4XSAhPT0gdDIgfHwgJFs5XSAhPT0gdmlld3MgPyAodDMgPSAvKiBAX19QVVJFX18gKi8ganN4KEluc2VydE1lbnUkMSwgeyAuLi5pbnNlcnRNZW51T3B0aW9ucywgbGFiZWxzLCBzY2hlbWFUeXBlczogdDIsIG9uU2VsZWN0LCB2aWV3cyB9KSwgJFs2XSA9IGluc2VydE1lbnVPcHRpb25zLCAkWzddID0gb25TZWxlY3QsICRbOF0gPSB0MiwgJFs5XSA9IHZpZXdzLCAkWzEwXSA9IHQzKSA6IHQzID0gJFsxMF0sIHQzO1xufSwgSW5zZXJ0TWVudVBvcG92ZXIgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoMTEpLCB7XG4gICAgbm9kZSxcbiAgICBvbkRpc21pc3MsXG4gICAgb25TZWxlY3QsXG4gICAgcmVmZXJlbmNlRWxlbWVudFxuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gbm9kZSB8fCAkWzFdICE9PSBvblNlbGVjdCA/ICh0MCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goSW5zZXJ0TWVudSwgeyBub2RlLCBvblNlbGVjdCB9KSwgJFswXSA9IG5vZGUsICRbMV0gPSBvblNlbGVjdCwgJFsyXSA9IHQwKSA6IHQwID0gJFsyXTtcbiAgY29uc3QgcG9wb3ZlckNvbnRlbnQgPSB0MCwgd2lkdGggPSAobm9kZS5vcHRpb25zPy5pbnNlcnRNZW51IHx8IHt9KS52aWV3cz8uc29tZShfdGVtcDMpID8gMCA6IHZvaWQgMDtcbiAgbGV0IHQxO1xuICAkWzNdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9IFtcImJvdHRvbVwiXSwgJFszXSA9IHQxKSA6IHQxID0gJFszXTtcbiAgbGV0IHQyO1xuICAkWzRdICE9PSBwb3BvdmVyQ29udGVudCB8fCAkWzVdICE9PSByZWZlcmVuY2VFbGVtZW50IHx8ICRbNl0gIT09IHdpZHRoID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChQb3BvdmVyLCB7IGFuaW1hdGU6ICEwLCBjb25zdHJhaW5TaXplOiAhMCwgY29udGVudDogcG9wb3ZlckNvbnRlbnQsIGZhbGxiYWNrUGxhY2VtZW50czogdDEsIG9wZW46ICEwLCBwbGFjZW1lbnQ6IFwidG9wXCIsIHByZXZlbnRPdmVyZmxvdzogITAsIHJlZmVyZW5jZUVsZW1lbnQsIHdpZHRoIH0pLCAkWzRdID0gcG9wb3ZlckNvbnRlbnQsICRbNV0gPSByZWZlcmVuY2VFbGVtZW50LCAkWzZdID0gd2lkdGgsICRbN10gPSB0MikgOiB0MiA9ICRbN107XG4gIGxldCB0MztcbiAgcmV0dXJuICRbOF0gIT09IG9uRGlzbWlzcyB8fCAkWzldICE9PSB0MiA/ICh0MyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9wb3ZlclBvcnRhbCwgeyBvbkRpc21pc3MsIGNoaWxkcmVuOiB0MiB9KSwgJFs4XSA9IG9uRGlzbWlzcywgJFs5XSA9IHQyLCAkWzEwXSA9IHQzKSA6IHQzID0gJFsxMF0sIHQzO1xufTtcbmZ1bmN0aW9uIF90ZW1wKHZpZXcpIHtcbiAgcmV0dXJuIHZpZXcubmFtZSA9PT0gXCJncmlkXCIgPyB7XG4gICAgLi4udmlldyxcbiAgICBwcmV2aWV3SW1hZ2VVcmw6IChuYW1lKSA9PiB2aWV3LnByZXZpZXdJbWFnZVVybHM/LltuYW1lXVxuICB9IDogdmlldztcbn1cbmZ1bmN0aW9uIF90ZW1wMih0eXBlKSB7XG4gIHJldHVybiB7XG4gICAgLi4udHlwZSxcbiAgICBpY29uOiBnZXROb2RlSWNvbih0eXBlKVxuICB9O1xufVxuZnVuY3Rpb24gX3RlbXAzKHZpZXcpIHtcbiAgcmV0dXJuIHZpZXcubmFtZSA9PT0gXCJncmlkXCI7XG59XG5jb25zdCBQb2ludGVyRXZlbnRzID0gKHQwKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDEwKTtcbiAgbGV0IGNoaWxkcmVuLCByZXN0LCBzdHlsZTtcbiAgJFswXSAhPT0gdDAgPyAoe1xuICAgIGNoaWxkcmVuLFxuICAgIHN0eWxlLFxuICAgIC4uLnJlc3RcbiAgfSA9IHQwLCAkWzBdID0gdDAsICRbMV0gPSBjaGlsZHJlbiwgJFsyXSA9IHJlc3QsICRbM10gPSBzdHlsZSkgOiAoY2hpbGRyZW4gPSAkWzFdLCByZXN0ID0gJFsyXSwgc3R5bGUgPSAkWzNdKTtcbiAgbGV0IHQxO1xuICAkWzRdICE9PSBzdHlsZSA/ICh0MSA9IHtcbiAgICAuLi5zdHlsZSxcbiAgICBwb2ludGVyRXZlbnRzOiBcImFsbFwiXG4gIH0sICRbNF0gPSBzdHlsZSwgJFs1XSA9IHQxKSA6IHQxID0gJFs1XTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFs2XSAhPT0gY2hpbGRyZW4gfHwgJFs3XSAhPT0gcmVzdCB8fCAkWzhdICE9PSB0MSA/ICh0MiA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBzdHlsZTogdDEsIFwiZGF0YS1zYW5pdHktb3ZlcmxheS1lbGVtZW50XCI6ICEwLCAuLi5yZXN0LCBjaGlsZHJlbiB9KSwgJFs2XSA9IGNoaWxkcmVuLCAkWzddID0gcmVzdCwgJFs4XSA9IHQxLCAkWzldID0gdDIpIDogdDIgPSAkWzldLCB0Mjtcbn07XG5leHBvcnQge1xuICBJbnNlcnRNZW51LFxuICBJbnNlcnRNZW51UG9wb3ZlcixcbiAgUG9pbnRlckV2ZW50cyxcbiAgUG9wb3ZlckJhY2tncm91bmQsXG4gIFBvcG92ZXJQb3J0YWwsXG4gIFRlbGVtZXRyeUNvbnRleHQsXG4gIGV2ZW50cyxcbiAgZ2V0Tm9kZUljb24sXG4gIHVzZVRlbGVtZXRyeVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBvaW50ZXJFdmVudHMuanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SharedStateContext: () => (/* binding */ SharedStateContext),\n/* harmony export */   createOverlayController: () => (/* binding */ createOverlayController),\n/* harmony export */   sanityNodesExistInSameArray: () => (/* binding */ sanityNodesExistInSameArray),\n/* harmony export */   useOptimistic: () => (/* binding */ useOptimistic),\n/* harmony export */   v4: () => (/* binding */ v4)\n/* harmony export */ });\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var use_effect_event__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! use-effect-event */ \"(ssr)/./node_modules/use-effect-event/dist/index.js\");\n/* harmony import */ var _context_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var _mutations_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mutations.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\");\n/* harmony import */ var _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sanity/visual-editing-csm */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing-csm/dist/index.js\");\n/* harmony import */ var _vercel_stega__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @vercel/stega */ \"(ssr)/./node_modules/@vercel/stega/dist/index.mjs\");\n\n\n\n\n\n\n\n\nfunction useOptimistic(passthrough, reducer) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(21), [pristine, setPristine] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0), [optimistic, setOptimistic] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(passthrough), [lastEvent, setLastEvent] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null), [lastPassthrough, setLastPassthrough] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(passthrough), actor = (0,_mutations_js__WEBPACK_IMPORTED_MODULE_3__.useOptimisticActor)();\n  let t0;\n  $[0] !== reducer ? (t0 = (action, prevState) => (Array.isArray(reducer) ? reducer : [reducer]).reduce((acc, reducer_0) => reducer_0(acc, {\n    document: action.document,\n    id: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(action.id),\n    originalId: action.id,\n    type: action.type\n  }), prevState), $[0] = reducer, $[1] = t0) : t0 = $[1];\n  const reduceStateFromAction = (0,use_effect_event__WEBPACK_IMPORTED_MODULE_5__.useEffectEvent)(t0);\n  let t1;\n  $[2] !== passthrough ? (t1 = () => setLastPassthrough(passthrough), $[2] = passthrough, $[3] = t1) : t1 = $[3];\n  const updateLastPassthrough = (0,use_effect_event__WEBPACK_IMPORTED_MODULE_5__.useEffectEvent)(t1);\n  let t2;\n  $[4] !== actor || $[5] !== reduceStateFromAction || $[6] !== updateLastPassthrough ? (t2 = () => {\n    if ((0,_context_js__WEBPACK_IMPORTED_MODULE_6__.isEmptyActor)(actor))\n      return;\n    let pristineTimeout;\n    const rebasedSub = actor.on(\"rebased.local\", (_event) => {\n      const event = {\n        document: _event.document,\n        id: _event.id,\n        originalId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(_event.id),\n        type: \"mutate\"\n      };\n      setOptimistic((prevState_0) => reduceStateFromAction(event, prevState_0)), setLastEvent(event), updateLastPassthrough(), setPristine(!1), clearTimeout(pristineTimeout);\n    }), pristineSub = actor.on(\"pristine\", () => {\n      pristineTimeout = setTimeout(() => {\n        (0,react__WEBPACK_IMPORTED_MODULE_1__.startTransition)(() => setPristine(!0));\n      }, 15e3);\n    });\n    return () => {\n      rebasedSub.unsubscribe(), pristineSub.unsubscribe();\n    };\n  }, $[4] = actor, $[5] = reduceStateFromAction, $[6] = updateLastPassthrough, $[7] = t2) : t2 = $[7];\n  let t3;\n  $[8] !== actor ? (t3 = [actor], $[8] = actor, $[9] = t3) : t3 = $[9], (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(t2, t3);\n  let t4;\n  $[10] !== lastEvent || $[11] !== lastPassthrough || $[12] !== passthrough || $[13] !== pristine || $[14] !== reduceStateFromAction ? (t4 = () => {\n    if (!pristine) {\n      if (!lastEvent)\n        throw new Error(\"No last event found when syncing passthrough\");\n      lastPassthrough !== passthrough && (0,react__WEBPACK_IMPORTED_MODULE_1__.startTransition)(() => {\n        setOptimistic(reduceStateFromAction(lastEvent, passthrough)), setLastPassthrough(passthrough);\n      });\n    }\n  }, $[10] = lastEvent, $[11] = lastPassthrough, $[12] = passthrough, $[13] = pristine, $[14] = reduceStateFromAction, $[15] = t4) : t4 = $[15];\n  let t5;\n  return $[16] !== lastEvent || $[17] !== lastPassthrough || $[18] !== passthrough || $[19] !== pristine ? (t5 = [lastEvent, lastPassthrough, passthrough, pristine], $[16] = lastEvent, $[17] = lastPassthrough, $[18] = passthrough, $[19] = pristine, $[20] = t5) : t5 = $[20], (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(t4, t5), pristine ? passthrough : optimistic;\n}\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i)\n  byteToHex.push((i + 256).toString(16).slice(1));\nfunction unsafeStringify(arr, offset = 0) {\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + \"-\" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + \"-\" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + \"-\" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + \"-\" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nfunction rng() {\n  if (!getRandomValues) {\n    if (typeof crypto > \"u\" || !crypto.getRandomValues)\n      throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");\n    getRandomValues = crypto.getRandomValues.bind(crypto);\n  }\n  return getRandomValues(rnds8);\n}\nconst randomUUID = typeof crypto < \"u\" && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nvar native = {\n  randomUUID\n};\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !options)\n    return native.randomUUID();\n  options = options || {};\n  const rnds = options.random ?? options.rng?.() ?? rng();\n  if (rnds.length < 16)\n    throw new Error(\"Random bytes length must be >= 16\");\n  return rnds[6] = rnds[6] & 15 | 64, rnds[8] = rnds[8] & 63 | 128, unsafeStringify(rnds);\n}\nfunction getRect(element) {\n  const domRect = element.getBoundingClientRect();\n  return {\n    x: domRect.x + scrollX,\n    y: domRect.y + scrollY,\n    w: domRect.width,\n    h: domRect.height\n  };\n}\nfunction offsetRect(rect, px, axis) {\n  return axis === \"x\" ? {\n    x: rect.x + px,\n    y: rect.y,\n    w: rect.w - 2 * px,\n    h: rect.h\n  } : {\n    x: rect.x,\n    y: rect.y + px,\n    w: rect.w,\n    h: rect.h - 2 * px\n  };\n}\nfunction rayIntersect(l1, l2) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2\n  } = l1, {\n    x1: x3,\n    y1: y3,\n    x2: x4,\n    y2: y4\n  } = l2;\n  if (x1 === x2 && y1 === y2 || x3 === x4 && y3 === y4)\n    return !1;\n  const denominator = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\n  if (denominator === 0)\n    return !1;\n  const ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator, ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator;\n  if (ua < 0 || ua > 1 || ub < 0 || ub > 1)\n    return !1;\n  const x = x1 + ua * (x2 - x1), y = y1 + ua * (y2 - y1);\n  return {\n    x,\n    y\n  };\n}\nfunction rectEqual(r1, r2) {\n  return r1.x === r2.x && r1.y === r2.y && r1.w === r2.w && r1.h === r2.h;\n}\nfunction rayRectIntersections(line, rect) {\n  const rectLines = [{\n    x1: rect.x,\n    y1: rect.y,\n    x2: rect.x + rect.w,\n    y2: rect.y\n  }, {\n    x1: rect.x + rect.w,\n    y1: rect.y,\n    x2: rect.x + rect.w,\n    y2: rect.y + rect.h\n  }, {\n    x1: rect.x + rect.w,\n    y1: rect.y + rect.h,\n    x2: rect.x,\n    y2: rect.y + rect.h\n  }, {\n    x1: rect.x,\n    y1: rect.y + rect.h,\n    x2: rect.x,\n    y2: rect.y\n  }], intersections = [];\n  for (let i = 0; i < rectLines.length; i++) {\n    const intersection = rayIntersect(line, rectLines[i]);\n    if (intersection) {\n      let isDuplicate = !1;\n      for (let j = 0; j < intersections.length; j++)\n        intersections[j].x === intersection.x && intersections[j].y === intersection.y && (isDuplicate = !0);\n      isDuplicate || intersections.push(intersection);\n    }\n  }\n  return intersections.length === 0 ? !1 : intersections.sort((a, b) => pointDist(a, {\n    x: line.x1,\n    y: line.y1\n  }) - pointDist(b, {\n    x: line.x1,\n    y: line.y1\n  }));\n}\nfunction pointDist(p1, p2) {\n  const a = p1.x - p2.x, b = p1.y - p2.y;\n  return Math.sqrt(a * a + b * b);\n}\nfunction pointInBounds(point, bounds) {\n  const withinX = point.x >= bounds.x && point.x <= bounds.x + bounds.w, withinY = point.y >= bounds.y && point.y <= bounds.y + bounds.h;\n  return withinX && withinY;\n}\nfunction findClosestIntersection(ray, targets, flow) {\n  const rayOrigin = {\n    x: ray.x1,\n    y: ray.y1\n  };\n  if (targets.some((t) => pointInBounds(rayOrigin, offsetRect(t, Math.min(t.w, t.h) / 10, flow === \"horizontal\" ? \"x\" : \"y\")))) return null;\n  let closestIntersection, closestRect;\n  for (const target of targets) {\n    const intersections = rayRectIntersections(ray, offsetRect(target, Math.min(target.w, target.h) / 10, flow === \"horizontal\" ? \"x\" : \"y\"));\n    if (intersections) {\n      const firstIntersection = intersections[0];\n      closestIntersection ? pointDist(rayOrigin, firstIntersection) < pointDist(rayOrigin, closestIntersection) && (closestIntersection = firstIntersection, closestRect = target) : (closestIntersection = firstIntersection, closestRect = target);\n    }\n  }\n  return closestRect || null;\n}\nfunction scaleRect(rect, scale, origin) {\n  const {\n    x,\n    y,\n    w,\n    h\n  } = rect, {\n    x: originX,\n    y: originY\n  } = origin, newX = originX + (x - originX) * scale, newY = originY + (y - originY) * scale, newWidth = w * scale, newHeight = h * scale;\n  return {\n    x: newX,\n    y: newY,\n    w: newWidth,\n    h: newHeight\n  };\n}\nfunction getRectGroupXExtent(rects) {\n  const minGroupX = Math.max(0, Math.min(...rects.map((r) => r.x))), maxGroupX = Math.min(document.body.offsetWidth, Math.max(...rects.map((r) => r.x + r.w)));\n  return {\n    min: minGroupX,\n    max: maxGroupX,\n    width: maxGroupX - minGroupX\n  };\n}\nfunction getRectGroupYExtent(rects) {\n  const minGroupY = Math.max(0, Math.min(...rects.map((r) => r.y))), maxGroupY = Math.min(document.body.scrollHeight, Math.max(...rects.map((r) => r.y + r.h)));\n  return {\n    min: minGroupY,\n    max: maxGroupY,\n    height: maxGroupY - minGroupY\n  };\n}\nfunction calcTargetFlow(targets) {\n  return targets.some((t1) => targets.filter((t2) => !rectEqual(t1, t2)).some((t2) => t1.y === t2.y)) ? \"horizontal\" : \"vertical\";\n}\nfunction calcInsertPosition(origin, targets, flow) {\n  if (flow === \"horizontal\") {\n    const rayLeft = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x - 1e8,\n      y2: origin.y\n    }, rayRight = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x + 1e8,\n      y2: origin.y\n    };\n    return {\n      left: findClosestIntersection(rayLeft, targets, flow),\n      right: findClosestIntersection(rayRight, targets, flow)\n    };\n  } else {\n    const rayTop = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x,\n      y2: origin.y - 1e8\n    }, rayBottom = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x,\n      y2: origin.y + 1e8\n    };\n    return {\n      top: findClosestIntersection(rayTop, targets, flow),\n      bottom: findClosestIntersection(rayBottom, targets, flow)\n    };\n  }\n}\nfunction findRectSanityData(rect, overlayGroup) {\n  return overlayGroup.find((e) => rectEqual(getRect(e.elements.element), rect))?.sanity;\n}\nfunction resolveInsertPosition(overlayGroup, insertPosition, flow) {\n  return Object.values(insertPosition).every((v) => v === null) ? null : flow === \"horizontal\" ? {\n    left: insertPosition.left ? {\n      rect: insertPosition.left,\n      sanity: findRectSanityData(insertPosition.left, overlayGroup)\n    } : null,\n    right: insertPosition.right ? {\n      rect: insertPosition.right,\n      sanity: findRectSanityData(insertPosition.right, overlayGroup)\n    } : null\n  } : {\n    top: insertPosition.top ? {\n      rect: insertPosition.top,\n      sanity: findRectSanityData(insertPosition.top, overlayGroup)\n    } : null,\n    bottom: insertPosition.bottom ? {\n      rect: insertPosition.bottom,\n      sanity: findRectSanityData(insertPosition.bottom, overlayGroup)\n    } : null\n  };\n}\nfunction calcMousePos(e) {\n  const bodyBounds = document.body.getBoundingClientRect();\n  return {\n    x: Math.max(bodyBounds.x, Math.min(e.clientX, bodyBounds.x + bodyBounds.width)),\n    y: e.clientY + window.scrollY\n  };\n}\nfunction calcMousePosInverseTransform(mousePos2) {\n  const body = document.body, transform = window.getComputedStyle(body).transform;\n  if (transform === \"none\")\n    return {\n      x: mousePos2.x,\n      y: mousePos2.y\n    };\n  const inverseMatrix = new DOMMatrix(transform).inverse(), transformedPoint = new DOMPoint(mousePos2.x, mousePos2.y).matrixTransform(inverseMatrix);\n  return {\n    x: transformedPoint.x,\n    y: transformedPoint.y\n  };\n}\nfunction buildPreviewSkeleton(mousePos2, element, scaleFactor) {\n  const bounds = getRect(element), children = [...element.querySelectorAll(\":where(h1, h2, h3, h4, p, a, img, span, button):not(:has(*))\")];\n  mousePos2.x <= bounds.x && (mousePos2.x = bounds.x), mousePos2.x >= bounds.x + bounds.w && (mousePos2.x = bounds.x + bounds.w), mousePos2.y >= bounds.y + bounds.h && (mousePos2.y = bounds.y + bounds.h), mousePos2.y <= bounds.y && (mousePos2.y = bounds.y);\n  const childRects = children.map((child) => {\n    const rect = scaleRect(getRect(child), scaleFactor, {\n      x: bounds.x,\n      y: bounds.y\n    });\n    return {\n      x: rect.x - bounds.x,\n      y: rect.y - bounds.y,\n      w: rect.w,\n      h: rect.h,\n      tagName: child.tagName\n    };\n  });\n  return {\n    offsetX: (bounds.x - mousePos2.x) * scaleFactor,\n    offsetY: (bounds.y - mousePos2.y) * scaleFactor,\n    w: bounds.w * scaleFactor,\n    h: bounds.h * scaleFactor,\n    maxWidth: bounds.w * scaleFactor * 0.75,\n    childRects\n  };\n}\nconst minDragDelta = 4;\nasync function applyMinimapWrapperTransform(target, scaleFactor, minYScaled, handler, rectUpdateFrequency) {\n  return new Promise((resolve) => {\n    target.addEventListener(\"transitionend\", () => {\n      setTimeout(() => {\n        handler({\n          type: \"overlay/dragEndMinimapTransition\"\n        });\n      }, rectUpdateFrequency * 2), resolve();\n    }, {\n      once: !0\n    }), handler({\n      type: \"overlay/dragStartMinimapTransition\"\n    }), handler({\n      type: \"overlay/dragToggleMinimap\",\n      display: !0\n    }), document.body.style.overflow = \"hidden\", document.body.style.height = \"100%\", document.documentElement.style.overflow = \"initial\", document.documentElement.style.height = \"100%\", setTimeout(() => {\n      target.style.transformOrigin = \"50% 0px\", target.style.transition = \"transform 150ms ease\", target.style.transform = `translate3d(0px, ${-minYScaled + scrollY}px, 0px) scale(${scaleFactor})`;\n    }, 25);\n  });\n}\nfunction calcMinimapTransformValues(rects, groupHeightOverride) {\n  let groupHeight = groupHeightOverride || getRectGroupYExtent(rects).height;\n  const padding = 100;\n  groupHeight += padding * 2;\n  const scaleFactor = groupHeight > window.innerHeight ? window.innerHeight / groupHeight : 1, scaledRects = rects.map((r) => scaleRect(r, scaleFactor, {\n    x: window.innerWidth / 2,\n    y: 0\n  })), {\n    min: minYScaled\n  } = getRectGroupYExtent(scaledRects);\n  return {\n    scaleFactor,\n    minYScaled: minYScaled - padding * scaleFactor\n  };\n}\nfunction calcGroupBoundsPreview(rects) {\n  const groupBoundsX = getRectGroupXExtent(rects), groupBoundsY = getRectGroupYExtent(rects), offsetDist = 8, canOffsetX = groupBoundsX.min > offsetDist && groupBoundsX.min + groupBoundsX.width <= window.innerWidth - offsetDist, canOffsetY = groupBoundsY.min > offsetDist && groupBoundsY.min + groupBoundsY.height <= document.body.scrollHeight - offsetDist, canOffset = canOffsetX && canOffsetY;\n  return {\n    x: canOffset ? groupBoundsX.min - offsetDist : groupBoundsX.min,\n    y: canOffset ? groupBoundsY.min - offsetDist : groupBoundsY.min,\n    w: canOffset ? groupBoundsX.width + offsetDist * 2 : groupBoundsX.width,\n    h: canOffset ? groupBoundsY.height + offsetDist * 2 : groupBoundsY.height\n  };\n}\nasync function resetMinimapWrapperTransform(endYOrigin, target, prescaleHeight2, handler, rectUpdateFrequency, previousRootStyleValues2) {\n  return new Promise((resolve) => {\n    const transform = window.getComputedStyle(target).transform;\n    if (new DOMMatrix(transform).a === 1) return;\n    const maxScroll = prescaleHeight2 - window.innerHeight, prevScrollY = scrollY;\n    endYOrigin -= window.innerHeight / 2, endYOrigin < 0 && (endYOrigin = 0), target.addEventListener(\"transitionend\", () => {\n      target.style.transition = \"none\", target.style.transform = \"none\", scrollTo({\n        top: endYOrigin,\n        behavior: \"instant\"\n      }), setTimeout(() => {\n        handler({\n          type: \"overlay/dragEndMinimapTransition\"\n        }), handler({\n          type: \"overlay/dragToggleMinimap\",\n          display: !1\n        });\n      }, rectUpdateFrequency * 2), resolve();\n    }, {\n      once: !0\n    }), handler({\n      type: \"overlay/dragStartMinimapTransition\"\n    }), target.style.transform = `translateY(${Math.max(prevScrollY - endYOrigin, -maxScroll + prevScrollY)}px) scale(1)`, previousRootStyleValues2 && (document.body.style.overflow = previousRootStyleValues2.body.overflow, document.body.style.height = previousRootStyleValues2.body.height, document.documentElement.style.overflow = previousRootStyleValues2.documentElement.overflow, document.documentElement.style.height = previousRootStyleValues2.documentElement.height);\n  });\n}\nlet minimapScaleApplied = !1, mousePosInverseTransform = {\n  y: 0\n}, mousePos = {\n  x: 0,\n  y: 0\n}, prescaleHeight = typeof document > \"u\" ? 0 : document.documentElement.scrollHeight, previousRootStyleValues = null;\nfunction handleOverlayDrag(opts) {\n  const {\n    mouseEvent,\n    element,\n    overlayGroup,\n    handler,\n    target,\n    onSequenceStart,\n    onSequenceEnd\n  } = opts;\n  if (mouseEvent.button !== 0) return;\n  window.focus();\n  const rectUpdateFrequency = 150;\n  let rects = overlayGroup.map((e) => getRect(e.elements.element));\n  const flow = element.getAttribute(\"data-sanity-drag-flow\") || calcTargetFlow(rects), dragGroup = element.getAttribute(\"data-sanity-drag-group\"), disableMinimap = !!element.getAttribute(\"data-sanity-drag-minimap-disable\"), preventInsertDefault = !!element.getAttribute(\"data-sanity-drag-prevent-default\"), documentHeightOverride = element.getAttribute(\"data-unstable_sanity-drag-document-height\"), groupHeightOverride = element.getAttribute(\"data-unstable_sanity-drag-group-height\");\n  let insertPosition = null;\n  const initialMousePos = calcMousePos(mouseEvent), scaleTarget = document.body, {\n    minYScaled,\n    scaleFactor\n  } = calcMinimapTransformValues(rects, groupHeightOverride ? ~~groupHeightOverride : null);\n  let sequenceStarted = !1, minimapPromptShown = !1, mousedown = !0;\n  minimapScaleApplied || (previousRootStyleValues = {\n    body: {\n      overflow: window.getComputedStyle(document.body).overflow,\n      height: window.getComputedStyle(document.body).height\n    },\n    documentElement: {\n      overflow: window.getComputedStyle(document.documentElement).overflow,\n      height: window.getComputedStyle(document.documentElement).height\n    }\n  }, prescaleHeight = documentHeightOverride ? ~~documentHeightOverride : document.documentElement.scrollHeight);\n  const rectsInterval = setInterval(() => {\n    rects = overlayGroup.map((e) => getRect(e.elements.element));\n  }, rectUpdateFrequency), applyMinimap = () => {\n    if (scaleFactor >= 1) return;\n    const skeleton = buildPreviewSkeleton(mousePos, element, scaleFactor);\n    handler({\n      type: \"overlay/dragUpdateSkeleton\",\n      skeleton\n    }), handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !1\n    }), applyMinimapWrapperTransform(scaleTarget, scaleFactor, minYScaled, handler, rectUpdateFrequency).then(() => {\n      setTimeout(() => {\n        handler({\n          type: \"overlay/dragUpdateGroupRect\",\n          groupRect: calcGroupBoundsPreview(rects)\n        });\n      }, rectUpdateFrequency * 2);\n    });\n  }, handleScroll = (e) => {\n    Math.abs(e.deltaY) >= 10 && scaleFactor < 1 && !minimapScaleApplied && !minimapPromptShown && !disableMinimap && mousedown && (handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !0\n    }), minimapPromptShown = !0), e.shiftKey && !minimapScaleApplied && !disableMinimap && (window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragApplyMinimap\")), minimapScaleApplied = !0, setTimeout(() => {\n      applyMinimap();\n    }, 50));\n  }, handleMouseMove = (e) => {\n    if (e.preventDefault(), mousePos = calcMousePos(e), mousePosInverseTransform = calcMousePosInverseTransform(mousePos), Math.abs(pointDist(mousePos, initialMousePos)) < minDragDelta) return;\n    if (!sequenceStarted) {\n      const groupRect = calcGroupBoundsPreview(rects), skeleton = buildPreviewSkeleton(mousePos, element, 1);\n      handler({\n        type: \"overlay/dragStart\",\n        flow\n      }), handler({\n        type: \"overlay/dragUpdateSkeleton\",\n        skeleton\n      }), handler({\n        type: \"overlay/dragUpdateGroupRect\",\n        groupRect\n      }), sequenceStarted = !0, onSequenceStart();\n    }\n    handler({\n      type: \"overlay/dragUpdateCursorPosition\",\n      x: mousePos.x,\n      y: mousePos.y\n    }), e.shiftKey && !minimapScaleApplied && !disableMinimap && (window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragApplyMinimap\")), minimapScaleApplied = !0, setTimeout(() => {\n      applyMinimap();\n    }, 50));\n    const newInsertPosition = calcInsertPosition(mousePos, rects, flow);\n    JSON.stringify(insertPosition) !== JSON.stringify(newInsertPosition) && (insertPosition = newInsertPosition, handler({\n      type: \"overlay/dragUpdateInsertPosition\",\n      insertPosition: resolveInsertPosition(overlayGroup, insertPosition, flow)\n    }));\n  }, handleMouseUp = () => {\n    mousedown = !1, handler({\n      type: \"overlay/dragEnd\",\n      target,\n      insertPosition: insertPosition ? resolveInsertPosition(overlayGroup, insertPosition, flow) : null,\n      dragGroup,\n      flow,\n      preventInsertDefault\n    }), minimapPromptShown && handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !1\n    }), minimapScaleApplied || (clearInterval(rectsInterval), onSequenceEnd(), removeFrameListeners(), removeKeyListeners()), removeMouseListeners();\n  }, handleKeyup = (e) => {\n    if (e.key === \"Shift\" && minimapScaleApplied) {\n      minimapScaleApplied = !1;\n      const skeleton = buildPreviewSkeleton(mousePos, element, 1 / scaleFactor);\n      handler({\n        type: \"overlay/dragUpdateSkeleton\",\n        skeleton\n      }), window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragResetMinimap\")), setTimeout(() => {\n        resetMinimapWrapperTransform(mousePosInverseTransform.y, scaleTarget, prescaleHeight, handler, rectUpdateFrequency, previousRootStyleValues);\n      }, 50), handler({\n        type: \"overlay/dragUpdateGroupRect\",\n        groupRect: null\n      }), mousedown || (clearInterval(rectsInterval), removeMouseListeners(), removeFrameListeners(), removeKeyListeners(), onSequenceEnd());\n    }\n  }, handleBlur = () => {\n    handler({\n      type: \"overlay/dragUpdateGroupRect\",\n      groupRect: null\n    }), window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragResetMinimap\")), setTimeout(() => {\n      resetMinimapWrapperTransform(mousePosInverseTransform.y, scaleTarget, prescaleHeight, handler, rectUpdateFrequency, previousRootStyleValues).then(() => {\n        minimapScaleApplied = !1;\n      });\n    }, 50), clearInterval(rectsInterval), removeMouseListeners(), removeFrameListeners(), removeKeyListeners(), onSequenceEnd();\n  }, removeMouseListeners = () => {\n    window.removeEventListener(\"mousemove\", handleMouseMove), window.removeEventListener(\"wheel\", handleScroll), window.removeEventListener(\"mouseup\", handleMouseUp);\n  }, removeKeyListeners = () => {\n    window.removeEventListener(\"keyup\", handleKeyup);\n  }, removeFrameListeners = () => {\n    window.removeEventListener(\"blur\", handleBlur);\n  };\n  window.addEventListener(\"blur\", handleBlur), window.addEventListener(\"keyup\", handleKeyup), window.addEventListener(\"wheel\", handleScroll), window.addEventListener(\"mousemove\", handleMouseMove), window.addEventListener(\"mouseup\", handleMouseUp);\n}\nconst isElementNode$1 = (target) => target instanceof HTMLElement || target instanceof SVGElement;\nfunction findNonInlineElement(element) {\n  const {\n    display\n  } = window.getComputedStyle(element);\n  if (display !== \"inline\") return element;\n  const parent = element.parentElement;\n  return parent ? findNonInlineElement(parent) : null;\n}\nconst findOverlayElement = (el) => !el || !isElementNode$1(el) ? null : el.dataset?.sanityOverlayElement ? el : findOverlayElement(el.parentElement);\nfunction testVercelStegaRegex(input) {\n  return _vercel_stega__WEBPACK_IMPORTED_MODULE_2__.VERCEL_STEGA_REGEX.lastIndex = 0, _vercel_stega__WEBPACK_IMPORTED_MODULE_2__.VERCEL_STEGA_REGEX.test(input);\n}\nfunction decodeStega(str, isAltText = !1) {\n  try {\n    const decoded = (0,_vercel_stega__WEBPACK_IMPORTED_MODULE_2__.vercelStegaDecode)(str);\n    return !decoded || decoded.origin !== \"sanity.io\" ? null : (isAltText && (decoded.href = decoded.href?.replace(\".alt\", \"\")), decoded);\n  } catch (err) {\n    return console.error(\"Failed to decode stega for string: \", str, \"with the original error: \", err), null;\n  }\n}\nfunction testAndDecodeStega(str, isAltText = !1) {\n  return testVercelStegaRegex(str) ? decodeStega(str, isAltText) : null;\n}\nconst isElementNode = (node) => node.nodeType === Node.ELEMENT_NODE, isImgElement = (el) => el.tagName === \"IMG\", isTimeElement = (el) => el.tagName === \"TIME\", isSvgRootElement = (el) => el.tagName.toUpperCase() === \"SVG\";\nfunction isSanityNode(node) {\n  return \"path\" in node;\n}\nfunction findCommonPath(first, second) {\n  let firstParts = first.split(\".\"), secondParts = second.split(\".\");\n  const maxLength = Math.min(firstParts.length, secondParts.length);\n  return firstParts = firstParts.slice(0, maxLength).reverse(), secondParts = secondParts.slice(0, maxLength).reverse(), firstParts.reduce((parts, part, i) => part === secondParts[i] ? [...parts, part] : [], []).reverse().join(\".\");\n}\nfunction findCommonSanityData(nodes) {\n  if (!nodes.length || !nodes.map((n) => isSanityNode(n)).every((n, _i, arr) => n === arr[0]))\n    return;\n  if (!isSanityNode(nodes[0])) return nodes[0];\n  const sanityNodes = nodes.filter(isSanityNode);\n  let common = nodes[0];\n  const consistentValueKeys = [\"projectId\", \"dataset\", \"id\", \"baseUrl\", \"workspace\", \"tool\"];\n  for (let i = 1; i < sanityNodes.length; i++) {\n    const node = sanityNodes[i];\n    if (consistentValueKeys.some((key) => node[key] !== common?.[key])) {\n      common = void 0;\n      break;\n    }\n    common = {\n      ...common,\n      path: findCommonPath(common.path, node.path)\n    };\n  }\n  return common;\n}\nfunction findSanityNodes(el) {\n  const mainResults = [];\n  function createResolvedElement(element, data, reason, preventGrouping) {\n    const sanity = (0,_sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_7__.decodeSanityNodeData)(data);\n    if (!sanity)\n      return;\n    const measureElement = findNonInlineElement(element);\n    if (measureElement)\n      return {\n        elements: {\n          element,\n          measureElement\n        },\n        sanity,\n        reason,\n        preventGrouping\n      };\n  }\n  function resolveNode(node) {\n    const {\n      nodeType,\n      parentElement,\n      textContent\n    } = node;\n    if (isElementNode(node) && node.dataset?.sanityEditTarget !== void 0) {\n      const nodesInTarget = findSanityNodes(node), commonData = findCommonSanityData(nodesInTarget.map((node2) => node2.type === \"element\" ? node2.commonSanity : void 0).filter((n) => n !== void 0));\n      if (commonData)\n        return {\n          reason: \"edit-target\",\n          elements: {\n            element: node,\n            measureElement: node\n          },\n          sanity: commonData\n        };\n    } else if (nodeType === Node.TEXT_NODE && parentElement && textContent) {\n      const data = testAndDecodeStega(textContent);\n      return data ? createResolvedElement(parentElement, data, \"stega-text\", !0) : void 0;\n    } else if (isElementNode(node)) {\n      if (node.tagName === \"SCRIPT\" || node.tagName === \"SANITY-VISUAL-EDITING\")\n        return;\n      if (node.dataset?.sanity)\n        return createResolvedElement(node, node.dataset.sanity, \"data-attribute\", !!(node.textContent && testVercelStegaRegex(node.textContent)));\n      if (node.dataset?.sanityEditInfo)\n        return createResolvedElement(node, node.dataset.sanityEditInfo, \"data-attribute\", !!(node.textContent && testVercelStegaRegex(node.textContent)));\n      if (isImgElement(node)) {\n        const data = testAndDecodeStega(node.alt, !0);\n        return data ? createResolvedElement(node, data, \"stega-attribute\") : void 0;\n      } else if (isTimeElement(node)) {\n        const data = testAndDecodeStega(node.dateTime, !0);\n        return data ? createResolvedElement(node, data, \"stega-attribute\") : void 0;\n      } else if (isSvgRootElement(node)) {\n        if (!node.ariaLabel) return;\n        const data = testAndDecodeStega(node.ariaLabel, !0);\n        return data ? createResolvedElement(node, data, \"stega-attribute\") : void 0;\n      }\n    }\n  }\n  function processNode(node, _parentGroup) {\n    const resolvedElement = resolveNode(node);\n    let parentGroup = _parentGroup;\n    if (isElementNode(node) && node.dataset?.sanityEditGroup !== void 0 && (parentGroup = {\n      type: \"group\",\n      elements: {\n        element: node,\n        measureElement: node\n      },\n      targets: []\n    }, mainResults.push(parentGroup)), resolvedElement) {\n      const target = {\n        elements: resolvedElement.elements,\n        sanity: resolvedElement.sanity,\n        reason: resolvedElement.reason\n      };\n      parentGroup && !resolvedElement.preventGrouping ? parentGroup.targets.push(target) : mainResults.push({\n        elements: resolvedElement.elements,\n        type: \"element\",\n        targets: [target]\n      });\n    }\n    if (isElementNode(node) && !isImgElement(node) && !(node.tagName === \"SCRIPT\" || node.tagName === \"SANITY-VISUAL-EDITING\"))\n      for (const childNode of node.childNodes)\n        processNode(childNode, parentGroup);\n  }\n  if (el)\n    for (const node of el.childNodes)\n      processNode(node, void 0);\n  return mainResults.map((node) => {\n    if (node.targets.length === 0 && node.type === \"group\")\n      return {\n        ...node,\n        commonSanity: void 0\n      };\n    const commonSanity = node.targets.length === 1 ? node.targets[0].sanity : findCommonSanityData(node.targets.map(({\n      sanity\n    }) => sanity).filter((n) => n !== void 0)) || node.targets[0].sanity;\n    return commonSanity ? {\n      ...node,\n      commonSanity\n    } : null;\n  }).filter((node) => node !== null);\n}\nfunction isSanityArrayPath(path) {\n  const lastDotIndex = path.lastIndexOf(\".\");\n  return path.substring(lastDotIndex, path.length).includes(\"[\");\n}\nfunction getSanityNodeArrayPath(path) {\n  if (!isSanityArrayPath(path)) return null;\n  const split = path.split(\".\");\n  return split[split.length - 1] = split[split.length - 1].replace(/\\[.*?\\]/g, \"[]\"), split.join(\".\");\n}\nfunction sanityNodesExistInSameArray(sanityNode1, sanityNode2) {\n  return !isSanityArrayPath(sanityNode1.path) || !isSanityArrayPath(sanityNode2.path) ? !1 : getSanityNodeArrayPath(sanityNode1.path) === getSanityNodeArrayPath(sanityNode2.path);\n}\nfunction resolveDragAndDropGroup(element, sanity, elementSet, elementsMap) {\n  if (!element.getAttribute(\"data-sanity\") || element.getAttribute(\"data-sanity-drag-disable\") || !sanity || !isSanityNode(sanity) || !isSanityArrayPath(sanity.path)) return null;\n  const targetDragGroup = element.getAttribute(\"data-sanity-drag-group\"), group = [...elementSet].reduce((acc, el) => {\n    const elData = elementsMap.get(el), elDragDisabled = el.getAttribute(\"data-sanity-drag-disable\"), elDragGroup = el.getAttribute(\"data-sanity-drag-group\"), elHasSanityAttribution = el.getAttribute(\"data-sanity\") !== null, sharedDragGroup = targetDragGroup !== null ? targetDragGroup === elDragGroup : !0;\n    return elData?.sanity && !elDragDisabled && isSanityNode(elData.sanity) && sanityNodesExistInSameArray(sanity, elData.sanity) && sharedDragGroup && elHasSanityAttribution && acc.push(elData), acc;\n  }, []);\n  return group.length <= 1 ? null : group;\n}\nfunction createOverlayController({\n  handler,\n  overlayElement,\n  inFrame,\n  inPopUp,\n  optimisticActorReady\n}) {\n  let activated = !1;\n  const elementIdMap = /* @__PURE__ */ new Map(), elementsMap = /* @__PURE__ */ new WeakMap(), elementSet = /* @__PURE__ */ new Set(), measureElements = /* @__PURE__ */ new WeakMap(), cursorMap = /* @__PURE__ */ new WeakMap();\n  let ro, io, mo, activeDragSequence = !1, hoverStack = [];\n  const getHoveredElement = () => hoverStack[hoverStack.length - 1];\n  function addEventHandlers(el, handlers) {\n    el.addEventListener(\"click\", handlers.click, {\n      capture: !0\n    }), el.addEventListener(\"contextmenu\", handlers.contextmenu, {\n      capture: !0\n    }), el.addEventListener(\"mousemove\", handlers.mousemove, {\n      once: !0,\n      capture: !0\n    }), el.addEventListener(\"mousedown\", handlers.mousedown, {\n      capture: !0\n    });\n  }\n  function removeEventHandlers(el, handlers) {\n    el.removeEventListener(\"click\", handlers.click, {\n      capture: !0\n    }), el.removeEventListener(\"contextmenu\", handlers.contextmenu, {\n      capture: !0\n    }), el.removeEventListener(\"mousemove\", handlers.mousemove, {\n      capture: !0\n    }), el.removeEventListener(\"mousedown\", handlers.mousedown, {\n      capture: !0\n    }), el.removeEventListener(\"mouseenter\", handlers.mouseenter), el.removeEventListener(\"mouseleave\", handlers.mouseleave);\n  }\n  function activateElement({\n    id,\n    elements,\n    handlers\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements;\n    addEventHandlers(element, handlers), ro.observe(measureElement), handler({\n      type: \"element/activate\",\n      id\n    });\n  }\n  function deactivateElement({\n    id,\n    elements,\n    handlers\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements;\n    removeEventHandlers(element, handlers), ro.unobserve(measureElement), hoverStack = hoverStack.filter((el) => el !== element), handler({\n      type: \"element/deactivate\",\n      id\n    });\n  }\n  function setOverlayCursor(element) {\n    if (!(!inFrame && !inPopUp || !optimisticActorReady))\n      for (const hoverstackElement of hoverStack) {\n        if (element === hoverstackElement) {\n          const targetSanityData = elementsMap.get(element)?.sanity;\n          if (!targetSanityData || !isSanityNode(targetSanityData)) return;\n          if (resolveDragAndDropGroup(element, targetSanityData, elementSet, elementsMap)) {\n            const existingCursor = element.style.cursor;\n            existingCursor && cursorMap.set(element, existingCursor), handler({\n              type: \"overlay/setCursor\",\n              element,\n              cursor: \"move\"\n            });\n            continue;\n          }\n        }\n        restoreOverlayCursor(hoverstackElement);\n      }\n  }\n  function restoreOverlayCursor(element) {\n    const previousCursor = cursorMap.get(element);\n    handler({\n      type: \"overlay/setCursor\",\n      element,\n      cursor: previousCursor\n    });\n  }\n  function registerElement({\n    type,\n    elements,\n    commonSanity,\n    targets\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements, eventHandlers = {\n      click(event) {\n        const target = event.target;\n        if (element === getHoveredElement() && element.contains(target)) {\n          inFrame && (event.preventDefault(), event.stopPropagation());\n          const sanity = elementsMap.get(element)?.sanity;\n          sanity && !activeDragSequence && handler({\n            type: \"element/click\",\n            id,\n            sanity\n          });\n        }\n      },\n      contextmenu(event) {\n        if (!(\"path\" in commonSanity) || !inFrame && !inPopUp || !optimisticActorReady || !commonSanity.path.split(\".\").pop()?.includes(\"[_key==\")) return;\n        const target = event.target;\n        element === getHoveredElement() && element.contains(target) && ((inFrame || inPopUp) && (event.preventDefault(), event.stopPropagation()), handler({\n          type: \"element/contextmenu\",\n          id,\n          position: {\n            x: event.clientX,\n            y: event.clientY\n          },\n          sanity: commonSanity\n        }));\n      },\n      mousedown(event) {\n        if (event.preventDefault(), event.currentTarget !== hoverStack.at(-1) || element.getAttribute(\"data-sanity-drag-disable\") || !inFrame && !inPopUp || !optimisticActorReady) return;\n        const targetSanityData = elementsMap.get(element)?.sanity;\n        if (!targetSanityData || !isSanityNode(targetSanityData) || !isSanityArrayPath(targetSanityData.path)) return;\n        const dragGroup = resolveDragAndDropGroup(element, commonSanity, elementSet, elementsMap);\n        dragGroup && handleOverlayDrag({\n          element,\n          handler,\n          mouseEvent: event,\n          overlayGroup: dragGroup,\n          target: targetSanityData,\n          onSequenceStart: () => {\n            activeDragSequence = !0;\n          },\n          onSequenceEnd: () => {\n            setTimeout(() => {\n              activeDragSequence = !1;\n            }, 250);\n          }\n        });\n      },\n      mousemove(event) {\n        eventHandlers.mouseenter(event);\n        const el = event.currentTarget;\n        el && (el.addEventListener(\"mouseenter\", eventHandlers.mouseenter), el.addEventListener(\"mouseleave\", eventHandlers.mouseleave));\n      },\n      mouseenter() {\n        document.querySelector(\"vercel-live-feedback\") && element.closest(\"[data-vercel-edit-info]\") || element.closest(\"[data-vercel-edit-target]\") || (hoverStack.push(element), handler({\n          type: \"element/mouseenter\",\n          id,\n          rect: getRect(element)\n        }), setOverlayCursor(element));\n      },\n      mouseleave(e) {\n        function leave() {\n          hoverStack.pop();\n          const hoveredElement = getHoveredElement();\n          if (handler({\n            type: \"element/mouseleave\",\n            id\n          }), hoveredElement) {\n            setOverlayCursor(hoveredElement);\n            const overlayElement2 = elementsMap.get(hoveredElement);\n            overlayElement2 && handler({\n              type: \"element/mouseenter\",\n              id: overlayElement2.id,\n              rect: getRect(hoveredElement)\n            });\n          }\n          restoreOverlayCursor(element);\n        }\n        function addDeferredLeave(el) {\n          const deferredLeave = (e2) => {\n            const {\n              relatedTarget: relatedTarget2\n            } = e2;\n            findOverlayElement(relatedTarget2) ? relatedTarget2 && isElementNode$1(relatedTarget2) && (el.removeEventListener(\"mouseleave\", deferredLeave), addDeferredLeave(relatedTarget2)) : (el.removeEventListener(\"mouseleave\", deferredLeave), leave());\n          };\n          el.addEventListener(\"mouseleave\", deferredLeave);\n        }\n        const {\n          relatedTarget\n        } = e, container = findOverlayElement(relatedTarget), isInteractiveOverlayElement = overlayElement.contains(container);\n        if (isElementNode$1(container) && isInteractiveOverlayElement)\n          return addDeferredLeave(container);\n        leave();\n      }\n    }, id = v4(), sanityNode = {\n      type,\n      id,\n      elements,\n      sanity: commonSanity,\n      handlers: eventHandlers\n    };\n    elementSet.add(element), measureElements.set(measureElement, element), elementIdMap.set(id, element), elementsMap.set(element, sanityNode), io?.observe(element), handler({\n      type: \"element/register\",\n      elementType: type,\n      id,\n      element,\n      rect: getRect(element),\n      sanity: commonSanity,\n      dragDisabled: !!element.getAttribute(\"data-sanity-drag-disable\"),\n      targets: targets.map((target) => ({\n        sanity: target.sanity,\n        element: target.elements.element\n      }))\n    }), activated && activateElement(sanityNode);\n  }\n  function updateElement(resolvedElement) {\n    const {\n      element\n    } = resolvedElement.elements, overlayElement2 = elementsMap.get(element);\n    overlayElement2 && (elementsMap.set(element, {\n      ...overlayElement2,\n      sanity: resolvedElement.commonSanity\n    }), handler({\n      type: \"element/update\",\n      elementType: overlayElement2.type,\n      id: overlayElement2.id,\n      rect: getRect(element),\n      sanity: resolvedElement.commonSanity,\n      targets: resolvedElement.targets.map((target) => ({\n        sanity: target.sanity,\n        element: target.elements.element\n      }))\n    }));\n  }\n  function parseElements(node) {\n    const sanityNodes = findSanityNodes(node);\n    for (const sanityNode of sanityNodes) {\n      if (sanityNode.type === \"group\") {\n        for (const target of sanityNode.targets) {\n          const overlayElement2 = elementsMap.get(target.elements.element);\n          overlayElement2 && overlayElement2.type === \"element\" && unregisterElement(target.elements.element);\n        }\n        sanityNode.targets.length === 0 && unregisterElement(sanityNode.elements.element);\n      }\n      if (!sanityNode.commonSanity) continue;\n      const {\n        element\n      } = sanityNode.elements;\n      elementsMap.has(element) ? updateElement(sanityNode) : registerElement(sanityNode);\n    }\n  }\n  function unregisterElement(element) {\n    const overlayElement2 = elementsMap.get(element);\n    if (overlayElement2) {\n      const {\n        id,\n        handlers\n      } = overlayElement2;\n      removeEventHandlers(element, handlers), ro.unobserve(element), elementsMap.delete(element), elementSet.delete(element), elementIdMap.delete(id), handler({\n        type: \"element/unregister\",\n        id\n      });\n    }\n  }\n  function handleMutation(mutations) {\n    let mutationWasInScope = !1;\n    for (const mutation of mutations) {\n      const {\n        target,\n        type\n      } = mutation, node = type === \"characterData\" ? target.parentElement : target;\n      if (!(node === overlayElement || overlayElement.contains(node)) && (mutationWasInScope = !0, isElementNode$1(node))) {\n        const possibleGroupParent = node.parentElement?.closest(\"[data-sanity-edit-group]\") || null, updateNodeTarget = isElementNode$1(possibleGroupParent) ? possibleGroupParent : node;\n        parseElements({\n          childNodes: [updateNodeTarget]\n        });\n      }\n    }\n    if (mutationWasInScope)\n      for (const element of elementSet)\n        element.isConnected || unregisterElement(element), elementsMap.get(element)?.type === \"group\" && !element.hasAttribute(\"data-sanity-edit-group\") && unregisterElement(element);\n  }\n  function updateRect(el) {\n    const overlayElement2 = elementsMap.get(el);\n    overlayElement2 && handler({\n      type: \"element/updateRect\",\n      id: overlayElement2.id,\n      rect: getRect(el)\n    });\n  }\n  function handleResize(entries) {\n    for (const entry of entries) {\n      const target = entry.target;\n      if (isElementNode$1(target)) {\n        const element = measureElements.get(target);\n        if (!element) return;\n        updateRect(element);\n      }\n    }\n  }\n  function handleIntersection(entries) {\n    if (activated)\n      for (const entry of entries) {\n        const {\n          target\n        } = entry, match = isElementNode$1(target) && elementsMap.get(target);\n        match && (entry.isIntersecting ? activateElement(match) : deactivateElement(match));\n      }\n  }\n  function handleBlur(event) {\n    const element = findOverlayElement(event.target);\n    if (element) {\n      element.dataset.sanityOverlayElement === \"capture\" && (event.preventDefault(), event.stopPropagation());\n      return;\n    }\n    hoverStack = [], handler({\n      type: \"overlay/blur\"\n    });\n  }\n  function handleExclusivePluginClosed() {\n    hoverStack = [], handler({\n      type: \"overlay/reset-mouse-state\"\n    });\n  }\n  function handleWindowResize() {\n    for (const element of elementSet)\n      updateRect(element);\n  }\n  function handleKeydown(event) {\n    event.key === \"Escape\" && (hoverStack = [], handler({\n      type: \"overlay/blur\"\n    }));\n  }\n  function handleWindowScroll(event) {\n    const {\n      target\n    } = event;\n    if (!(target === window.document || !isElementNode$1(target)))\n      for (const element of elementSet)\n        target.contains(element) && updateRect(element);\n  }\n  function activate() {\n    activated || (io = new IntersectionObserver(handleIntersection, {\n      threshold: 0.3\n    }), elementSet.forEach((element) => io.observe(element)), handler({\n      type: \"overlay/activate\"\n    }), activated = !0);\n  }\n  function deactivate() {\n    activated && (io?.disconnect(), elementSet.forEach((element) => {\n      const overlayElement2 = elementsMap.get(element);\n      overlayElement2 && deactivateElement(overlayElement2);\n    }), handler({\n      type: \"overlay/deactivate\"\n    }), activated = !1);\n  }\n  function handleHeaderClick(event) {\n    const {\n      id\n    } = event.detail, element = elementIdMap.get(id);\n    if (!element) return;\n    const sanity = elementsMap.get(element)?.sanity;\n    sanity && handler({\n      type: \"element/click\",\n      id,\n      sanity\n    });\n  }\n  function destroy() {\n    window.removeEventListener(\"click\", handleBlur), window.removeEventListener(\"contextmenu\", handleBlur), window.removeEventListener(\"sanity-overlay/exclusive-plugin-closed\", handleExclusivePluginClosed), window.removeEventListener(\"sanity-overlay/label-click\", handleHeaderClick), window.removeEventListener(\"keydown\", handleKeydown), window.removeEventListener(\"resize\", handleWindowResize), window.removeEventListener(\"scroll\", handleWindowScroll), mo.disconnect(), ro.disconnect(), elementSet.forEach((element) => {\n      unregisterElement(element);\n    }), elementIdMap.clear(), elementSet.clear(), hoverStack = [], deactivate();\n  }\n  function create() {\n    window.addEventListener(\"click\", handleBlur), window.addEventListener(\"contextmenu\", handleBlur), window.addEventListener(\"sanity-overlay/exclusive-plugin-closed\", handleExclusivePluginClosed), window.addEventListener(\"sanity-overlay/label-click\", handleHeaderClick), window.addEventListener(\"keydown\", handleKeydown), window.addEventListener(\"resize\", handleWindowResize), window.addEventListener(\"scroll\", handleWindowScroll, {\n      capture: !0,\n      passive: !0\n    }), ro = new ResizeObserver(handleResize), mo = new MutationObserver(handleMutation), mo.observe(document.body, {\n      attributes: !0,\n      characterData: !0,\n      childList: !0,\n      subtree: !0\n    }), parseElements(document.body), activate();\n  }\n  return window.document.fonts.ready.then(() => {\n    for (const element of elementSet)\n      updateRect(element);\n  }), create(), {\n    activate,\n    deactivate,\n    destroy\n  };\n}\nconst SharedStateContext = (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null);\n\n//# sourceMappingURL=SharedStateContext.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL1NoYXJlZFN0YXRlQ29udGV4dC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQTJDO0FBQ1M7QUFDd0I7QUFDMUI7QUFDTjtBQUNRO0FBQ2M7QUFDSTtBQUN0RTtBQUNBLFlBQVkseURBQUMsZ0NBQWdDLCtDQUFRLG9DQUFvQywrQ0FBUSwyQ0FBMkMsK0NBQVEsZ0RBQWdELCtDQUFRLHVCQUF1QixpRUFBa0I7QUFDclA7QUFDQTtBQUNBO0FBQ0EsUUFBUSxrRUFBYztBQUN0QjtBQUNBO0FBQ0EsR0FBRztBQUNILGdDQUFnQyxnRUFBYztBQUM5QztBQUNBO0FBQ0EsZ0NBQWdDLGdFQUFjO0FBQzlDO0FBQ0E7QUFDQSxRQUFRLHlEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixrRUFBYztBQUNsQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxRQUFRLHNEQUFlO0FBQ3ZCLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esd0VBQXdFLGdEQUFTO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsc0RBQWU7QUFDeEQ7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQSxtUkFBbVIsZ0RBQVM7QUFDNVI7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxrQkFBa0Isc0JBQXNCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwwQkFBMEI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsK0lBQStJLHNCQUFzQixpQkFBaUIsWUFBWTtBQUNsTSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUssMENBQTBDLDZEQUE2RDtBQUM1RyxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyw2REFBa0IsZ0JBQWdCLDZEQUFrQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0VBQWlCO0FBQ3JDO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHdCQUF3QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsZ0ZBQW9CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixvREFBYTtBQU90QztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L19jaHVua3MtZXMvU2hhcmVkU3RhdGVDb250ZXh0LmpzPzJhYTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYyB9IGZyb20gXCJyZWFjdC1jb21waWxlci1ydW50aW1lXCI7XG5pbXBvcnQgeyBnZXRQdWJsaXNoZWRJZCB9IGZyb20gXCJAc2FuaXR5L2NsaWVudC9jc21cIjtcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHN0YXJ0VHJhbnNpdGlvbiwgY3JlYXRlQ29udGV4dCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlRWZmZWN0RXZlbnQgfSBmcm9tIFwidXNlLWVmZmVjdC1ldmVudFwiO1xuaW1wb3J0IHsgaXNFbXB0eUFjdG9yIH0gZnJvbSBcIi4vY29udGV4dC5qc1wiO1xuaW1wb3J0IHsgdXNlT3B0aW1pc3RpY0FjdG9yIH0gZnJvbSBcIi4vbXV0YXRpb25zLmpzXCI7XG5pbXBvcnQgeyBkZWNvZGVTYW5pdHlOb2RlRGF0YSB9IGZyb20gXCJAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nLWNzbVwiO1xuaW1wb3J0IHsgVkVSQ0VMX1NURUdBX1JFR0VYLCB2ZXJjZWxTdGVnYURlY29kZSB9IGZyb20gXCJAdmVyY2VsL3N0ZWdhXCI7XG5mdW5jdGlvbiB1c2VPcHRpbWlzdGljKHBhc3N0aHJvdWdoLCByZWR1Y2VyKSB7XG4gIGNvbnN0ICQgPSBjKDIxKSwgW3ByaXN0aW5lLCBzZXRQcmlzdGluZV0gPSB1c2VTdGF0ZSghMCksIFtvcHRpbWlzdGljLCBzZXRPcHRpbWlzdGljXSA9IHVzZVN0YXRlKHBhc3N0aHJvdWdoKSwgW2xhc3RFdmVudCwgc2V0TGFzdEV2ZW50XSA9IHVzZVN0YXRlKG51bGwpLCBbbGFzdFBhc3N0aHJvdWdoLCBzZXRMYXN0UGFzc3Rocm91Z2hdID0gdXNlU3RhdGUocGFzc3Rocm91Z2gpLCBhY3RvciA9IHVzZU9wdGltaXN0aWNBY3RvcigpO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IHJlZHVjZXIgPyAodDAgPSAoYWN0aW9uLCBwcmV2U3RhdGUpID0+IChBcnJheS5pc0FycmF5KHJlZHVjZXIpID8gcmVkdWNlciA6IFtyZWR1Y2VyXSkucmVkdWNlKChhY2MsIHJlZHVjZXJfMCkgPT4gcmVkdWNlcl8wKGFjYywge1xuICAgIGRvY3VtZW50OiBhY3Rpb24uZG9jdW1lbnQsXG4gICAgaWQ6IGdldFB1Ymxpc2hlZElkKGFjdGlvbi5pZCksXG4gICAgb3JpZ2luYWxJZDogYWN0aW9uLmlkLFxuICAgIHR5cGU6IGFjdGlvbi50eXBlXG4gIH0pLCBwcmV2U3RhdGUpLCAkWzBdID0gcmVkdWNlciwgJFsxXSA9IHQwKSA6IHQwID0gJFsxXTtcbiAgY29uc3QgcmVkdWNlU3RhdGVGcm9tQWN0aW9uID0gdXNlRWZmZWN0RXZlbnQodDApO1xuICBsZXQgdDE7XG4gICRbMl0gIT09IHBhc3N0aHJvdWdoID8gKHQxID0gKCkgPT4gc2V0TGFzdFBhc3N0aHJvdWdoKHBhc3N0aHJvdWdoKSwgJFsyXSA9IHBhc3N0aHJvdWdoLCAkWzNdID0gdDEpIDogdDEgPSAkWzNdO1xuICBjb25zdCB1cGRhdGVMYXN0UGFzc3Rocm91Z2ggPSB1c2VFZmZlY3RFdmVudCh0MSk7XG4gIGxldCB0MjtcbiAgJFs0XSAhPT0gYWN0b3IgfHwgJFs1XSAhPT0gcmVkdWNlU3RhdGVGcm9tQWN0aW9uIHx8ICRbNl0gIT09IHVwZGF0ZUxhc3RQYXNzdGhyb3VnaCA/ICh0MiA9ICgpID0+IHtcbiAgICBpZiAoaXNFbXB0eUFjdG9yKGFjdG9yKSlcbiAgICAgIHJldHVybjtcbiAgICBsZXQgcHJpc3RpbmVUaW1lb3V0O1xuICAgIGNvbnN0IHJlYmFzZWRTdWIgPSBhY3Rvci5vbihcInJlYmFzZWQubG9jYWxcIiwgKF9ldmVudCkgPT4ge1xuICAgICAgY29uc3QgZXZlbnQgPSB7XG4gICAgICAgIGRvY3VtZW50OiBfZXZlbnQuZG9jdW1lbnQsXG4gICAgICAgIGlkOiBfZXZlbnQuaWQsXG4gICAgICAgIG9yaWdpbmFsSWQ6IGdldFB1Ymxpc2hlZElkKF9ldmVudC5pZCksXG4gICAgICAgIHR5cGU6IFwibXV0YXRlXCJcbiAgICAgIH07XG4gICAgICBzZXRPcHRpbWlzdGljKChwcmV2U3RhdGVfMCkgPT4gcmVkdWNlU3RhdGVGcm9tQWN0aW9uKGV2ZW50LCBwcmV2U3RhdGVfMCkpLCBzZXRMYXN0RXZlbnQoZXZlbnQpLCB1cGRhdGVMYXN0UGFzc3Rocm91Z2goKSwgc2V0UHJpc3RpbmUoITEpLCBjbGVhclRpbWVvdXQocHJpc3RpbmVUaW1lb3V0KTtcbiAgICB9KSwgcHJpc3RpbmVTdWIgPSBhY3Rvci5vbihcInByaXN0aW5lXCIsICgpID0+IHtcbiAgICAgIHByaXN0aW5lVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzdGFydFRyYW5zaXRpb24oKCkgPT4gc2V0UHJpc3RpbmUoITApKTtcbiAgICAgIH0sIDE1ZTMpO1xuICAgIH0pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICByZWJhc2VkU3ViLnVuc3Vic2NyaWJlKCksIHByaXN0aW5lU3ViLnVuc3Vic2NyaWJlKCk7XG4gICAgfTtcbiAgfSwgJFs0XSA9IGFjdG9yLCAkWzVdID0gcmVkdWNlU3RhdGVGcm9tQWN0aW9uLCAkWzZdID0gdXBkYXRlTGFzdFBhc3N0aHJvdWdoLCAkWzddID0gdDIpIDogdDIgPSAkWzddO1xuICBsZXQgdDM7XG4gICRbOF0gIT09IGFjdG9yID8gKHQzID0gW2FjdG9yXSwgJFs4XSA9IGFjdG9yLCAkWzldID0gdDMpIDogdDMgPSAkWzldLCB1c2VFZmZlY3QodDIsIHQzKTtcbiAgbGV0IHQ0O1xuICAkWzEwXSAhPT0gbGFzdEV2ZW50IHx8ICRbMTFdICE9PSBsYXN0UGFzc3Rocm91Z2ggfHwgJFsxMl0gIT09IHBhc3N0aHJvdWdoIHx8ICRbMTNdICE9PSBwcmlzdGluZSB8fCAkWzE0XSAhPT0gcmVkdWNlU3RhdGVGcm9tQWN0aW9uID8gKHQ0ID0gKCkgPT4ge1xuICAgIGlmICghcHJpc3RpbmUpIHtcbiAgICAgIGlmICghbGFzdEV2ZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBsYXN0IGV2ZW50IGZvdW5kIHdoZW4gc3luY2luZyBwYXNzdGhyb3VnaFwiKTtcbiAgICAgIGxhc3RQYXNzdGhyb3VnaCAhPT0gcGFzc3Rocm91Z2ggJiYgc3RhcnRUcmFuc2l0aW9uKCgpID0+IHtcbiAgICAgICAgc2V0T3B0aW1pc3RpYyhyZWR1Y2VTdGF0ZUZyb21BY3Rpb24obGFzdEV2ZW50LCBwYXNzdGhyb3VnaCkpLCBzZXRMYXN0UGFzc3Rocm91Z2gocGFzc3Rocm91Z2gpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LCAkWzEwXSA9IGxhc3RFdmVudCwgJFsxMV0gPSBsYXN0UGFzc3Rocm91Z2gsICRbMTJdID0gcGFzc3Rocm91Z2gsICRbMTNdID0gcHJpc3RpbmUsICRbMTRdID0gcmVkdWNlU3RhdGVGcm9tQWN0aW9uLCAkWzE1XSA9IHQ0KSA6IHQ0ID0gJFsxNV07XG4gIGxldCB0NTtcbiAgcmV0dXJuICRbMTZdICE9PSBsYXN0RXZlbnQgfHwgJFsxN10gIT09IGxhc3RQYXNzdGhyb3VnaCB8fCAkWzE4XSAhPT0gcGFzc3Rocm91Z2ggfHwgJFsxOV0gIT09IHByaXN0aW5lID8gKHQ1ID0gW2xhc3RFdmVudCwgbGFzdFBhc3N0aHJvdWdoLCBwYXNzdGhyb3VnaCwgcHJpc3RpbmVdLCAkWzE2XSA9IGxhc3RFdmVudCwgJFsxN10gPSBsYXN0UGFzc3Rocm91Z2gsICRbMThdID0gcGFzc3Rocm91Z2gsICRbMTldID0gcHJpc3RpbmUsICRbMjBdID0gdDUpIDogdDUgPSAkWzIwXSwgdXNlRWZmZWN0KHQ0LCB0NSksIHByaXN0aW5lID8gcGFzc3Rocm91Z2ggOiBvcHRpbWlzdGljO1xufVxuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5mb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKVxuICBieXRlVG9IZXgucHVzaCgoaSArIDI1NikudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbmZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgcmV0dXJuIChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArIFwiLVwiICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArIFwiLVwiICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA2XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDddXSArIFwiLVwiICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArIFwiLVwiICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxubGV0IGdldFJhbmRvbVZhbHVlcztcbmNvbnN0IHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpO1xuZnVuY3Rpb24gcm5nKCkge1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIGlmICh0eXBlb2YgY3J5cHRvID4gXCJ1XCIgfHwgIWNyeXB0by5nZXRSYW5kb21WYWx1ZXMpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKCkgbm90IHN1cHBvcnRlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCNnZXRyYW5kb212YWx1ZXMtbm90LXN1cHBvcnRlZFwiKTtcbiAgICBnZXRSYW5kb21WYWx1ZXMgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcbiAgfVxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn1cbmNvbnN0IHJhbmRvbVVVSUQgPSB0eXBlb2YgY3J5cHRvIDwgXCJ1XCIgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xudmFyIG5hdGl2ZSA9IHtcbiAgcmFuZG9tVVVJRFxufTtcbmZ1bmN0aW9uIHY0KG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KSB7XG4gIGlmIChuYXRpdmUucmFuZG9tVVVJRCAmJiAhb3B0aW9ucylcbiAgICByZXR1cm4gbmF0aXZlLnJhbmRvbVVVSUQoKTtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSA/PyBvcHRpb25zLnJuZz8uKCkgPz8gcm5nKCk7XG4gIGlmIChybmRzLmxlbmd0aCA8IDE2KVxuICAgIHRocm93IG5ldyBFcnJvcihcIlJhbmRvbSBieXRlcyBsZW5ndGggbXVzdCBiZSA+PSAxNlwiKTtcbiAgcmV0dXJuIHJuZHNbNl0gPSBybmRzWzZdICYgMTUgfCA2NCwgcm5kc1s4XSA9IHJuZHNbOF0gJiA2MyB8IDEyOCwgdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuZnVuY3Rpb24gZ2V0UmVjdChlbGVtZW50KSB7XG4gIGNvbnN0IGRvbVJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4ge1xuICAgIHg6IGRvbVJlY3QueCArIHNjcm9sbFgsXG4gICAgeTogZG9tUmVjdC55ICsgc2Nyb2xsWSxcbiAgICB3OiBkb21SZWN0LndpZHRoLFxuICAgIGg6IGRvbVJlY3QuaGVpZ2h0XG4gIH07XG59XG5mdW5jdGlvbiBvZmZzZXRSZWN0KHJlY3QsIHB4LCBheGlzKSB7XG4gIHJldHVybiBheGlzID09PSBcInhcIiA/IHtcbiAgICB4OiByZWN0LnggKyBweCxcbiAgICB5OiByZWN0LnksXG4gICAgdzogcmVjdC53IC0gMiAqIHB4LFxuICAgIGg6IHJlY3QuaFxuICB9IDoge1xuICAgIHg6IHJlY3QueCxcbiAgICB5OiByZWN0LnkgKyBweCxcbiAgICB3OiByZWN0LncsXG4gICAgaDogcmVjdC5oIC0gMiAqIHB4XG4gIH07XG59XG5mdW5jdGlvbiByYXlJbnRlcnNlY3QobDEsIGwyKSB7XG4gIGNvbnN0IHtcbiAgICB4MSxcbiAgICB5MSxcbiAgICB4MixcbiAgICB5MlxuICB9ID0gbDEsIHtcbiAgICB4MTogeDMsXG4gICAgeTE6IHkzLFxuICAgIHgyOiB4NCxcbiAgICB5MjogeTRcbiAgfSA9IGwyO1xuICBpZiAoeDEgPT09IHgyICYmIHkxID09PSB5MiB8fCB4MyA9PT0geDQgJiYgeTMgPT09IHk0KVxuICAgIHJldHVybiAhMTtcbiAgY29uc3QgZGVub21pbmF0b3IgPSAoeTQgLSB5MykgKiAoeDIgLSB4MSkgLSAoeDQgLSB4MykgKiAoeTIgLSB5MSk7XG4gIGlmIChkZW5vbWluYXRvciA9PT0gMClcbiAgICByZXR1cm4gITE7XG4gIGNvbnN0IHVhID0gKCh4NCAtIHgzKSAqICh5MSAtIHkzKSAtICh5NCAtIHkzKSAqICh4MSAtIHgzKSkgLyBkZW5vbWluYXRvciwgdWIgPSAoKHgyIC0geDEpICogKHkxIC0geTMpIC0gKHkyIC0geTEpICogKHgxIC0geDMpKSAvIGRlbm9taW5hdG9yO1xuICBpZiAodWEgPCAwIHx8IHVhID4gMSB8fCB1YiA8IDAgfHwgdWIgPiAxKVxuICAgIHJldHVybiAhMTtcbiAgY29uc3QgeCA9IHgxICsgdWEgKiAoeDIgLSB4MSksIHkgPSB5MSArIHVhICogKHkyIC0geTEpO1xuICByZXR1cm4ge1xuICAgIHgsXG4gICAgeVxuICB9O1xufVxuZnVuY3Rpb24gcmVjdEVxdWFsKHIxLCByMikge1xuICByZXR1cm4gcjEueCA9PT0gcjIueCAmJiByMS55ID09PSByMi55ICYmIHIxLncgPT09IHIyLncgJiYgcjEuaCA9PT0gcjIuaDtcbn1cbmZ1bmN0aW9uIHJheVJlY3RJbnRlcnNlY3Rpb25zKGxpbmUsIHJlY3QpIHtcbiAgY29uc3QgcmVjdExpbmVzID0gW3tcbiAgICB4MTogcmVjdC54LFxuICAgIHkxOiByZWN0LnksXG4gICAgeDI6IHJlY3QueCArIHJlY3QudyxcbiAgICB5MjogcmVjdC55XG4gIH0sIHtcbiAgICB4MTogcmVjdC54ICsgcmVjdC53LFxuICAgIHkxOiByZWN0LnksXG4gICAgeDI6IHJlY3QueCArIHJlY3QudyxcbiAgICB5MjogcmVjdC55ICsgcmVjdC5oXG4gIH0sIHtcbiAgICB4MTogcmVjdC54ICsgcmVjdC53LFxuICAgIHkxOiByZWN0LnkgKyByZWN0LmgsXG4gICAgeDI6IHJlY3QueCxcbiAgICB5MjogcmVjdC55ICsgcmVjdC5oXG4gIH0sIHtcbiAgICB4MTogcmVjdC54LFxuICAgIHkxOiByZWN0LnkgKyByZWN0LmgsXG4gICAgeDI6IHJlY3QueCxcbiAgICB5MjogcmVjdC55XG4gIH1dLCBpbnRlcnNlY3Rpb25zID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcmVjdExpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgaW50ZXJzZWN0aW9uID0gcmF5SW50ZXJzZWN0KGxpbmUsIHJlY3RMaW5lc1tpXSk7XG4gICAgaWYgKGludGVyc2VjdGlvbikge1xuICAgICAgbGV0IGlzRHVwbGljYXRlID0gITE7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGludGVyc2VjdGlvbnMubGVuZ3RoOyBqKyspXG4gICAgICAgIGludGVyc2VjdGlvbnNbal0ueCA9PT0gaW50ZXJzZWN0aW9uLnggJiYgaW50ZXJzZWN0aW9uc1tqXS55ID09PSBpbnRlcnNlY3Rpb24ueSAmJiAoaXNEdXBsaWNhdGUgPSAhMCk7XG4gICAgICBpc0R1cGxpY2F0ZSB8fCBpbnRlcnNlY3Rpb25zLnB1c2goaW50ZXJzZWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGludGVyc2VjdGlvbnMubGVuZ3RoID09PSAwID8gITEgOiBpbnRlcnNlY3Rpb25zLnNvcnQoKGEsIGIpID0+IHBvaW50RGlzdChhLCB7XG4gICAgeDogbGluZS54MSxcbiAgICB5OiBsaW5lLnkxXG4gIH0pIC0gcG9pbnREaXN0KGIsIHtcbiAgICB4OiBsaW5lLngxLFxuICAgIHk6IGxpbmUueTFcbiAgfSkpO1xufVxuZnVuY3Rpb24gcG9pbnREaXN0KHAxLCBwMikge1xuICBjb25zdCBhID0gcDEueCAtIHAyLngsIGIgPSBwMS55IC0gcDIueTtcbiAgcmV0dXJuIE1hdGguc3FydChhICogYSArIGIgKiBiKTtcbn1cbmZ1bmN0aW9uIHBvaW50SW5Cb3VuZHMocG9pbnQsIGJvdW5kcykge1xuICBjb25zdCB3aXRoaW5YID0gcG9pbnQueCA+PSBib3VuZHMueCAmJiBwb2ludC54IDw9IGJvdW5kcy54ICsgYm91bmRzLncsIHdpdGhpblkgPSBwb2ludC55ID49IGJvdW5kcy55ICYmIHBvaW50LnkgPD0gYm91bmRzLnkgKyBib3VuZHMuaDtcbiAgcmV0dXJuIHdpdGhpblggJiYgd2l0aGluWTtcbn1cbmZ1bmN0aW9uIGZpbmRDbG9zZXN0SW50ZXJzZWN0aW9uKHJheSwgdGFyZ2V0cywgZmxvdykge1xuICBjb25zdCByYXlPcmlnaW4gPSB7XG4gICAgeDogcmF5LngxLFxuICAgIHk6IHJheS55MVxuICB9O1xuICBpZiAodGFyZ2V0cy5zb21lKCh0KSA9PiBwb2ludEluQm91bmRzKHJheU9yaWdpbiwgb2Zmc2V0UmVjdCh0LCBNYXRoLm1pbih0LncsIHQuaCkgLyAxMCwgZmxvdyA9PT0gXCJob3Jpem9udGFsXCIgPyBcInhcIiA6IFwieVwiKSkpKSByZXR1cm4gbnVsbDtcbiAgbGV0IGNsb3Nlc3RJbnRlcnNlY3Rpb24sIGNsb3Nlc3RSZWN0O1xuICBmb3IgKGNvbnN0IHRhcmdldCBvZiB0YXJnZXRzKSB7XG4gICAgY29uc3QgaW50ZXJzZWN0aW9ucyA9IHJheVJlY3RJbnRlcnNlY3Rpb25zKHJheSwgb2Zmc2V0UmVjdCh0YXJnZXQsIE1hdGgubWluKHRhcmdldC53LCB0YXJnZXQuaCkgLyAxMCwgZmxvdyA9PT0gXCJob3Jpem9udGFsXCIgPyBcInhcIiA6IFwieVwiKSk7XG4gICAgaWYgKGludGVyc2VjdGlvbnMpIHtcbiAgICAgIGNvbnN0IGZpcnN0SW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uc1swXTtcbiAgICAgIGNsb3Nlc3RJbnRlcnNlY3Rpb24gPyBwb2ludERpc3QocmF5T3JpZ2luLCBmaXJzdEludGVyc2VjdGlvbikgPCBwb2ludERpc3QocmF5T3JpZ2luLCBjbG9zZXN0SW50ZXJzZWN0aW9uKSAmJiAoY2xvc2VzdEludGVyc2VjdGlvbiA9IGZpcnN0SW50ZXJzZWN0aW9uLCBjbG9zZXN0UmVjdCA9IHRhcmdldCkgOiAoY2xvc2VzdEludGVyc2VjdGlvbiA9IGZpcnN0SW50ZXJzZWN0aW9uLCBjbG9zZXN0UmVjdCA9IHRhcmdldCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBjbG9zZXN0UmVjdCB8fCBudWxsO1xufVxuZnVuY3Rpb24gc2NhbGVSZWN0KHJlY3QsIHNjYWxlLCBvcmlnaW4pIHtcbiAgY29uc3Qge1xuICAgIHgsXG4gICAgeSxcbiAgICB3LFxuICAgIGhcbiAgfSA9IHJlY3QsIHtcbiAgICB4OiBvcmlnaW5YLFxuICAgIHk6IG9yaWdpbllcbiAgfSA9IG9yaWdpbiwgbmV3WCA9IG9yaWdpblggKyAoeCAtIG9yaWdpblgpICogc2NhbGUsIG5ld1kgPSBvcmlnaW5ZICsgKHkgLSBvcmlnaW5ZKSAqIHNjYWxlLCBuZXdXaWR0aCA9IHcgKiBzY2FsZSwgbmV3SGVpZ2h0ID0gaCAqIHNjYWxlO1xuICByZXR1cm4ge1xuICAgIHg6IG5ld1gsXG4gICAgeTogbmV3WSxcbiAgICB3OiBuZXdXaWR0aCxcbiAgICBoOiBuZXdIZWlnaHRcbiAgfTtcbn1cbmZ1bmN0aW9uIGdldFJlY3RHcm91cFhFeHRlbnQocmVjdHMpIHtcbiAgY29uc3QgbWluR3JvdXBYID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oLi4ucmVjdHMubWFwKChyKSA9PiByLngpKSksIG1heEdyb3VwWCA9IE1hdGgubWluKGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGgsIE1hdGgubWF4KC4uLnJlY3RzLm1hcCgocikgPT4gci54ICsgci53KSkpO1xuICByZXR1cm4ge1xuICAgIG1pbjogbWluR3JvdXBYLFxuICAgIG1heDogbWF4R3JvdXBYLFxuICAgIHdpZHRoOiBtYXhHcm91cFggLSBtaW5Hcm91cFhcbiAgfTtcbn1cbmZ1bmN0aW9uIGdldFJlY3RHcm91cFlFeHRlbnQocmVjdHMpIHtcbiAgY29uc3QgbWluR3JvdXBZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oLi4ucmVjdHMubWFwKChyKSA9PiByLnkpKSksIG1heEdyb3VwWSA9IE1hdGgubWluKGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBNYXRoLm1heCguLi5yZWN0cy5tYXAoKHIpID0+IHIueSArIHIuaCkpKTtcbiAgcmV0dXJuIHtcbiAgICBtaW46IG1pbkdyb3VwWSxcbiAgICBtYXg6IG1heEdyb3VwWSxcbiAgICBoZWlnaHQ6IG1heEdyb3VwWSAtIG1pbkdyb3VwWVxuICB9O1xufVxuZnVuY3Rpb24gY2FsY1RhcmdldEZsb3codGFyZ2V0cykge1xuICByZXR1cm4gdGFyZ2V0cy5zb21lKCh0MSkgPT4gdGFyZ2V0cy5maWx0ZXIoKHQyKSA9PiAhcmVjdEVxdWFsKHQxLCB0MikpLnNvbWUoKHQyKSA9PiB0MS55ID09PSB0Mi55KSkgPyBcImhvcml6b250YWxcIiA6IFwidmVydGljYWxcIjtcbn1cbmZ1bmN0aW9uIGNhbGNJbnNlcnRQb3NpdGlvbihvcmlnaW4sIHRhcmdldHMsIGZsb3cpIHtcbiAgaWYgKGZsb3cgPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgY29uc3QgcmF5TGVmdCA9IHtcbiAgICAgIHgxOiBvcmlnaW4ueCxcbiAgICAgIHkxOiBvcmlnaW4ueSxcbiAgICAgIHgyOiBvcmlnaW4ueCAtIDFlOCxcbiAgICAgIHkyOiBvcmlnaW4ueVxuICAgIH0sIHJheVJpZ2h0ID0ge1xuICAgICAgeDE6IG9yaWdpbi54LFxuICAgICAgeTE6IG9yaWdpbi55LFxuICAgICAgeDI6IG9yaWdpbi54ICsgMWU4LFxuICAgICAgeTI6IG9yaWdpbi55XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgbGVmdDogZmluZENsb3Nlc3RJbnRlcnNlY3Rpb24ocmF5TGVmdCwgdGFyZ2V0cywgZmxvdyksXG4gICAgICByaWdodDogZmluZENsb3Nlc3RJbnRlcnNlY3Rpb24ocmF5UmlnaHQsIHRhcmdldHMsIGZsb3cpXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCByYXlUb3AgPSB7XG4gICAgICB4MTogb3JpZ2luLngsXG4gICAgICB5MTogb3JpZ2luLnksXG4gICAgICB4Mjogb3JpZ2luLngsXG4gICAgICB5Mjogb3JpZ2luLnkgLSAxZThcbiAgICB9LCByYXlCb3R0b20gPSB7XG4gICAgICB4MTogb3JpZ2luLngsXG4gICAgICB5MTogb3JpZ2luLnksXG4gICAgICB4Mjogb3JpZ2luLngsXG4gICAgICB5Mjogb3JpZ2luLnkgKyAxZThcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICB0b3A6IGZpbmRDbG9zZXN0SW50ZXJzZWN0aW9uKHJheVRvcCwgdGFyZ2V0cywgZmxvdyksXG4gICAgICBib3R0b206IGZpbmRDbG9zZXN0SW50ZXJzZWN0aW9uKHJheUJvdHRvbSwgdGFyZ2V0cywgZmxvdylcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBmaW5kUmVjdFNhbml0eURhdGEocmVjdCwgb3ZlcmxheUdyb3VwKSB7XG4gIHJldHVybiBvdmVybGF5R3JvdXAuZmluZCgoZSkgPT4gcmVjdEVxdWFsKGdldFJlY3QoZS5lbGVtZW50cy5lbGVtZW50KSwgcmVjdCkpPy5zYW5pdHk7XG59XG5mdW5jdGlvbiByZXNvbHZlSW5zZXJ0UG9zaXRpb24ob3ZlcmxheUdyb3VwLCBpbnNlcnRQb3NpdGlvbiwgZmxvdykge1xuICByZXR1cm4gT2JqZWN0LnZhbHVlcyhpbnNlcnRQb3NpdGlvbikuZXZlcnkoKHYpID0+IHYgPT09IG51bGwpID8gbnVsbCA6IGZsb3cgPT09IFwiaG9yaXpvbnRhbFwiID8ge1xuICAgIGxlZnQ6IGluc2VydFBvc2l0aW9uLmxlZnQgPyB7XG4gICAgICByZWN0OiBpbnNlcnRQb3NpdGlvbi5sZWZ0LFxuICAgICAgc2FuaXR5OiBmaW5kUmVjdFNhbml0eURhdGEoaW5zZXJ0UG9zaXRpb24ubGVmdCwgb3ZlcmxheUdyb3VwKVxuICAgIH0gOiBudWxsLFxuICAgIHJpZ2h0OiBpbnNlcnRQb3NpdGlvbi5yaWdodCA/IHtcbiAgICAgIHJlY3Q6IGluc2VydFBvc2l0aW9uLnJpZ2h0LFxuICAgICAgc2FuaXR5OiBmaW5kUmVjdFNhbml0eURhdGEoaW5zZXJ0UG9zaXRpb24ucmlnaHQsIG92ZXJsYXlHcm91cClcbiAgICB9IDogbnVsbFxuICB9IDoge1xuICAgIHRvcDogaW5zZXJ0UG9zaXRpb24udG9wID8ge1xuICAgICAgcmVjdDogaW5zZXJ0UG9zaXRpb24udG9wLFxuICAgICAgc2FuaXR5OiBmaW5kUmVjdFNhbml0eURhdGEoaW5zZXJ0UG9zaXRpb24udG9wLCBvdmVybGF5R3JvdXApXG4gICAgfSA6IG51bGwsXG4gICAgYm90dG9tOiBpbnNlcnRQb3NpdGlvbi5ib3R0b20gPyB7XG4gICAgICByZWN0OiBpbnNlcnRQb3NpdGlvbi5ib3R0b20sXG4gICAgICBzYW5pdHk6IGZpbmRSZWN0U2FuaXR5RGF0YShpbnNlcnRQb3NpdGlvbi5ib3R0b20sIG92ZXJsYXlHcm91cClcbiAgICB9IDogbnVsbFxuICB9O1xufVxuZnVuY3Rpb24gY2FsY01vdXNlUG9zKGUpIHtcbiAgY29uc3QgYm9keUJvdW5kcyA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHJldHVybiB7XG4gICAgeDogTWF0aC5tYXgoYm9keUJvdW5kcy54LCBNYXRoLm1pbihlLmNsaWVudFgsIGJvZHlCb3VuZHMueCArIGJvZHlCb3VuZHMud2lkdGgpKSxcbiAgICB5OiBlLmNsaWVudFkgKyB3aW5kb3cuc2Nyb2xsWVxuICB9O1xufVxuZnVuY3Rpb24gY2FsY01vdXNlUG9zSW52ZXJzZVRyYW5zZm9ybShtb3VzZVBvczIpIHtcbiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHksIHRyYW5zZm9ybSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGJvZHkpLnRyYW5zZm9ybTtcbiAgaWYgKHRyYW5zZm9ybSA9PT0gXCJub25lXCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IG1vdXNlUG9zMi54LFxuICAgICAgeTogbW91c2VQb3MyLnlcbiAgICB9O1xuICBjb25zdCBpbnZlcnNlTWF0cml4ID0gbmV3IERPTU1hdHJpeCh0cmFuc2Zvcm0pLmludmVyc2UoKSwgdHJhbnNmb3JtZWRQb2ludCA9IG5ldyBET01Qb2ludChtb3VzZVBvczIueCwgbW91c2VQb3MyLnkpLm1hdHJpeFRyYW5zZm9ybShpbnZlcnNlTWF0cml4KTtcbiAgcmV0dXJuIHtcbiAgICB4OiB0cmFuc2Zvcm1lZFBvaW50LngsXG4gICAgeTogdHJhbnNmb3JtZWRQb2ludC55XG4gIH07XG59XG5mdW5jdGlvbiBidWlsZFByZXZpZXdTa2VsZXRvbihtb3VzZVBvczIsIGVsZW1lbnQsIHNjYWxlRmFjdG9yKSB7XG4gIGNvbnN0IGJvdW5kcyA9IGdldFJlY3QoZWxlbWVudCksIGNoaWxkcmVuID0gWy4uLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIjp3aGVyZShoMSwgaDIsIGgzLCBoNCwgcCwgYSwgaW1nLCBzcGFuLCBidXR0b24pOm5vdCg6aGFzKCopKVwiKV07XG4gIG1vdXNlUG9zMi54IDw9IGJvdW5kcy54ICYmIChtb3VzZVBvczIueCA9IGJvdW5kcy54KSwgbW91c2VQb3MyLnggPj0gYm91bmRzLnggKyBib3VuZHMudyAmJiAobW91c2VQb3MyLnggPSBib3VuZHMueCArIGJvdW5kcy53KSwgbW91c2VQb3MyLnkgPj0gYm91bmRzLnkgKyBib3VuZHMuaCAmJiAobW91c2VQb3MyLnkgPSBib3VuZHMueSArIGJvdW5kcy5oKSwgbW91c2VQb3MyLnkgPD0gYm91bmRzLnkgJiYgKG1vdXNlUG9zMi55ID0gYm91bmRzLnkpO1xuICBjb25zdCBjaGlsZFJlY3RzID0gY2hpbGRyZW4ubWFwKChjaGlsZCkgPT4ge1xuICAgIGNvbnN0IHJlY3QgPSBzY2FsZVJlY3QoZ2V0UmVjdChjaGlsZCksIHNjYWxlRmFjdG9yLCB7XG4gICAgICB4OiBib3VuZHMueCxcbiAgICAgIHk6IGJvdW5kcy55XG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IHJlY3QueCAtIGJvdW5kcy54LFxuICAgICAgeTogcmVjdC55IC0gYm91bmRzLnksXG4gICAgICB3OiByZWN0LncsXG4gICAgICBoOiByZWN0LmgsXG4gICAgICB0YWdOYW1lOiBjaGlsZC50YWdOYW1lXG4gICAgfTtcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgb2Zmc2V0WDogKGJvdW5kcy54IC0gbW91c2VQb3MyLngpICogc2NhbGVGYWN0b3IsXG4gICAgb2Zmc2V0WTogKGJvdW5kcy55IC0gbW91c2VQb3MyLnkpICogc2NhbGVGYWN0b3IsXG4gICAgdzogYm91bmRzLncgKiBzY2FsZUZhY3RvcixcbiAgICBoOiBib3VuZHMuaCAqIHNjYWxlRmFjdG9yLFxuICAgIG1heFdpZHRoOiBib3VuZHMudyAqIHNjYWxlRmFjdG9yICogMC43NSxcbiAgICBjaGlsZFJlY3RzXG4gIH07XG59XG5jb25zdCBtaW5EcmFnRGVsdGEgPSA0O1xuYXN5bmMgZnVuY3Rpb24gYXBwbHlNaW5pbWFwV3JhcHBlclRyYW5zZm9ybSh0YXJnZXQsIHNjYWxlRmFjdG9yLCBtaW5ZU2NhbGVkLCBoYW5kbGVyLCByZWN0VXBkYXRlRnJlcXVlbmN5KSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCAoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdFbmRNaW5pbWFwVHJhbnNpdGlvblwiXG4gICAgICAgIH0pO1xuICAgICAgfSwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSAqIDIpLCByZXNvbHZlKCk7XG4gICAgfSwge1xuICAgICAgb25jZTogITBcbiAgICB9KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1N0YXJ0TWluaW1hcFRyYW5zaXRpb25cIlxuICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFwiLFxuICAgICAgZGlzcGxheTogITBcbiAgICB9KSwgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCIsIGRvY3VtZW50LmJvZHkuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCIsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IFwiaW5pdGlhbFwiLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCIsIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGFyZ2V0LnN0eWxlLnRyYW5zZm9ybU9yaWdpbiA9IFwiNTAlIDBweFwiLCB0YXJnZXQuc3R5bGUudHJhbnNpdGlvbiA9IFwidHJhbnNmb3JtIDE1MG1zIGVhc2VcIiwgdGFyZ2V0LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUzZCgwcHgsICR7LW1pbllTY2FsZWQgKyBzY3JvbGxZfXB4LCAwcHgpIHNjYWxlKCR7c2NhbGVGYWN0b3J9KWA7XG4gICAgfSwgMjUpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGNhbGNNaW5pbWFwVHJhbnNmb3JtVmFsdWVzKHJlY3RzLCBncm91cEhlaWdodE92ZXJyaWRlKSB7XG4gIGxldCBncm91cEhlaWdodCA9IGdyb3VwSGVpZ2h0T3ZlcnJpZGUgfHwgZ2V0UmVjdEdyb3VwWUV4dGVudChyZWN0cykuaGVpZ2h0O1xuICBjb25zdCBwYWRkaW5nID0gMTAwO1xuICBncm91cEhlaWdodCArPSBwYWRkaW5nICogMjtcbiAgY29uc3Qgc2NhbGVGYWN0b3IgPSBncm91cEhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCA/IHdpbmRvdy5pbm5lckhlaWdodCAvIGdyb3VwSGVpZ2h0IDogMSwgc2NhbGVkUmVjdHMgPSByZWN0cy5tYXAoKHIpID0+IHNjYWxlUmVjdChyLCBzY2FsZUZhY3Rvciwge1xuICAgIHg6IHdpbmRvdy5pbm5lcldpZHRoIC8gMixcbiAgICB5OiAwXG4gIH0pKSwge1xuICAgIG1pbjogbWluWVNjYWxlZFxuICB9ID0gZ2V0UmVjdEdyb3VwWUV4dGVudChzY2FsZWRSZWN0cyk7XG4gIHJldHVybiB7XG4gICAgc2NhbGVGYWN0b3IsXG4gICAgbWluWVNjYWxlZDogbWluWVNjYWxlZCAtIHBhZGRpbmcgKiBzY2FsZUZhY3RvclxuICB9O1xufVxuZnVuY3Rpb24gY2FsY0dyb3VwQm91bmRzUHJldmlldyhyZWN0cykge1xuICBjb25zdCBncm91cEJvdW5kc1ggPSBnZXRSZWN0R3JvdXBYRXh0ZW50KHJlY3RzKSwgZ3JvdXBCb3VuZHNZID0gZ2V0UmVjdEdyb3VwWUV4dGVudChyZWN0cyksIG9mZnNldERpc3QgPSA4LCBjYW5PZmZzZXRYID0gZ3JvdXBCb3VuZHNYLm1pbiA+IG9mZnNldERpc3QgJiYgZ3JvdXBCb3VuZHNYLm1pbiArIGdyb3VwQm91bmRzWC53aWR0aCA8PSB3aW5kb3cuaW5uZXJXaWR0aCAtIG9mZnNldERpc3QsIGNhbk9mZnNldFkgPSBncm91cEJvdW5kc1kubWluID4gb2Zmc2V0RGlzdCAmJiBncm91cEJvdW5kc1kubWluICsgZ3JvdXBCb3VuZHNZLmhlaWdodCA8PSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCAtIG9mZnNldERpc3QsIGNhbk9mZnNldCA9IGNhbk9mZnNldFggJiYgY2FuT2Zmc2V0WTtcbiAgcmV0dXJuIHtcbiAgICB4OiBjYW5PZmZzZXQgPyBncm91cEJvdW5kc1gubWluIC0gb2Zmc2V0RGlzdCA6IGdyb3VwQm91bmRzWC5taW4sXG4gICAgeTogY2FuT2Zmc2V0ID8gZ3JvdXBCb3VuZHNZLm1pbiAtIG9mZnNldERpc3QgOiBncm91cEJvdW5kc1kubWluLFxuICAgIHc6IGNhbk9mZnNldCA/IGdyb3VwQm91bmRzWC53aWR0aCArIG9mZnNldERpc3QgKiAyIDogZ3JvdXBCb3VuZHNYLndpZHRoLFxuICAgIGg6IGNhbk9mZnNldCA/IGdyb3VwQm91bmRzWS5oZWlnaHQgKyBvZmZzZXREaXN0ICogMiA6IGdyb3VwQm91bmRzWS5oZWlnaHRcbiAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0TWluaW1hcFdyYXBwZXJUcmFuc2Zvcm0oZW5kWU9yaWdpbiwgdGFyZ2V0LCBwcmVzY2FsZUhlaWdodDIsIGhhbmRsZXIsIHJlY3RVcGRhdGVGcmVxdWVuY3ksIHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzMikge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjb25zdCB0cmFuc2Zvcm0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0YXJnZXQpLnRyYW5zZm9ybTtcbiAgICBpZiAobmV3IERPTU1hdHJpeCh0cmFuc2Zvcm0pLmEgPT09IDEpIHJldHVybjtcbiAgICBjb25zdCBtYXhTY3JvbGwgPSBwcmVzY2FsZUhlaWdodDIgLSB3aW5kb3cuaW5uZXJIZWlnaHQsIHByZXZTY3JvbGxZID0gc2Nyb2xsWTtcbiAgICBlbmRZT3JpZ2luIC09IHdpbmRvdy5pbm5lckhlaWdodCAvIDIsIGVuZFlPcmlnaW4gPCAwICYmIChlbmRZT3JpZ2luID0gMCksIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCAoKSA9PiB7XG4gICAgICB0YXJnZXQuc3R5bGUudHJhbnNpdGlvbiA9IFwibm9uZVwiLCB0YXJnZXQuc3R5bGUudHJhbnNmb3JtID0gXCJub25lXCIsIHNjcm9sbFRvKHtcbiAgICAgICAgdG9wOiBlbmRZT3JpZ2luLFxuICAgICAgICBiZWhhdmlvcjogXCJpbnN0YW50XCJcbiAgICAgIH0pLCBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdFbmRNaW5pbWFwVHJhbnNpdGlvblwiXG4gICAgICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBcIixcbiAgICAgICAgICBkaXNwbGF5OiAhMVxuICAgICAgICB9KTtcbiAgICAgIH0sIHJlY3RVcGRhdGVGcmVxdWVuY3kgKiAyKSwgcmVzb2x2ZSgpO1xuICAgIH0sIHtcbiAgICAgIG9uY2U6ICEwXG4gICAgfSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdTdGFydE1pbmltYXBUcmFuc2l0aW9uXCJcbiAgICB9KSwgdGFyZ2V0LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVZKCR7TWF0aC5tYXgocHJldlNjcm9sbFkgLSBlbmRZT3JpZ2luLCAtbWF4U2Nyb2xsICsgcHJldlNjcm9sbFkpfXB4KSBzY2FsZSgxKWAsIHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzMiAmJiAoZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzMi5ib2R5Lm92ZXJmbG93LCBkb2N1bWVudC5ib2R5LnN0eWxlLmhlaWdodCA9IHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzMi5ib2R5LmhlaWdodCwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gcHJldmlvdXNSb290U3R5bGVWYWx1ZXMyLmRvY3VtZW50RWxlbWVudC5vdmVyZmxvdywgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmhlaWdodCA9IHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzMi5kb2N1bWVudEVsZW1lbnQuaGVpZ2h0KTtcbiAgfSk7XG59XG5sZXQgbWluaW1hcFNjYWxlQXBwbGllZCA9ICExLCBtb3VzZVBvc0ludmVyc2VUcmFuc2Zvcm0gPSB7XG4gIHk6IDBcbn0sIG1vdXNlUG9zID0ge1xuICB4OiAwLFxuICB5OiAwXG59LCBwcmVzY2FsZUhlaWdodCA9IHR5cGVvZiBkb2N1bWVudCA+IFwidVwiID8gMCA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQsIHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzID0gbnVsbDtcbmZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlEcmFnKG9wdHMpIHtcbiAgY29uc3Qge1xuICAgIG1vdXNlRXZlbnQsXG4gICAgZWxlbWVudCxcbiAgICBvdmVybGF5R3JvdXAsXG4gICAgaGFuZGxlcixcbiAgICB0YXJnZXQsXG4gICAgb25TZXF1ZW5jZVN0YXJ0LFxuICAgIG9uU2VxdWVuY2VFbmRcbiAgfSA9IG9wdHM7XG4gIGlmIChtb3VzZUV2ZW50LmJ1dHRvbiAhPT0gMCkgcmV0dXJuO1xuICB3aW5kb3cuZm9jdXMoKTtcbiAgY29uc3QgcmVjdFVwZGF0ZUZyZXF1ZW5jeSA9IDE1MDtcbiAgbGV0IHJlY3RzID0gb3ZlcmxheUdyb3VwLm1hcCgoZSkgPT4gZ2V0UmVjdChlLmVsZW1lbnRzLmVsZW1lbnQpKTtcbiAgY29uc3QgZmxvdyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1mbG93XCIpIHx8IGNhbGNUYXJnZXRGbG93KHJlY3RzKSwgZHJhZ0dyb3VwID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWdyb3VwXCIpLCBkaXNhYmxlTWluaW1hcCA9ICEhZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLW1pbmltYXAtZGlzYWJsZVwiKSwgcHJldmVudEluc2VydERlZmF1bHQgPSAhIWVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1wcmV2ZW50LWRlZmF1bHRcIiksIGRvY3VtZW50SGVpZ2h0T3ZlcnJpZGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdW5zdGFibGVfc2FuaXR5LWRyYWctZG9jdW1lbnQtaGVpZ2h0XCIpLCBncm91cEhlaWdodE92ZXJyaWRlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXVuc3RhYmxlX3Nhbml0eS1kcmFnLWdyb3VwLWhlaWdodFwiKTtcbiAgbGV0IGluc2VydFBvc2l0aW9uID0gbnVsbDtcbiAgY29uc3QgaW5pdGlhbE1vdXNlUG9zID0gY2FsY01vdXNlUG9zKG1vdXNlRXZlbnQpLCBzY2FsZVRhcmdldCA9IGRvY3VtZW50LmJvZHksIHtcbiAgICBtaW5ZU2NhbGVkLFxuICAgIHNjYWxlRmFjdG9yXG4gIH0gPSBjYWxjTWluaW1hcFRyYW5zZm9ybVZhbHVlcyhyZWN0cywgZ3JvdXBIZWlnaHRPdmVycmlkZSA/IH5+Z3JvdXBIZWlnaHRPdmVycmlkZSA6IG51bGwpO1xuICBsZXQgc2VxdWVuY2VTdGFydGVkID0gITEsIG1pbmltYXBQcm9tcHRTaG93biA9ICExLCBtb3VzZWRvd24gPSAhMDtcbiAgbWluaW1hcFNjYWxlQXBwbGllZCB8fCAocHJldmlvdXNSb290U3R5bGVWYWx1ZXMgPSB7XG4gICAgYm9keToge1xuICAgICAgb3ZlcmZsb3c6IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLm92ZXJmbG93LFxuICAgICAgaGVpZ2h0OiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5oZWlnaHRcbiAgICB9LFxuICAgIGRvY3VtZW50RWxlbWVudDoge1xuICAgICAgb3ZlcmZsb3c6IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkub3ZlcmZsb3csXG4gICAgICBoZWlnaHQ6IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuaGVpZ2h0XG4gICAgfVxuICB9LCBwcmVzY2FsZUhlaWdodCA9IGRvY3VtZW50SGVpZ2h0T3ZlcnJpZGUgPyB+fmRvY3VtZW50SGVpZ2h0T3ZlcnJpZGUgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0KTtcbiAgY29uc3QgcmVjdHNJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICByZWN0cyA9IG92ZXJsYXlHcm91cC5tYXAoKGUpID0+IGdldFJlY3QoZS5lbGVtZW50cy5lbGVtZW50KSk7XG4gIH0sIHJlY3RVcGRhdGVGcmVxdWVuY3kpLCBhcHBseU1pbmltYXAgPSAoKSA9PiB7XG4gICAgaWYgKHNjYWxlRmFjdG9yID49IDEpIHJldHVybjtcbiAgICBjb25zdCBza2VsZXRvbiA9IGJ1aWxkUHJldmlld1NrZWxldG9uKG1vdXNlUG9zLCBlbGVtZW50LCBzY2FsZUZhY3Rvcik7XG4gICAgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZVNrZWxldG9uXCIsXG4gICAgICBza2VsZXRvblxuICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFByb21wdFwiLFxuICAgICAgZGlzcGxheTogITFcbiAgICB9KSwgYXBwbHlNaW5pbWFwV3JhcHBlclRyYW5zZm9ybShzY2FsZVRhcmdldCwgc2NhbGVGYWN0b3IsIG1pbllTY2FsZWQsIGhhbmRsZXIsIHJlY3RVcGRhdGVGcmVxdWVuY3kpLnRoZW4oKCkgPT4ge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGhhbmRsZXIoe1xuICAgICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlR3JvdXBSZWN0XCIsXG4gICAgICAgICAgZ3JvdXBSZWN0OiBjYWxjR3JvdXBCb3VuZHNQcmV2aWV3KHJlY3RzKVxuICAgICAgICB9KTtcbiAgICAgIH0sIHJlY3RVcGRhdGVGcmVxdWVuY3kgKiAyKTtcbiAgICB9KTtcbiAgfSwgaGFuZGxlU2Nyb2xsID0gKGUpID0+IHtcbiAgICBNYXRoLmFicyhlLmRlbHRhWSkgPj0gMTAgJiYgc2NhbGVGYWN0b3IgPCAxICYmICFtaW5pbWFwU2NhbGVBcHBsaWVkICYmICFtaW5pbWFwUHJvbXB0U2hvd24gJiYgIWRpc2FibGVNaW5pbWFwICYmIG1vdXNlZG93biAmJiAoaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBQcm9tcHRcIixcbiAgICAgIGRpc3BsYXk6ICEwXG4gICAgfSksIG1pbmltYXBQcm9tcHRTaG93biA9ICEwKSwgZS5zaGlmdEtleSAmJiAhbWluaW1hcFNjYWxlQXBwbGllZCAmJiAhZGlzYWJsZU1pbmltYXAgJiYgKHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcInVuc3RhYmxlX3Nhbml0eS9kcmFnQXBwbHlNaW5pbWFwXCIpKSwgbWluaW1hcFNjYWxlQXBwbGllZCA9ICEwLCBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGFwcGx5TWluaW1hcCgpO1xuICAgIH0sIDUwKSk7XG4gIH0sIGhhbmRsZU1vdXNlTW92ZSA9IChlKSA9PiB7XG4gICAgaWYgKGUucHJldmVudERlZmF1bHQoKSwgbW91c2VQb3MgPSBjYWxjTW91c2VQb3MoZSksIG1vdXNlUG9zSW52ZXJzZVRyYW5zZm9ybSA9IGNhbGNNb3VzZVBvc0ludmVyc2VUcmFuc2Zvcm0obW91c2VQb3MpLCBNYXRoLmFicyhwb2ludERpc3QobW91c2VQb3MsIGluaXRpYWxNb3VzZVBvcykpIDwgbWluRHJhZ0RlbHRhKSByZXR1cm47XG4gICAgaWYgKCFzZXF1ZW5jZVN0YXJ0ZWQpIHtcbiAgICAgIGNvbnN0IGdyb3VwUmVjdCA9IGNhbGNHcm91cEJvdW5kc1ByZXZpZXcocmVjdHMpLCBza2VsZXRvbiA9IGJ1aWxkUHJldmlld1NrZWxldG9uKG1vdXNlUG9zLCBlbGVtZW50LCAxKTtcbiAgICAgIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1N0YXJ0XCIsXG4gICAgICAgIGZsb3dcbiAgICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVTa2VsZXRvblwiLFxuICAgICAgICBza2VsZXRvblxuICAgICAgfSksIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUdyb3VwUmVjdFwiLFxuICAgICAgICBncm91cFJlY3RcbiAgICAgIH0pLCBzZXF1ZW5jZVN0YXJ0ZWQgPSAhMCwgb25TZXF1ZW5jZVN0YXJ0KCk7XG4gICAgfVxuICAgIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVDdXJzb3JQb3NpdGlvblwiLFxuICAgICAgeDogbW91c2VQb3MueCxcbiAgICAgIHk6IG1vdXNlUG9zLnlcbiAgICB9KSwgZS5zaGlmdEtleSAmJiAhbWluaW1hcFNjYWxlQXBwbGllZCAmJiAhZGlzYWJsZU1pbmltYXAgJiYgKHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcInVuc3RhYmxlX3Nhbml0eS9kcmFnQXBwbHlNaW5pbWFwXCIpKSwgbWluaW1hcFNjYWxlQXBwbGllZCA9ICEwLCBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGFwcGx5TWluaW1hcCgpO1xuICAgIH0sIDUwKSk7XG4gICAgY29uc3QgbmV3SW5zZXJ0UG9zaXRpb24gPSBjYWxjSW5zZXJ0UG9zaXRpb24obW91c2VQb3MsIHJlY3RzLCBmbG93KTtcbiAgICBKU09OLnN0cmluZ2lmeShpbnNlcnRQb3NpdGlvbikgIT09IEpTT04uc3RyaW5naWZ5KG5ld0luc2VydFBvc2l0aW9uKSAmJiAoaW5zZXJ0UG9zaXRpb24gPSBuZXdJbnNlcnRQb3NpdGlvbiwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUluc2VydFBvc2l0aW9uXCIsXG4gICAgICBpbnNlcnRQb3NpdGlvbjogcmVzb2x2ZUluc2VydFBvc2l0aW9uKG92ZXJsYXlHcm91cCwgaW5zZXJ0UG9zaXRpb24sIGZsb3cpXG4gICAgfSkpO1xuICB9LCBoYW5kbGVNb3VzZVVwID0gKCkgPT4ge1xuICAgIG1vdXNlZG93biA9ICExLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnRW5kXCIsXG4gICAgICB0YXJnZXQsXG4gICAgICBpbnNlcnRQb3NpdGlvbjogaW5zZXJ0UG9zaXRpb24gPyByZXNvbHZlSW5zZXJ0UG9zaXRpb24ob3ZlcmxheUdyb3VwLCBpbnNlcnRQb3NpdGlvbiwgZmxvdykgOiBudWxsLFxuICAgICAgZHJhZ0dyb3VwLFxuICAgICAgZmxvdyxcbiAgICAgIHByZXZlbnRJbnNlcnREZWZhdWx0XG4gICAgfSksIG1pbmltYXBQcm9tcHRTaG93biAmJiBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFByb21wdFwiLFxuICAgICAgZGlzcGxheTogITFcbiAgICB9KSwgbWluaW1hcFNjYWxlQXBwbGllZCB8fCAoY2xlYXJJbnRlcnZhbChyZWN0c0ludGVydmFsKSwgb25TZXF1ZW5jZUVuZCgpLCByZW1vdmVGcmFtZUxpc3RlbmVycygpLCByZW1vdmVLZXlMaXN0ZW5lcnMoKSksIHJlbW92ZU1vdXNlTGlzdGVuZXJzKCk7XG4gIH0sIGhhbmRsZUtleXVwID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiU2hpZnRcIiAmJiBtaW5pbWFwU2NhbGVBcHBsaWVkKSB7XG4gICAgICBtaW5pbWFwU2NhbGVBcHBsaWVkID0gITE7XG4gICAgICBjb25zdCBza2VsZXRvbiA9IGJ1aWxkUHJldmlld1NrZWxldG9uKG1vdXNlUG9zLCBlbGVtZW50LCAxIC8gc2NhbGVGYWN0b3IpO1xuICAgICAgaGFuZGxlcih7XG4gICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlU2tlbGV0b25cIixcbiAgICAgICAgc2tlbGV0b25cbiAgICAgIH0pLCB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJ1bnN0YWJsZV9zYW5pdHkvZHJhZ1Jlc2V0TWluaW1hcFwiKSksIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICByZXNldE1pbmltYXBXcmFwcGVyVHJhbnNmb3JtKG1vdXNlUG9zSW52ZXJzZVRyYW5zZm9ybS55LCBzY2FsZVRhcmdldCwgcHJlc2NhbGVIZWlnaHQsIGhhbmRsZXIsIHJlY3RVcGRhdGVGcmVxdWVuY3ksIHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzKTtcbiAgICAgIH0sIDUwKSwgaGFuZGxlcih7XG4gICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlR3JvdXBSZWN0XCIsXG4gICAgICAgIGdyb3VwUmVjdDogbnVsbFxuICAgICAgfSksIG1vdXNlZG93biB8fCAoY2xlYXJJbnRlcnZhbChyZWN0c0ludGVydmFsKSwgcmVtb3ZlTW91c2VMaXN0ZW5lcnMoKSwgcmVtb3ZlRnJhbWVMaXN0ZW5lcnMoKSwgcmVtb3ZlS2V5TGlzdGVuZXJzKCksIG9uU2VxdWVuY2VFbmQoKSk7XG4gICAgfVxuICB9LCBoYW5kbGVCbHVyID0gKCkgPT4ge1xuICAgIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVHcm91cFJlY3RcIixcbiAgICAgIGdyb3VwUmVjdDogbnVsbFxuICAgIH0pLCB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJ1bnN0YWJsZV9zYW5pdHkvZHJhZ1Jlc2V0TWluaW1hcFwiKSksIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgcmVzZXRNaW5pbWFwV3JhcHBlclRyYW5zZm9ybShtb3VzZVBvc0ludmVyc2VUcmFuc2Zvcm0ueSwgc2NhbGVUYXJnZXQsIHByZXNjYWxlSGVpZ2h0LCBoYW5kbGVyLCByZWN0VXBkYXRlRnJlcXVlbmN5LCBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlcykudGhlbigoKSA9PiB7XG4gICAgICAgIG1pbmltYXBTY2FsZUFwcGxpZWQgPSAhMTtcbiAgICAgIH0pO1xuICAgIH0sIDUwKSwgY2xlYXJJbnRlcnZhbChyZWN0c0ludGVydmFsKSwgcmVtb3ZlTW91c2VMaXN0ZW5lcnMoKSwgcmVtb3ZlRnJhbWVMaXN0ZW5lcnMoKSwgcmVtb3ZlS2V5TGlzdGVuZXJzKCksIG9uU2VxdWVuY2VFbmQoKTtcbiAgfSwgcmVtb3ZlTW91c2VMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgaGFuZGxlTW91c2VNb3ZlKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCBoYW5kbGVTY3JvbGwpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgaGFuZGxlTW91c2VVcCk7XG4gIH0sIHJlbW92ZUtleUxpc3RlbmVycyA9ICgpID0+IHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUtleXVwKTtcbiAgfSwgcmVtb3ZlRnJhbWVMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGhhbmRsZUJsdXIpO1xuICB9O1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgaGFuZGxlQmx1ciksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgaGFuZGxlS2V5dXApLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIGhhbmRsZVNjcm9sbCksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZU1vdXNlTW92ZSksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBoYW5kbGVNb3VzZVVwKTtcbn1cbmNvbnN0IGlzRWxlbWVudE5vZGUkMSA9ICh0YXJnZXQpID0+IHRhcmdldCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IHx8IHRhcmdldCBpbnN0YW5jZW9mIFNWR0VsZW1lbnQ7XG5mdW5jdGlvbiBmaW5kTm9uSW5saW5lRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IHtcbiAgICBkaXNwbGF5XG4gIH0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbiAgaWYgKGRpc3BsYXkgIT09IFwiaW5saW5lXCIpIHJldHVybiBlbGVtZW50O1xuICBjb25zdCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gIHJldHVybiBwYXJlbnQgPyBmaW5kTm9uSW5saW5lRWxlbWVudChwYXJlbnQpIDogbnVsbDtcbn1cbmNvbnN0IGZpbmRPdmVybGF5RWxlbWVudCA9IChlbCkgPT4gIWVsIHx8ICFpc0VsZW1lbnROb2RlJDEoZWwpID8gbnVsbCA6IGVsLmRhdGFzZXQ/LnNhbml0eU92ZXJsYXlFbGVtZW50ID8gZWwgOiBmaW5kT3ZlcmxheUVsZW1lbnQoZWwucGFyZW50RWxlbWVudCk7XG5mdW5jdGlvbiB0ZXN0VmVyY2VsU3RlZ2FSZWdleChpbnB1dCkge1xuICByZXR1cm4gVkVSQ0VMX1NURUdBX1JFR0VYLmxhc3RJbmRleCA9IDAsIFZFUkNFTF9TVEVHQV9SRUdFWC50ZXN0KGlucHV0KTtcbn1cbmZ1bmN0aW9uIGRlY29kZVN0ZWdhKHN0ciwgaXNBbHRUZXh0ID0gITEpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkZWNvZGVkID0gdmVyY2VsU3RlZ2FEZWNvZGUoc3RyKTtcbiAgICByZXR1cm4gIWRlY29kZWQgfHwgZGVjb2RlZC5vcmlnaW4gIT09IFwic2FuaXR5LmlvXCIgPyBudWxsIDogKGlzQWx0VGV4dCAmJiAoZGVjb2RlZC5ocmVmID0gZGVjb2RlZC5ocmVmPy5yZXBsYWNlKFwiLmFsdFwiLCBcIlwiKSksIGRlY29kZWQpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBkZWNvZGUgc3RlZ2EgZm9yIHN0cmluZzogXCIsIHN0ciwgXCJ3aXRoIHRoZSBvcmlnaW5hbCBlcnJvcjogXCIsIGVyciksIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIHRlc3RBbmREZWNvZGVTdGVnYShzdHIsIGlzQWx0VGV4dCA9ICExKSB7XG4gIHJldHVybiB0ZXN0VmVyY2VsU3RlZ2FSZWdleChzdHIpID8gZGVjb2RlU3RlZ2Eoc3RyLCBpc0FsdFRleHQpIDogbnVsbDtcbn1cbmNvbnN0IGlzRWxlbWVudE5vZGUgPSAobm9kZSkgPT4gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUsIGlzSW1nRWxlbWVudCA9IChlbCkgPT4gZWwudGFnTmFtZSA9PT0gXCJJTUdcIiwgaXNUaW1lRWxlbWVudCA9IChlbCkgPT4gZWwudGFnTmFtZSA9PT0gXCJUSU1FXCIsIGlzU3ZnUm9vdEVsZW1lbnQgPSAoZWwpID0+IGVsLnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PT0gXCJTVkdcIjtcbmZ1bmN0aW9uIGlzU2FuaXR5Tm9kZShub2RlKSB7XG4gIHJldHVybiBcInBhdGhcIiBpbiBub2RlO1xufVxuZnVuY3Rpb24gZmluZENvbW1vblBhdGgoZmlyc3QsIHNlY29uZCkge1xuICBsZXQgZmlyc3RQYXJ0cyA9IGZpcnN0LnNwbGl0KFwiLlwiKSwgc2Vjb25kUGFydHMgPSBzZWNvbmQuc3BsaXQoXCIuXCIpO1xuICBjb25zdCBtYXhMZW5ndGggPSBNYXRoLm1pbihmaXJzdFBhcnRzLmxlbmd0aCwgc2Vjb25kUGFydHMubGVuZ3RoKTtcbiAgcmV0dXJuIGZpcnN0UGFydHMgPSBmaXJzdFBhcnRzLnNsaWNlKDAsIG1heExlbmd0aCkucmV2ZXJzZSgpLCBzZWNvbmRQYXJ0cyA9IHNlY29uZFBhcnRzLnNsaWNlKDAsIG1heExlbmd0aCkucmV2ZXJzZSgpLCBmaXJzdFBhcnRzLnJlZHVjZSgocGFydHMsIHBhcnQsIGkpID0+IHBhcnQgPT09IHNlY29uZFBhcnRzW2ldID8gWy4uLnBhcnRzLCBwYXJ0XSA6IFtdLCBbXSkucmV2ZXJzZSgpLmpvaW4oXCIuXCIpO1xufVxuZnVuY3Rpb24gZmluZENvbW1vblNhbml0eURhdGEobm9kZXMpIHtcbiAgaWYgKCFub2Rlcy5sZW5ndGggfHwgIW5vZGVzLm1hcCgobikgPT4gaXNTYW5pdHlOb2RlKG4pKS5ldmVyeSgobiwgX2ksIGFycikgPT4gbiA9PT0gYXJyWzBdKSlcbiAgICByZXR1cm47XG4gIGlmICghaXNTYW5pdHlOb2RlKG5vZGVzWzBdKSkgcmV0dXJuIG5vZGVzWzBdO1xuICBjb25zdCBzYW5pdHlOb2RlcyA9IG5vZGVzLmZpbHRlcihpc1Nhbml0eU5vZGUpO1xuICBsZXQgY29tbW9uID0gbm9kZXNbMF07XG4gIGNvbnN0IGNvbnNpc3RlbnRWYWx1ZUtleXMgPSBbXCJwcm9qZWN0SWRcIiwgXCJkYXRhc2V0XCIsIFwiaWRcIiwgXCJiYXNlVXJsXCIsIFwid29ya3NwYWNlXCIsIFwidG9vbFwiXTtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBzYW5pdHlOb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IG5vZGUgPSBzYW5pdHlOb2Rlc1tpXTtcbiAgICBpZiAoY29uc2lzdGVudFZhbHVlS2V5cy5zb21lKChrZXkpID0+IG5vZGVba2V5XSAhPT0gY29tbW9uPy5ba2V5XSkpIHtcbiAgICAgIGNvbW1vbiA9IHZvaWQgMDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjb21tb24gPSB7XG4gICAgICAuLi5jb21tb24sXG4gICAgICBwYXRoOiBmaW5kQ29tbW9uUGF0aChjb21tb24ucGF0aCwgbm9kZS5wYXRoKVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNvbW1vbjtcbn1cbmZ1bmN0aW9uIGZpbmRTYW5pdHlOb2RlcyhlbCkge1xuICBjb25zdCBtYWluUmVzdWx0cyA9IFtdO1xuICBmdW5jdGlvbiBjcmVhdGVSZXNvbHZlZEVsZW1lbnQoZWxlbWVudCwgZGF0YSwgcmVhc29uLCBwcmV2ZW50R3JvdXBpbmcpIHtcbiAgICBjb25zdCBzYW5pdHkgPSBkZWNvZGVTYW5pdHlOb2RlRGF0YShkYXRhKTtcbiAgICBpZiAoIXNhbml0eSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBtZWFzdXJlRWxlbWVudCA9IGZpbmROb25JbmxpbmVFbGVtZW50KGVsZW1lbnQpO1xuICAgIGlmIChtZWFzdXJlRWxlbWVudClcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICBtZWFzdXJlRWxlbWVudFxuICAgICAgICB9LFxuICAgICAgICBzYW5pdHksXG4gICAgICAgIHJlYXNvbixcbiAgICAgICAgcHJldmVudEdyb3VwaW5nXG4gICAgICB9O1xuICB9XG4gIGZ1bmN0aW9uIHJlc29sdmVOb2RlKG5vZGUpIHtcbiAgICBjb25zdCB7XG4gICAgICBub2RlVHlwZSxcbiAgICAgIHBhcmVudEVsZW1lbnQsXG4gICAgICB0ZXh0Q29udGVudFxuICAgIH0gPSBub2RlO1xuICAgIGlmIChpc0VsZW1lbnROb2RlKG5vZGUpICYmIG5vZGUuZGF0YXNldD8uc2FuaXR5RWRpdFRhcmdldCAhPT0gdm9pZCAwKSB7XG4gICAgICBjb25zdCBub2Rlc0luVGFyZ2V0ID0gZmluZFNhbml0eU5vZGVzKG5vZGUpLCBjb21tb25EYXRhID0gZmluZENvbW1vblNhbml0eURhdGEobm9kZXNJblRhcmdldC5tYXAoKG5vZGUyKSA9PiBub2RlMi50eXBlID09PSBcImVsZW1lbnRcIiA/IG5vZGUyLmNvbW1vblNhbml0eSA6IHZvaWQgMCkuZmlsdGVyKChuKSA9PiBuICE9PSB2b2lkIDApKTtcbiAgICAgIGlmIChjb21tb25EYXRhKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlYXNvbjogXCJlZGl0LXRhcmdldFwiLFxuICAgICAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgICAgICBlbGVtZW50OiBub2RlLFxuICAgICAgICAgICAgbWVhc3VyZUVsZW1lbnQ6IG5vZGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNhbml0eTogY29tbW9uRGF0YVxuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAobm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFICYmIHBhcmVudEVsZW1lbnQgJiYgdGV4dENvbnRlbnQpIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB0ZXN0QW5kRGVjb2RlU3RlZ2EodGV4dENvbnRlbnQpO1xuICAgICAgcmV0dXJuIGRhdGEgPyBjcmVhdGVSZXNvbHZlZEVsZW1lbnQocGFyZW50RWxlbWVudCwgZGF0YSwgXCJzdGVnYS10ZXh0XCIsICEwKSA6IHZvaWQgMDtcbiAgICB9IGVsc2UgaWYgKGlzRWxlbWVudE5vZGUobm9kZSkpIHtcbiAgICAgIGlmIChub2RlLnRhZ05hbWUgPT09IFwiU0NSSVBUXCIgfHwgbm9kZS50YWdOYW1lID09PSBcIlNBTklUWS1WSVNVQUwtRURJVElOR1wiKVxuICAgICAgICByZXR1cm47XG4gICAgICBpZiAobm9kZS5kYXRhc2V0Py5zYW5pdHkpXG4gICAgICAgIHJldHVybiBjcmVhdGVSZXNvbHZlZEVsZW1lbnQobm9kZSwgbm9kZS5kYXRhc2V0LnNhbml0eSwgXCJkYXRhLWF0dHJpYnV0ZVwiLCAhIShub2RlLnRleHRDb250ZW50ICYmIHRlc3RWZXJjZWxTdGVnYVJlZ2V4KG5vZGUudGV4dENvbnRlbnQpKSk7XG4gICAgICBpZiAobm9kZS5kYXRhc2V0Py5zYW5pdHlFZGl0SW5mbylcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVJlc29sdmVkRWxlbWVudChub2RlLCBub2RlLmRhdGFzZXQuc2FuaXR5RWRpdEluZm8sIFwiZGF0YS1hdHRyaWJ1dGVcIiwgISEobm9kZS50ZXh0Q29udGVudCAmJiB0ZXN0VmVyY2VsU3RlZ2FSZWdleChub2RlLnRleHRDb250ZW50KSkpO1xuICAgICAgaWYgKGlzSW1nRWxlbWVudChub2RlKSkge1xuICAgICAgICBjb25zdCBkYXRhID0gdGVzdEFuZERlY29kZVN0ZWdhKG5vZGUuYWx0LCAhMCk7XG4gICAgICAgIHJldHVybiBkYXRhID8gY3JlYXRlUmVzb2x2ZWRFbGVtZW50KG5vZGUsIGRhdGEsIFwic3RlZ2EtYXR0cmlidXRlXCIpIDogdm9pZCAwO1xuICAgICAgfSBlbHNlIGlmIChpc1RpbWVFbGVtZW50KG5vZGUpKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB0ZXN0QW5kRGVjb2RlU3RlZ2Eobm9kZS5kYXRlVGltZSwgITApO1xuICAgICAgICByZXR1cm4gZGF0YSA/IGNyZWF0ZVJlc29sdmVkRWxlbWVudChub2RlLCBkYXRhLCBcInN0ZWdhLWF0dHJpYnV0ZVwiKSA6IHZvaWQgMDtcbiAgICAgIH0gZWxzZSBpZiAoaXNTdmdSb290RWxlbWVudChub2RlKSkge1xuICAgICAgICBpZiAoIW5vZGUuYXJpYUxhYmVsKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGRhdGEgPSB0ZXN0QW5kRGVjb2RlU3RlZ2Eobm9kZS5hcmlhTGFiZWwsICEwKTtcbiAgICAgICAgcmV0dXJuIGRhdGEgPyBjcmVhdGVSZXNvbHZlZEVsZW1lbnQobm9kZSwgZGF0YSwgXCJzdGVnYS1hdHRyaWJ1dGVcIikgOiB2b2lkIDA7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHByb2Nlc3NOb2RlKG5vZGUsIF9wYXJlbnRHcm91cCkge1xuICAgIGNvbnN0IHJlc29sdmVkRWxlbWVudCA9IHJlc29sdmVOb2RlKG5vZGUpO1xuICAgIGxldCBwYXJlbnRHcm91cCA9IF9wYXJlbnRHcm91cDtcbiAgICBpZiAoaXNFbGVtZW50Tm9kZShub2RlKSAmJiBub2RlLmRhdGFzZXQ/LnNhbml0eUVkaXRHcm91cCAhPT0gdm9pZCAwICYmIChwYXJlbnRHcm91cCA9IHtcbiAgICAgIHR5cGU6IFwiZ3JvdXBcIixcbiAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgIGVsZW1lbnQ6IG5vZGUsXG4gICAgICAgIG1lYXN1cmVFbGVtZW50OiBub2RlXG4gICAgICB9LFxuICAgICAgdGFyZ2V0czogW11cbiAgICB9LCBtYWluUmVzdWx0cy5wdXNoKHBhcmVudEdyb3VwKSksIHJlc29sdmVkRWxlbWVudCkge1xuICAgICAgY29uc3QgdGFyZ2V0ID0ge1xuICAgICAgICBlbGVtZW50czogcmVzb2x2ZWRFbGVtZW50LmVsZW1lbnRzLFxuICAgICAgICBzYW5pdHk6IHJlc29sdmVkRWxlbWVudC5zYW5pdHksXG4gICAgICAgIHJlYXNvbjogcmVzb2x2ZWRFbGVtZW50LnJlYXNvblxuICAgICAgfTtcbiAgICAgIHBhcmVudEdyb3VwICYmICFyZXNvbHZlZEVsZW1lbnQucHJldmVudEdyb3VwaW5nID8gcGFyZW50R3JvdXAudGFyZ2V0cy5wdXNoKHRhcmdldCkgOiBtYWluUmVzdWx0cy5wdXNoKHtcbiAgICAgICAgZWxlbWVudHM6IHJlc29sdmVkRWxlbWVudC5lbGVtZW50cyxcbiAgICAgICAgdHlwZTogXCJlbGVtZW50XCIsXG4gICAgICAgIHRhcmdldHM6IFt0YXJnZXRdXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzRWxlbWVudE5vZGUobm9kZSkgJiYgIWlzSW1nRWxlbWVudChub2RlKSAmJiAhKG5vZGUudGFnTmFtZSA9PT0gXCJTQ1JJUFRcIiB8fCBub2RlLnRhZ05hbWUgPT09IFwiU0FOSVRZLVZJU1VBTC1FRElUSU5HXCIpKVxuICAgICAgZm9yIChjb25zdCBjaGlsZE5vZGUgb2Ygbm9kZS5jaGlsZE5vZGVzKVxuICAgICAgICBwcm9jZXNzTm9kZShjaGlsZE5vZGUsIHBhcmVudEdyb3VwKTtcbiAgfVxuICBpZiAoZWwpXG4gICAgZm9yIChjb25zdCBub2RlIG9mIGVsLmNoaWxkTm9kZXMpXG4gICAgICBwcm9jZXNzTm9kZShub2RlLCB2b2lkIDApO1xuICByZXR1cm4gbWFpblJlc3VsdHMubWFwKChub2RlKSA9PiB7XG4gICAgaWYgKG5vZGUudGFyZ2V0cy5sZW5ndGggPT09IDAgJiYgbm9kZS50eXBlID09PSBcImdyb3VwXCIpXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5ub2RlLFxuICAgICAgICBjb21tb25TYW5pdHk6IHZvaWQgMFxuICAgICAgfTtcbiAgICBjb25zdCBjb21tb25TYW5pdHkgPSBub2RlLnRhcmdldHMubGVuZ3RoID09PSAxID8gbm9kZS50YXJnZXRzWzBdLnNhbml0eSA6IGZpbmRDb21tb25TYW5pdHlEYXRhKG5vZGUudGFyZ2V0cy5tYXAoKHtcbiAgICAgIHNhbml0eVxuICAgIH0pID0+IHNhbml0eSkuZmlsdGVyKChuKSA9PiBuICE9PSB2b2lkIDApKSB8fCBub2RlLnRhcmdldHNbMF0uc2FuaXR5O1xuICAgIHJldHVybiBjb21tb25TYW5pdHkgPyB7XG4gICAgICAuLi5ub2RlLFxuICAgICAgY29tbW9uU2FuaXR5XG4gICAgfSA6IG51bGw7XG4gIH0pLmZpbHRlcigobm9kZSkgPT4gbm9kZSAhPT0gbnVsbCk7XG59XG5mdW5jdGlvbiBpc1Nhbml0eUFycmF5UGF0aChwYXRoKSB7XG4gIGNvbnN0IGxhc3REb3RJbmRleCA9IHBhdGgubGFzdEluZGV4T2YoXCIuXCIpO1xuICByZXR1cm4gcGF0aC5zdWJzdHJpbmcobGFzdERvdEluZGV4LCBwYXRoLmxlbmd0aCkuaW5jbHVkZXMoXCJbXCIpO1xufVxuZnVuY3Rpb24gZ2V0U2FuaXR5Tm9kZUFycmF5UGF0aChwYXRoKSB7XG4gIGlmICghaXNTYW5pdHlBcnJheVBhdGgocGF0aCkpIHJldHVybiBudWxsO1xuICBjb25zdCBzcGxpdCA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICByZXR1cm4gc3BsaXRbc3BsaXQubGVuZ3RoIC0gMV0gPSBzcGxpdFtzcGxpdC5sZW5ndGggLSAxXS5yZXBsYWNlKC9cXFsuKj9cXF0vZywgXCJbXVwiKSwgc3BsaXQuam9pbihcIi5cIik7XG59XG5mdW5jdGlvbiBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXkoc2FuaXR5Tm9kZTEsIHNhbml0eU5vZGUyKSB7XG4gIHJldHVybiAhaXNTYW5pdHlBcnJheVBhdGgoc2FuaXR5Tm9kZTEucGF0aCkgfHwgIWlzU2FuaXR5QXJyYXlQYXRoKHNhbml0eU5vZGUyLnBhdGgpID8gITEgOiBnZXRTYW5pdHlOb2RlQXJyYXlQYXRoKHNhbml0eU5vZGUxLnBhdGgpID09PSBnZXRTYW5pdHlOb2RlQXJyYXlQYXRoKHNhbml0eU5vZGUyLnBhdGgpO1xufVxuZnVuY3Rpb24gcmVzb2x2ZURyYWdBbmREcm9wR3JvdXAoZWxlbWVudCwgc2FuaXR5LCBlbGVtZW50U2V0LCBlbGVtZW50c01hcCkge1xuICBpZiAoIWVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHlcIikgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWRpc2FibGVcIikgfHwgIXNhbml0eSB8fCAhaXNTYW5pdHlOb2RlKHNhbml0eSkgfHwgIWlzU2FuaXR5QXJyYXlQYXRoKHNhbml0eS5wYXRoKSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHRhcmdldERyYWdHcm91cCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1ncm91cFwiKSwgZ3JvdXAgPSBbLi4uZWxlbWVudFNldF0ucmVkdWNlKChhY2MsIGVsKSA9PiB7XG4gICAgY29uc3QgZWxEYXRhID0gZWxlbWVudHNNYXAuZ2V0KGVsKSwgZWxEcmFnRGlzYWJsZWQgPSBlbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWRpc2FibGVcIiksIGVsRHJhZ0dyb3VwID0gZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1ncm91cFwiKSwgZWxIYXNTYW5pdHlBdHRyaWJ1dGlvbiA9IGVsLmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5XCIpICE9PSBudWxsLCBzaGFyZWREcmFnR3JvdXAgPSB0YXJnZXREcmFnR3JvdXAgIT09IG51bGwgPyB0YXJnZXREcmFnR3JvdXAgPT09IGVsRHJhZ0dyb3VwIDogITA7XG4gICAgcmV0dXJuIGVsRGF0YT8uc2FuaXR5ICYmICFlbERyYWdEaXNhYmxlZCAmJiBpc1Nhbml0eU5vZGUoZWxEYXRhLnNhbml0eSkgJiYgc2FuaXR5Tm9kZXNFeGlzdEluU2FtZUFycmF5KHNhbml0eSwgZWxEYXRhLnNhbml0eSkgJiYgc2hhcmVkRHJhZ0dyb3VwICYmIGVsSGFzU2FuaXR5QXR0cmlidXRpb24gJiYgYWNjLnB1c2goZWxEYXRhKSwgYWNjO1xuICB9LCBbXSk7XG4gIHJldHVybiBncm91cC5sZW5ndGggPD0gMSA/IG51bGwgOiBncm91cDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXlDb250cm9sbGVyKHtcbiAgaGFuZGxlcixcbiAgb3ZlcmxheUVsZW1lbnQsXG4gIGluRnJhbWUsXG4gIGluUG9wVXAsXG4gIG9wdGltaXN0aWNBY3RvclJlYWR5XG59KSB7XG4gIGxldCBhY3RpdmF0ZWQgPSAhMTtcbiAgY29uc3QgZWxlbWVudElkTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSwgZWxlbWVudHNNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKSwgZWxlbWVudFNldCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksIG1lYXN1cmVFbGVtZW50cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpLCBjdXJzb3JNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgbGV0IHJvLCBpbywgbW8sIGFjdGl2ZURyYWdTZXF1ZW5jZSA9ICExLCBob3ZlclN0YWNrID0gW107XG4gIGNvbnN0IGdldEhvdmVyZWRFbGVtZW50ID0gKCkgPT4gaG92ZXJTdGFja1tob3ZlclN0YWNrLmxlbmd0aCAtIDFdO1xuICBmdW5jdGlvbiBhZGRFdmVudEhhbmRsZXJzKGVsLCBoYW5kbGVycykge1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVycy5jbGljaywge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGhhbmRsZXJzLmNvbnRleHRtZW51LCB7XG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZXJzLm1vdXNlbW92ZSwge1xuICAgICAgb25jZTogITAsXG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZXJzLm1vdXNlZG93biwge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiByZW1vdmVFdmVudEhhbmRsZXJzKGVsLCBoYW5kbGVycykge1xuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVycy5jbGljaywge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGhhbmRsZXJzLmNvbnRleHRtZW51LCB7XG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZXJzLm1vdXNlbW92ZSwge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVycy5tb3VzZWRvd24sIHtcbiAgICAgIGNhcHR1cmU6ICEwXG4gICAgfSksIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIGhhbmRsZXJzLm1vdXNlZW50ZXIpLCBlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBoYW5kbGVycy5tb3VzZWxlYXZlKTtcbiAgfVxuICBmdW5jdGlvbiBhY3RpdmF0ZUVsZW1lbnQoe1xuICAgIGlkLFxuICAgIGVsZW1lbnRzLFxuICAgIGhhbmRsZXJzXG4gIH0pIHtcbiAgICBjb25zdCB7XG4gICAgICBlbGVtZW50LFxuICAgICAgbWVhc3VyZUVsZW1lbnRcbiAgICB9ID0gZWxlbWVudHM7XG4gICAgYWRkRXZlbnRIYW5kbGVycyhlbGVtZW50LCBoYW5kbGVycyksIHJvLm9ic2VydmUobWVhc3VyZUVsZW1lbnQpLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwiZWxlbWVudC9hY3RpdmF0ZVwiLFxuICAgICAgaWRcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiBkZWFjdGl2YXRlRWxlbWVudCh7XG4gICAgaWQsXG4gICAgZWxlbWVudHMsXG4gICAgaGFuZGxlcnNcbiAgfSkge1xuICAgIGNvbnN0IHtcbiAgICAgIGVsZW1lbnQsXG4gICAgICBtZWFzdXJlRWxlbWVudFxuICAgIH0gPSBlbGVtZW50cztcbiAgICByZW1vdmVFdmVudEhhbmRsZXJzKGVsZW1lbnQsIGhhbmRsZXJzKSwgcm8udW5vYnNlcnZlKG1lYXN1cmVFbGVtZW50KSwgaG92ZXJTdGFjayA9IGhvdmVyU3RhY2suZmlsdGVyKChlbCkgPT4gZWwgIT09IGVsZW1lbnQpLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwiZWxlbWVudC9kZWFjdGl2YXRlXCIsXG4gICAgICBpZFxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIHNldE92ZXJsYXlDdXJzb3IoZWxlbWVudCkge1xuICAgIGlmICghKCFpbkZyYW1lICYmICFpblBvcFVwIHx8ICFvcHRpbWlzdGljQWN0b3JSZWFkeSkpXG4gICAgICBmb3IgKGNvbnN0IGhvdmVyc3RhY2tFbGVtZW50IG9mIGhvdmVyU3RhY2spIHtcbiAgICAgICAgaWYgKGVsZW1lbnQgPT09IGhvdmVyc3RhY2tFbGVtZW50KSB7XG4gICAgICAgICAgY29uc3QgdGFyZ2V0U2FuaXR5RGF0YSA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KT8uc2FuaXR5O1xuICAgICAgICAgIGlmICghdGFyZ2V0U2FuaXR5RGF0YSB8fCAhaXNTYW5pdHlOb2RlKHRhcmdldFNhbml0eURhdGEpKSByZXR1cm47XG4gICAgICAgICAgaWYgKHJlc29sdmVEcmFnQW5kRHJvcEdyb3VwKGVsZW1lbnQsIHRhcmdldFNhbml0eURhdGEsIGVsZW1lbnRTZXQsIGVsZW1lbnRzTWFwKSkge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdDdXJzb3IgPSBlbGVtZW50LnN0eWxlLmN1cnNvcjtcbiAgICAgICAgICAgIGV4aXN0aW5nQ3Vyc29yICYmIGN1cnNvck1hcC5zZXQoZWxlbWVudCwgZXhpc3RpbmdDdXJzb3IpLCBoYW5kbGVyKHtcbiAgICAgICAgICAgICAgdHlwZTogXCJvdmVybGF5L3NldEN1cnNvclwiLFxuICAgICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgICBjdXJzb3I6IFwibW92ZVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXN0b3JlT3ZlcmxheUN1cnNvcihob3ZlcnN0YWNrRWxlbWVudCk7XG4gICAgICB9XG4gIH1cbiAgZnVuY3Rpb24gcmVzdG9yZU92ZXJsYXlDdXJzb3IoZWxlbWVudCkge1xuICAgIGNvbnN0IHByZXZpb3VzQ3Vyc29yID0gY3Vyc29yTWFwLmdldChlbGVtZW50KTtcbiAgICBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9zZXRDdXJzb3JcIixcbiAgICAgIGVsZW1lbnQsXG4gICAgICBjdXJzb3I6IHByZXZpb3VzQ3Vyc29yXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHtcbiAgICB0eXBlLFxuICAgIGVsZW1lbnRzLFxuICAgIGNvbW1vblNhbml0eSxcbiAgICB0YXJnZXRzXG4gIH0pIHtcbiAgICBjb25zdCB7XG4gICAgICBlbGVtZW50LFxuICAgICAgbWVhc3VyZUVsZW1lbnRcbiAgICB9ID0gZWxlbWVudHMsIGV2ZW50SGFuZGxlcnMgPSB7XG4gICAgICBjbGljayhldmVudCkge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGlmIChlbGVtZW50ID09PSBnZXRIb3ZlcmVkRWxlbWVudCgpICYmIGVsZW1lbnQuY29udGFpbnModGFyZ2V0KSkge1xuICAgICAgICAgIGluRnJhbWUgJiYgKGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpKTtcbiAgICAgICAgICBjb25zdCBzYW5pdHkgPSBlbGVtZW50c01hcC5nZXQoZWxlbWVudCk/LnNhbml0eTtcbiAgICAgICAgICBzYW5pdHkgJiYgIWFjdGl2ZURyYWdTZXF1ZW5jZSAmJiBoYW5kbGVyKHtcbiAgICAgICAgICAgIHR5cGU6IFwiZWxlbWVudC9jbGlja1wiLFxuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICBzYW5pdHlcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGNvbnRleHRtZW51KGV2ZW50KSB7XG4gICAgICAgIGlmICghKFwicGF0aFwiIGluIGNvbW1vblNhbml0eSkgfHwgIWluRnJhbWUgJiYgIWluUG9wVXAgfHwgIW9wdGltaXN0aWNBY3RvclJlYWR5IHx8ICFjb21tb25TYW5pdHkucGF0aC5zcGxpdChcIi5cIikucG9wKCk/LmluY2x1ZGVzKFwiW19rZXk9PVwiKSkgcmV0dXJuO1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGVsZW1lbnQgPT09IGdldEhvdmVyZWRFbGVtZW50KCkgJiYgZWxlbWVudC5jb250YWlucyh0YXJnZXQpICYmICgoaW5GcmFtZSB8fCBpblBvcFVwKSAmJiAoZXZlbnQucHJldmVudERlZmF1bHQoKSwgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkpLCBoYW5kbGVyKHtcbiAgICAgICAgICB0eXBlOiBcImVsZW1lbnQvY29udGV4dG1lbnVcIixcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgeDogZXZlbnQuY2xpZW50WCxcbiAgICAgICAgICAgIHk6IGV2ZW50LmNsaWVudFlcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNhbml0eTogY29tbW9uU2FuaXR5XG4gICAgICAgIH0pKTtcbiAgICAgIH0sXG4gICAgICBtb3VzZWRvd24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGV2ZW50LmN1cnJlbnRUYXJnZXQgIT09IGhvdmVyU3RhY2suYXQoLTEpIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1kaXNhYmxlXCIpIHx8ICFpbkZyYW1lICYmICFpblBvcFVwIHx8ICFvcHRpbWlzdGljQWN0b3JSZWFkeSkgcmV0dXJuO1xuICAgICAgICBjb25zdCB0YXJnZXRTYW5pdHlEYXRhID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpPy5zYW5pdHk7XG4gICAgICAgIGlmICghdGFyZ2V0U2FuaXR5RGF0YSB8fCAhaXNTYW5pdHlOb2RlKHRhcmdldFNhbml0eURhdGEpIHx8ICFpc1Nhbml0eUFycmF5UGF0aCh0YXJnZXRTYW5pdHlEYXRhLnBhdGgpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGRyYWdHcm91cCA9IHJlc29sdmVEcmFnQW5kRHJvcEdyb3VwKGVsZW1lbnQsIGNvbW1vblNhbml0eSwgZWxlbWVudFNldCwgZWxlbWVudHNNYXApO1xuICAgICAgICBkcmFnR3JvdXAgJiYgaGFuZGxlT3ZlcmxheURyYWcoe1xuICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgaGFuZGxlcixcbiAgICAgICAgICBtb3VzZUV2ZW50OiBldmVudCxcbiAgICAgICAgICBvdmVybGF5R3JvdXA6IGRyYWdHcm91cCxcbiAgICAgICAgICB0YXJnZXQ6IHRhcmdldFNhbml0eURhdGEsXG4gICAgICAgICAgb25TZXF1ZW5jZVN0YXJ0OiAoKSA9PiB7XG4gICAgICAgICAgICBhY3RpdmVEcmFnU2VxdWVuY2UgPSAhMDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uU2VxdWVuY2VFbmQ6ICgpID0+IHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBhY3RpdmVEcmFnU2VxdWVuY2UgPSAhMTtcbiAgICAgICAgICAgIH0sIDI1MCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBtb3VzZW1vdmUoZXZlbnQpIHtcbiAgICAgICAgZXZlbnRIYW5kbGVycy5tb3VzZWVudGVyKGV2ZW50KTtcbiAgICAgICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICBlbCAmJiAoZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZXZlbnRIYW5kbGVycy5tb3VzZWVudGVyKSwgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZXZlbnRIYW5kbGVycy5tb3VzZWxlYXZlKSk7XG4gICAgICB9LFxuICAgICAgbW91c2VlbnRlcigpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInZlcmNlbC1saXZlLWZlZWRiYWNrXCIpICYmIGVsZW1lbnQuY2xvc2VzdChcIltkYXRhLXZlcmNlbC1lZGl0LWluZm9dXCIpIHx8IGVsZW1lbnQuY2xvc2VzdChcIltkYXRhLXZlcmNlbC1lZGl0LXRhcmdldF1cIikgfHwgKGhvdmVyU3RhY2sucHVzaChlbGVtZW50KSwgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJlbGVtZW50L21vdXNlZW50ZXJcIixcbiAgICAgICAgICBpZCxcbiAgICAgICAgICByZWN0OiBnZXRSZWN0KGVsZW1lbnQpXG4gICAgICAgIH0pLCBzZXRPdmVybGF5Q3Vyc29yKGVsZW1lbnQpKTtcbiAgICAgIH0sXG4gICAgICBtb3VzZWxlYXZlKGUpIHtcbiAgICAgICAgZnVuY3Rpb24gbGVhdmUoKSB7XG4gICAgICAgICAgaG92ZXJTdGFjay5wb3AoKTtcbiAgICAgICAgICBjb25zdCBob3ZlcmVkRWxlbWVudCA9IGdldEhvdmVyZWRFbGVtZW50KCk7XG4gICAgICAgICAgaWYgKGhhbmRsZXIoe1xuICAgICAgICAgICAgdHlwZTogXCJlbGVtZW50L21vdXNlbGVhdmVcIixcbiAgICAgICAgICAgIGlkXG4gICAgICAgICAgfSksIGhvdmVyZWRFbGVtZW50KSB7XG4gICAgICAgICAgICBzZXRPdmVybGF5Q3Vyc29yKGhvdmVyZWRFbGVtZW50KTtcbiAgICAgICAgICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChob3ZlcmVkRWxlbWVudCk7XG4gICAgICAgICAgICBvdmVybGF5RWxlbWVudDIgJiYgaGFuZGxlcih7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZWxlbWVudC9tb3VzZWVudGVyXCIsXG4gICAgICAgICAgICAgIGlkOiBvdmVybGF5RWxlbWVudDIuaWQsXG4gICAgICAgICAgICAgIHJlY3Q6IGdldFJlY3QoaG92ZXJlZEVsZW1lbnQpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdG9yZU92ZXJsYXlDdXJzb3IoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYWRkRGVmZXJyZWRMZWF2ZShlbCkge1xuICAgICAgICAgIGNvbnN0IGRlZmVycmVkTGVhdmUgPSAoZTIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgcmVsYXRlZFRhcmdldDogcmVsYXRlZFRhcmdldDJcbiAgICAgICAgICAgIH0gPSBlMjtcbiAgICAgICAgICAgIGZpbmRPdmVybGF5RWxlbWVudChyZWxhdGVkVGFyZ2V0MikgPyByZWxhdGVkVGFyZ2V0MiAmJiBpc0VsZW1lbnROb2RlJDEocmVsYXRlZFRhcmdldDIpICYmIChlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBkZWZlcnJlZExlYXZlKSwgYWRkRGVmZXJyZWRMZWF2ZShyZWxhdGVkVGFyZ2V0MikpIDogKGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGRlZmVycmVkTGVhdmUpLCBsZWF2ZSgpKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGRlZmVycmVkTGVhdmUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICByZWxhdGVkVGFyZ2V0XG4gICAgICAgIH0gPSBlLCBjb250YWluZXIgPSBmaW5kT3ZlcmxheUVsZW1lbnQocmVsYXRlZFRhcmdldCksIGlzSW50ZXJhY3RpdmVPdmVybGF5RWxlbWVudCA9IG92ZXJsYXlFbGVtZW50LmNvbnRhaW5zKGNvbnRhaW5lcik7XG4gICAgICAgIGlmIChpc0VsZW1lbnROb2RlJDEoY29udGFpbmVyKSAmJiBpc0ludGVyYWN0aXZlT3ZlcmxheUVsZW1lbnQpXG4gICAgICAgICAgcmV0dXJuIGFkZERlZmVycmVkTGVhdmUoY29udGFpbmVyKTtcbiAgICAgICAgbGVhdmUoKTtcbiAgICAgIH1cbiAgICB9LCBpZCA9IHY0KCksIHNhbml0eU5vZGUgPSB7XG4gICAgICB0eXBlLFxuICAgICAgaWQsXG4gICAgICBlbGVtZW50cyxcbiAgICAgIHNhbml0eTogY29tbW9uU2FuaXR5LFxuICAgICAgaGFuZGxlcnM6IGV2ZW50SGFuZGxlcnNcbiAgICB9O1xuICAgIGVsZW1lbnRTZXQuYWRkKGVsZW1lbnQpLCBtZWFzdXJlRWxlbWVudHMuc2V0KG1lYXN1cmVFbGVtZW50LCBlbGVtZW50KSwgZWxlbWVudElkTWFwLnNldChpZCwgZWxlbWVudCksIGVsZW1lbnRzTWFwLnNldChlbGVtZW50LCBzYW5pdHlOb2RlKSwgaW8/Lm9ic2VydmUoZWxlbWVudCksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJlbGVtZW50L3JlZ2lzdGVyXCIsXG4gICAgICBlbGVtZW50VHlwZTogdHlwZSxcbiAgICAgIGlkLFxuICAgICAgZWxlbWVudCxcbiAgICAgIHJlY3Q6IGdldFJlY3QoZWxlbWVudCksXG4gICAgICBzYW5pdHk6IGNvbW1vblNhbml0eSxcbiAgICAgIGRyYWdEaXNhYmxlZDogISFlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctZGlzYWJsZVwiKSxcbiAgICAgIHRhcmdldHM6IHRhcmdldHMubWFwKCh0YXJnZXQpID0+ICh7XG4gICAgICAgIHNhbml0eTogdGFyZ2V0LnNhbml0eSxcbiAgICAgICAgZWxlbWVudDogdGFyZ2V0LmVsZW1lbnRzLmVsZW1lbnRcbiAgICAgIH0pKVxuICAgIH0pLCBhY3RpdmF0ZWQgJiYgYWN0aXZhdGVFbGVtZW50KHNhbml0eU5vZGUpO1xuICB9XG4gIGZ1bmN0aW9uIHVwZGF0ZUVsZW1lbnQocmVzb2x2ZWRFbGVtZW50KSB7XG4gICAgY29uc3Qge1xuICAgICAgZWxlbWVudFxuICAgIH0gPSByZXNvbHZlZEVsZW1lbnQuZWxlbWVudHMsIG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KTtcbiAgICBvdmVybGF5RWxlbWVudDIgJiYgKGVsZW1lbnRzTWFwLnNldChlbGVtZW50LCB7XG4gICAgICAuLi5vdmVybGF5RWxlbWVudDIsXG4gICAgICBzYW5pdHk6IHJlc29sdmVkRWxlbWVudC5jb21tb25TYW5pdHlcbiAgICB9KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvdXBkYXRlXCIsXG4gICAgICBlbGVtZW50VHlwZTogb3ZlcmxheUVsZW1lbnQyLnR5cGUsXG4gICAgICBpZDogb3ZlcmxheUVsZW1lbnQyLmlkLFxuICAgICAgcmVjdDogZ2V0UmVjdChlbGVtZW50KSxcbiAgICAgIHNhbml0eTogcmVzb2x2ZWRFbGVtZW50LmNvbW1vblNhbml0eSxcbiAgICAgIHRhcmdldHM6IHJlc29sdmVkRWxlbWVudC50YXJnZXRzLm1hcCgodGFyZ2V0KSA9PiAoe1xuICAgICAgICBzYW5pdHk6IHRhcmdldC5zYW5pdHksXG4gICAgICAgIGVsZW1lbnQ6IHRhcmdldC5lbGVtZW50cy5lbGVtZW50XG4gICAgICB9KSlcbiAgICB9KSk7XG4gIH1cbiAgZnVuY3Rpb24gcGFyc2VFbGVtZW50cyhub2RlKSB7XG4gICAgY29uc3Qgc2FuaXR5Tm9kZXMgPSBmaW5kU2FuaXR5Tm9kZXMobm9kZSk7XG4gICAgZm9yIChjb25zdCBzYW5pdHlOb2RlIG9mIHNhbml0eU5vZGVzKSB7XG4gICAgICBpZiAoc2FuaXR5Tm9kZS50eXBlID09PSBcImdyb3VwXCIpIHtcbiAgICAgICAgZm9yIChjb25zdCB0YXJnZXQgb2Ygc2FuaXR5Tm9kZS50YXJnZXRzKSB7XG4gICAgICAgICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KHRhcmdldC5lbGVtZW50cy5lbGVtZW50KTtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudDIgJiYgb3ZlcmxheUVsZW1lbnQyLnR5cGUgPT09IFwiZWxlbWVudFwiICYmIHVucmVnaXN0ZXJFbGVtZW50KHRhcmdldC5lbGVtZW50cy5lbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBzYW5pdHlOb2RlLnRhcmdldHMubGVuZ3RoID09PSAwICYmIHVucmVnaXN0ZXJFbGVtZW50KHNhbml0eU5vZGUuZWxlbWVudHMuZWxlbWVudCk7XG4gICAgICB9XG4gICAgICBpZiAoIXNhbml0eU5vZGUuY29tbW9uU2FuaXR5KSBjb250aW51ZTtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZWxlbWVudFxuICAgICAgfSA9IHNhbml0eU5vZGUuZWxlbWVudHM7XG4gICAgICBlbGVtZW50c01hcC5oYXMoZWxlbWVudCkgPyB1cGRhdGVFbGVtZW50KHNhbml0eU5vZGUpIDogcmVnaXN0ZXJFbGVtZW50KHNhbml0eU5vZGUpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KSB7XG4gICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpO1xuICAgIGlmIChvdmVybGF5RWxlbWVudDIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaWQsXG4gICAgICAgIGhhbmRsZXJzXG4gICAgICB9ID0gb3ZlcmxheUVsZW1lbnQyO1xuICAgICAgcmVtb3ZlRXZlbnRIYW5kbGVycyhlbGVtZW50LCBoYW5kbGVycyksIHJvLnVub2JzZXJ2ZShlbGVtZW50KSwgZWxlbWVudHNNYXAuZGVsZXRlKGVsZW1lbnQpLCBlbGVtZW50U2V0LmRlbGV0ZShlbGVtZW50KSwgZWxlbWVudElkTWFwLmRlbGV0ZShpZCksIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcImVsZW1lbnQvdW5yZWdpc3RlclwiLFxuICAgICAgICBpZFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZU11dGF0aW9uKG11dGF0aW9ucykge1xuICAgIGxldCBtdXRhdGlvbldhc0luU2NvcGUgPSAhMTtcbiAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgICAgY29uc3Qge1xuICAgICAgICB0YXJnZXQsXG4gICAgICAgIHR5cGVcbiAgICAgIH0gPSBtdXRhdGlvbiwgbm9kZSA9IHR5cGUgPT09IFwiY2hhcmFjdGVyRGF0YVwiID8gdGFyZ2V0LnBhcmVudEVsZW1lbnQgOiB0YXJnZXQ7XG4gICAgICBpZiAoIShub2RlID09PSBvdmVybGF5RWxlbWVudCB8fCBvdmVybGF5RWxlbWVudC5jb250YWlucyhub2RlKSkgJiYgKG11dGF0aW9uV2FzSW5TY29wZSA9ICEwLCBpc0VsZW1lbnROb2RlJDEobm9kZSkpKSB7XG4gICAgICAgIGNvbnN0IHBvc3NpYmxlR3JvdXBQYXJlbnQgPSBub2RlLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoXCJbZGF0YS1zYW5pdHktZWRpdC1ncm91cF1cIikgfHwgbnVsbCwgdXBkYXRlTm9kZVRhcmdldCA9IGlzRWxlbWVudE5vZGUkMShwb3NzaWJsZUdyb3VwUGFyZW50KSA/IHBvc3NpYmxlR3JvdXBQYXJlbnQgOiBub2RlO1xuICAgICAgICBwYXJzZUVsZW1lbnRzKHtcbiAgICAgICAgICBjaGlsZE5vZGVzOiBbdXBkYXRlTm9kZVRhcmdldF1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChtdXRhdGlvbldhc0luU2NvcGUpXG4gICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudFNldClcbiAgICAgICAgZWxlbWVudC5pc0Nvbm5lY3RlZCB8fCB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KSwgZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpPy50eXBlID09PSBcImdyb3VwXCIgJiYgIWVsZW1lbnQuaGFzQXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZWRpdC1ncm91cFwiKSAmJiB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KTtcbiAgfVxuICBmdW5jdGlvbiB1cGRhdGVSZWN0KGVsKSB7XG4gICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KGVsKTtcbiAgICBvdmVybGF5RWxlbWVudDIgJiYgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvdXBkYXRlUmVjdFwiLFxuICAgICAgaWQ6IG92ZXJsYXlFbGVtZW50Mi5pZCxcbiAgICAgIHJlY3Q6IGdldFJlY3QoZWwpXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlUmVzaXplKGVudHJpZXMpIHtcbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IGVudHJ5LnRhcmdldDtcbiAgICAgIGlmIChpc0VsZW1lbnROb2RlJDEodGFyZ2V0KSkge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gbWVhc3VyZUVsZW1lbnRzLmdldCh0YXJnZXQpO1xuICAgICAgICBpZiAoIWVsZW1lbnQpIHJldHVybjtcbiAgICAgICAgdXBkYXRlUmVjdChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlSW50ZXJzZWN0aW9uKGVudHJpZXMpIHtcbiAgICBpZiAoYWN0aXZhdGVkKVxuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICB0YXJnZXRcbiAgICAgICAgfSA9IGVudHJ5LCBtYXRjaCA9IGlzRWxlbWVudE5vZGUkMSh0YXJnZXQpICYmIGVsZW1lbnRzTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICBtYXRjaCAmJiAoZW50cnkuaXNJbnRlcnNlY3RpbmcgPyBhY3RpdmF0ZUVsZW1lbnQobWF0Y2gpIDogZGVhY3RpdmF0ZUVsZW1lbnQobWF0Y2gpKTtcbiAgICAgIH1cbiAgfVxuICBmdW5jdGlvbiBoYW5kbGVCbHVyKGV2ZW50KSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGZpbmRPdmVybGF5RWxlbWVudChldmVudC50YXJnZXQpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICBlbGVtZW50LmRhdGFzZXQuc2FuaXR5T3ZlcmxheUVsZW1lbnQgPT09IFwiY2FwdHVyZVwiICYmIChldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBldmVudC5zdG9wUHJvcGFnYXRpb24oKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGhvdmVyU3RhY2sgPSBbXSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvYmx1clwiXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlRXhjbHVzaXZlUGx1Z2luQ2xvc2VkKCkge1xuICAgIGhvdmVyU3RhY2sgPSBbXSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvcmVzZXQtbW91c2Utc3RhdGVcIlxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZVdpbmRvd1Jlc2l6ZSgpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudFNldClcbiAgICAgIHVwZGF0ZVJlY3QoZWxlbWVudCk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlS2V5ZG93bihldmVudCkge1xuICAgIGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIiAmJiAoaG92ZXJTdGFjayA9IFtdLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9ibHVyXCJcbiAgICB9KSk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlV2luZG93U2Nyb2xsKGV2ZW50KSB7XG4gICAgY29uc3Qge1xuICAgICAgdGFyZ2V0XG4gICAgfSA9IGV2ZW50O1xuICAgIGlmICghKHRhcmdldCA9PT0gd2luZG93LmRvY3VtZW50IHx8ICFpc0VsZW1lbnROb2RlJDEodGFyZ2V0KSkpXG4gICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudFNldClcbiAgICAgICAgdGFyZ2V0LmNvbnRhaW5zKGVsZW1lbnQpICYmIHVwZGF0ZVJlY3QoZWxlbWVudCk7XG4gIH1cbiAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgYWN0aXZhdGVkIHx8IChpbyA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihoYW5kbGVJbnRlcnNlY3Rpb24sIHtcbiAgICAgIHRocmVzaG9sZDogMC4zXG4gICAgfSksIGVsZW1lbnRTZXQuZm9yRWFjaCgoZWxlbWVudCkgPT4gaW8ub2JzZXJ2ZShlbGVtZW50KSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2FjdGl2YXRlXCJcbiAgICB9KSwgYWN0aXZhdGVkID0gITApO1xuICB9XG4gIGZ1bmN0aW9uIGRlYWN0aXZhdGUoKSB7XG4gICAgYWN0aXZhdGVkICYmIChpbz8uZGlzY29ubmVjdCgpLCBlbGVtZW50U2V0LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KTtcbiAgICAgIG92ZXJsYXlFbGVtZW50MiAmJiBkZWFjdGl2YXRlRWxlbWVudChvdmVybGF5RWxlbWVudDIpO1xuICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kZWFjdGl2YXRlXCJcbiAgICB9KSwgYWN0aXZhdGVkID0gITEpO1xuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZUhlYWRlckNsaWNrKGV2ZW50KSB7XG4gICAgY29uc3Qge1xuICAgICAgaWRcbiAgICB9ID0gZXZlbnQuZGV0YWlsLCBlbGVtZW50ID0gZWxlbWVudElkTWFwLmdldChpZCk7XG4gICAgaWYgKCFlbGVtZW50KSByZXR1cm47XG4gICAgY29uc3Qgc2FuaXR5ID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpPy5zYW5pdHk7XG4gICAgc2FuaXR5ICYmIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJlbGVtZW50L2NsaWNrXCIsXG4gICAgICBpZCxcbiAgICAgIHNhbml0eVxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVCbHVyKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVCbHVyKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzYW5pdHktb3ZlcmxheS9leGNsdXNpdmUtcGx1Z2luLWNsb3NlZFwiLCBoYW5kbGVFeGNsdXNpdmVQbHVnaW5DbG9zZWQpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNhbml0eS1vdmVybGF5L2xhYmVsLWNsaWNrXCIsIGhhbmRsZUhlYWRlckNsaWNrKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleWRvd24pLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBoYW5kbGVXaW5kb3dSZXNpemUpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBoYW5kbGVXaW5kb3dTY3JvbGwpLCBtby5kaXNjb25uZWN0KCksIHJvLmRpc2Nvbm5lY3QoKSwgZWxlbWVudFNldC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KTtcbiAgICB9KSwgZWxlbWVudElkTWFwLmNsZWFyKCksIGVsZW1lbnRTZXQuY2xlYXIoKSwgaG92ZXJTdGFjayA9IFtdLCBkZWFjdGl2YXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gY3JlYXRlKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQmx1ciksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgaGFuZGxlQmx1ciksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2FuaXR5LW92ZXJsYXkvZXhjbHVzaXZlLXBsdWdpbi1jbG9zZWRcIiwgaGFuZGxlRXhjbHVzaXZlUGx1Z2luQ2xvc2VkKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzYW5pdHktb3ZlcmxheS9sYWJlbC1jbGlja1wiLCBoYW5kbGVIZWFkZXJDbGljayksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVLZXlkb3duKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgaGFuZGxlV2luZG93UmVzaXplKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaGFuZGxlV2luZG93U2Nyb2xsLCB7XG4gICAgICBjYXB0dXJlOiAhMCxcbiAgICAgIHBhc3NpdmU6ICEwXG4gICAgfSksIHJvID0gbmV3IFJlc2l6ZU9ic2VydmVyKGhhbmRsZVJlc2l6ZSksIG1vID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoaGFuZGxlTXV0YXRpb24pLCBtby5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcbiAgICAgIGF0dHJpYnV0ZXM6ICEwLFxuICAgICAgY2hhcmFjdGVyRGF0YTogITAsXG4gICAgICBjaGlsZExpc3Q6ICEwLFxuICAgICAgc3VidHJlZTogITBcbiAgICB9KSwgcGFyc2VFbGVtZW50cyhkb2N1bWVudC5ib2R5KSwgYWN0aXZhdGUoKTtcbiAgfVxuICByZXR1cm4gd2luZG93LmRvY3VtZW50LmZvbnRzLnJlYWR5LnRoZW4oKCkgPT4ge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50U2V0KVxuICAgICAgdXBkYXRlUmVjdChlbGVtZW50KTtcbiAgfSksIGNyZWF0ZSgpLCB7XG4gICAgYWN0aXZhdGUsXG4gICAgZGVhY3RpdmF0ZSxcbiAgICBkZXN0cm95XG4gIH07XG59XG5jb25zdCBTaGFyZWRTdGF0ZUNvbnRleHQgPSBjcmVhdGVDb250ZXh0KG51bGwpO1xuZXhwb3J0IHtcbiAgU2hhcmVkU3RhdGVDb250ZXh0LFxuICBjcmVhdGVPdmVybGF5Q29udHJvbGxlcixcbiAgc2FuaXR5Tm9kZXNFeGlzdEluU2FtZUFycmF5LFxuICB1c2VPcHRpbWlzdGljLFxuICB2NFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNoYXJlZFN0YXRlQ29udGV4dC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   actor: () => (/* binding */ actor),\n/* harmony export */   emptyActor: () => (/* binding */ emptyActor),\n/* harmony export */   isEmptyActor: () => (/* binding */ isEmptyActor),\n/* harmony export */   listeners: () => (/* binding */ listeners),\n/* harmony export */   setActor: () => (/* binding */ setActor)\n/* harmony export */ });\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n\nconst emptyActor = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.createEmptyActor)();\nlet actor = emptyActor;\nconst listeners = /* @__PURE__ */ new Set();\nfunction isEmptyActor(actor2) {\n  return actor2 === emptyActor;\n}\nfunction setActor(nextActor) {\n  actor = nextActor;\n  for (const onActorChange of listeners)\n    onActorChange();\n}\n\n//# sourceMappingURL=context.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL2NvbnRleHQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTBDO0FBQzFDLG1CQUFtQix3REFBZ0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L19jaHVua3MtZXMvY29udGV4dC5qcz9kYTdlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUVtcHR5QWN0b3IgfSBmcm9tIFwieHN0YXRlXCI7XG5jb25zdCBlbXB0eUFjdG9yID0gY3JlYXRlRW1wdHlBY3RvcigpO1xubGV0IGFjdG9yID0gZW1wdHlBY3RvcjtcbmNvbnN0IGxpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG5mdW5jdGlvbiBpc0VtcHR5QWN0b3IoYWN0b3IyKSB7XG4gIHJldHVybiBhY3RvcjIgPT09IGVtcHR5QWN0b3I7XG59XG5mdW5jdGlvbiBzZXRBY3RvcihuZXh0QWN0b3IpIHtcbiAgYWN0b3IgPSBuZXh0QWN0b3I7XG4gIGZvciAoY29uc3Qgb25BY3RvckNoYW5nZSBvZiBsaXN0ZW5lcnMpXG4gICAgb25BY3RvckNoYW5nZSgpO1xufVxuZXhwb3J0IHtcbiAgYWN0b3IsXG4gIGVtcHR5QWN0b3IsXG4gIGlzRW1wdHlBY3RvcixcbiAgbGlzdGVuZXJzLFxuICBzZXRBY3RvclxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbnRleHQuanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   get: () => (/* binding */ get),\n/* harmony export */   getArrayDuplicatePatches: () => (/* binding */ getArrayDuplicatePatches),\n/* harmony export */   getArrayInsertPatches: () => (/* binding */ getArrayInsertPatches),\n/* harmony export */   getArrayItemKeyAndParentPath: () => (/* binding */ getArrayItemKeyAndParentPath),\n/* harmony export */   getArrayMovePatches: () => (/* binding */ getArrayMovePatches),\n/* harmony export */   getArrayRemovePatches: () => (/* binding */ getArrayRemovePatches),\n/* harmony export */   useDocuments: () => (/* binding */ useDocuments),\n/* harmony export */   useOptimisticActor: () => (/* binding */ useOptimisticActor),\n/* harmony export */   useOptimisticActorReady: () => (/* binding */ useOptimisticActorReady)\n/* harmony export */ });\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\");\n/* harmony import */ var _sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/presentation-comlink */ \"(ssr)/./node_modules/@sanity/presentation-comlink/dist/index.js\");\n/* harmony import */ var _context_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var get_random_values_esm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! get-random-values-esm */ \"(ssr)/./node_modules/get-random-values-esm/index.mjs\");\n\n\n\n\n\n\n\nconst reKeySegment$1 = /_key\\s*==\\s*['\"](.*)['\"]/, reIndexTuple = /^\\d*:\\d*$/;\nfunction isIndexSegment(segment) {\n  return typeof segment == \"number\" || typeof segment == \"string\" && /^\\[\\d+\\]$/.test(segment);\n}\nfunction isKeySegment(segment) {\n  return typeof segment == \"string\" ? reKeySegment$1.test(segment.trim()) : typeof segment == \"object\" && \"_key\" in segment;\n}\nfunction isIndexTuple(segment) {\n  if (typeof segment == \"string\" && reIndexTuple.test(segment))\n    return !0;\n  if (!Array.isArray(segment) || segment.length !== 2)\n    return !1;\n  const [from, to] = segment;\n  return (typeof from == \"number\" || from === \"\") && (typeof to == \"number\" || to === \"\");\n}\nconst rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g, reKeySegment = /_key\\s*==\\s*['\"](.*)['\"]/;\nfunction get(obj, path, defaultVal) {\n  const select = typeof path == \"string\" ? fromString(path) : path;\n  if (!Array.isArray(select))\n    throw new Error(\"Path must be an array or a string\");\n  let acc = obj;\n  for (let i = 0; i < select.length; i++) {\n    const segment = select[i];\n    if (isIndexSegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc[segment];\n    }\n    if (isKeySegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc.find((item) => item._key === segment._key);\n    }\n    if (typeof segment == \"string\" && (acc = typeof acc == \"object\" && acc !== null ? acc[segment] : void 0), typeof acc > \"u\")\n      return defaultVal;\n  }\n  return acc;\n}\nfunction fromString(path) {\n  if (typeof path != \"string\")\n    throw new Error(\"Path is not a string\");\n  const segments = path.match(rePropName);\n  if (!segments)\n    throw new Error(\"Invalid path string\");\n  return segments.map(normalizePathSegment);\n}\nfunction normalizePathSegment(segment) {\n  return isIndexSegment(segment) ? normalizeIndexSegment(segment) : isKeySegment(segment) ? normalizeKeySegment(segment) : isIndexTuple(segment) ? normalizeIndexTupleSegment(segment) : segment;\n}\nfunction normalizeIndexSegment(segment) {\n  return Number(segment.replace(/[^\\d]/g, \"\"));\n}\nfunction normalizeKeySegment(segment) {\n  return { _key: segment.match(reKeySegment)[1] };\n}\nfunction normalizeIndexTupleSegment(segment) {\n  const [from, to] = segment.split(\":\").map((seg) => seg === \"\" ? seg : Number(seg));\n  return [from, to];\n}\nfunction useOptimisticActor() {\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(_temp, _temp2, _temp3);\n}\nfunction _temp3() {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.emptyActor;\n}\nfunction _temp2() {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.actor;\n}\nfunction _temp(listener) {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.listeners.add(listener), () => _context_js__WEBPACK_IMPORTED_MODULE_2__.listeners.delete(listener);\n}\nfunction useOptimisticActorReady() {\n  const actor2 = useOptimisticActor();\n  let t0;\n  return t0 = !(0,_context_js__WEBPACK_IMPORTED_MODULE_2__.isEmptyActor)(actor2), t0;\n}\nfunction debounce(fn, timeout) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer), timer = setTimeout(() => {\n      fn.apply(fn, args);\n    }, timeout);\n  };\n}\nfunction getDocumentsAndSnapshot(id, actor2) {\n  const inFrame = (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__.isMaybePreviewIframe)(), inPopUp = (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__.isMaybePreviewWindow)();\n  if ((0,_context_js__WEBPACK_IMPORTED_MODULE_2__.isEmptyActor)(actor2) || !inFrame && !inPopUp)\n    throw new Error(\"The `useDocuments` hook cannot be used in this context\");\n  const draftId = (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getDraftId)(id), publishedId = (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(id), documents = actor2.getSnapshot().context?.documents, draftDoc = documents?.[draftId], publishedDoc = documents?.[publishedId], doc = draftDoc || publishedDoc;\n  if (!doc)\n    throw new Error(`Document \"${id}\" not found`);\n  const snapshot = draftDoc.getSnapshot().context?.local || publishedDoc.getSnapshot().context?.local, snapshotPromise = new Promise((resolve) => {\n    if (snapshot)\n      resolve(snapshot);\n    else {\n      const subscriber = doc.on(\"ready\", (event) => {\n        const {\n          snapshot: snapshot2\n        } = event;\n        resolve(snapshot2 || null), subscriber.unsubscribe();\n      });\n    }\n  });\n  return {\n    draftDoc,\n    draftId,\n    getSnapshot: () => snapshotPromise,\n    publishedDoc,\n    publishedId,\n    /**\n     * @deprecated - use `getSnapshot` instead\n     */\n    get snapshot() {\n      if (!snapshot)\n        throw new Error(`Snapshot for document \"${id}\" not found`);\n      return snapshot;\n    }\n  };\n}\nfunction createDocumentCommit(id, actor2) {\n  return () => {\n    const {\n      draftDoc\n    } = getDocumentsAndSnapshot(id, actor2);\n    draftDoc.send({\n      type: \"submit\"\n    });\n  };\n}\nfunction createDocumentGet(id, actor2) {\n  return (path) => {\n    const {\n      snapshot\n    } = getDocumentsAndSnapshot(id, actor2);\n    return path ? get(snapshot, path) : snapshot;\n  };\n}\nfunction createDocumentGetSnapshot(id, actor2) {\n  const {\n    getSnapshot\n  } = getDocumentsAndSnapshot(id, actor2);\n  return getSnapshot;\n}\nfunction createDocumentPatch(id, actor2) {\n  return async (patches, options) => {\n    const result = getDocumentsAndSnapshot(id, actor2), {\n      draftDoc,\n      draftId,\n      getSnapshot,\n      publishedId\n    } = result, {\n      commit = !0\n    } = options || {}, resolvedPatches = await (typeof patches == \"function\" ? patches({\n      draftId,\n      publishedId,\n      /**\n       * @deprecated - use `getSnapshot` instead\n       */\n      get snapshot() {\n        return result.snapshot;\n      },\n      getSnapshot\n    }) : patches), _snapshot = await getSnapshot();\n    if (!_snapshot)\n      throw new Error(`Snapshot for document \"${id}\" not found`);\n    draftDoc.send({\n      type: \"mutate\",\n      mutations: [\n        // Attempt to create the draft document, it might not exist if the\n        // snapshot was from the published document\n        (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.createIfNotExists)({\n          ..._snapshot,\n          _id: draftId\n        }),\n        // Patch the draft document with the resolved patches\n        (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.patch)(draftId, resolvedPatches)\n      ]\n    }), commit && (typeof commit == \"object\" && \"debounce\" in commit ? debounce(() => draftDoc.send({\n      type: \"submit\"\n    }), commit.debounce)() : draftDoc.send({\n      type: \"submit\"\n    }));\n  };\n}\nfunction useDocuments() {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(7), actor2 = useOptimisticActor();\n  let t0;\n  $[0] !== actor2 ? (t0 = (documentId) => ({\n    id: documentId,\n    commit: createDocumentCommit(documentId, actor2),\n    get: createDocumentGet(documentId, actor2),\n    getSnapshot: createDocumentGetSnapshot(documentId, actor2),\n    patch: createDocumentPatch(documentId, actor2)\n  }), $[0] = actor2, $[1] = t0) : t0 = $[1];\n  const getDocument = t0;\n  let t1;\n  $[2] !== actor2 ? (t1 = (id, mutations, options) => {\n    const {\n      draftDoc\n    } = getDocumentsAndSnapshot(id, actor2), {\n      commit: t22\n    } = options || {}, commit = t22 === void 0 ? !0 : t22;\n    draftDoc.send({\n      type: \"mutate\",\n      mutations\n    }), commit && (typeof commit == \"object\" && \"debounce\" in commit ? debounce(() => draftDoc.send({\n      type: \"submit\"\n    }), commit.debounce)() : draftDoc.send({\n      type: \"submit\"\n    }));\n  }, $[2] = actor2, $[3] = t1) : t1 = $[3];\n  const mutateDocument = t1;\n  let t2;\n  return $[4] !== getDocument || $[5] !== mutateDocument ? (t2 = {\n    getDocument,\n    mutateDocument\n  }, $[4] = getDocument, $[5] = mutateDocument, $[6] = t2) : t2 = $[6], t2;\n}\nfunction whatwgRNG(length = 16) {\n  const rnds8 = new Uint8Array(length);\n  return (0,get_random_values_esm__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(rnds8), rnds8;\n}\nconst getByteHexTable = /* @__PURE__ */ (() => {\n  let table;\n  return () => {\n    if (table)\n      return table;\n    table = [];\n    for (let i = 0; i < 256; ++i)\n      table[i] = (i + 256).toString(16).slice(1);\n    return table;\n  };\n})();\nfunction randomKey(length) {\n  const table = getByteHexTable();\n  return whatwgRNG(length).reduce((str, n) => str + table[n], \"\").slice(0, length);\n}\nfunction getArrayItemKeyAndParentPath(pathOrNode) {\n  const elementPath = typeof pathOrNode == \"string\" ? pathOrNode : pathOrNode.path, lastDotIndex = elementPath.lastIndexOf(\".\"), lastPathItem = elementPath.substring(lastDotIndex + 1, elementPath.length);\n  if (!lastPathItem.indexOf(\"[\")) throw new Error(\"Invalid path: not an array\");\n  const lastArrayIndex = elementPath.lastIndexOf(\"[\"), path = elementPath.substring(0, lastArrayIndex);\n  let key, hasExplicitKey;\n  if (lastPathItem.includes(\"_key\")) {\n    const startIndex = lastPathItem.indexOf('\"') + 1, endIndex = lastPathItem.indexOf('\"', startIndex);\n    key = lastPathItem.substring(startIndex, endIndex), hasExplicitKey = !0;\n  } else {\n    const startIndex = lastPathItem.indexOf(\"[\") + 1, endIndex = lastPathItem.indexOf(\"]\", startIndex);\n    key = lastPathItem.substring(startIndex, endIndex), hasExplicitKey = !1;\n  }\n  if (!path || !key) throw new Error(\"Invalid path\");\n  return {\n    path,\n    key,\n    hasExplicitKey\n  };\n}\nfunction getArrayDuplicatePatches(node, snapshot, position = \"after\") {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), duplicate = {\n    ...get(snapshot, node.path),\n    _key: randomKey()\n  };\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(duplicate, position, {\n    _key: itemKey\n  }))];\n}\nfunction getArrayRemovePatches(node, snapshot) {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), currentIndex = get(snapshot, arrayPath).findIndex((item) => item._key === itemKey);\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.truncate)(currentIndex, currentIndex + 1))];\n}\nfunction getArrayInsertPatches(node, insertType, position) {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), insertKey = randomKey();\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)([{\n    _type: insertType,\n    _key: insertKey\n  }], position, {\n    _key: itemKey\n  }))];\n}\nasync function getArrayMovePatches(node, doc, moveTo) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), snapshot = await doc.getSnapshot(), array = get(snapshot, arrayPath), item = get(snapshot, node.path), currentIndex = array.findIndex((item2) => item2._key === itemKey);\n  let nextIndex = -1, position = \"before\";\n  if (moveTo === \"first\") {\n    if (currentIndex === 0) return [];\n    nextIndex = 0, position = \"before\";\n  } else if (moveTo === \"last\") {\n    if (currentIndex === array.length - 1) return [];\n    nextIndex = -1, position = \"after\";\n  } else if (moveTo === \"next\") {\n    if (currentIndex === array.length - 1) return [];\n    nextIndex = currentIndex, position = \"after\";\n  } else if (moveTo === \"previous\") {\n    if (currentIndex === 0) return [];\n    nextIndex = currentIndex - 1, position = \"before\";\n  }\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.truncate)(currentIndex, currentIndex + 1)), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(item, position, nextIndex))];\n}\n\n//# sourceMappingURL=mutations.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL211dGF0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTJDO0FBQ3FCO0FBQ2dCO0FBQ1U7QUFDaEI7QUFDN0I7QUFDTztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUJBQW1CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMkRBQW9CO0FBQzdCO0FBQ0E7QUFDQSxTQUFTLG1EQUFVO0FBQ25CO0FBQ0E7QUFDQSxTQUFTLDhDQUFLO0FBQ2Q7QUFDQTtBQUNBLFNBQVMsa0RBQVMsc0JBQXNCLGtEQUFTO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5REFBWTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGtGQUFvQixjQUFjLGtGQUFvQjtBQUN4RSxNQUFNLHlEQUFZO0FBQ2xCO0FBQ0Esa0JBQWtCLDhEQUFVLG9CQUFvQixrRUFBYztBQUM5RDtBQUNBLGlDQUFpQyxHQUFHO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsR0FBRztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNLGVBQWU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnREFBZ0QsR0FBRztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUI7QUFDekI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFFBQVEscURBQUs7QUFDYjtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU0sZUFBZTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsU0FBUyxpRUFBZTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxVQUFVLGtEQUFFLFlBQVksc0RBQU07QUFDOUI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixVQUFVLGtEQUFFLFlBQVksd0RBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixVQUFVLGtEQUFFLFlBQVksc0RBQU07QUFDOUI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUsa0RBQUUsWUFBWSx3REFBUSxtQ0FBbUMsa0RBQUUsWUFBWSxzREFBTTtBQUN2RjtBQVdFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4vbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9tdXRhdGlvbnMuanM/NWExMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjIH0gZnJvbSBcInJlYWN0LWNvbXBpbGVyLXJ1bnRpbWVcIjtcbmltcG9ydCB7IGdldERyYWZ0SWQsIGdldFB1Ymxpc2hlZElkIH0gZnJvbSBcIkBzYW5pdHkvY2xpZW50L2NzbVwiO1xuaW1wb3J0IHsgY3JlYXRlSWZOb3RFeGlzdHMsIHBhdGNoLCBhdCwgaW5zZXJ0LCB0cnVuY2F0ZSB9IGZyb20gXCJAc2FuaXR5L211dGF0ZVwiO1xuaW1wb3J0IHsgaXNNYXliZVByZXZpZXdJZnJhbWUsIGlzTWF5YmVQcmV2aWV3V2luZG93IH0gZnJvbSBcIkBzYW5pdHkvcHJlc2VudGF0aW9uLWNvbWxpbmtcIjtcbmltcG9ydCB7IGlzRW1wdHlBY3RvciwgbGlzdGVuZXJzLCBhY3RvciwgZW1wdHlBY3RvciB9IGZyb20gXCIuL2NvbnRleHQuanNcIjtcbmltcG9ydCB7IHVzZVN5bmNFeHRlcm5hbFN0b3JlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgZ2V0UmFuZG9tVmFsdWVzIGZyb20gXCJnZXQtcmFuZG9tLXZhbHVlcy1lc21cIjtcbmNvbnN0IHJlS2V5U2VnbWVudCQxID0gL19rZXlcXHMqPT1cXHMqWydcIl0oLiopWydcIl0vLCByZUluZGV4VHVwbGUgPSAvXlxcZCo6XFxkKiQvO1xuZnVuY3Rpb24gaXNJbmRleFNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gdHlwZW9mIHNlZ21lbnQgPT0gXCJudW1iZXJcIiB8fCB0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiICYmIC9eXFxbXFxkK1xcXSQvLnRlc3Qoc2VnbWVudCk7XG59XG5mdW5jdGlvbiBpc0tleVNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gdHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiA/IHJlS2V5U2VnbWVudCQxLnRlc3Qoc2VnbWVudC50cmltKCkpIDogdHlwZW9mIHNlZ21lbnQgPT0gXCJvYmplY3RcIiAmJiBcIl9rZXlcIiBpbiBzZWdtZW50O1xufVxuZnVuY3Rpb24gaXNJbmRleFR1cGxlKHNlZ21lbnQpIHtcbiAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgJiYgcmVJbmRleFR1cGxlLnRlc3Qoc2VnbWVudCkpXG4gICAgcmV0dXJuICEwO1xuICBpZiAoIUFycmF5LmlzQXJyYXkoc2VnbWVudCkgfHwgc2VnbWVudC5sZW5ndGggIT09IDIpXG4gICAgcmV0dXJuICExO1xuICBjb25zdCBbZnJvbSwgdG9dID0gc2VnbWVudDtcbiAgcmV0dXJuICh0eXBlb2YgZnJvbSA9PSBcIm51bWJlclwiIHx8IGZyb20gPT09IFwiXCIpICYmICh0eXBlb2YgdG8gPT0gXCJudW1iZXJcIiB8fCB0byA9PT0gXCJcIik7XG59XG5jb25zdCByZVByb3BOYW1lID0gL1teLltcXF1dK3xcXFsoPzooLT9cXGQrKD86XFwuXFxkKyk/KXwoW1wiJ10pKCg/Oig/IVxcMilbXlxcXFxdfFxcXFwuKSo/KVxcMilcXF18KD89KD86XFwufFxcW1xcXSkoPzpcXC58XFxbXFxdfCQpKS9nLCByZUtleVNlZ21lbnQgPSAvX2tleVxccyo9PVxccypbJ1wiXSguKilbJ1wiXS87XG5mdW5jdGlvbiBnZXQob2JqLCBwYXRoLCBkZWZhdWx0VmFsKSB7XG4gIGNvbnN0IHNlbGVjdCA9IHR5cGVvZiBwYXRoID09IFwic3RyaW5nXCIgPyBmcm9tU3RyaW5nKHBhdGgpIDogcGF0aDtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHNlbGVjdCkpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUGF0aCBtdXN0IGJlIGFuIGFycmF5IG9yIGEgc3RyaW5nXCIpO1xuICBsZXQgYWNjID0gb2JqO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNlZ21lbnQgPSBzZWxlY3RbaV07XG4gICAgaWYgKGlzSW5kZXhTZWdtZW50KHNlZ21lbnQpKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYWNjKSlcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWw7XG4gICAgICBhY2MgPSBhY2Nbc2VnbWVudF07XG4gICAgfVxuICAgIGlmIChpc0tleVNlZ21lbnQoc2VnbWVudCkpIHtcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShhY2MpKVxuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbDtcbiAgICAgIGFjYyA9IGFjYy5maW5kKChpdGVtKSA9PiBpdGVtLl9rZXkgPT09IHNlZ21lbnQuX2tleSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiICYmIChhY2MgPSB0eXBlb2YgYWNjID09IFwib2JqZWN0XCIgJiYgYWNjICE9PSBudWxsID8gYWNjW3NlZ21lbnRdIDogdm9pZCAwKSwgdHlwZW9mIGFjYyA+IFwidVwiKVxuICAgICAgcmV0dXJuIGRlZmF1bHRWYWw7XG4gIH1cbiAgcmV0dXJuIGFjYztcbn1cbmZ1bmN0aW9uIGZyb21TdHJpbmcocGF0aCkge1xuICBpZiAodHlwZW9mIHBhdGggIT0gXCJzdHJpbmdcIilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXRoIGlzIG5vdCBhIHN0cmluZ1wiKTtcbiAgY29uc3Qgc2VnbWVudHMgPSBwYXRoLm1hdGNoKHJlUHJvcE5hbWUpO1xuICBpZiAoIXNlZ21lbnRzKVxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGF0aCBzdHJpbmdcIik7XG4gIHJldHVybiBzZWdtZW50cy5tYXAobm9ybWFsaXplUGF0aFNlZ21lbnQpO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplUGF0aFNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gaXNJbmRleFNlZ21lbnQoc2VnbWVudCkgPyBub3JtYWxpemVJbmRleFNlZ21lbnQoc2VnbWVudCkgOiBpc0tleVNlZ21lbnQoc2VnbWVudCkgPyBub3JtYWxpemVLZXlTZWdtZW50KHNlZ21lbnQpIDogaXNJbmRleFR1cGxlKHNlZ21lbnQpID8gbm9ybWFsaXplSW5kZXhUdXBsZVNlZ21lbnQoc2VnbWVudCkgOiBzZWdtZW50O1xufVxuZnVuY3Rpb24gbm9ybWFsaXplSW5kZXhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIE51bWJlcihzZWdtZW50LnJlcGxhY2UoL1teXFxkXS9nLCBcIlwiKSk7XG59XG5mdW5jdGlvbiBub3JtYWxpemVLZXlTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHsgX2tleTogc2VnbWVudC5tYXRjaChyZUtleVNlZ21lbnQpWzFdIH07XG59XG5mdW5jdGlvbiBub3JtYWxpemVJbmRleFR1cGxlU2VnbWVudChzZWdtZW50KSB7XG4gIGNvbnN0IFtmcm9tLCB0b10gPSBzZWdtZW50LnNwbGl0KFwiOlwiKS5tYXAoKHNlZykgPT4gc2VnID09PSBcIlwiID8gc2VnIDogTnVtYmVyKHNlZykpO1xuICByZXR1cm4gW2Zyb20sIHRvXTtcbn1cbmZ1bmN0aW9uIHVzZU9wdGltaXN0aWNBY3RvcigpIHtcbiAgcmV0dXJuIHVzZVN5bmNFeHRlcm5hbFN0b3JlKF90ZW1wLCBfdGVtcDIsIF90ZW1wMyk7XG59XG5mdW5jdGlvbiBfdGVtcDMoKSB7XG4gIHJldHVybiBlbXB0eUFjdG9yO1xufVxuZnVuY3Rpb24gX3RlbXAyKCkge1xuICByZXR1cm4gYWN0b3I7XG59XG5mdW5jdGlvbiBfdGVtcChsaXN0ZW5lcikge1xuICByZXR1cm4gbGlzdGVuZXJzLmFkZChsaXN0ZW5lciksICgpID0+IGxpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xufVxuZnVuY3Rpb24gdXNlT3B0aW1pc3RpY0FjdG9yUmVhZHkoKSB7XG4gIGNvbnN0IGFjdG9yMiA9IHVzZU9wdGltaXN0aWNBY3RvcigpO1xuICBsZXQgdDA7XG4gIHJldHVybiB0MCA9ICFpc0VtcHR5QWN0b3IoYWN0b3IyKSwgdDA7XG59XG5mdW5jdGlvbiBkZWJvdW5jZShmbiwgdGltZW91dCkge1xuICBsZXQgdGltZXI7XG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGNsZWFyVGltZW91dCh0aW1lciksIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBmbi5hcHBseShmbiwgYXJncyk7XG4gICAgfSwgdGltZW91dCk7XG4gIH07XG59XG5mdW5jdGlvbiBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKSB7XG4gIGNvbnN0IGluRnJhbWUgPSBpc01heWJlUHJldmlld0lmcmFtZSgpLCBpblBvcFVwID0gaXNNYXliZVByZXZpZXdXaW5kb3coKTtcbiAgaWYgKGlzRW1wdHlBY3RvcihhY3RvcjIpIHx8ICFpbkZyYW1lICYmICFpblBvcFVwKVxuICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBgdXNlRG9jdW1lbnRzYCBob29rIGNhbm5vdCBiZSB1c2VkIGluIHRoaXMgY29udGV4dFwiKTtcbiAgY29uc3QgZHJhZnRJZCA9IGdldERyYWZ0SWQoaWQpLCBwdWJsaXNoZWRJZCA9IGdldFB1Ymxpc2hlZElkKGlkKSwgZG9jdW1lbnRzID0gYWN0b3IyLmdldFNuYXBzaG90KCkuY29udGV4dD8uZG9jdW1lbnRzLCBkcmFmdERvYyA9IGRvY3VtZW50cz8uW2RyYWZ0SWRdLCBwdWJsaXNoZWREb2MgPSBkb2N1bWVudHM/LltwdWJsaXNoZWRJZF0sIGRvYyA9IGRyYWZ0RG9jIHx8IHB1Ymxpc2hlZERvYztcbiAgaWYgKCFkb2MpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBEb2N1bWVudCBcIiR7aWR9XCIgbm90IGZvdW5kYCk7XG4gIGNvbnN0IHNuYXBzaG90ID0gZHJhZnREb2MuZ2V0U25hcHNob3QoKS5jb250ZXh0Py5sb2NhbCB8fCBwdWJsaXNoZWREb2MuZ2V0U25hcHNob3QoKS5jb250ZXh0Py5sb2NhbCwgc25hcHNob3RQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBpZiAoc25hcHNob3QpXG4gICAgICByZXNvbHZlKHNuYXBzaG90KTtcbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IHN1YnNjcmliZXIgPSBkb2Mub24oXCJyZWFkeVwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHNuYXBzaG90OiBzbmFwc2hvdDJcbiAgICAgICAgfSA9IGV2ZW50O1xuICAgICAgICByZXNvbHZlKHNuYXBzaG90MiB8fCBudWxsKSwgc3Vic2NyaWJlci51bnN1YnNjcmliZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBkcmFmdERvYyxcbiAgICBkcmFmdElkLFxuICAgIGdldFNuYXBzaG90OiAoKSA9PiBzbmFwc2hvdFByb21pc2UsXG4gICAgcHVibGlzaGVkRG9jLFxuICAgIHB1Ymxpc2hlZElkLFxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIC0gdXNlIGBnZXRTbmFwc2hvdGAgaW5zdGVhZFxuICAgICAqL1xuICAgIGdldCBzbmFwc2hvdCgpIHtcbiAgICAgIGlmICghc25hcHNob3QpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgU25hcHNob3QgZm9yIGRvY3VtZW50IFwiJHtpZH1cIiBub3QgZm91bmRgKTtcbiAgICAgIHJldHVybiBzbmFwc2hvdDtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVEb2N1bWVudENvbW1pdChpZCwgYWN0b3IyKSB7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgZHJhZnREb2NcbiAgICB9ID0gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMik7XG4gICAgZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcInN1Ym1pdFwiXG4gICAgfSk7XG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVEb2N1bWVudEdldChpZCwgYWN0b3IyKSB7XG4gIHJldHVybiAocGF0aCkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHNuYXBzaG90XG4gICAgfSA9IGdldERvY3VtZW50c0FuZFNuYXBzaG90KGlkLCBhY3RvcjIpO1xuICAgIHJldHVybiBwYXRoID8gZ2V0KHNuYXBzaG90LCBwYXRoKSA6IHNuYXBzaG90O1xuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRHZXRTbmFwc2hvdChpZCwgYWN0b3IyKSB7XG4gIGNvbnN0IHtcbiAgICBnZXRTbmFwc2hvdFxuICB9ID0gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMik7XG4gIHJldHVybiBnZXRTbmFwc2hvdDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50UGF0Y2goaWQsIGFjdG9yMikge1xuICByZXR1cm4gYXN5bmMgKHBhdGNoZXMsIG9wdGlvbnMpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKSwge1xuICAgICAgZHJhZnREb2MsXG4gICAgICBkcmFmdElkLFxuICAgICAgZ2V0U25hcHNob3QsXG4gICAgICBwdWJsaXNoZWRJZFxuICAgIH0gPSByZXN1bHQsIHtcbiAgICAgIGNvbW1pdCA9ICEwXG4gICAgfSA9IG9wdGlvbnMgfHwge30sIHJlc29sdmVkUGF0Y2hlcyA9IGF3YWl0ICh0eXBlb2YgcGF0Y2hlcyA9PSBcImZ1bmN0aW9uXCIgPyBwYXRjaGVzKHtcbiAgICAgIGRyYWZ0SWQsXG4gICAgICBwdWJsaXNoZWRJZCxcbiAgICAgIC8qKlxuICAgICAgICogQGRlcHJlY2F0ZWQgLSB1c2UgYGdldFNuYXBzaG90YCBpbnN0ZWFkXG4gICAgICAgKi9cbiAgICAgIGdldCBzbmFwc2hvdCgpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5zbmFwc2hvdDtcbiAgICAgIH0sXG4gICAgICBnZXRTbmFwc2hvdFxuICAgIH0pIDogcGF0Y2hlcyksIF9zbmFwc2hvdCA9IGF3YWl0IGdldFNuYXBzaG90KCk7XG4gICAgaWYgKCFfc25hcHNob3QpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFNuYXBzaG90IGZvciBkb2N1bWVudCBcIiR7aWR9XCIgbm90IGZvdW5kYCk7XG4gICAgZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcIm11dGF0ZVwiLFxuICAgICAgbXV0YXRpb25zOiBbXG4gICAgICAgIC8vIEF0dGVtcHQgdG8gY3JlYXRlIHRoZSBkcmFmdCBkb2N1bWVudCwgaXQgbWlnaHQgbm90IGV4aXN0IGlmIHRoZVxuICAgICAgICAvLyBzbmFwc2hvdCB3YXMgZnJvbSB0aGUgcHVibGlzaGVkIGRvY3VtZW50XG4gICAgICAgIGNyZWF0ZUlmTm90RXhpc3RzKHtcbiAgICAgICAgICAuLi5fc25hcHNob3QsXG4gICAgICAgICAgX2lkOiBkcmFmdElkXG4gICAgICAgIH0pLFxuICAgICAgICAvLyBQYXRjaCB0aGUgZHJhZnQgZG9jdW1lbnQgd2l0aCB0aGUgcmVzb2x2ZWQgcGF0Y2hlc1xuICAgICAgICBwYXRjaChkcmFmdElkLCByZXNvbHZlZFBhdGNoZXMpXG4gICAgICBdXG4gICAgfSksIGNvbW1pdCAmJiAodHlwZW9mIGNvbW1pdCA9PSBcIm9iamVjdFwiICYmIFwiZGVib3VuY2VcIiBpbiBjb21taXQgPyBkZWJvdW5jZSgoKSA9PiBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwic3VibWl0XCJcbiAgICB9KSwgY29tbWl0LmRlYm91bmNlKSgpIDogZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcInN1Ym1pdFwiXG4gICAgfSkpO1xuICB9O1xufVxuZnVuY3Rpb24gdXNlRG9jdW1lbnRzKCkge1xuICBjb25zdCAkID0gYyg3KSwgYWN0b3IyID0gdXNlT3B0aW1pc3RpY0FjdG9yKCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gYWN0b3IyID8gKHQwID0gKGRvY3VtZW50SWQpID0+ICh7XG4gICAgaWQ6IGRvY3VtZW50SWQsXG4gICAgY29tbWl0OiBjcmVhdGVEb2N1bWVudENvbW1pdChkb2N1bWVudElkLCBhY3RvcjIpLFxuICAgIGdldDogY3JlYXRlRG9jdW1lbnRHZXQoZG9jdW1lbnRJZCwgYWN0b3IyKSxcbiAgICBnZXRTbmFwc2hvdDogY3JlYXRlRG9jdW1lbnRHZXRTbmFwc2hvdChkb2N1bWVudElkLCBhY3RvcjIpLFxuICAgIHBhdGNoOiBjcmVhdGVEb2N1bWVudFBhdGNoKGRvY3VtZW50SWQsIGFjdG9yMilcbiAgfSksICRbMF0gPSBhY3RvcjIsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IGdldERvY3VtZW50ID0gdDA7XG4gIGxldCB0MTtcbiAgJFsyXSAhPT0gYWN0b3IyID8gKHQxID0gKGlkLCBtdXRhdGlvbnMsIG9wdGlvbnMpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBkcmFmdERvY1xuICAgIH0gPSBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKSwge1xuICAgICAgY29tbWl0OiB0MjJcbiAgICB9ID0gb3B0aW9ucyB8fCB7fSwgY29tbWl0ID0gdDIyID09PSB2b2lkIDAgPyAhMCA6IHQyMjtcbiAgICBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwibXV0YXRlXCIsXG4gICAgICBtdXRhdGlvbnNcbiAgICB9KSwgY29tbWl0ICYmICh0eXBlb2YgY29tbWl0ID09IFwib2JqZWN0XCIgJiYgXCJkZWJvdW5jZVwiIGluIGNvbW1pdCA/IGRlYm91bmNlKCgpID0+IGRyYWZ0RG9jLnNlbmQoe1xuICAgICAgdHlwZTogXCJzdWJtaXRcIlxuICAgIH0pLCBjb21taXQuZGVib3VuY2UpKCkgOiBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwic3VibWl0XCJcbiAgICB9KSk7XG4gIH0sICRbMl0gPSBhY3RvcjIsICRbM10gPSB0MSkgOiB0MSA9ICRbM107XG4gIGNvbnN0IG11dGF0ZURvY3VtZW50ID0gdDE7XG4gIGxldCB0MjtcbiAgcmV0dXJuICRbNF0gIT09IGdldERvY3VtZW50IHx8ICRbNV0gIT09IG11dGF0ZURvY3VtZW50ID8gKHQyID0ge1xuICAgIGdldERvY3VtZW50LFxuICAgIG11dGF0ZURvY3VtZW50XG4gIH0sICRbNF0gPSBnZXREb2N1bWVudCwgJFs1XSA9IG11dGF0ZURvY3VtZW50LCAkWzZdID0gdDIpIDogdDIgPSAkWzZdLCB0Mjtcbn1cbmZ1bmN0aW9uIHdoYXR3Z1JORyhsZW5ndGggPSAxNikge1xuICBjb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpLCBybmRzODtcbn1cbmNvbnN0IGdldEJ5dGVIZXhUYWJsZSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4ge1xuICBsZXQgdGFibGU7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgaWYgKHRhYmxlKVxuICAgICAgcmV0dXJuIHRhYmxlO1xuICAgIHRhYmxlID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSlcbiAgICAgIHRhYmxlW2ldID0gKGkgKyAyNTYpLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcbiAgICByZXR1cm4gdGFibGU7XG4gIH07XG59KSgpO1xuZnVuY3Rpb24gcmFuZG9tS2V5KGxlbmd0aCkge1xuICBjb25zdCB0YWJsZSA9IGdldEJ5dGVIZXhUYWJsZSgpO1xuICByZXR1cm4gd2hhdHdnUk5HKGxlbmd0aCkucmVkdWNlKChzdHIsIG4pID0+IHN0ciArIHRhYmxlW25dLCBcIlwiKS5zbGljZSgwLCBsZW5ndGgpO1xufVxuZnVuY3Rpb24gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChwYXRoT3JOb2RlKSB7XG4gIGNvbnN0IGVsZW1lbnRQYXRoID0gdHlwZW9mIHBhdGhPck5vZGUgPT0gXCJzdHJpbmdcIiA/IHBhdGhPck5vZGUgOiBwYXRoT3JOb2RlLnBhdGgsIGxhc3REb3RJbmRleCA9IGVsZW1lbnRQYXRoLmxhc3RJbmRleE9mKFwiLlwiKSwgbGFzdFBhdGhJdGVtID0gZWxlbWVudFBhdGguc3Vic3RyaW5nKGxhc3REb3RJbmRleCArIDEsIGVsZW1lbnRQYXRoLmxlbmd0aCk7XG4gIGlmICghbGFzdFBhdGhJdGVtLmluZGV4T2YoXCJbXCIpKSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhdGg6IG5vdCBhbiBhcnJheVwiKTtcbiAgY29uc3QgbGFzdEFycmF5SW5kZXggPSBlbGVtZW50UGF0aC5sYXN0SW5kZXhPZihcIltcIiksIHBhdGggPSBlbGVtZW50UGF0aC5zdWJzdHJpbmcoMCwgbGFzdEFycmF5SW5kZXgpO1xuICBsZXQga2V5LCBoYXNFeHBsaWNpdEtleTtcbiAgaWYgKGxhc3RQYXRoSXRlbS5pbmNsdWRlcyhcIl9rZXlcIikpIHtcbiAgICBjb25zdCBzdGFydEluZGV4ID0gbGFzdFBhdGhJdGVtLmluZGV4T2YoJ1wiJykgKyAxLCBlbmRJbmRleCA9IGxhc3RQYXRoSXRlbS5pbmRleE9mKCdcIicsIHN0YXJ0SW5kZXgpO1xuICAgIGtleSA9IGxhc3RQYXRoSXRlbS5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpLCBoYXNFeHBsaWNpdEtleSA9ICEwO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBsYXN0UGF0aEl0ZW0uaW5kZXhPZihcIltcIikgKyAxLCBlbmRJbmRleCA9IGxhc3RQYXRoSXRlbS5pbmRleE9mKFwiXVwiLCBzdGFydEluZGV4KTtcbiAgICBrZXkgPSBsYXN0UGF0aEl0ZW0uc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSwgaGFzRXhwbGljaXRLZXkgPSAhMTtcbiAgfVxuICBpZiAoIXBhdGggfHwgIWtleSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXRoXCIpO1xuICByZXR1cm4ge1xuICAgIHBhdGgsXG4gICAga2V5LFxuICAgIGhhc0V4cGxpY2l0S2V5XG4gIH07XG59XG5mdW5jdGlvbiBnZXRBcnJheUR1cGxpY2F0ZVBhdGNoZXMobm9kZSwgc25hcHNob3QsIHBvc2l0aW9uID0gXCJhZnRlclwiKSB7XG4gIGNvbnN0IHtcbiAgICBwYXRoOiBhcnJheVBhdGgsXG4gICAga2V5OiBpdGVtS2V5XG4gIH0gPSBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoKG5vZGUpLCBkdXBsaWNhdGUgPSB7XG4gICAgLi4uZ2V0KHNuYXBzaG90LCBub2RlLnBhdGgpLFxuICAgIF9rZXk6IHJhbmRvbUtleSgpXG4gIH07XG4gIHJldHVybiBbYXQoYXJyYXlQYXRoLCBpbnNlcnQoZHVwbGljYXRlLCBwb3NpdGlvbiwge1xuICAgIF9rZXk6IGl0ZW1LZXlcbiAgfSkpXTtcbn1cbmZ1bmN0aW9uIGdldEFycmF5UmVtb3ZlUGF0Y2hlcyhub2RlLCBzbmFwc2hvdCkge1xuICBjb25zdCB7XG4gICAgcGF0aDogYXJyYXlQYXRoLFxuICAgIGtleTogaXRlbUtleVxuICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKSwgY3VycmVudEluZGV4ID0gZ2V0KHNuYXBzaG90LCBhcnJheVBhdGgpLmZpbmRJbmRleCgoaXRlbSkgPT4gaXRlbS5fa2V5ID09PSBpdGVtS2V5KTtcbiAgcmV0dXJuIFthdChhcnJheVBhdGgsIHRydW5jYXRlKGN1cnJlbnRJbmRleCwgY3VycmVudEluZGV4ICsgMSkpXTtcbn1cbmZ1bmN0aW9uIGdldEFycmF5SW5zZXJ0UGF0Y2hlcyhub2RlLCBpbnNlcnRUeXBlLCBwb3NpdGlvbikge1xuICBjb25zdCB7XG4gICAgcGF0aDogYXJyYXlQYXRoLFxuICAgIGtleTogaXRlbUtleVxuICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKSwgaW5zZXJ0S2V5ID0gcmFuZG9tS2V5KCk7XG4gIHJldHVybiBbYXQoYXJyYXlQYXRoLCBpbnNlcnQoW3tcbiAgICBfdHlwZTogaW5zZXJ0VHlwZSxcbiAgICBfa2V5OiBpbnNlcnRLZXlcbiAgfV0sIHBvc2l0aW9uLCB7XG4gICAgX2tleTogaXRlbUtleVxuICB9KSldO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0QXJyYXlNb3ZlUGF0Y2hlcyhub2RlLCBkb2MsIG1vdmVUbykge1xuICBpZiAoIW5vZGUudHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiTm9kZSB0eXBlIGlzIG1pc3NpbmdcIik7XG4gIGNvbnN0IHtcbiAgICBwYXRoOiBhcnJheVBhdGgsXG4gICAga2V5OiBpdGVtS2V5XG4gIH0gPSBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoKG5vZGUpLCBzbmFwc2hvdCA9IGF3YWl0IGRvYy5nZXRTbmFwc2hvdCgpLCBhcnJheSA9IGdldChzbmFwc2hvdCwgYXJyYXlQYXRoKSwgaXRlbSA9IGdldChzbmFwc2hvdCwgbm9kZS5wYXRoKSwgY3VycmVudEluZGV4ID0gYXJyYXkuZmluZEluZGV4KChpdGVtMikgPT4gaXRlbTIuX2tleSA9PT0gaXRlbUtleSk7XG4gIGxldCBuZXh0SW5kZXggPSAtMSwgcG9zaXRpb24gPSBcImJlZm9yZVwiO1xuICBpZiAobW92ZVRvID09PSBcImZpcnN0XCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSAwKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gMCwgcG9zaXRpb24gPSBcImJlZm9yZVwiO1xuICB9IGVsc2UgaWYgKG1vdmVUbyA9PT0gXCJsYXN0XCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSBhcnJheS5sZW5ndGggLSAxKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gLTEsIHBvc2l0aW9uID0gXCJhZnRlclwiO1xuICB9IGVsc2UgaWYgKG1vdmVUbyA9PT0gXCJuZXh0XCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSBhcnJheS5sZW5ndGggLSAxKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gY3VycmVudEluZGV4LCBwb3NpdGlvbiA9IFwiYWZ0ZXJcIjtcbiAgfSBlbHNlIGlmIChtb3ZlVG8gPT09IFwicHJldmlvdXNcIikge1xuICAgIGlmIChjdXJyZW50SW5kZXggPT09IDApIHJldHVybiBbXTtcbiAgICBuZXh0SW5kZXggPSBjdXJyZW50SW5kZXggLSAxLCBwb3NpdGlvbiA9IFwiYmVmb3JlXCI7XG4gIH1cbiAgcmV0dXJuIFthdChhcnJheVBhdGgsIHRydW5jYXRlKGN1cnJlbnRJbmRleCwgY3VycmVudEluZGV4ICsgMSkpLCBhdChhcnJheVBhdGgsIGluc2VydChpdGVtLCBwb3NpdGlvbiwgbmV4dEluZGV4KSldO1xufVxuZXhwb3J0IHtcbiAgZ2V0LFxuICBnZXRBcnJheUR1cGxpY2F0ZVBhdGNoZXMsXG4gIGdldEFycmF5SW5zZXJ0UGF0Y2hlcyxcbiAgZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aCxcbiAgZ2V0QXJyYXlNb3ZlUGF0Y2hlcyxcbiAgZ2V0QXJyYXlSZW1vdmVQYXRjaGVzLFxuICB1c2VEb2N1bWVudHMsXG4gIHVzZU9wdGltaXN0aWNBY3RvcixcbiAgdXNlT3B0aW1pc3RpY0FjdG9yUmVhZHlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tdXRhdGlvbnMuanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   actor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_7__.actor),\n/* harmony export */   createDatasetMutator: () => (/* binding */ createDatasetMutator),\n/* harmony export */   createDocumentMutator: () => (/* binding */ createDocumentMutator),\n/* harmony export */   emptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_7__.emptyActor),\n/* harmony export */   isEmptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_7__.isEmptyActor),\n/* harmony export */   listeners: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_7__.listeners),\n/* harmony export */   setActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_7__.setActor)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../_chunks-es/context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sanity/mutate/_unstable_machine */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/log-b8ca474e.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/xstate.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/assign-541a432d.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/raise-13a60c49.development.esm.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\");\n\n\n\n\nconst createDocumentMutator = (comlink) => {\n  const fetchSnapshot = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.fromPromise)(async ({\n    input,\n    signal\n  }) => {\n    const {\n      id\n    } = input, {\n      snapshot\n    } = await comlink.fetch(\"visual-editing/fetch-snapshot\", {\n      documentId: id\n    }, {\n      signal\n    });\n    return snapshot;\n  }), submitMutations = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.fromPromise)(async ({\n    input\n  }) => {\n    const {\n      transactions\n    } = input;\n    for (const transaction of transactions) {\n      const data = _sanity_mutate__WEBPACK_IMPORTED_MODULE_1__.SanityEncoder.encodeTransaction(transaction);\n      return comlink.post(\"visual-editing/mutate\", data);\n    }\n  });\n  return _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.documentMutatorMachine.provide({\n    actions: {\n      \"send sync event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n        enqueue\n      }) => {\n        enqueue.sendParent(({\n          context\n        }) => ({\n          type: \"sync\",\n          id: context.id,\n          document: context.remote\n        })), enqueue.emit(({\n          context\n        }) => ({\n          type: \"ready\",\n          snapshot: context.local\n        }));\n      })\n    },\n    actors: {\n      \"fetch remote snapshot\": fetchSnapshot,\n      \"submit mutations as transactions\": submitMutations\n    }\n  });\n}, datasetMutatorMachine = (0,xstate__WEBPACK_IMPORTED_MODULE_4__.setup)({\n  types: {},\n  actions: {\n    \"emit sync event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"sync\"), event)),\n    \"emit mutation event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), event)),\n    \"emit rebased event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, [\"rebased.local\", \"rebased.remote\"]), event)),\n    \"emit pristine event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, [\"pristine\"]), event)),\n    \"add document actor\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      documents: ({\n        context,\n        event,\n        spawn\n      }) => {\n        (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"observe\");\n        const id = event.documentId;\n        return context.documents[id] ? context.documents : {\n          ...context.documents,\n          [id]: spawn(\"documentMutatorMachine\", {\n            input: {\n              id,\n              client: context.client,\n              sharedListener: context.sharedListener || (0,_sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.createSharedListener)(context.client)\n            },\n            id\n          })\n        };\n      }\n    }),\n    \"stop remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.s)(({\n      context,\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"unobserve\"), context.documents[event.documentId])),\n    \"remove remote snapshot from context\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      documents: ({\n        context,\n        event\n      }) => {\n        if ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"unobserve\"), !context.documents[event.documentId]) return context.documents;\n        const {\n          [event.documentId]: _,\n          ...documents\n        } = context.documents;\n        return documents;\n      }\n    })\n  },\n  actors: {\n    documentMutatorMachine: _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.documentMutatorMachine\n  }\n}).createMachine({\n  /** @xstate-layout N4IgpgJg5mDOIC5QBsD2BjAhsgIhgrgLZgB2ALgMTICWsZpA2gAwC6ioADqrNWdaiXYgAHogC0ADgBMAOgkA2ACyKArBICcTdfKXSANCACeiFQHYZpgMxWV800yYqp6gIyn5AXw8G0WXAWJyCnwSGjpGViEuHj4BIVEEKUt5OSlFU1smFwkFW0sDY0T1GRUXRXkXKVN7HSYJJkUvHwxsPHQiUjIZDgAnWj4SMApCfDJMemY2JBBo3n5BaYSXeVlbKRUsiXdFSxcXfKNERSqZTbr1zVMJNyaQX1aAzpkIah6yQwp0VEJCXkmo7hzOKLRDLFwyFxaSzXKTOKQudSKCQFRDOczqCSWJjwjbHCQqRFebwgEioCBwIT3fztQJkAExebxcQuFEIZaWGRIrF7dSXKTyFSNYlUtodcjdPp0aiDelAhagBLpVmWAmc46mNwSZTyLQuFS3EWPcUvN6FTiA2LykSoq6c6wbCqVUzparKioyRFVfkq1zqNSWIkeIA */\n  id: \"dataset-mutator\",\n  context: ({\n    input\n  }) => ({\n    documents: {},\n    client: input.client,\n    sharedListener: input.sharedListener\n  }),\n  on: {\n    sync: {\n      actions: [\"emit sync event\"]\n    },\n    mutation: {\n      actions: [\"emit mutation event\"]\n    },\n    \"rebased.*\": {\n      actions: [\"emit rebased event\"]\n    },\n    pristine: {\n      actions: [\"emit pristine event\"]\n    },\n    observe: {\n      actions: [\"add document actor\"]\n    },\n    unobserve: {\n      actions: [\"stop remote snapshot\", \"remove remote snapshot from context\"]\n    }\n  },\n  initial: \"pristine\",\n  states: {\n    pristine: {}\n  }\n}), createDatasetMutator = (comlink) => datasetMutatorMachine.provide({\n  actors: {\n    documentMutatorMachine: createDocumentMutator(comlink)\n  }\n});\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9vcHRpbWlzdGljL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFnRztBQUNBO0FBQ0U7QUFDbkQ7QUFDL0M7QUFDQSx3QkFBd0IsbURBQVc7QUFDbkM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRyxxQkFBcUIsbURBQVc7QUFDbkM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLG1CQUFtQix5REFBYTtBQUNoQztBQUNBO0FBQ0EsR0FBRztBQUNILFNBQVMsbUZBQXNCO0FBQy9CO0FBQ0EsbUNBQW1DLHlDQUFjO0FBQ2pEO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDLDBCQUEwQiw2Q0FBSztBQUNoQyxXQUFXO0FBQ1g7QUFDQSx1QkFBdUIseUNBQUk7QUFDM0I7QUFDQSxLQUFLLE1BQU0sbURBQVc7QUFDdEIsMkJBQTJCLHlDQUFJO0FBQy9CO0FBQ0EsS0FBSyxNQUFNLG1EQUFXO0FBQ3RCLDBCQUEwQix5Q0FBSTtBQUM5QjtBQUNBLEtBQUssTUFBTSxtREFBVztBQUN0QiwyQkFBMkIseUNBQUk7QUFDL0I7QUFDQSxLQUFLLE1BQU0sbURBQVc7QUFDdEIsMEJBQTBCLHlDQUFNO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLFFBQVEsbURBQVc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QscUZBQW9CO0FBQzVFLGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMLDRCQUE0Qix5Q0FBUztBQUNyQztBQUNBO0FBQ0EsS0FBSyxNQUFNLG1EQUFXO0FBQ3RCLDJDQUEyQyx5Q0FBTTtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsWUFBWSxtREFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFTQztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZlZGlhbi1uZXdzcm9vbS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L29wdGltaXN0aWMvaW5kZXguanM/YmJiNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhY3RvciwgZW1wdHlBY3RvciwgaXNFbXB0eUFjdG9yLCBsaXN0ZW5lcnMsIHNldEFjdG9yIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvY29udGV4dC5qc1wiO1xuaW1wb3J0IHsgZG9jdW1lbnRNdXRhdG9yTWFjaGluZSwgY3JlYXRlU2hhcmVkTGlzdGVuZXIgfSBmcm9tIFwiQHNhbml0eS9tdXRhdGUvX3Vuc3RhYmxlX21hY2hpbmVcIjtcbmltcG9ydCB7IGZyb21Qcm9taXNlLCBlbnF1ZXVlQWN0aW9ucywgc2V0dXAsIGFzc2lnbiwgc3RvcENoaWxkLCBlbWl0LCBhc3NlcnRFdmVudCB9IGZyb20gXCJ4c3RhdGVcIjtcbmltcG9ydCB7IFNhbml0eUVuY29kZXIgfSBmcm9tIFwiQHNhbml0eS9tdXRhdGVcIjtcbmNvbnN0IGNyZWF0ZURvY3VtZW50TXV0YXRvciA9IChjb21saW5rKSA9PiB7XG4gIGNvbnN0IGZldGNoU25hcHNob3QgPSBmcm9tUHJvbWlzZShhc3luYyAoe1xuICAgIGlucHV0LFxuICAgIHNpZ25hbFxuICB9KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgaWRcbiAgICB9ID0gaW5wdXQsIHtcbiAgICAgIHNuYXBzaG90XG4gICAgfSA9IGF3YWl0IGNvbWxpbmsuZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9mZXRjaC1zbmFwc2hvdFwiLCB7XG4gICAgICBkb2N1bWVudElkOiBpZFxuICAgIH0sIHtcbiAgICAgIHNpZ25hbFxuICAgIH0pO1xuICAgIHJldHVybiBzbmFwc2hvdDtcbiAgfSksIHN1Ym1pdE11dGF0aW9ucyA9IGZyb21Qcm9taXNlKGFzeW5jICh7XG4gICAgaW5wdXRcbiAgfSkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHRyYW5zYWN0aW9uc1xuICAgIH0gPSBpbnB1dDtcbiAgICBmb3IgKGNvbnN0IHRyYW5zYWN0aW9uIG9mIHRyYW5zYWN0aW9ucykge1xuICAgICAgY29uc3QgZGF0YSA9IFNhbml0eUVuY29kZXIuZW5jb2RlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuICAgICAgcmV0dXJuIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL211dGF0ZVwiLCBkYXRhKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gZG9jdW1lbnRNdXRhdG9yTWFjaGluZS5wcm92aWRlKHtcbiAgICBhY3Rpb25zOiB7XG4gICAgICBcInNlbmQgc3luYyBldmVudCB0byBwYXJlbnRcIjogZW5xdWV1ZUFjdGlvbnMoKHtcbiAgICAgICAgZW5xdWV1ZVxuICAgICAgfSkgPT4ge1xuICAgICAgICBlbnF1ZXVlLnNlbmRQYXJlbnQoKHtcbiAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH0pID0+ICh7XG4gICAgICAgICAgdHlwZTogXCJzeW5jXCIsXG4gICAgICAgICAgaWQ6IGNvbnRleHQuaWQsXG4gICAgICAgICAgZG9jdW1lbnQ6IGNvbnRleHQucmVtb3RlXG4gICAgICAgIH0pKSwgZW5xdWV1ZS5lbWl0KCh7XG4gICAgICAgICAgY29udGV4dFxuICAgICAgICB9KSA9PiAoe1xuICAgICAgICAgIHR5cGU6IFwicmVhZHlcIixcbiAgICAgICAgICBzbmFwc2hvdDogY29udGV4dC5sb2NhbFxuICAgICAgICB9KSk7XG4gICAgICB9KVxuICAgIH0sXG4gICAgYWN0b3JzOiB7XG4gICAgICBcImZldGNoIHJlbW90ZSBzbmFwc2hvdFwiOiBmZXRjaFNuYXBzaG90LFxuICAgICAgXCJzdWJtaXQgbXV0YXRpb25zIGFzIHRyYW5zYWN0aW9uc1wiOiBzdWJtaXRNdXRhdGlvbnNcbiAgICB9XG4gIH0pO1xufSwgZGF0YXNldE11dGF0b3JNYWNoaW5lID0gc2V0dXAoe1xuICB0eXBlczoge30sXG4gIGFjdGlvbnM6IHtcbiAgICBcImVtaXQgc3luYyBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJzeW5jXCIpLCBldmVudCkpLFxuICAgIFwiZW1pdCBtdXRhdGlvbiBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJtdXRhdGlvblwiKSwgZXZlbnQpKSxcbiAgICBcImVtaXQgcmViYXNlZCBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgW1wicmViYXNlZC5sb2NhbFwiLCBcInJlYmFzZWQucmVtb3RlXCJdKSwgZXZlbnQpKSxcbiAgICBcImVtaXQgcHJpc3RpbmUgZXZlbnRcIjogZW1pdCgoe1xuICAgICAgZXZlbnRcbiAgICB9KSA9PiAoYXNzZXJ0RXZlbnQoZXZlbnQsIFtcInByaXN0aW5lXCJdKSwgZXZlbnQpKSxcbiAgICBcImFkZCBkb2N1bWVudCBhY3RvclwiOiBhc3NpZ24oe1xuICAgICAgZG9jdW1lbnRzOiAoe1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBldmVudCxcbiAgICAgICAgc3Bhd25cbiAgICAgIH0pID0+IHtcbiAgICAgICAgYXNzZXJ0RXZlbnQoZXZlbnQsIFwib2JzZXJ2ZVwiKTtcbiAgICAgICAgY29uc3QgaWQgPSBldmVudC5kb2N1bWVudElkO1xuICAgICAgICByZXR1cm4gY29udGV4dC5kb2N1bWVudHNbaWRdID8gY29udGV4dC5kb2N1bWVudHMgOiB7XG4gICAgICAgICAgLi4uY29udGV4dC5kb2N1bWVudHMsXG4gICAgICAgICAgW2lkXTogc3Bhd24oXCJkb2N1bWVudE11dGF0b3JNYWNoaW5lXCIsIHtcbiAgICAgICAgICAgIGlucHV0OiB7XG4gICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICBjbGllbnQ6IGNvbnRleHQuY2xpZW50LFxuICAgICAgICAgICAgICBzaGFyZWRMaXN0ZW5lcjogY29udGV4dC5zaGFyZWRMaXN0ZW5lciB8fCBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjb250ZXh0LmNsaWVudClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpZFxuICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSksXG4gICAgXCJzdG9wIHJlbW90ZSBzbmFwc2hvdFwiOiBzdG9wQ2hpbGQoKHtcbiAgICAgIGNvbnRleHQsXG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJ1bm9ic2VydmVcIiksIGNvbnRleHQuZG9jdW1lbnRzW2V2ZW50LmRvY3VtZW50SWRdKSksXG4gICAgXCJyZW1vdmUgcmVtb3RlIHNuYXBzaG90IGZyb20gY29udGV4dFwiOiBhc3NpZ24oe1xuICAgICAgZG9jdW1lbnRzOiAoe1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBldmVudFxuICAgICAgfSkgPT4ge1xuICAgICAgICBpZiAoYXNzZXJ0RXZlbnQoZXZlbnQsIFwidW5vYnNlcnZlXCIpLCAhY29udGV4dC5kb2N1bWVudHNbZXZlbnQuZG9jdW1lbnRJZF0pIHJldHVybiBjb250ZXh0LmRvY3VtZW50cztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIFtldmVudC5kb2N1bWVudElkXTogXyxcbiAgICAgICAgICAuLi5kb2N1bWVudHNcbiAgICAgICAgfSA9IGNvbnRleHQuZG9jdW1lbnRzO1xuICAgICAgICByZXR1cm4gZG9jdW1lbnRzO1xuICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIGFjdG9yczoge1xuICAgIGRvY3VtZW50TXV0YXRvck1hY2hpbmVcbiAgfVxufSkuY3JlYXRlTWFjaGluZSh7XG4gIC8qKiBAeHN0YXRlLWxheW91dCBONElncGdKZzVtRE9JQzVRQnNEMkJqQWhzZ0loZ3JnTFpnQjJBTGdNVElDV3NacEEyZ0F3QzZpb0FEcXJOV2RhaVhZZ0FIb2dDMEFEZ0JNQU9na0EyQUN5S0FyQklDY1RkZktYU0FOQ0FDZWlGUUhZWnBnTXhXVjgwMHlZcXA2Z0l5bjVBWHc4RzBXWEFXSnlDbndTR2pwR1ZpRXVIajRCSVZFRUtVdDVPU2xGVTFzbUZ3a0ZXMHNEWTBUMUdSVVhSWGtYS1ZON0hTWUpKa1V2SHd4c1BIUWlVaklaRGdBbldqNFNNQXBDZkRKTWVtWTJKQkJvM241QmFZU1hlVmxiS1JVc2lYZEZTeGNYZktORVJTcVpUYnIxelZNSk55YVFYMWFBenBrSWFoNnlRd3AwVkVKQ1hrbW83aHpPS0xSRExGd3lGeGFTelhLVE9LUXVkU0tDUUZSRE9jenFDU1dKandqYkhDUXFSRmVid2dFaW9DQndJVDNmenRRSmtBRXhlYnhjUXVGRUlaYVdHUklyRjdkU1hLVHlGU05ZbFV0b2RjamRQcDBhaURlbEFoYWdCTHBWbVdBbWM0Nm1Od1NaVHlMUXVGUzNFV1BjVXZONkZUaUEyTHlrU29xNmM2d2JDcVZVenBhcktpb3lSRlZma3ExenFOU1dJa2VJQSAqL1xuICBpZDogXCJkYXRhc2V0LW11dGF0b3JcIixcbiAgY29udGV4dDogKHtcbiAgICBpbnB1dFxuICB9KSA9PiAoe1xuICAgIGRvY3VtZW50czoge30sXG4gICAgY2xpZW50OiBpbnB1dC5jbGllbnQsXG4gICAgc2hhcmVkTGlzdGVuZXI6IGlucHV0LnNoYXJlZExpc3RlbmVyXG4gIH0pLFxuICBvbjoge1xuICAgIHN5bmM6IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgc3luYyBldmVudFwiXVxuICAgIH0sXG4gICAgbXV0YXRpb246IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgbXV0YXRpb24gZXZlbnRcIl1cbiAgICB9LFxuICAgIFwicmViYXNlZC4qXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgcmViYXNlZCBldmVudFwiXVxuICAgIH0sXG4gICAgcHJpc3RpbmU6IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgcHJpc3RpbmUgZXZlbnRcIl1cbiAgICB9LFxuICAgIG9ic2VydmU6IHtcbiAgICAgIGFjdGlvbnM6IFtcImFkZCBkb2N1bWVudCBhY3RvclwiXVxuICAgIH0sXG4gICAgdW5vYnNlcnZlOiB7XG4gICAgICBhY3Rpb25zOiBbXCJzdG9wIHJlbW90ZSBzbmFwc2hvdFwiLCBcInJlbW92ZSByZW1vdGUgc25hcHNob3QgZnJvbSBjb250ZXh0XCJdXG4gICAgfVxuICB9LFxuICBpbml0aWFsOiBcInByaXN0aW5lXCIsXG4gIHN0YXRlczoge1xuICAgIHByaXN0aW5lOiB7fVxuICB9XG59KSwgY3JlYXRlRGF0YXNldE11dGF0b3IgPSAoY29tbGluaykgPT4gZGF0YXNldE11dGF0b3JNYWNoaW5lLnByb3ZpZGUoe1xuICBhY3RvcnM6IHtcbiAgICBkb2N1bWVudE11dGF0b3JNYWNoaW5lOiBjcmVhdGVEb2N1bWVudE11dGF0b3IoY29tbGluaylcbiAgfVxufSk7XG5leHBvcnQge1xuICBhY3RvcixcbiAgY3JlYXRlRGF0YXNldE11dGF0b3IsXG4gIGNyZWF0ZURvY3VtZW50TXV0YXRvcixcbiAgZW1wdHlBY3RvcixcbiAgaXNFbXB0eUFjdG9yLFxuICBsaXN0ZW5lcnMsXG4gIHNldEFjdG9yXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VisualEditing: () => (/* binding */ VisualEditing),\n/* harmony export */   createDataAttribute: () => (/* reexport safe */ _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__.createDataAttribute),\n/* harmony export */   createDatasetMutator: () => (/* reexport safe */ _optimistic_index_js__WEBPACK_IMPORTED_MODULE_20__.createDatasetMutator),\n/* harmony export */   createDocumentMutator: () => (/* reexport safe */ _optimistic_index_js__WEBPACK_IMPORTED_MODULE_20__.createDocumentMutator),\n/* harmony export */   emptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_22__.emptyActor),\n/* harmony export */   useDocuments: () => (/* reexport safe */ _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments),\n/* harmony export */   useOptimistic: () => (/* reexport safe */ _chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_14__.useOptimistic),\n/* harmony export */   useOptimisticActor: () => (/* reexport safe */ _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActor)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/next-sanity/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @sanity/presentation-comlink */ \"(ssr)/./node_modules/@sanity/presentation-comlink/dist/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-dom.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sanity/ui */ \"(ssr)/./node_modules/@sanity/ui/dist/_chunks-es/_visual-editing.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! styled-components */ \"(ssr)/./node_modules/styled-components/dist/styled-components.esm.js\");\n/* harmony import */ var _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../_chunks-es/mutations.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\");\n/* harmony import */ var _chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../_chunks-es/SharedStateContext.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\");\n/* harmony import */ var _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../_chunks-es/PointerEvents.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/icons */ \"(ssr)/./node_modules/@sanity/icons/dist/index.js\");\n/* harmony import */ var _sanity_ui__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @sanity/ui */ \"(ssr)/./node_modules/@sanity/ui/dist/index.mjs\");\n/* harmony import */ var _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @sanity/visual-editing-csm */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing-csm/dist/index.js\");\n/* harmony import */ var scroll_into_view_if_needed__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! scroll-into-view-if-needed */ \"(ssr)/./node_modules/scroll-into-view-if-needed/dist/index.js\");\n/* harmony import */ var _sanity_comlink__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @sanity/comlink */ \"(ssr)/./node_modules/@sanity/comlink/dist/index.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/raise-13a60c49.development.esm.js\");\n/* harmony import */ var _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../_chunks-es/context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/Subject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/observable/merge.js\");\n/* harmony import */ var _optimistic_index_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../optimistic/index.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst History = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(8), {\n    comlink,\n    history\n  } = props;\n  let t0, t1;\n  $[0] !== comlink || $[1] !== history ? (t0 = () => comlink?.on(\"presentation/navigate\", (data) => {\n    history?.update(data);\n  }), t1 = [comlink, history], $[0] = comlink, $[1] = history, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  let t2, t3;\n  return $[4] !== comlink || $[5] !== history ? (t2 = () => {\n    if (history)\n      return history.subscribe((update) => {\n        update.title = update.title || document.title, comlink?.post(\"visual-editing/navigate\", update);\n      });\n  }, t3 = [comlink, history], $[4] = comlink, $[5] = history, $[6] = t2, $[7] = t3) : (t2 = $[6], t3 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3), null;\n}, Meta = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(3), {\n    comlink\n  } = props;\n  let t0, t1;\n  return $[0] !== comlink ? (t0 = () => {\n    const sendMeta = () => {\n      comlink.post(\"visual-editing/meta\", {\n        title: document.title\n      });\n    }, observer = new MutationObserver((t2) => {\n      const [mutation] = t2;\n      mutation.target.nodeName === \"TITLE\" && sendMeta();\n    });\n    return observer.observe(document.head, {\n      subtree: !0,\n      characterData: !0,\n      childList: !0\n    }), sendMeta(), () => observer.disconnect();\n  }, t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), null;\n};\nfunction getReferenceNodeAndInsertPosition(position) {\n  if (position) {\n    const {\n      top,\n      right,\n      bottom,\n      left\n    } = position;\n    if (left || top)\n      return {\n        node: (left ?? top).sanity,\n        position: \"after\"\n      };\n    if (right || bottom)\n      return {\n        node: (right ?? bottom).sanity,\n        position: \"before\"\n      };\n  }\n}\nfunction useDragEndEvents() {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    getDocument\n  } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments)();\n  let t0, t1;\n  $[0] !== getDocument ? (t0 = () => {\n    const handler = (e) => {\n      const {\n        insertPosition,\n        target,\n        preventInsertDefault\n      } = e.detail;\n      if (preventInsertDefault)\n        return;\n      const reference = getReferenceNodeAndInsertPosition(insertPosition);\n      if (reference) {\n        const doc = getDocument(target.id), {\n          node,\n          position\n        } = reference, {\n          key: targetKey,\n          hasExplicitKey\n        } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayItemKeyAndParentPath)(target), {\n          path: arrayPath,\n          key: referenceItemKey\n        } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayItemKeyAndParentPath)(node);\n        arrayPath && referenceItemKey && referenceItemKey !== targetKey && doc.patch(async (t22) => {\n          const {\n            getSnapshot\n          } = t22, snapshot = await getSnapshot(), elementValue = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.get)(snapshot, target.path);\n          return hasExplicitKey ? [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.remove)({\n            _key: targetKey\n          })), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(elementValue, position, {\n            _key: referenceItemKey\n          }))] : [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.remove)(~~targetKey)), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(elementValue, position, referenceItemKey > targetKey ? ~~referenceItemKey - 1 : ~~referenceItemKey))];\n        });\n      }\n    };\n    return window.addEventListener(\"sanity/dragEnd\", handler), () => {\n      window.removeEventListener(\"sanity/dragEnd\", handler);\n    };\n  }, t1 = [getDocument], $[0] = getDocument, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  const dispatchDragEndEvent = _temp$9;\n  let t2;\n  return $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = {\n    dispatchDragEndEvent\n  }, $[3] = t2) : t2 = $[3], t2;\n}\nfunction _temp$9(event) {\n  const customEvent = new CustomEvent(\"sanity/dragEnd\", {\n    detail: event,\n    cancelable: !0\n  });\n  window.dispatchEvent(customEvent);\n}\nconst SchemaContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(null);\nfunction useSchema() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(SchemaContext);\n  if (!context)\n    throw new Error(\"Schema context is missing\");\n  return context;\n}\nfunction getArrayRemoveAction(node, doc) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(async ({\n    getSnapshot\n  }) => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayRemovePatches)(node, await getSnapshot()));\n}\nfunction getArrayInsertAction(node, doc, insertType, position) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(() => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayInsertPatches)(node, insertType, position));\n}\nfunction getDuplicateAction(node, doc) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(async ({\n    getSnapshot\n  }) => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayDuplicatePatches)(node, await getSnapshot()));\n}\nfunction getContextMenuItems(context) {\n  const {\n    node,\n    field,\n    parent,\n    doc\n  } = context;\n  return field?.type === \"arrayItem\" ? getContextMenuArrayItems({\n    node,\n    field,\n    doc\n  }) : parent?.type === \"union\" ? getContextMenuUnionItems({\n    node,\n    parent,\n    doc\n  }) : Promise.resolve([]);\n}\nfunction getDuplicateItem(context) {\n  const {\n    node,\n    doc\n  } = context;\n  return doc ? [{\n    type: \"action\",\n    label: \"Duplicate\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.CopyIcon,\n    action: getDuplicateAction(node, doc),\n    telemetryEvent: \"Visual Editing Context Menu Item Duplicated\"\n  }] : [];\n}\nfunction getRemoveItems(context) {\n  const {\n    node,\n    doc\n  } = context;\n  return doc ? [{\n    type: \"action\",\n    label: \"Remove\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.RemoveIcon,\n    action: getArrayRemoveAction(node, doc),\n    telemetryEvent: \"Visual Editing Context Menu Item Removed\"\n  }] : [];\n}\nasync function getMoveItems(context, withDivider = !0) {\n  const {\n    node,\n    doc\n  } = context;\n  if (!doc) return [];\n  const items = [], groupItems = [], [moveUpPatches, moveDownPatches, moveFirstPatches, moveLastPatches] = await Promise.all([(0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"previous\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"next\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"first\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"last\")]);\n  return moveFirstPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"To top\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.PublishIcon,\n    action: () => doc.patch(moveFirstPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveUpPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"Up\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ArrowUpIcon,\n    action: () => doc.patch(moveUpPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveDownPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"Down\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ArrowDownIcon,\n    action: () => doc.patch(moveDownPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveLastPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"To bottom\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.UnpublishIcon,\n    action: () => doc.patch(moveLastPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), groupItems.length && (items.push({\n    type: \"group\",\n    label: \"Move\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.SortIcon,\n    items: groupItems\n  }), withDivider && items.push({\n    type: \"divider\"\n  })), items;\n}\nasync function getContextMenuArrayItems(context) {\n  const {\n    node,\n    field,\n    doc\n  } = context, items = [];\n  return items.push(...getDuplicateItem(context)), items.push(...getRemoveItems(context)), items.push(...await getMoveItems(context)), items.push({\n    type: \"action\",\n    label: \"Insert before\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertAboveIcon,\n    action: getArrayInsertAction(node, doc, field.name, \"before\"),\n    telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n  }), items.push({\n    type: \"action\",\n    label: \"Insert after\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon,\n    action: getArrayInsertAction(node, doc, field.name, \"after\"),\n    telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n  }), items;\n}\nconst InsertMenuWrapper = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(12), {\n    label,\n    parent,\n    width,\n    onSelect,\n    boundaryElement\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [\"left-start\", \"right\", \"left\", \"right-end\", \"left-end\", \"bottom\", \"top\"], $[0] = t0) : t0 = $[0];\n  let t1;\n  $[1] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = [4, 4, 4, 4], $[1] = t1) : t1 = $[1];\n  let t2;\n  $[2] !== boundaryElement || $[3] !== width ? (t2 = {\n    arrow: !1,\n    constrainSize: !0,\n    floatingBoundary: boundaryElement,\n    padding: 0,\n    placement: \"right-start\",\n    fallbackPlacements: t0,\n    preventOverflow: !0,\n    width,\n    __unstable_margins: t1\n  }, $[2] = boundaryElement, $[3] = width, $[4] = t2) : t2 = $[4];\n  let t3;\n  $[5] !== onSelect || $[6] !== parent ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.InsertMenu, { node: parent, onSelect }), $[5] = onSelect, $[6] = parent, $[7] = t3) : t3 = $[7];\n  let t4;\n  return $[8] !== label || $[9] !== t2 || $[10] !== t3 ? (t4 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuGroup, { fontSize: 1, icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon, padding: 2, popover: t2, space: 2, text: label, children: t3 }), $[8] = label, $[9] = t2, $[10] = t3, $[11] = t4) : t4 = $[11], t4;\n};\nasync function getContextMenuUnionItems(context) {\n  const {\n    doc,\n    node,\n    parent\n  } = context, items = [];\n  if (items.push(...getDuplicateItem(context)), items.push(...getRemoveItems(context)), items.push(...await getMoveItems(context)), parent.options?.insertMenu) {\n    const width = (parent.options.insertMenu || {}).views?.some((view) => view.name === \"grid\") ? 0 : void 0;\n    items.push({\n      type: \"custom\",\n      component: ({\n        boundaryElement,\n        sendTelemetry\n      }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(InsertMenuWrapper, { label: \"Insert before\", onSelect: (schemaType) => {\n        getArrayInsertAction(node, doc, schemaType.name, \"before\")(), sendTelemetry(\"Visual Editing Context Menu Item Inserted\", null);\n      }, parent, width, boundaryElement })\n    }), items.push({\n      type: \"custom\",\n      component: ({\n        boundaryElement,\n        sendTelemetry\n      }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(InsertMenuWrapper, { label: \"Insert after\", onSelect: (schemaType) => {\n        getArrayInsertAction(node, doc, schemaType.name, \"after\")(), sendTelemetry(\"Visual Editing Context Menu Item Inserted\", null);\n      }, parent, width, boundaryElement })\n    });\n  } else\n    items.push({\n      type: \"group\",\n      label: \"Insert before\",\n      icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertAboveIcon,\n      items: parent.of.filter((item) => item.type === \"unionOption\").map((t) => ({\n        type: \"action\",\n        icon: (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(t),\n        label: t.name === \"block\" ? \"Paragraph\" : t.title || t.name,\n        action: getArrayInsertAction(node, doc, t.name, \"before\"),\n        telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n      }))\n    }), items.push({\n      type: \"group\",\n      label: \"Insert after\",\n      icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon,\n      items: parent.of.filter((item) => item.type === \"unionOption\").map((t) => ({\n        type: \"action\",\n        label: t.name === \"block\" ? \"Paragraph\" : t.title || t.name,\n        icon: (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(t),\n        action: getArrayInsertAction(node, doc, t.name, \"after\"),\n        telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n      }))\n    });\n  return items;\n}\nconst POPOVER_MARGINS = [-4, 4, -4, 4];\nfunction ContextMenuItem(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(27), {\n    node,\n    onDismiss,\n    boundaryElement\n  } = props, sendTelemetry = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.useTelemetry)();\n  let t0;\n  $[0] !== node || $[1] !== onDismiss || $[2] !== sendTelemetry ? (t0 = () => {\n    node.type === \"action\" && (node.action?.(), onDismiss?.(), node.telemetryEvent && sendTelemetry(node.telemetryEvent, null));\n  }, $[0] = node, $[1] = onDismiss, $[2] = sendTelemetry, $[3] = t0) : t0 = $[3];\n  const onClick = t0;\n  if (node.type === \"divider\") {\n    let t1;\n    return $[4] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {}), $[4] = t1) : t1 = $[4], t1;\n  }\n  if (node.type === \"action\") {\n    const t1 = !node.action;\n    let t2;\n    return $[5] !== node.hotkeys || $[6] !== node.icon || $[7] !== node.label || $[8] !== onClick || $[9] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuItem, { fontSize: 1, hotkeys: node.hotkeys, icon: node.icon, padding: 2, space: 2, text: node.label, disabled: t1, onClick }), $[5] = node.hotkeys, $[6] = node.icon, $[7] = node.label, $[8] = onClick, $[9] = t1, $[10] = t2) : t2 = $[10], t2;\n  }\n  if (node.type === \"group\") {\n    const t1 = node.icon;\n    let t2;\n    $[11] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = {\n      arrow: !1,\n      constrainSize: !0,\n      placement: \"right-start\",\n      fallbackPlacements: [\"left-start\", \"right\", \"left\", \"right-end\", \"left-end\", \"bottom\", \"top\"],\n      preventOverflow: !0,\n      __unstable_margins: POPOVER_MARGINS\n    }, $[11] = t2) : t2 = $[11];\n    const t3 = node.label;\n    let t4;\n    if ($[12] !== boundaryElement || $[13] !== node.items || $[14] !== onDismiss) {\n      let t52;\n      $[16] !== boundaryElement || $[17] !== onDismiss ? (t52 = (item, itemIndex) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenuItem, { node: item, onDismiss, boundaryElement }, itemIndex), $[16] = boundaryElement, $[17] = onDismiss, $[18] = t52) : t52 = $[18], t4 = node.items.map(t52), $[12] = boundaryElement, $[13] = node.items, $[14] = onDismiss, $[15] = t4;\n    } else\n      t4 = $[15];\n    let t5;\n    return $[19] !== node.icon || $[20] !== node.label || $[21] !== t4 ? (t5 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuGroup, { fontSize: 1, icon: t1, padding: 2, popover: t2, space: 2, text: t3, children: t4 }), $[19] = node.icon, $[20] = node.label, $[21] = t4, $[22] = t5) : t5 = $[22], t5;\n  }\n  if (node.type === \"custom\") {\n    const {\n      component: Component\n    } = node;\n    let t1;\n    return $[23] !== Component || $[24] !== boundaryElement || $[25] !== sendTelemetry ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component, { boundaryElement, sendTelemetry }), $[23] = Component, $[24] = boundaryElement, $[25] = sendTelemetry, $[26] = t1) : t1 = $[26], t1;\n  }\n  return null;\n}\nconst ContextMenu = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(43), {\n    node,\n    onDismiss,\n    position: t0\n  } = props, {\n    x,\n    y\n  } = t0, [boundaryElement, setBoundaryElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), {\n    getField\n  } = useSchema(), {\n    getDocument\n  } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments)();\n  let t1;\n  $[0] !== getField || $[1] !== node ? (t1 = getField(node), $[0] = getField, $[1] = node, $[2] = t1) : t1 = $[2];\n  const {\n    field,\n    parent\n  } = t1;\n  let t2;\n  t2 = field?.title || field?.name || \"Unknown type\";\n  const title = t2, [items, setItems] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(void 0);\n  let t3, t4;\n  $[3] !== field || $[4] !== getDocument || $[5] !== node || $[6] !== parent ? (t3 = () => {\n    (async () => {\n      const doc = getDocument(node.id);\n      if (!doc)\n        return;\n      const items_0 = await getContextMenuItems({\n        node,\n        field,\n        parent,\n        doc\n      });\n      setItems(items_0);\n    })();\n  }, t4 = [field, node, parent, getDocument], $[3] = field, $[4] = getDocument, $[5] = node, $[6] = parent, $[7] = t3, $[8] = t4) : (t3 = $[7], t4 = $[8]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  let t5, t6;\n  $[9] !== x || $[10] !== y ? (t6 = {\n    getBoundingClientRect: () => ({\n      bottom: y,\n      left: x,\n      right: x,\n      top: y,\n      width: 0,\n      height: 0\n    })\n  }, $[9] = x, $[10] = y, $[11] = t6) : t6 = $[11], t5 = t6;\n  const contextMenuReferenceElement = t5;\n  let t7, t8;\n  $[12] !== field ? (t8 = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(field), $[12] = field, $[13] = t8) : t8 = $[13], t7 = t8;\n  const icon = t7;\n  let t9;\n  $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t9 = {\n    minWidth: 120,\n    maxWidth: 160\n  }, $[14] = t9) : t9 = $[14];\n  let t10;\n  $[15] !== icon || $[16] !== items ? (t10 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { flex: \"none\", children: items ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: icon }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Spinner, { size: 1 }) }), $[15] = icon, $[16] = items, $[17] = t10) : t10 = $[17];\n  const t11 = items ? title : \"Loading...\";\n  let t12;\n  $[18] !== t11 ? (t12 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Stack, { flex: 1, space: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"semibold\", children: t11 }) }), $[18] = t11, $[19] = t12) : t12 = $[19];\n  let t13;\n  $[20] !== t10 || $[21] !== t12 ? (t13 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex, { gap: 2, padding: 2, children: [\n    t10,\n    t12\n  ] }), $[20] = t10, $[21] = t12, $[22] = t13) : t13 = $[22];\n  let t14;\n  $[23] !== boundaryElement || $[24] !== items || $[25] !== onDismiss ? (t14 = items && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {}),\n    items.map((item, i) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenuItem, { node: item, onDismiss, boundaryElement }, i))\n  ] }), $[23] = boundaryElement, $[24] = items, $[25] = onDismiss, $[26] = t14) : t14 = $[26];\n  let t15;\n  $[27] !== t13 || $[28] !== t14 ? (t15 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Menu, { style: t9, children: [\n    t13,\n    t14\n  ] }), $[27] = t13, $[28] = t14, $[29] = t15) : t15 = $[29];\n  const t16 = `${x}-${y}`;\n  let t17;\n  $[30] !== x || $[31] !== y ? (t17 = {\n    position: \"absolute\",\n    left: x,\n    top: y\n  }, $[30] = x, $[31] = y, $[32] = t17) : t17 = $[32];\n  let t18;\n  $[33] !== t16 || $[34] !== t17 ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: t17 }, t16), $[33] = t16, $[34] = t17, $[35] = t18) : t18 = $[35];\n  let t19;\n  $[36] !== contextMenuReferenceElement || $[37] !== t15 || $[38] !== t18 ? (t19 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Popover, { __unstable_margins: POPOVER_MARGINS, arrow: !1, open: !0, placement: \"right-start\", referenceElement: contextMenuReferenceElement, content: t15, children: t18 }), $[36] = contextMenuReferenceElement, $[37] = t15, $[38] = t18, $[39] = t19) : t19 = $[39];\n  let t20;\n  return $[40] !== onDismiss || $[41] !== t19 ? (t20 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PopoverPortal, { setBoundaryElement, onDismiss, children: t19 }), $[40] = onDismiss, $[41] = t19, $[42] = t20) : t20 = $[42], t20;\n};\nfunction getLinkHref(href, referer) {\n  try {\n    const parsed = new URL(href, typeof location > \"u\" ? void 0 : location.origin);\n    if (parsed.hash) {\n      const hash = new URL(getLinkHref(parsed.hash.slice(1), referer));\n      return `${parsed.origin}${parsed.pathname}${parsed.search}#${hash.pathname}${hash.search}`;\n    }\n    return parsed.searchParams.set(\"preview\", referer), parsed.toString();\n  } catch {\n    return href;\n  }\n}\nconst PreviewSnapshotsContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(null);\nfunction usePreviewSnapshots() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(PreviewSnapshotsContext);\n  if (!context)\n    throw new Error(\"Preview Snapshots context is missing\");\n  return context;\n}\nconst isReactElementOverlayComponent = (component) => (0,react__WEBPACK_IMPORTED_MODULE_2__.isValidElement)(component), Root$3 = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  background-color: var(--overlay-bg);\n  border-radius: 3px;\n  pointer-events: none;\n  position: absolute;\n  will-change: transform;\n  box-shadow: var(--overlay-box-shadow);\n  transition: none;\n\n  --overlay-bg: transparent;\n  --overlay-box-shadow: inset 0 0 0 1px transparent;\n\n  [data-overlays] & {\n    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));\n    --overlay-box-shadow: inset 0 0 0 2px\n      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));\n  }\n\n  [data-fading-out] & {\n    transition:\n      box-shadow 1550ms,\n      background-color 1550ms;\n\n    --overlay-bg: rgba(0, 0, 255, 0);\n    --overlay-box-shadow: inset 0 0 0 1px transparent;\n  }\n\n  &[data-focused] {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  }\n\n  &[data-hovered]:not([data-focused]) {\n    transition: none;\n    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);\n  }\n\n  /* [data-unmounted] & {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  } */\n\n  :link {\n    text-decoration: none;\n  }\n`, Actions = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`, HUD = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  top: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  gap: 4px;\n  padding: 4px 0;\n  flex-wrap: wrap;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    top: calc(100% + 2rem);\n  }\n`, MenuWrapper = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  margin: -0.5rem;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n`, Tab = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`, ActionOpen = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  cursor: pointer;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n\n  & [data-ui='Text'] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`, Labels = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  display: flex;\n  align-items: center;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n  & [data-ui='Text'],\n  & [data-sanity-icon] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`, ExclusivePluginContainer = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  position: absolute;\n  inset: 0;\n  pointer-events: all;\n`;\nfunction createIntentLink(node) {\n  const {\n    id,\n    type,\n    path,\n    baseUrl,\n    tool,\n    workspace\n  } = node;\n  return (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.createEditUrl)({\n    baseUrl,\n    workspace,\n    tool,\n    type,\n    id,\n    path: path ? (0,_sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__.pathToUrlString)(_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.studioPath.fromString(path)) : []\n  });\n}\nconst ElementOverlayInner = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(59), {\n    id,\n    element,\n    focused,\n    componentResolver,\n    node,\n    showActions,\n    draggable,\n    targets,\n    elementType,\n    comlink,\n    onActivateExclusivePlugin,\n    onMenuOpenChange\n  } = props, {\n    getField,\n    getType\n  } = useSchema();\n  let t0;\n  $[0] !== getType || $[1] !== node ? (t0 = getType(node), $[0] = getType, $[1] = node, $[2] = t0) : t0 = $[2];\n  const schemaType = t0;\n  let t1;\n  $[3] !== node ? (t1 = \"path\" in node ? createIntentLink(node) : node.href, $[3] = node, $[4] = t1) : t1 = $[4];\n  const href = t1, previewSnapshots = usePreviewSnapshots();\n  let t2;\n  bb0: {\n    if (!(\"path\" in node)) {\n      t2 = void 0;\n      break bb0;\n    }\n    let t32;\n    $[5] !== node || $[6] !== previewSnapshots ? (t32 = previewSnapshots.find((snapshot) => snapshot._id === node.id)?.title, $[5] = node, $[6] = previewSnapshots, $[7] = t32) : t32 = $[7], t2 = t32;\n  }\n  const title = t2;\n  let t3, t4;\n  $[8] !== element || $[9] !== focused || $[10] !== getField || $[11] !== getType ? (t4 = function(node_0, nodeElement) {\n    const schemaType_0 = getType(node_0), {\n      field,\n      parent\n    } = getField(node_0);\n    if (!(\"id\" in node_0) || !field || !schemaType_0)\n      return;\n    const type = field.value.type;\n    return {\n      document: schemaType_0,\n      element,\n      targetElement: nodeElement || element,\n      field,\n      focused: !!focused,\n      node: node_0,\n      parent,\n      type\n    };\n  }, $[8] = element, $[9] = focused, $[10] = getField, $[11] = getType, $[12] = t4) : t4 = $[12];\n  const getContext = t4;\n  let t5;\n  $[13] !== elementType || $[14] !== getContext || $[15] !== node ? (t5 = elementType === \"element\" ? getContext(node) : void 0, $[13] = elementType, $[14] = getContext, $[15] = node, $[16] = t5) : t5 = $[16];\n  let t6;\n  if ($[17] !== getContext || $[18] !== targets) {\n    let t72;\n    $[20] !== getContext ? (t72 = (target) => getContext(target.sanity, target.element), $[20] = getContext, $[21] = t72) : t72 = $[21], t6 = targets.map(t72).filter(_temp$8), $[17] = getContext, $[18] = targets, $[19] = t6;\n  } else\n    t6 = $[19];\n  let t7;\n  $[22] !== t5 || $[23] !== t6 ? (t7 = {\n    legacyComponentContext: t5,\n    pluginContexts: t6\n  }, $[22] = t5, $[23] = t6, $[24] = t7) : t7 = $[24], t3 = t7;\n  const resolverContexts = t3, customComponents = useCustomComponents(resolverContexts.legacyComponentContext, componentResolver), nodePluginCollections = useResolvedNodePlugins(resolverContexts.pluginContexts, props.plugins);\n  let t8;\n  $[25] !== schemaType ? (t8 = schemaType?.icon ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n    __html: schemaType.icon\n  } }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.DocumentIcon, {}), $[25] = schemaType, $[26] = t8) : t8 = $[26];\n  const icon = t8, menuId = (0,react__WEBPACK_IMPORTED_MODULE_2__.useId)();\n  let t9;\n  $[27] !== nodePluginCollections ? (t9 = nodePluginCollections?.some(_temp2$5), $[27] = nodePluginCollections, $[28] = t9) : t9 = $[28];\n  const showMenu = t9 || nodePluginCollections?.length > 1;\n  let t10;\n  $[29] !== id ? (t10 = () => {\n    window.dispatchEvent(new CustomEvent(\"sanity-overlay/label-click\", {\n      detail: {\n        id\n      }\n    }));\n  }, $[29] = id, $[30] = t10) : t10 = $[30];\n  const handleLabelClick = t10;\n  let t11;\n  $[31] !== href || $[32] !== showActions ? (t11 = showActions ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Actions, { gap: 1, paddingY: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Link, { href }) }) : null, $[31] = href, $[32] = showActions, $[33] = t11) : t11 = $[33];\n  let t12;\n  $[34] !== comlink || $[35] !== draggable || $[36] !== handleLabelClick || $[37] !== icon || $[38] !== menuId || $[39] !== nodePluginCollections || $[40] !== onActivateExclusivePlugin || $[41] !== onMenuOpenChange || $[42] !== showMenu || $[43] !== title ? (t12 = (title || showMenu) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Tab, { gap: 1, paddingY: 1, onClick: handleLabelClick, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Labels, { gap: 2, padding: 2, children: [\n    draggable && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { marginRight: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { className: \"drag-handle\", size: 0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.DragHandleIcon, {}) }) }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 0, children: icon }),\n    title && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"medium\", children: title }),\n    showMenu && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { paddingLeft: 2, onClick: _temp3$2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(MenuWrapper, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_12__.MenuButton, { id: menuId, popover: {\n      animate: !0,\n      placement: \"bottom-start\",\n      constrainSize: !0,\n      tone: \"default\"\n    }, onOpen: () => {\n      onMenuOpenChange?.(!0);\n    }, onClose: () => {\n      onMenuOpenChange?.(!1);\n    }, button: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Button, { icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.EllipsisVerticalIcon, tone: \"primary\", padding: 2 }), menu: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Menu, { paddingY: 0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PointerEvents, { children: nodePluginCollections?.map((nodePluginCollection_0, index) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react__WEBPACK_IMPORTED_MODULE_2__.Fragment, { children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Stack, { role: \"group\", paddingY: 1, space: 0, children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuItem, { paddingY: 2, text: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { paddingY: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { muted: !0, size: 1, style: {\n          textTransform: \"capitalize\"\n        }, children: `${nodePluginCollection_0.context.document.name}: ${nodePluginCollection_0.context.field?.name}` }) }), onClick: () => {\n          nodePluginCollection_0.context.node && comlink?.post(\"visual-editing/focus\", nodePluginCollection_0.context.node);\n        } }),\n        nodePluginCollection_0.exclusive.map((exclusive) => exclusive.component ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuItem, { paddingY: 2, icon: exclusive.icon || /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.PlugIcon, {}), text: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { paddingY: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: exclusive.title || exclusive.name }) }), onClick: () => onActivateExclusivePlugin?.(exclusive, nodePluginCollection_0.context) }, exclusive.name) : null)\n      ] }),\n      index < nodePluginCollections.length - 1 && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {})\n    ] }, nodePluginCollection_0.id)) }) }) }) }) })\n  ] }) }), $[34] = comlink, $[35] = draggable, $[36] = handleLabelClick, $[37] = icon, $[38] = menuId, $[39] = nodePluginCollections, $[40] = onActivateExclusivePlugin, $[41] = onMenuOpenChange, $[42] = showMenu, $[43] = title, $[44] = t12) : t12 = $[44];\n  let t13;\n  $[45] !== nodePluginCollections ? (t13 = nodePluginCollections?.map(_temp4$1), $[45] = nodePluginCollections, $[46] = t13) : t13 = $[46];\n  let t14;\n  $[47] !== t13 ? (t14 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(HUD, { children: t13 }), $[47] = t13, $[48] = t14) : t14 = $[48];\n  let t15;\n  $[49] !== t11 || $[50] !== t12 || $[51] !== t14 ? (t15 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PointerEvents, { children: [\n    t11,\n    t12,\n    t14\n  ] }), $[49] = t11, $[50] = t12, $[51] = t14, $[52] = t15) : t15 = $[52];\n  let t16;\n  $[53] !== customComponents || $[54] !== resolverContexts.legacyComponentContext ? (t16 = Array.isArray(customComponents) ? customComponents.map((t172, i) => {\n    const {\n      component: Component_1,\n      props: props_0\n    } = t172;\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component_1, { PointerEvents: _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PointerEvents, ...resolverContexts.legacyComponentContext, ...props_0 }, i);\n  }) : customComponents, $[53] = customComponents, $[54] = resolverContexts.legacyComponentContext, $[55] = t16) : t16 = $[55];\n  let t17;\n  return $[56] !== t15 || $[57] !== t16 ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t15,\n    t16\n  ] }), $[56] = t15, $[57] = t16, $[58] = t17) : t17 = $[58], t17;\n}, ElementOverlay = (0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(38), {\n    draggable,\n    focused,\n    hovered,\n    rect,\n    wasMaybeCollapsed,\n    enableScrollIntoView\n  } = props, ref = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null), scrolledIntoViewRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(!1);\n  let t0;\n  const t1 = `${rect.w}px`, t2 = `${rect.h}px`, t3 = `translate(${rect.x}px, ${rect.y}px)`;\n  let t4;\n  $[0] !== t1 || $[1] !== t2 || $[2] !== t3 ? (t4 = {\n    width: t1,\n    height: t2,\n    transform: t3\n  }, $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4) : t4 = $[3], t0 = t4;\n  const style = t0;\n  let t5, t6;\n  $[4] !== enableScrollIntoView || $[5] !== focused || $[6] !== wasMaybeCollapsed ? (t5 = () => {\n    if (!scrolledIntoViewRef.current && !wasMaybeCollapsed && focused === !0 && ref.current && enableScrollIntoView) {\n      const target = ref.current;\n      (0,scroll_into_view_if_needed__WEBPACK_IMPORTED_MODULE_13__[\"default\"])(ref.current, {\n        behavior: (actions) => {\n          actions.length !== 0 && target.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"center\",\n            inline: \"nearest\"\n          });\n        },\n        scrollMode: \"if-needed\",\n        block: \"center\",\n        inline: \"nearest\"\n      });\n    }\n    scrolledIntoViewRef.current = focused === !0;\n  }, t6 = [focused, wasMaybeCollapsed, enableScrollIntoView], $[4] = enableScrollIntoView, $[5] = focused, $[6] = wasMaybeCollapsed, $[7] = t5, $[8] = t6) : (t5 = $[7], t6 = $[8]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t5, t6);\n  const [isNearTop, setIsNearTop] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1);\n  let t7;\n  $[9] !== hovered ? (t7 = () => {\n    if (!ref.current || !hovered)\n      return;\n    const io = new IntersectionObserver((t82) => {\n      const [intersection] = t82;\n      setIsNearTop(intersection.boundingClientRect.top < 0);\n    }, {\n      threshold: 1\n    });\n    return io.observe(ref.current), () => io.disconnect();\n  }, $[9] = hovered, $[10] = t7) : t7 = $[10];\n  let t8;\n  $[11] !== hovered || $[12] !== isNearTop ? (t8 = [hovered, isNearTop], $[11] = hovered, $[12] = isNearTop, $[13] = t8) : t8 = $[13], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t7, t8);\n  const [activeExclusivePlugin, setActiveExclusivePlugin] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t9;\n  $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t9 = () => {\n    setActiveExclusivePlugin(null), window.dispatchEvent(new CustomEvent(\"sanity-overlay/exclusive-plugin-closed\"));\n  }, $[14] = t9) : t9 = $[14];\n  const closeExclusivePluginView = t9;\n  let t10;\n  $[15] === Symbol.for(\"react.memo_cache_sentinel\") ? (t10 = (plugin, context) => {\n    setActiveExclusivePlugin({\n      plugin,\n      context\n    });\n  }, $[15] = t10) : t10 = $[15];\n  const onActivateExclusivePlugin = t10, handleExclusivePluginClick = _temp5$1, ExclusivePluginComponent = activeExclusivePlugin?.plugin.component, [menuOpen, setMenuOpen] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1);\n  let t11;\n  $[16] === Symbol.for(\"react.memo_cache_sentinel\") ? (t11 = () => {\n    setMenuOpen(!1);\n  }, $[16] = t11) : t11 = $[16];\n  let t12;\n  $[17] !== hovered ? (t12 = [hovered], $[17] = hovered, $[18] = t12) : t12 = $[18], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t11, t12);\n  let t13;\n  $[19] !== ExclusivePluginComponent || $[20] !== menuOpen ? (t13 = menuOpen || ExclusivePluginComponent ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PopoverBackground, { onDismiss: closeExclusivePluginView, blockScroll: menuOpen }) : null, $[19] = ExclusivePluginComponent, $[20] = menuOpen, $[21] = t13) : t13 = $[21];\n  const t14 = focused ? \"\" : void 0, t15 = hovered ? \"\" : void 0, t16 = isNearTop ? \"\" : void 0, t17 = draggable ? \"\" : void 0, t18 = menuOpen ? \"\" : void 0;\n  let t19;\n  $[22] !== ExclusivePluginComponent || $[23] !== activeExclusivePlugin || $[24] !== hovered || $[25] !== props ? (t19 = ExclusivePluginComponent ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ExclusivePluginContainer, { \"data-sanity-overlay-element\": !0, onClick: handleExclusivePluginClick, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ExclusivePluginComponent, { ...activeExclusivePlugin.context, closeExclusiveView: closeExclusivePluginView }) }) : hovered ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ElementOverlayInner, { ...props, onActivateExclusivePlugin, onMenuOpenChange: setMenuOpen }) : null, $[22] = ExclusivePluginComponent, $[23] = activeExclusivePlugin, $[24] = hovered, $[25] = props, $[26] = t19) : t19 = $[26];\n  let t20;\n  $[27] !== style || $[28] !== t14 || $[29] !== t15 || $[30] !== t16 || $[31] !== t17 || $[32] !== t18 || $[33] !== t19 ? (t20 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Root$3, { \"data-focused\": t14, \"data-hovered\": t15, \"data-flipped\": t16, \"data-draggable\": t17, \"data-menu-open\": t18, ref, style, children: t19 }), $[27] = style, $[28] = t14, $[29] = t15, $[30] = t16, $[31] = t17, $[32] = t18, $[33] = t19, $[34] = t20) : t20 = $[34];\n  let t21;\n  return $[35] !== t13 || $[36] !== t20 ? (t21 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t13,\n    t20\n  ] }), $[35] = t13, $[36] = t20, $[37] = t21) : t21 = $[37], t21;\n});\nfunction useResolvedNodePlugins(componentContexts, plugins) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5);\n  let t0, t1;\n  if ($[0] !== componentContexts || $[1] !== plugins) {\n    let t2;\n    $[3] !== plugins ? (t2 = (componentContext) => {\n      const instance = {\n        id: (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_14__.v4)(),\n        context: componentContext,\n        hud: [],\n        exclusive: []\n      };\n      return plugins?.forEach((plugin) => {\n        plugin.guard?.(componentContext) && (plugin.type === \"hud\" && instance.hud.push(plugin), plugin.type === \"exclusive\" && instance.exclusive.push(plugin));\n      }), instance;\n    }, $[3] = plugins, $[4] = t2) : t2 = $[4], t1 = componentContexts.map(t2), $[0] = componentContexts, $[1] = plugins, $[2] = t1;\n  } else\n    t1 = $[2];\n  return t0 = t1, t0;\n}\nfunction useCustomComponents(componentContext, componentResolver) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4);\n  let t0;\n  bb0: {\n    if (!componentContext) {\n      t0 = void 0;\n      break bb0;\n    }\n    let t1;\n    if ($[0] !== componentContext || $[1] !== componentResolver) {\n      const resolved = componentResolver?.(componentContext);\n      if (!resolved) {\n        t0 = void 0;\n        break bb0;\n      }\n      if (isReactElementOverlayComponent(resolved)) {\n        t0 = resolved;\n        break bb0;\n      }\n      t1 = (Array.isArray(resolved) ? resolved : [resolved]).map(_temp6$1), $[0] = componentContext, $[1] = componentResolver, $[2] = t1, $[3] = t0;\n    } else\n      t1 = $[2], t0 = $[3];\n    t0 = t1;\n  }\n  return t0;\n}\nfunction _temp6$1(component) {\n  return typeof component == \"object\" && \"component\" in component ? component : {\n    component,\n    props: {}\n  };\n}\nconst Link = (0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(6), referer = (0,react__WEBPACK_IMPORTED_MODULE_2__.useSyncExternalStore)(_temp7$1, _temp8$1);\n  let t0, t1;\n  $[0] !== props.href || $[1] !== referer ? (t1 = getLinkHref(props.href, referer), $[0] = props.href, $[1] = referer, $[2] = t1) : t1 = $[2], t0 = t1;\n  const href = t0;\n  let t2;\n  $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ActionOpen, { padding: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"medium\", children: \"Open in Studio\" }) }), $[3] = t2) : t2 = $[3];\n  let t3;\n  return $[4] !== href ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { as: \"a\", href, target: \"_blank\", rel: \"noopener noreferrer\", children: t2 }), $[4] = href, $[5] = t3) : t3 = $[5], t3;\n});\nfunction _temp$8(ctx) {\n  return ctx !== void 0;\n}\nfunction _temp2$5(nodePluginCollection) {\n  return nodePluginCollection.exclusive.length > 0;\n}\nfunction _temp3$2(e) {\n  e.stopPropagation();\n}\nfunction _temp4$1(nodePluginCollection_1) {\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_2__.Fragment, { children: nodePluginCollection_1.hud.map((hud) => {\n    const Component_0 = hud.component;\n    return Component_0 ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component_0, { ...nodePluginCollection_1.context }, hud.name) : null;\n  }) }, nodePluginCollection_1.id);\n}\nfunction _temp5$1(event) {\n  event.stopPropagation();\n}\nfunction _temp7$1(onStoreChange) {\n  const handlePopState = () => onStoreChange();\n  return window.addEventListener(\"popstate\", handlePopState), () => window.removeEventListener(\"popstate\", handlePopState);\n}\nfunction _temp8$1() {\n  return window.location.href;\n}\nconst OverlayDragGroupRect = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5), {\n    dragGroupRect\n  } = t0, t1 = `${dragGroupRect.y}px`, t2 = `${dragGroupRect.x}px`, t3 = `${dragGroupRect.w - 1}px`, t4 = `${dragGroupRect.h - 1}px`;\n  let t5;\n  return $[0] !== t1 || $[1] !== t2 || $[2] !== t3 || $[3] !== t4 ? (t5 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n    position: \"absolute\",\n    top: t1,\n    left: t2,\n    width: t3,\n    height: t4,\n    border: \"1px dashed #f0709b\",\n    pointerEvents: \"none\"\n  } }), $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4, $[4] = t5) : t5 = $[4], t5;\n}, markerThickness = 6;\nfunction lerp(v0, v1, t) {\n  return v0 * (1 - t) + v1 * t;\n}\nconst OverlayDragInsertMarker = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    dragInsertPosition\n  } = t0;\n  if (dragInsertPosition === null)\n    return;\n  const flow = dragInsertPosition?.left || dragInsertPosition?.right ? \"horizontal\" : \"vertical\";\n  let x = 0, y = 0, width = 0, height = 0;\n  if (flow === \"horizontal\") {\n    const {\n      left,\n      right\n    } = dragInsertPosition;\n    if (width = markerThickness, right && left) {\n      const startX = left.rect.x + left.rect.w, endX = right.rect.x, offset = Math.min(right.rect.h, left.rect.h) * 0.0125;\n      x = lerp(startX, endX, 0.5) - markerThickness / 2, y = left.rect.y + offset, height = Math.min(right.rect.h, left.rect.h) - offset * 2;\n    } else if (right && !left) {\n      const offset_0 = right.rect.h * 0.0125;\n      x = right.rect.x - markerThickness / 2, y = right.rect.y + offset_0, height = right.rect.h - offset_0 * 2;\n    } else if (left && !right) {\n      const offset_1 = left.rect.h * 0.0125;\n      x = left.rect.x + left.rect.w - markerThickness / 2, y = left.rect.y + offset_1, height = left.rect.h - offset_1 * 2;\n    }\n  } else {\n    const {\n      bottom,\n      top\n    } = dragInsertPosition;\n    if (bottom && top) {\n      const startX_0 = Math.min(top.rect.x, bottom.rect.x), startY = top.rect.y + top.rect.h, endY = bottom.rect.y, offset_2 = Math.min(bottom.rect.w, top.rect.w) * 0.0125;\n      height = markerThickness, x = startX_0 + offset_2, y = lerp(startY, endY, 0.5) - markerThickness / 2, width = Math.max(bottom.rect.w, top.rect.w) - offset_2 * 2;\n    } else if (bottom && !top) {\n      const offset_3 = bottom.rect.w * 0.0125;\n      x = bottom.rect.x + offset_3, y = bottom.rect.y - markerThickness / 2, width = bottom.rect.w - offset_3 * 2, height = markerThickness;\n    } else if (top && !bottom) {\n      const offset_4 = top.rect.w * 0.0125;\n      x = top.rect.x + offset_4, y = top.rect.y + top.rect.h - markerThickness / 2, width = top.rect.w - offset_4 * 2, height = markerThickness;\n    }\n  }\n  const t1 = `${width}px`, t2 = `${height}px`, t3 = `translate(${x}px, ${y}px)`;\n  let t4;\n  return $[0] !== t1 || $[1] !== t2 || $[2] !== t3 ? (t4 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n    position: \"absolute\",\n    width: t1,\n    height: t2,\n    transform: t3,\n    background: \"#556bfc\",\n    border: \"2px solid white\",\n    borderRadius: \"999px\",\n    zIndex: \"999999\"\n  } }), $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4) : t4 = $[3], t4;\n}, Root$2 = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  --drag-preview-opacity: 0.98;\n  --drag-preview-skeleton-stroke: #ffffff;\n\n  @media (prefers-color-scheme: dark) {\n    --drag-preview-skeleton-stroke: #383d51;\n  }\n\n  position: fixed;\n  display: grid;\n  transform: ${({\n  $scaleFactor,\n  $width,\n  $height\n}) => `translate(calc(var(--drag-preview-x) - ${$width / 2}px), calc(var(--drag-preview-y) - ${$height / 2}px)) scale(${$scaleFactor})`};\n  width: ${({\n  $width\n}) => `${$width}px`};\n  height: ${({\n  $height\n}) => `${$height}px`};\n  z-index: 9999999;\n  opacity: var(--drag-preview-opacity);\n  cursor: move;\n\n  .drag-preview-content-wrapper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    container-type: inline-size;\n  }\n\n  [data-ui='card'] {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n\n  .drag-preview-skeleton {\n    position: absolute;\n    inset: 0;\n\n    rect {\n      stroke: var(--drag-preview-skeleton-stroke);\n    }\n  }\n\n  .drag-preview-handle {\n    position: absolute;\n    top: 4cqmin;\n    left: 4cqmin;\n    width: 6cqmin;\n    fill: var(--drag-preview-handle-fill);\n  }\n`;\nfunction clamp(number, min, max) {\n  return number < min ? min : number > max ? max : number;\n}\nfunction map(number, inMin, inMax, outMin, outMax) {\n  const mapped = (number - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;\n  return clamp(mapped, outMin, outMax);\n}\nconst OverlayDragPreview = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(50), {\n    skeleton\n  } = t0, maxSkeletonWidth = Math.min(skeleton.maxWidth, window.innerWidth / 2), scaleFactor = skeleton.w > maxSkeletonWidth ? maxSkeletonWidth / skeleton.w : 1, offsetX = skeleton.offsetX * scaleFactor, offsetY = skeleton.offsetY * scaleFactor, prefersDark = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.usePrefersDark)(), theme = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.useTheme_v2)(), radius = theme.radius[~~map(skeleton.w, 0, 1920, 1, theme.radius.length - 2)];\n  let T0, T1, t1, t10, t11, t12, t13, t14, t2, t3, t4, t5, t6, t7, t8, t9;\n  if ($[0] !== offsetX || $[1] !== offsetY || $[2] !== prefersDark || $[3] !== radius || $[4] !== scaleFactor || $[5] !== skeleton.childRects || $[6] !== skeleton.h || $[7] !== skeleton.w) {\n    const imageRects = skeleton.childRects.filter(_temp$7), textRects = skeleton.childRects.filter(_temp2$4);\n    T1 = Root$2, t10 = skeleton.w, t11 = skeleton.h, t12 = offsetX, t13 = offsetY, t14 = scaleFactor, T0 = _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card, t5 = radius, t6 = 4, t7 = \"hidden\", t8 = \"transparent\", t9 = prefersDark ? \"dark\" : \"light\", t4 = \"drag-preview-content-wrapper\", t2 = \"drag-preview-skeleton\", t3 = `0 0 ${skeleton.w} ${skeleton.h}`, t1 = [...imageRects, ...textRects], $[0] = offsetX, $[1] = offsetY, $[2] = prefersDark, $[3] = radius, $[4] = scaleFactor, $[5] = skeleton.childRects, $[6] = skeleton.h, $[7] = skeleton.w, $[8] = T0, $[9] = T1, $[10] = t1, $[11] = t10, $[12] = t11, $[13] = t12, $[14] = t13, $[15] = t14, $[16] = t2, $[17] = t3, $[18] = t4, $[19] = t5, $[20] = t6, $[21] = t7, $[22] = t8, $[23] = t9;\n  } else\n    T0 = $[8], T1 = $[9], t1 = $[10], t10 = $[11], t11 = $[12], t12 = $[13], t13 = $[14], t14 = $[15], t2 = $[16], t3 = $[17], t4 = $[18], t5 = $[19], t6 = $[20], t7 = $[21], t8 = $[22], t9 = $[23];\n  let t15;\n  $[24] !== t1 || $[25] !== theme.color ? (t15 = t1.map((r_1, i) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"rect\", { x: r_1.x, y: r_1.y, width: r_1.w, height: r_1.h, fill: theme.color.skeleton.from }, i)), $[24] = t1, $[25] = theme.color, $[26] = t15) : t15 = $[26];\n  let t16;\n  $[27] !== t15 || $[28] !== t2 || $[29] !== t3 ? (t16 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"svg\", { className: t2, viewBox: t3, children: t15 }), $[27] = t15, $[28] = t2, $[29] = t3, $[30] = t16) : t16 = $[30];\n  let t17;\n  $[31] !== t16 || $[32] !== t4 ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { className: t4, children: t16 }), $[31] = t16, $[32] = t4, $[33] = t17) : t17 = $[33];\n  let t18;\n  $[34] !== T0 || $[35] !== t17 || $[36] !== t5 || $[37] !== t6 || $[38] !== t7 || $[39] !== t8 || $[40] !== t9 ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(T0, { radius: t5, shadow: t6, overflow: t7, tone: t8, scheme: t9, children: t17 }), $[34] = T0, $[35] = t17, $[36] = t5, $[37] = t6, $[38] = t7, $[39] = t8, $[40] = t9, $[41] = t18) : t18 = $[41];\n  let t19;\n  return $[42] !== T1 || $[43] !== t10 || $[44] !== t11 || $[45] !== t12 || $[46] !== t13 || $[47] !== t14 || $[48] !== t18 ? (t19 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(T1, { $width: t10, $height: t11, $offsetX: t12, $offsetY: t13, $scaleFactor: t14, children: t18 }), $[42] = T1, $[43] = t10, $[44] = t11, $[45] = t12, $[46] = t13, $[47] = t14, $[48] = t18, $[49] = t19) : t19 = $[49], t19;\n};\nfunction _temp$7(r) {\n  return r.tagName === \"IMG\";\n}\nfunction _temp2$4(r_0) {\n  return r_0.tagName !== \"IMG\";\n}\nconst Root$1 = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  position: fixed;\n  bottom: 2rem;\n  left: 2rem;\n`, OverlayMinimapPrompt = () => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(2);\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = {\n    zIndex: \"999999\"\n  }, $[0] = t0) : t0 = $[0];\n  let t1;\n  return $[1] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Root$1, { padding: 2, shadow: 2, radius: 2, style: t0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex, { align: \"center\", gap: 2, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Hotkeys, { keys: [\"Shift\"] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: \"Zoom Out\" }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ExpandIcon, {})\n  ] }) }), $[1] = t1) : t1 = $[1], t1;\n}, elementsReducer = (elements, message) => {\n  const {\n    type\n  } = message;\n  switch (type) {\n    case \"element/register\":\n      return elements.find((e) => e.id === message.id) ? elements : [...elements, {\n        id: message.id,\n        activated: !1,\n        element: message.element,\n        focused: !1,\n        hovered: !1,\n        rect: message.rect,\n        sanity: message.sanity,\n        dragDisabled: message.dragDisabled,\n        targets: message.targets,\n        elementType: message.elementType\n      }];\n    case \"element/activate\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        activated: !0\n      } : e);\n    case \"element/update\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        sanity: message.sanity,\n        rect: message.rect,\n        targets: message.targets,\n        elementType: message.elementType\n      } : e);\n    case \"element/unregister\":\n      return elements.filter((e) => e.id !== message.id);\n    case \"element/deactivate\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        activated: !1,\n        hovered: !1\n      } : e);\n    case \"element/mouseenter\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        rect: message.rect,\n        hovered: !0\n      } : {\n        ...e,\n        hovered: !1\n      });\n    case \"element/mouseleave\":\n      return elements.map((element) => element.id === message.id ? {\n        ...element,\n        hovered: !1\n      } : element);\n    case \"element/updateRect\":\n      return elements.map((element) => element.id === message.id ? {\n        ...element,\n        rect: message.rect\n      } : element);\n    case \"element/click\":\n      return elements.map((e) => ({\n        ...e,\n        focused: e.id === message.id && \"clicked\"\n      }));\n    case \"overlay/reset-mouse-state\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1,\n        hovered: !1\n      }));\n    case \"overlay/blur\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1\n      }));\n    case \"presentation/blur\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1\n      }));\n    case \"presentation/focus\": {\n      const clickedElement = elements.find((e) => e.focused === \"clicked\");\n      return elements.map((e) => {\n        const focused = \"path\" in e.sanity && e.sanity.id === message.data.id && e.sanity.path === message.data.path;\n        return clickedElement && e === clickedElement && focused ? e : {\n          ...e,\n          // Mark as a dupe if another matching item has been clicked to prevent\n          // scrolling, otherwise just set focus as a boolean\n          focused: focused && clickedElement ? \"duplicate\" : focused\n        };\n      });\n    }\n    default:\n      return elements;\n  }\n};\nfunction overlayStateReducer(state, message) {\n  const {\n    type\n  } = message;\n  let {\n    contextMenu,\n    focusPath,\n    perspective,\n    isDragging,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    dragMinimapTransition,\n    dragGroupRect\n  } = state, wasMaybeCollapsed = !1;\n  if (type === \"presentation/focus\") {\n    const prevFocusPath = state.focusPath;\n    focusPath = message.data.path, prevFocusPath !== focusPath && (wasMaybeCollapsed = prevFocusPath.slice(focusPath.length).startsWith(\"[\"));\n  }\n  return type === \"presentation/perspective\" && (perspective = message.data.perspective), type === \"element/contextmenu\" && (\"sanity\" in message ? contextMenu = {\n    node: message.sanity,\n    position: message.position\n  } : contextMenu = null), (type === \"element/click\" || type === \"element/mouseleave\" || type === \"overlay/blur\" || type === \"presentation/blur\" || type === \"presentation/focus\") && (contextMenu = null), type === \"overlay/dragUpdateInsertPosition\" && (dragInsertPosition = message.insertPosition), type === \"overlay/dragStart\" && (isDragging = !0), message.type === \"overlay/dragUpdateSkeleton\" && (dragSkeleton = message.skeleton), type === \"overlay/dragEnd\" && (isDragging = !1), message.type === \"overlay/dragToggleMinimapPrompt\" && (dragShowMinimapPrompt = message.display), type === \"overlay/dragStartMinimapTransition\" && (dragMinimapTransition = !0), type === \"overlay/dragEndMinimapTransition\" && (dragMinimapTransition = !1), type === \"overlay/dragUpdateGroupRect\" && (dragGroupRect = message.groupRect), type === \"overlay/dragToggleMinimap\" && (dragShowMinimap = message.display), {\n    ...state,\n    contextMenu,\n    elements: elementsReducer(state.elements, message),\n    dragInsertPosition,\n    dragSkeleton,\n    dragGroupRect,\n    isDragging,\n    focusPath,\n    perspective,\n    wasMaybeCollapsed,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragMinimapTransition\n  };\n}\nconst PreviewSnapshotsProvider = function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(13), {\n    comlink,\n    children\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [], $[0] = t0) : t0 = $[0];\n  const [previewSnapshots, setPreviewSnapshots] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0);\n  let t1;\n  $[1] !== comlink ? (t1 = async (signal) => {\n    if (comlink)\n      try {\n        const response = await comlink.fetch(\"visual-editing/preview-snapshots\", void 0, {\n          signal,\n          suppressWarnings: !0\n        });\n        setPreviewSnapshots(response.snapshots);\n      } catch {\n      }\n  }, $[1] = comlink, $[2] = t1) : t1 = $[2];\n  const fetchPreviewSnapshots = t1;\n  let t2, t3;\n  $[3] !== comlink || $[4] !== fetchPreviewSnapshots ? (t2 = () => {\n    if (!comlink)\n      return;\n    const previewSapshotsFetch = new AbortController(), unsub = comlink.onStatus(() => {\n      fetchPreviewSnapshots(previewSapshotsFetch.signal);\n    }, \"connected\");\n    return () => {\n      previewSapshotsFetch.abort(), unsub();\n    };\n  }, t3 = [comlink, fetchPreviewSnapshots], $[3] = comlink, $[4] = fetchPreviewSnapshots, $[5] = t2, $[6] = t3) : (t2 = $[5], t3 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3);\n  let t4, t5;\n  $[7] !== comlink ? (t4 = () => comlink?.on(\"presentation/preview-snapshots\", (data) => {\n    setPreviewSnapshots(data.snapshots);\n  }), t5 = [comlink], $[7] = comlink, $[8] = t4, $[9] = t5) : (t4 = $[8], t5 = $[9]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t4, t5);\n  let t6;\n  t6 = previewSnapshots;\n  const context = t6;\n  let t7;\n  return $[10] !== children || $[11] !== context ? (t7 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PreviewSnapshotsContext.Provider, { value: context, children }), $[10] = children, $[11] = context, $[12] = t7) : t7 = $[12], t7;\n};\nfunction isSanityNode(node) {\n  return \"path\" in node;\n}\nfunction isDocumentSchemaType(type) {\n  return type.type === \"document\";\n}\nfunction isTypeSchemaType(type) {\n  return type.type === \"type\";\n}\nfunction popUnkeyedPathSegments(path) {\n  return path.split(\".\").toReversed().reduce((acc, part) => acc.length ? [part, ...acc] : part.includes(\"[_key==\") ? [part] : [], []).join(\".\");\n}\nfunction getPathsWithUnresolvedTypes(elements) {\n  return elements.reduce((acc, element) => {\n    const {\n      sanity\n    } = element;\n    if (!(\"id\" in sanity) || !sanity.path.includes(\"[_key==\")) return acc;\n    const path = popUnkeyedPathSegments(sanity.path);\n    return acc.find((item) => item.id === sanity.id && item.path === path) || acc.push({\n      id: sanity.id,\n      path\n    }), acc;\n  }, []);\n}\nconst SchemaProvider = function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(22), {\n    comlink,\n    children,\n    elements\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = /* @__PURE__ */ new Map(), $[0] = t0) : t0 = $[0];\n  const [resolvedTypes, setResolvedTypes] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0), [schema, setSchema] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t1, t2;\n  $[1] !== comlink ? (t1 = () => {\n    if (!comlink)\n      return;\n    const fetchSchema = async function(signal) {\n      if (comlink)\n        try {\n          const response = await comlink.fetch(\"visual-editing/schema\", void 0, {\n            signal,\n            suppressWarnings: !0\n          });\n          setSchema(response.schema);\n        } catch {\n        }\n    }, schemaFetch = new AbortController(), unsub = comlink.onStatus(() => {\n      fetchSchema(schemaFetch.signal);\n    }, \"connected\");\n    return () => {\n      schemaFetch.abort(), unsub();\n    };\n  }, t2 = [comlink], $[1] = comlink, $[2] = t1, $[3] = t2) : (t1 = $[2], t2 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  let t3;\n  $[4] === Symbol.for(\"react.memo_cache_sentinel\") ? (t3 = [], $[4] = t3) : t3 = $[4];\n  const reportedPathsRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(t3), t4 = (0,react__WEBPACK_IMPORTED_MODULE_2__.useDeferredValue)(elements);\n  let t5;\n  $[5] !== t4 ? (t5 = getPathsWithUnresolvedTypes(t4), $[5] = t4, $[6] = t5) : t5 = $[6];\n  const paths = t5, controllerRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);\n  let t6, t7;\n  $[7] !== comlink || $[8] !== paths ? (t6 = () => {\n    if (!paths.length || !comlink)\n      return;\n    const reportPaths = async (paths_0, signal_0) => {\n      const initialReportedPaths = reportedPathsRef.current;\n      try {\n        reportedPathsRef.current = paths_0;\n        const response_0 = await comlink.fetch(\"visual-editing/schema-union-types\", {\n          paths: paths_0\n        }, {\n          signal: signal_0,\n          suppressWarnings: !0\n        });\n        if (signal_0.aborted)\n          return;\n        setResolvedTypes(response_0.types), controllerRef.current = null;\n      } catch {\n      }\n      signal_0.aborted && (reportedPathsRef.current = initialReportedPaths);\n    };\n    paths.some((p) => !reportedPathsRef.current.find((t82) => {\n      const {\n        id,\n        path\n      } = t82;\n      return id === p.id && path === p.path;\n    })) && (controllerRef.current?.abort(), controllerRef.current = new AbortController(), reportPaths(paths, controllerRef.current.signal));\n  }, t7 = [comlink, paths], $[7] = comlink, $[8] = paths, $[9] = t6, $[10] = t7) : (t6 = $[9], t7 = $[10]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t6, t7);\n  let t8;\n  $[11] !== schema ? (t8 = (node, _type) => {\n    const type = _type || \"document\";\n    if (!schema || typeof node != \"string\" && (!isSanityNode(node) || !Array.isArray(schema)))\n      return;\n    const name = typeof node == \"string\" ? node : node.type, filter = type === \"document\" ? isDocumentSchemaType : isTypeSchemaType;\n    return schema.filter(filter).find((schemaType) => schemaType.name === name);\n  }, $[11] = schema, $[12] = t8) : t8 = $[12];\n  const getType = t8;\n  let t9;\n  $[13] !== getType || $[14] !== resolvedTypes ? (t9 = (node_0) => {\n    if (!isSanityNode(node_0))\n      return {\n        field: void 0,\n        parent: void 0\n      };\n    const schemaType_0 = getType(node_0);\n    if (!schemaType_0)\n      return {\n        field: void 0,\n        parent: void 0\n      };\n    function fieldFromPath(schemaType_1, path_0, parent, t102) {\n      const prevPath = t102 === void 0 ? [] : t102;\n      if (!schemaType_1)\n        return {\n          field: void 0,\n          parent: void 0\n        };\n      const [next, ...rest] = path_0;\n      if (\"fields\" in schemaType_1) {\n        const objectField = schemaType_1.fields[next];\n        if (!objectField && \"rest\" in schemaType_1)\n          return fieldFromPath(schemaType_1.rest, path_0, schemaType_1, prevPath);\n        if (!rest.length)\n          return {\n            field: objectField,\n            parent\n          };\n        if (!objectField)\n          throw new Error(`[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path_0].join(\".\")}\"`);\n        return fieldFromPath(objectField.value, rest, schemaType_1, [...prevPath, next]);\n      } else {\n        if (schemaType_1.type === \"array\")\n          return fieldFromPath(schemaType_1.of, path_0, schemaType_1, prevPath);\n        if (schemaType_1.type === \"arrayItem\")\n          return rest.length ? fieldFromPath(schemaType_1.value, rest, schemaType_1, [...prevPath, next]) : {\n            field: schemaType_1,\n            parent\n          };\n        if (schemaType_1.type === \"union\") {\n          const name_0 = next.startsWith(\"[_key==\") ? resolvedTypes?.get(node_0.id)?.get([prevPath.join(\".\"), next].filter(Boolean).join(\"\")) : next;\n          return fieldFromPath(schemaType_1.of.find((item) => item.type === \"unionOption\" ? item.name === name_0 : item), rest, schemaType_1, [...prevPath, next]);\n        } else {\n          if (schemaType_1.type === \"unionOption\")\n            return next ? fieldFromPath(schemaType_1.value, path_0, schemaType_1, prevPath) : {\n              field: schemaType_1,\n              parent\n            };\n          if (schemaType_1.type === \"inline\") {\n            const type_0 = getType(schemaType_1.name, \"type\");\n            return fieldFromPath(type_0.value, path_0, schemaType_1, prevPath);\n          }\n        }\n      }\n      throw new Error(`[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path_0].join(\".\")}\"`);\n    }\n    const nodePath = node_0.path.split(\".\").flatMap(_temp$6);\n    try {\n      return fieldFromPath(schemaType_0, nodePath, void 0);\n    } catch (t112) {\n      const e = t112;\n      return e instanceof Error && console.warn(e.message), {\n        field: void 0,\n        parent: void 0\n      };\n    }\n  }, $[13] = getType, $[14] = resolvedTypes, $[15] = t9) : t9 = $[15];\n  const getField = t9;\n  let t10, t11;\n  $[16] !== getField || $[17] !== getType ? (t11 = {\n    getField,\n    getType\n  }, $[16] = getField, $[17] = getType, $[18] = t11) : t11 = $[18], t10 = t11;\n  const context = t10;\n  let t12;\n  return $[19] !== children || $[20] !== context ? (t12 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SchemaContext.Provider, { value: context, children }), $[19] = children, $[20] = context, $[21] = t12) : t12 = $[21], t12;\n};\nfunction _temp$6(part) {\n  return part.includes(\"[\") ? part.split(/(\\[.+\\])/, 2) : [part];\n}\nconst createStore = (initialState) => {\n  let state = initialState;\n  const getState = () => state, listeners = /* @__PURE__ */ new Set();\n  return {\n    getState,\n    setState: (fn) => {\n      state = fn(state), listeners.forEach((l) => l());\n    },\n    subscribe: (listener) => (listeners.add(listener), () => listeners.delete(listener))\n  };\n}, store = createStore({}), SharedStateProvider = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(11), {\n    comlink,\n    children\n  } = props;\n  let t0, t1;\n  $[0] !== comlink ? (t0 = () => comlink?.on(\"presentation/shared-state\", _temp$5), t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  let t2, t3;\n  $[3] !== comlink ? (t2 = () => {\n    (async function() {\n      const value = await comlink?.fetch(\"visual-editing/shared-state\", void 0, {\n        suppressWarnings: !0\n      });\n      value && store.setState(() => value.state);\n    })().catch(_temp2$3);\n  }, t3 = [comlink], $[3] = comlink, $[4] = t2, $[5] = t3) : (t2 = $[4], t3 = $[5]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3);\n  let t4, t5;\n  $[6] !== comlink ? (t5 = {\n    comlink,\n    store\n  }, $[6] = comlink, $[7] = t5) : t5 = $[7], t4 = t5;\n  const value_0 = t4;\n  let t6;\n  return $[8] !== children || $[9] !== value_0 ? (t6 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_14__.SharedStateContext.Provider, { value: value_0, children }), $[8] = children, $[9] = value_0, $[10] = t6) : t6 = $[10], t6;\n};\nfunction _temp$5(data) {\n  \"value\" in data ? store.setState((prev) => ({\n    ...prev,\n    [data.key]: data.value\n  })) : store.setState((prev_0) => Object.fromEntries(Object.entries(prev_0).filter((t0) => {\n    const [key] = t0;\n    return key !== data.key;\n  })));\n}\nfunction _temp2$3(reason) {\n  console.debug(reason), console.warn(\"[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date\");\n}\nconst TelemetryProvider = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5), {\n    children,\n    comlink\n  } = t0;\n  let t1;\n  $[0] !== comlink ? (t1 = (name, data) => {\n    if (!comlink)\n      return;\n    const event = _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.events[name];\n    if (event)\n      comlink.post(\"visual-editing/telemetry-log\", {\n        event,\n        data\n      });\n    else\n      throw new Error(`Telemetry event: ${name} does not exist`);\n  }, $[0] = comlink, $[1] = t1) : t1 = $[1];\n  const log = t1;\n  let t2;\n  return $[2] !== children || $[3] !== log ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.TelemetryContext.Provider, { value: log, children }), $[2] = children, $[3] = log, $[4] = t2) : t2 = $[4], t2;\n};\nfunction useController(element, handler, inFrame, inPopUp) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(7), overlayController = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0), optimisticActorReady = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActorReady)();\n  let t0, t1;\n  return $[0] !== element || $[1] !== handler || $[2] !== inFrame || $[3] !== inPopUp || $[4] !== optimisticActorReady ? (t0 = () => {\n    if (element)\n      return overlayController.current = (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_14__.createOverlayController)({\n        handler,\n        overlayElement: element,\n        inFrame,\n        inPopUp,\n        optimisticActorReady\n      }), () => {\n        overlayController.current?.destroy(), overlayController.current = void 0;\n      };\n  }, t1 = [element, handler, inFrame, inPopUp, optimisticActorReady], $[0] = element, $[1] = handler, $[2] = inFrame, $[3] = inPopUp, $[4] = optimisticActorReady, $[5] = t0, $[6] = t1) : (t0 = $[5], t1 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), overlayController;\n}\nfunction usePerspectiveSync(comlink, dispatch) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4);\n  let t0, t1;\n  $[0] !== comlink || $[1] !== dispatch ? (t0 = () => {\n    const controller = new AbortController();\n    comlink?.fetch(\"visual-editing/fetch-perspective\", void 0, {\n      signal: controller.signal,\n      suppressWarnings: !0\n    }).then((data) => {\n      dispatch({\n        type: \"presentation/perspective\",\n        data\n      });\n    }).catch(_temp$4);\n    const unsub = comlink?.on(\"presentation/perspective\", (data_0) => {\n      dispatch({\n        type: \"presentation/perspective\",\n        data: data_0\n      });\n    });\n    return () => {\n      unsub?.(), controller.abort();\n    };\n  }, t1 = [comlink, dispatch], $[0] = comlink, $[1] = dispatch, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n}\nfunction _temp$4() {\n}\nfunction isEqualSets(a, b) {\n  if (a === b) return !0;\n  if (a.size !== b.size) return !1;\n  for (const value of a) if (!b.has(value)) return !1;\n  return !0;\n}\nfunction useReportDocuments(comlink, elements, perspective) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(7), lastReported = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0);\n  let t0;\n  $[0] !== comlink ? (t0 = (documents, perspective_0) => {\n    comlink?.post(\"visual-editing/documents\", {\n      documents,\n      perspective: perspective_0\n    });\n  }, $[0] = comlink, $[1] = t0) : t0 = $[1];\n  const reportDocuments = t0;\n  let t1, t2;\n  $[2] !== elements || $[3] !== perspective || $[4] !== reportDocuments ? (t1 = () => {\n    const nodes = elements.map(_temp$3).filter(_temp2$2), nodeIds = new Set(nodes.map(_temp3$1));\n    if (!lastReported.current || !isEqualSets(nodeIds, lastReported.current.nodeIds) || perspective !== lastReported.current.perspective) {\n      const documentsOnPage = Array.from(nodeIds).map((_id) => {\n        const node_0 = nodes.find((node) => node.id === _id), {\n          type,\n          projectId: _projectId,\n          dataset: _dataset\n        } = node_0;\n        return _projectId && _dataset ? {\n          _id,\n          _type: type,\n          _projectId,\n          _dataset\n        } : {\n          _id,\n          _type: type\n        };\n      });\n      lastReported.current = {\n        nodeIds,\n        perspective\n      }, reportDocuments(documentsOnPage, perspective);\n    }\n  }, t2 = [elements, perspective, reportDocuments], $[2] = elements, $[3] = perspective, $[4] = reportDocuments, $[5] = t1, $[6] = t2) : (t1 = $[5], t2 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n}\nfunction _temp3$1(e_0) {\n  return e_0.id;\n}\nfunction _temp2$2(s) {\n  return !!s;\n}\nfunction _temp$3(e) {\n  const {\n    sanity\n  } = e;\n  return !sanity || !(\"id\" in sanity) ? null : sanity;\n}\nconst Root = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  background-color: transparent;\n  direction: ltr;\n  inset: 0;\n  pointer-events: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: ${({\n  $zIndex\n}) => $zIndex ?? \"9999999\"};\n`;\nfunction raf2(fn) {\n  let r0, r1;\n  return r0 = requestAnimationFrame(() => {\n    r1 = requestAnimationFrame(fn);\n  }), () => {\n    r0 !== void 0 && cancelAnimationFrame(r0), r1 !== void 0 && cancelAnimationFrame(r1);\n  };\n}\nconst DocumentReporter = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(8), {\n    documentIds\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [], $[0] = t0) : t0 = $[0];\n  const [uniqueIds, setUniqueIds] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0);\n  let t1, t2;\n  $[1] !== documentIds ? (t1 = () => {\n    setUniqueIds((prev) => {\n      const next = Array.from(new Set(documentIds));\n      return prev.length === next.length && prev.reduce(_temp$2, next)?.length === 0 ? prev : next;\n    });\n  }, t2 = [documentIds], $[1] = documentIds, $[2] = t1, $[3] = t2) : (t1 = $[2], t2 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  const actor = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActor)();\n  let t3, t4;\n  return $[4] !== actor || $[5] !== uniqueIds ? (t3 = () => {\n    for (const id_0 of uniqueIds)\n      actor.send({\n        type: \"observe\",\n        documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getDraftId)(id_0)\n      }), actor.send({\n        type: \"observe\",\n        documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getPublishedId)(id_0)\n      });\n    return () => {\n      for (const id_1 of uniqueIds)\n        actor.send({\n          type: \"unobserve\",\n          documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getDraftId)(id_1)\n        }), actor.send({\n          type: \"unobserve\",\n          documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getPublishedId)(id_1)\n        });\n    };\n  }, t4 = [actor, uniqueIds], $[4] = actor, $[5] = uniqueIds, $[6] = t3, $[7] = t4) : (t3 = $[6], t4 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4), null;\n}, OverlaysController = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(12), {\n    comlink,\n    dispatch,\n    inFrame,\n    inPopUp,\n    onDrag,\n    overlayEnabled,\n    rootElement\n  } = props, {\n    dispatchDragEndEvent\n  } = useDragEndEvents(), sendTelemetry = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.useTelemetry)();\n  let t0;\n  $[0] !== comlink || $[1] !== dispatch || $[2] !== dispatchDragEndEvent || $[3] !== onDrag || $[4] !== sendTelemetry ? (t0 = (message) => {\n    if (message.type === \"element/click\") {\n      const {\n        sanity\n      } = message;\n      comlink?.post(\"visual-editing/focus\", sanity), sendTelemetry(\"Visual Editing Overlay Clicked\", null);\n    } else if (message.type === \"overlay/activate\")\n      comlink?.post(\"visual-editing/toggle\", {\n        enabled: !0\n      });\n    else if (message.type === \"overlay/deactivate\")\n      comlink?.post(\"visual-editing/toggle\", {\n        enabled: !1\n      });\n    else if (message.type === \"overlay/dragEnd\") {\n      const {\n        insertPosition,\n        target,\n        dragGroup,\n        flow,\n        preventInsertDefault\n      } = message;\n      dispatchDragEndEvent({\n        insertPosition,\n        target,\n        dragGroup,\n        flow,\n        preventInsertDefault\n      }), insertPosition && sendTelemetry(\"Visual Editing Drag Sequence Completed\", null);\n    } else if (message.type === \"overlay/dragUpdateCursorPosition\") {\n      onDrag(message.x, message.y);\n      return;\n    } else if (message.type === \"overlay/dragToggleMinimap\" && message.display === !0)\n      sendTelemetry(\"Visual Editing Drag Minimap Enabled\", null);\n    else if (message.type === \"overlay/setCursor\") {\n      const {\n        element,\n        cursor\n      } = message;\n      cursor ? element.style.cursor = cursor : element.style.removeProperty(\"cursor\");\n    }\n    dispatch(message);\n  }, $[0] = comlink, $[1] = dispatch, $[2] = dispatchDragEndEvent, $[3] = onDrag, $[4] = sendTelemetry, $[5] = t0) : t0 = $[5];\n  const controller = useController(rootElement, t0, inFrame, inPopUp);\n  let t1;\n  $[6] !== controller.current || $[7] !== overlayEnabled ? (t1 = () => {\n    overlayEnabled ? controller.current?.activate() : controller.current?.deactivate();\n  }, $[6] = controller.current, $[7] = overlayEnabled, $[8] = t1) : t1 = $[8];\n  let t2;\n  return $[9] !== controller || $[10] !== overlayEnabled ? (t2 = [controller, overlayEnabled], $[9] = controller, $[10] = overlayEnabled, $[11] = t2) : t2 = $[11], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2), null;\n}, Overlays = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(76), {\n    comlink,\n    comlinkStatus,\n    componentResolver: _componentResolver,\n    inFrame,\n    inPopUp,\n    zIndex\n  } = props, prefersDark = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.usePrefersDark)();\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = {\n    contextMenu: null,\n    dragInsertPosition: null,\n    dragShowMinimap: !1,\n    dragShowMinimapPrompt: !1,\n    dragSkeleton: null,\n    elements: [],\n    focusPath: \"\",\n    isDragging: !1,\n    perspective: \"published\",\n    wasMaybeCollapsed: !1,\n    dragMinimapTransition: !1,\n    dragGroupRect: null\n  }, $[0] = t0) : t0 = $[0];\n  const [t1, dispatch] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useReducer)(overlayStateReducer, t0), {\n    contextMenu,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    elements,\n    isDragging,\n    perspective,\n    wasMaybeCollapsed,\n    dragMinimapTransition,\n    dragGroupRect\n  } = t1, [rootElement, setRootElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), [overlayEnabled, setOverlayEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0);\n  let t2, t3;\n  $[1] !== comlink ? (t2 = () => {\n    const unsubs = [comlink?.on(\"presentation/focus\", (data) => {\n      dispatch({\n        type: \"presentation/focus\",\n        data\n      });\n    }), comlink?.on(\"presentation/blur\", (data_0) => {\n      dispatch({\n        type: \"presentation/blur\",\n        data: data_0\n      });\n    }), comlink?.on(\"presentation/toggle-overlay\", () => {\n      setOverlayEnabled(_temp2$1);\n    })].filter(Boolean);\n    return () => unsubs.forEach(_temp3);\n  }, t3 = [comlink], $[1] = comlink, $[2] = t2, $[3] = t3) : (t2 = $[2], t3 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3), usePerspectiveSync(comlink, dispatch), useReportDocuments(comlink, elements, perspective);\n  let t4;\n  $[4] !== rootElement ? (t4 = (x, y) => {\n    rootElement && (rootElement.style.setProperty(\"--drag-preview-x\", `${x}px`), rootElement.style.setProperty(\"--drag-preview-y\", `${y - window.scrollY}px`));\n  }, $[4] = rootElement, $[5] = t4) : t4 = $[5];\n  const updateDragPreviewCustomProps = t4;\n  let t5, t6;\n  $[6] === Symbol.for(\"react.memo_cache_sentinel\") ? (t5 = () => {\n    const handleClick = _temp4, handleKeyUp = (e) => {\n      isAltKey(e) && setOverlayEnabled(_temp5);\n    }, handleKeydown = (e_0) => {\n      isAltKey(e_0) && setOverlayEnabled(_temp6), isHotkey([\"mod\", \"\\\\\"], e_0) && setOverlayEnabled(_temp7);\n    };\n    return window.addEventListener(\"click\", handleClick), window.addEventListener(\"keydown\", handleKeydown), window.addEventListener(\"keyup\", handleKeyUp), () => {\n      window.removeEventListener(\"click\", handleClick), window.removeEventListener(\"keydown\", handleKeydown), window.removeEventListener(\"keyup\", handleKeyUp);\n    };\n  }, t6 = [setOverlayEnabled], $[6] = t5, $[7] = t6) : (t5 = $[6], t6 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t5, t6);\n  const [overlaysFlash, setOverlaysFlash] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1), [fadingOut, setFadingOut] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1), fadeOutTimeoutRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0);\n  let t7, t8;\n  $[8] !== overlayEnabled ? (t7 = () => {\n    if (overlayEnabled)\n      return raf2(() => {\n        setOverlaysFlash(!0), raf2(() => {\n          setFadingOut(!0), fadeOutTimeoutRef.current = setTimeout(() => {\n            setFadingOut(!1), setOverlaysFlash(!1);\n          }, 1500);\n        });\n      });\n    fadeOutTimeoutRef.current && (clearTimeout(fadeOutTimeoutRef.current), setOverlaysFlash(!1), setFadingOut(!1));\n  }, t8 = [overlayEnabled], $[8] = overlayEnabled, $[9] = t7, $[10] = t8) : (t7 = $[9], t8 = $[10]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t7, t8);\n  let t9, t10;\n  $[11] !== elements ? (t10 = elements.flatMap(_temp8), $[11] = elements, $[12] = t10) : t10 = $[12], t9 = t10;\n  const documentIds = t9;\n  let t11;\n  $[13] === Symbol.for(\"react.memo_cache_sentinel\") ? (t11 = () => {\n    dispatch({\n      type: \"overlay/blur\"\n    });\n  }, $[13] = t11) : t11 = $[13];\n  const closeContextMenu = t11, optimisticActorReady = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActorReady)();\n  let t12;\n  t12 = optimisticActorReady ? _componentResolver : void 0;\n  const componentResolver = t12;\n  let t13;\n  bb0: {\n    if ((inFrame || inPopUp) && comlinkStatus !== \"connected\" || isDragging) {\n      let t143;\n      $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t143 = [], $[14] = t143) : t143 = $[14], t13 = t143;\n      break bb0;\n    }\n    let t142;\n    $[15] !== comlink || $[16] !== componentResolver || $[17] !== dragMinimapTransition || $[18] !== dragShowMinimap || $[19] !== elements || $[20] !== inFrame || $[21] !== isDragging || $[22] !== optimisticActorReady || $[23] !== props.plugins || $[24] !== wasMaybeCollapsed ? (t142 = elements.filter(_temp9).map((t152) => {\n      const {\n        id,\n        element: element_0,\n        focused,\n        hovered,\n        rect,\n        sanity,\n        dragDisabled,\n        targets,\n        elementType\n      } = t152, draggable = !dragDisabled && !!element_0.getAttribute(\"data-sanity\") && optimisticActorReady && elements.some((e_2) => \"id\" in e_2.sanity && \"id\" in sanity ? (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_14__.sanityNodesExistInSameArray)(e_2.sanity, sanity) && e_2.sanity.path !== sanity.path : !1);\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ElementOverlay, { comlink, componentResolver, plugins: props.plugins, element: element_0, enableScrollIntoView: !isDragging && !dragMinimapTransition && !dragShowMinimap, id, focused, hovered, node: sanity, rect, showActions: !inFrame, draggable, isDragging: isDragging || dragMinimapTransition, wasMaybeCollapsed: focused && wasMaybeCollapsed, targets, elementType }, id);\n    }), $[15] = comlink, $[16] = componentResolver, $[17] = dragMinimapTransition, $[18] = dragShowMinimap, $[19] = elements, $[20] = inFrame, $[21] = isDragging, $[22] = optimisticActorReady, $[23] = props.plugins, $[24] = wasMaybeCollapsed, $[25] = t142) : t142 = $[25], t13 = t142;\n  }\n  const elementsToRender = t13, t14 = prefersDark ? \"dark\" : \"light\", t15 = fadingOut ? \"\" : void 0, t16 = overlaysFlash ? \"\" : void 0;\n  let t17;\n  $[26] !== documentIds || $[27] !== perspective ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(DocumentReporter, { documentIds, perspective }), $[26] = documentIds, $[27] = perspective, $[28] = t17) : t17 = $[28];\n  let t18;\n  $[29] !== comlink || $[30] !== inFrame || $[31] !== inPopUp || $[32] !== overlayEnabled || $[33] !== rootElement || $[34] !== updateDragPreviewCustomProps ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlaysController, { comlink, dispatch, inFrame, inPopUp, onDrag: updateDragPreviewCustomProps, overlayEnabled, rootElement }), $[29] = comlink, $[30] = inFrame, $[31] = inPopUp, $[32] = overlayEnabled, $[33] = rootElement, $[34] = updateDragPreviewCustomProps, $[35] = t18) : t18 = $[35];\n  let t19;\n  $[36] !== contextMenu ? (t19 = contextMenu && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenu, { ...contextMenu, onDismiss: closeContextMenu }), $[36] = contextMenu, $[37] = t19) : t19 = $[37];\n  let t20;\n  $[38] !== dragGroupRect || $[39] !== dragInsertPosition || $[40] !== dragMinimapTransition || $[41] !== dragShowMinimapPrompt || $[42] !== isDragging ? (t20 = isDragging && !dragMinimapTransition && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    dragInsertPosition && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragInsertMarker, { dragInsertPosition }),\n    dragShowMinimapPrompt && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayMinimapPrompt, {}),\n    dragGroupRect && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragGroupRect, { dragGroupRect })\n  ] }), $[38] = dragGroupRect, $[39] = dragInsertPosition, $[40] = dragMinimapTransition, $[41] = dragShowMinimapPrompt, $[42] = isDragging, $[43] = t20) : t20 = $[43];\n  let t21;\n  $[44] !== dragSkeleton || $[45] !== isDragging ? (t21 = isDragging && dragSkeleton && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragPreview, { skeleton: dragSkeleton }), $[44] = dragSkeleton, $[45] = isDragging, $[46] = t21) : t21 = $[46];\n  let t22;\n  $[47] !== elementsToRender || $[48] !== t15 || $[49] !== t16 || $[50] !== t17 || $[51] !== t18 || $[52] !== t19 || $[53] !== t20 || $[54] !== t21 || $[55] !== zIndex ? (t22 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Root, { \"data-fading-out\": t15, \"data-overlays\": t16, ref: setRootElement, $zIndex: zIndex, children: [\n    t17,\n    t18,\n    t19,\n    elementsToRender,\n    t20,\n    t21\n  ] }), $[47] = elementsToRender, $[48] = t15, $[49] = t16, $[50] = t17, $[51] = t18, $[52] = t19, $[53] = t20, $[54] = t21, $[55] = zIndex, $[56] = t22) : t22 = $[56];\n  let t23;\n  $[57] !== comlink || $[58] !== t22 ? (t23 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SharedStateProvider, { comlink, children: t22 }), $[57] = comlink, $[58] = t22, $[59] = t23) : t23 = $[59];\n  let t24;\n  $[60] !== comlink || $[61] !== t23 ? (t24 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PreviewSnapshotsProvider, { comlink, children: t23 }), $[60] = comlink, $[61] = t23, $[62] = t24) : t24 = $[62];\n  let t25;\n  $[63] !== comlink || $[64] !== elements || $[65] !== t24 ? (t25 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SchemaProvider, { comlink, elements, children: t24 }), $[63] = comlink, $[64] = elements, $[65] = t24, $[66] = t25) : t25 = $[66];\n  let t26;\n  $[67] !== rootElement || $[68] !== t25 ? (t26 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.LayerProvider, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.PortalProvider, { element: rootElement, children: t25 }) }), $[67] = rootElement, $[68] = t25, $[69] = t26) : t26 = $[69];\n  let t27;\n  $[70] !== t14 || $[71] !== t26 ? (t27 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.ThemeProvider, { scheme: t14, theme: _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.studioTheme, tone: \"transparent\", children: t26 }), $[70] = t14, $[71] = t26, $[72] = t27) : t27 = $[72];\n  let t28;\n  return $[73] !== comlink || $[74] !== t27 ? (t28 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TelemetryProvider, { comlink, children: t27 }), $[73] = comlink, $[74] = t27, $[75] = t28) : t28 = $[75], t28;\n}, IS_MAC = typeof window < \"u\" && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform), MODIFIERS = {\n  alt: \"altKey\",\n  ctrl: \"ctrlKey\",\n  mod: IS_MAC ? \"metaKey\" : \"ctrlKey\",\n  shift: \"shiftKey\"\n};\nfunction isHotkey(keys, event) {\n  return keys.every((key) => MODIFIERS[key] ? event[MODIFIERS[key]] : event.key === key.toUpperCase());\n}\nfunction isAltKey(event) {\n  return event.key === \"Alt\";\n}\nfunction _temp$2(acc, prevId) {\n  return acc.filter((id) => id !== prevId);\n}\nfunction _temp2$1(enabled) {\n  return !enabled;\n}\nfunction _temp3(unsub) {\n  return unsub();\n}\nfunction _temp4(event) {\n  const target = event.target;\n  if (((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.isHTMLAnchorElement)(target) || (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.isHTMLElement)(target) && target.closest(\"a\")) && event.altKey) {\n    event.preventDefault(), event.stopPropagation();\n    const newEvent = new MouseEvent(event.type, {\n      ...event,\n      altKey: !1,\n      bubbles: !0,\n      cancelable: !0\n    });\n    event.target?.dispatchEvent(newEvent);\n  }\n}\nfunction _temp5(enabled_0) {\n  return !enabled_0;\n}\nfunction _temp6(enabled_1) {\n  return !enabled_1;\n}\nfunction _temp7(enabled_2) {\n  return !enabled_2;\n}\nfunction _temp8(element) {\n  return \"id\" in element.sanity ? [element.sanity.id] : [];\n}\nfunction _temp9(e_1) {\n  return e_1.activated || e_1.focused;\n}\nconst Refresh = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    comlink,\n    refresh\n  } = props, manualRefreshRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(0), mutationRefreshRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(0);\n  let t0, t1;\n  return $[0] !== comlink || $[1] !== refresh ? (t0 = () => comlink.on(\"presentation/refresh\", (data) => {\n    if (data.source === \"manual\") {\n      clearTimeout(manualRefreshRef.current);\n      const promise = refresh(data);\n      if (promise === !1)\n        return;\n      comlink.post(\"visual-editing/refreshing\", data);\n      let timedOut = !1;\n      manualRefreshRef.current = window.setTimeout(() => {\n        comlink.post(\"visual-editing/refreshed\", data), timedOut = !0;\n      }, 3e3), promise?.finally?.(() => {\n        timedOut || (clearTimeout(manualRefreshRef.current), comlink.post(\"visual-editing/refreshed\", data));\n      });\n    } else if (data.source === \"mutation\") {\n      clearTimeout(mutationRefreshRef.current);\n      const promise_0 = refresh(data);\n      if (promise_0 === !1)\n        return;\n      comlink.post(\"visual-editing/refreshing\", data), mutationRefreshRef.current = window.setTimeout(() => {\n        const promise_1 = refresh(data);\n        promise_1 !== !1 && (comlink.post(\"visual-editing/refreshing\", data), promise_1?.finally?.(() => {\n          comlink.post(\"visual-editing/refreshed\", data);\n        }) || comlink.post(\"visual-editing/refreshed\", data));\n      }, 1e3), promise_0?.finally?.(() => {\n        comlink.post(\"visual-editing/refreshed\", data);\n      }) || comlink.post(\"visual-editing/refreshed\", data);\n    }\n  }), t1 = [comlink, refresh], $[0] = comlink, $[1] = refresh, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), null;\n};\nfunction useComlink(t0) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(9), active = t0 === void 0 ? !0 : t0, [node, setNode] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(), [status, setStatus] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(\"idle\");\n  let t1, t2;\n  $[0] !== active ? (t1 = () => {\n    if (!active)\n      return;\n    const instance = (0,_sanity_comlink__WEBPACK_IMPORTED_MODULE_15__.createNode)({\n      name: \"visual-editing\",\n      connectTo: \"presentation\"\n    }, (0,_sanity_comlink__WEBPACK_IMPORTED_MODULE_15__.createNodeMachine)().provide({\n      actors: (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_16__.createCompatibilityActors)()\n    })), unsub = instance.onStatus(() => setStatus(\"connected\"), \"connected\");\n    setNode(instance);\n    const stop = instance.start();\n    return () => {\n      unsub(), stop(), setNode(void 0);\n    };\n  }, t2 = [active], $[0] = active, $[1] = t1, $[2] = t2) : (t1 = $[1], t2 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  let t3, t4;\n  $[3] !== status ? (t3 = () => {\n    if (status === \"connected\")\n      return;\n    const controller = new AbortController();\n    return window.addEventListener(\"message\", _temp$1, {\n      signal: controller.signal\n    }), () => {\n      controller.abort();\n    };\n  }, t4 = [status], $[3] = status, $[4] = t3, $[5] = t4) : (t3 = $[4], t4 = $[5]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  let t5;\n  return $[6] !== node || $[7] !== status ? (t5 = [node, status], $[6] = node, $[7] = status, $[8] = t5) : t5 = $[8], t5;\n}\nfunction _temp$1(t0) {\n  const {\n    data,\n    origin\n  } = t0;\n  data && typeof data == \"object\" && \"domain\" in data && data.domain === \"sanity/channels\" && \"from\" in data && data.from === \"presentation\" && \"type\" in data && data.type === \"presentation/status\" && window.parent.postMessage({\n    domain: \"sanity/channels\",\n    type: \"visual-editing/status\",\n    data: {\n      origin: location.origin\n    }\n  }, origin);\n}\nfunction createSharedListener(comlink) {\n  const incomingConnection$ = new rxjs__WEBPACK_IMPORTED_MODULE_17__.ReplaySubject(1), incomingMutations$ = new rxjs__WEBPACK_IMPORTED_MODULE_18__.Subject();\n  return comlink.fetch(\"visual-editing/snapshot-welcome\", void 0, {\n    suppressWarnings: !0\n  }).then((data) => {\n    incomingConnection$.next(data.event);\n  }).catch(() => {\n  }), comlink.on(\"presentation/snapshot-event\", (data) => {\n    data.event.type === \"reconnect\" && incomingConnection$.next(data.event), data.event.type === \"mutation\" && incomingMutations$.next(data.event);\n  }), (0,rxjs__WEBPACK_IMPORTED_MODULE_19__.merge)(incomingConnection$, incomingMutations$);\n}\nfunction useDatasetMutator(comlink) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(3);\n  let t0, t1;\n  $[0] !== comlink ? (t0 = () => {\n    if (!comlink)\n      return;\n    const listener = createSharedListener(comlink), datasetMutator = (0,_optimistic_index_js__WEBPACK_IMPORTED_MODULE_20__.createDatasetMutator)(comlink), mutator = (0,xstate__WEBPACK_IMPORTED_MODULE_21__.c)(datasetMutator, {\n      input: {\n        client: {\n          withConfig: _temp\n        },\n        sharedListener: listener\n      }\n    });\n    mutator.start();\n    const featuresFetch = new AbortController();\n    return comlink.fetch(\"visual-editing/features\", void 0, {\n      signal: featuresFetch.signal,\n      suppressWarnings: !0\n    }).then((data) => {\n      data.features.optimistic && (0,_chunks_es_context_js__WEBPACK_IMPORTED_MODULE_22__.setActor)(mutator);\n    }).catch(_temp2), () => {\n      mutator.stop(), featuresFetch.abort();\n    };\n  }, t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n}\nfunction _temp2() {\n  console.warn(\"[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.\");\n}\nfunction _temp() {\n}\nconst VisualEditing = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(23), {\n    components,\n    plugins,\n    history,\n    portal: t0,\n    refresh,\n    zIndex\n  } = props, portal = t0 === void 0 ? !0 : t0, [inFrame, setInFrame] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), [inPopUp, setInPopUp] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t1, t2;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = () => {\n    setInFrame((0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_16__.isMaybePreviewIframe)()), setInPopUp((0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_16__.isMaybePreviewWindow)());\n  }, t2 = [], $[0] = t1, $[1] = t2) : (t1 = $[0], t2 = $[1]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  const [portalElement, setPortalElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t3, t4;\n  $[2] !== portal ? (t3 = () => {\n    if (portal === !1)\n      return;\n    const node = document.createElement(\"sanity-visual-editing\");\n    return document.documentElement.appendChild(node), setPortalElement(node), () => {\n      setPortalElement(null), document.documentElement.contains(node) && document.documentElement.removeChild(node);\n    };\n  }, t4 = [portal], $[2] = portal, $[3] = t3, $[4] = t4) : (t3 = $[3], t4 = $[4]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  const [comlink, comlinkStatus] = useComlink(inFrame === !0 || inPopUp === !0);\n  useDatasetMutator(comlinkStatus === \"connected\" ? comlink : void 0);\n  let t5;\n  $[5] !== comlink || $[6] !== comlinkStatus || $[7] !== components || $[8] !== inFrame || $[9] !== inPopUp || $[10] !== plugins || $[11] !== zIndex ? (t5 = inFrame !== null && inPopUp !== null && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Overlays, { comlink, comlinkStatus, componentResolver: components, plugins, inFrame, inPopUp, zIndex }), $[5] = comlink, $[6] = comlinkStatus, $[7] = components, $[8] = inFrame, $[9] = inPopUp, $[10] = plugins, $[11] = zIndex, $[12] = t5) : t5 = $[12];\n  let t6;\n  $[13] !== comlink || $[14] !== history || $[15] !== refresh ? (t6 = comlink && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(History, { comlink, history }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Meta, { comlink }),\n    refresh && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Refresh, { comlink, refresh })\n  ] }), $[13] = comlink, $[14] = history, $[15] = refresh, $[16] = t6) : t6 = $[16];\n  let t7;\n  $[17] !== t5 || $[18] !== t6 ? (t7 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t5,\n    t6\n  ] }), $[17] = t5, $[18] = t6, $[19] = t7) : t7 = $[19];\n  const children = t7;\n  if (portal === !1 || !portalElement)\n    return children;\n  let t8;\n  return $[20] !== children || $[21] !== portalElement ? (t8 = (0,react_dom__WEBPACK_IMPORTED_MODULE_3__.createPortal)(children, portalElement), $[20] = children, $[21] = portalElement, $[22] = t8) : t8 = $[22], t8;\n};\nVisualEditing.displayName = \"VisualEditing\";\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9yZWFjdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXdEO0FBQ2I7QUFDMEU7QUFDbUU7QUFDL0k7QUFDa0Q7QUFDc0w7QUFDdE87QUFDNEw7QUFDcEc7QUFDL0Q7QUFDaEI7QUFDOEc7QUFDaUU7QUFDN0o7QUFDVDtBQUNJO0FBQ1Q7QUFDUTtBQUMzQjtBQUNlO0FBQ0U7QUFDRDtBQUNTO0FBQ0M7QUFDL0Q7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHLDRHQUE0RyxnREFBUztBQUN4SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEdBQUcsMkdBQTJHLGdEQUFTO0FBQ3ZILENBQUM7QUFDRCxZQUFZLHlEQUFDO0FBQ2I7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHLGtGQUFrRixnREFBUztBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSSxFQUFFLHFFQUFZO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVLEVBQUUscUZBQTRCO0FBQ3hDO0FBQ0E7QUFDQSxVQUFVLEVBQUUscUZBQTRCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0RBQXNELDREQUFHO0FBQ3JFLG1DQUFtQyxrREFBRSxZQUFZLHNEQUFNO0FBQ3ZEO0FBQ0EsV0FBVyxJQUFJLGtEQUFFLFlBQVksc0RBQU07QUFDbkM7QUFDQSxXQUFXLE9BQU8sa0RBQUUsWUFBWSxzREFBTSxnQkFBZ0Isa0RBQUUsWUFBWSxzREFBTTtBQUMxRSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsMEZBQTBGLGdEQUFTO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHNCQUFzQixvREFBYTtBQUNuQztBQUNBLGtCQUFrQixpREFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxLQUFLLDhFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsOEVBQXFCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLEtBQUssaUZBQXdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbURBQVE7QUFDbEI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUscURBQVU7QUFDcEI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsOEhBQThILDRFQUFtQix5QkFBeUIsNEVBQW1CLHFCQUFxQiw0RUFBbUIsc0JBQXNCLDRFQUFtQjtBQUM5UTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHNEQUFXO0FBQ3JCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFVBQVUsc0RBQVc7QUFDckI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsVUFBVSx3REFBYTtBQUN2QjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxVQUFVLHdEQUFhO0FBQ3ZCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFVBQVUsbURBQVE7QUFDbEI7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMERBQWU7QUFDekI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsVUFBVSwwREFBZTtBQUN6QjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Qsc0RBQUcsQ0FBQyxtRUFBVSxJQUFJLHdCQUF3QjtBQUN6RztBQUNBLCtFQUErRSxzREFBRyxDQUFDLGdFQUFTLElBQUksbUJBQW1CLDBEQUFlLGdFQUFnRTtBQUNsTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8scUJBQXFCLHNEQUFHLHNCQUFzQjtBQUNyRDtBQUNBLE9BQU8sa0NBQWtDO0FBQ3pDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8scUJBQXFCLHNEQUFHLHNCQUFzQjtBQUNyRDtBQUNBLE9BQU8sa0NBQWtDO0FBQ3pDLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwREFBZTtBQUMzQjtBQUNBO0FBQ0EsY0FBYyx3RUFBVztBQUN6QjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZLDBEQUFlO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0VBQVc7QUFDekI7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsSUFBSSx5QkFBeUIseUVBQVk7QUFDekM7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLG9GQUFvRixzREFBRyxDQUFDLGtFQUFXLElBQUk7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5SUFBeUksc0RBQUcsQ0FBQywrREFBUSxJQUFJLG9IQUFvSDtBQUM3UTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUdBQXFHLHNEQUFHLG9CQUFvQix3Q0FBd0M7QUFDcEssTUFBTTtBQUNOO0FBQ0E7QUFDQSwrRkFBK0Ysc0RBQUcsQ0FBQyxnRUFBUyxJQUFJLGtGQUFrRjtBQUNsTTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLCtHQUErRyxzREFBRyxjQUFjLGdDQUFnQztBQUNoSztBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUksOENBQThDLCtDQUFRO0FBQzFEO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSSxFQUFFLHFFQUFZO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLHdDQUF3QywrQ0FBUTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMLEdBQUcseUpBQXlKLGdEQUFTO0FBQ3JLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLDBCQUEwQix3RUFBVztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsNkRBQTZELHNEQUFHLENBQUMsMERBQUcsSUFBSSxnREFBZ0Qsc0RBQUcsQ0FBQywyREFBSSxJQUFJLHlCQUF5QixvQkFBb0Isc0RBQUcsQ0FBQyw4REFBTyxJQUFJLFNBQVMsR0FBRztBQUM1TTtBQUNBO0FBQ0EseUNBQXlDLHNEQUFHLENBQUMsNERBQUssSUFBSSw2Q0FBNkMsc0RBQUcsQ0FBQywyREFBSSxJQUFJLDRDQUE0QyxHQUFHO0FBQzlKO0FBQ0EsMERBQTBELHVEQUFJLENBQUMsMkRBQUksSUFBSTtBQUN2RTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0dBQXdHLHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUN6SCxvQkFBb0Isc0RBQUcsQ0FBQyxrRUFBVyxJQUFJO0FBQ3ZDLDJDQUEyQyxzREFBRyxvQkFBb0Isd0NBQXdDO0FBQzFHLEtBQUs7QUFDTDtBQUNBLDBEQUEwRCx1REFBSSxDQUFDLDJEQUFJLElBQUk7QUFDdkU7QUFDQTtBQUNBLEtBQUs7QUFDTCxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLDBEQUEwRCxzREFBRyxVQUFVLFlBQVk7QUFDbkY7QUFDQSxtR0FBbUcsc0RBQUcsQ0FBQyw4REFBTyxJQUFJLGdLQUFnSztBQUNsUjtBQUNBLHVFQUF1RSxzREFBRyxDQUFDLHNFQUFhLElBQUksOENBQThDO0FBQzFJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixjQUFjLEVBQUUsZ0JBQWdCLEVBQUUsY0FBYyxHQUFHLGNBQWMsRUFBRSxZQUFZO0FBQy9GO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLG9EQUFhO0FBQzdDO0FBQ0Esa0JBQWtCLGlEQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELHFEQUFjLHNCQUFzQix5REFBTSxDQUFDLCtEQUFJO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLGFBQWEseURBQU0sQ0FBQywrREFBSTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMseURBQU0sQ0FBQywrREFBSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHlEQUFNLENBQUMsK0RBQUk7QUFDNUI7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUyx5REFBTSxDQUFDLCtEQUFJO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlEQUFNLENBQUMsK0RBQUk7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFNLENBQUMsK0RBQUk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIscURBQU07QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLFNBQVMsa0VBQWE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw0RUFBZSxDQUFDLDJEQUFVO0FBQzNDLEdBQUc7QUFDSDtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxrRUFBa0Usc0RBQUcsVUFBVTtBQUMvRTtBQUNBLEtBQUssb0JBQW9CLHNEQUFHLENBQUMsdURBQVksSUFBSTtBQUM3Qyw0QkFBNEIsNENBQUs7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EsaUZBQWlGLHNEQUFHLFlBQVksK0NBQStDLHNEQUFHLFNBQVMsTUFBTSxHQUFHO0FBQ3BLO0FBQ0EsZ1RBQWdULHNEQUFHLFFBQVEsMEVBQTBFLHVEQUFJLFdBQVc7QUFDcFosaUNBQWlDLHNEQUFHLENBQUMsMERBQUcsSUFBSSwwQ0FBMEMsc0RBQUcsQ0FBQywyREFBSSxJQUFJLDZEQUE2RCxzREFBRyxDQUFDLHlEQUFjLElBQUksR0FBRyxHQUFHO0FBQzNMLG9CQUFvQixzREFBRyxDQUFDLDJEQUFJLElBQUkseUJBQXlCO0FBQ3pELDZCQUE2QixzREFBRyxDQUFDLDJEQUFJLElBQUksNENBQTRDO0FBQ3JGLGdDQUFnQyxzREFBRyxDQUFDLDBEQUFHLElBQUksNkRBQTZELHNEQUFHLGdCQUFnQiwwQkFBMEIsc0RBQUcsQ0FBQyxtREFBVSxJQUFJO0FBQ3ZLO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSywwQkFBMEIsc0RBQUcsQ0FBQyw2REFBTSxJQUFJLE1BQU0sK0RBQW9CLCtCQUErQix5QkFBeUIsc0RBQUcsQ0FBQywyREFBSSxJQUFJLHVDQUF1QyxzREFBRyxDQUFDLHNFQUFhLElBQUksd0ZBQXdGLHVEQUFJLENBQUMsMkNBQVUsSUFBSTtBQUNsVCxzQkFBc0IsdURBQUksQ0FBQyw0REFBSyxJQUFJO0FBQ3BDLHdCQUF3QixzREFBRyxDQUFDLCtEQUFRLElBQUksbUNBQW1DLHNEQUFHLENBQUMsMERBQUcsSUFBSSx1Q0FBdUMsc0RBQUcsQ0FBQywyREFBSSxJQUFJO0FBQ3pJO0FBQ0EsU0FBUyxlQUFlLDZDQUE2QyxJQUFJLDJDQUEyQyxHQUFHLEdBQUc7QUFDMUg7QUFDQSxXQUFXO0FBQ1gsa0dBQWtHLHNEQUFHLENBQUMsK0RBQVEsSUFBSSxxREFBcUQsc0RBQUcsQ0FBQyxtREFBUSxJQUFJLHlCQUF5QixzREFBRyxDQUFDLDBEQUFHLElBQUksdUNBQXVDLHNEQUFHLENBQUMsMkRBQUksSUFBSSxzREFBc0QsR0FBRywwRkFBMEY7QUFDamEsU0FBUztBQUNULGtFQUFrRSxzREFBRyxDQUFDLGtFQUFhLElBQUk7QUFDdkYsT0FBTywrQkFBK0IsR0FBRyxHQUFHLEdBQUcsR0FBRztBQUNsRCxLQUFLLEdBQUc7QUFDUjtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsc0RBQUcsUUFBUSxlQUFlO0FBQ25FO0FBQ0EsMkVBQTJFLHVEQUFJLENBQUMsc0VBQWEsSUFBSTtBQUNqRztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTiwyQkFBMkIsc0RBQUcsZ0JBQWdCLGFBQWEsa0lBQTBEO0FBQ3JILEdBQUc7QUFDSDtBQUNBLGlFQUFpRSx1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDbEY7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDLG1CQUFtQiwyQ0FBSTtBQUN4QixZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxlQUFlLDZDQUFNLDhCQUE4Qiw2Q0FBTTtBQUM3RDtBQUNBLGdCQUFnQixPQUFPLGFBQWEsT0FBTyx1QkFBdUIsT0FBTyxNQUFNLE9BQU87QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSx1RUFBYztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUcsa0xBQWtMLGdEQUFTO0FBQzlMLG9DQUFvQywrQ0FBUTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBLHVJQUF1SSxnREFBUztBQUNoSiw0REFBNEQsK0NBQVE7QUFDcEU7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0gsOEtBQThLLCtDQUFRO0FBQ3RMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHFGQUFxRixnREFBUztBQUM5RjtBQUNBLDJIQUEySCxzREFBRyxDQUFDLDBFQUFpQixJQUFJLDREQUE0RDtBQUNoTjtBQUNBO0FBQ0Esb0tBQW9LLHNEQUFHLDZCQUE2QixrR0FBa0csc0RBQUcsNkJBQTZCLGdGQUFnRixHQUFHLDhCQUE4QixzREFBRyx3QkFBd0Isb0VBQW9FO0FBQ3RoQjtBQUNBLGlKQUFpSixzREFBRyxXQUFXLHdJQUF3STtBQUN2UztBQUNBLGlFQUFpRSx1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDbEY7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkscUVBQUU7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsMkNBQUk7QUFDakIsWUFBWSx5REFBQyxlQUFlLDJEQUFvQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSxzREFBRyxlQUFlLHNDQUFzQyxzREFBRyxDQUFDLDJEQUFJLElBQUksdURBQXVELEdBQUc7QUFDek07QUFDQSwrQ0FBK0Msc0RBQUcsQ0FBQywwREFBRyxJQUFJLDJFQUEyRTtBQUNySSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsc0RBQUcsQ0FBQywyQ0FBVSxJQUFJO0FBQzNDO0FBQ0EseUNBQXlDLHNEQUFHLGdCQUFnQixtQ0FBbUM7QUFDL0YsR0FBRyxHQUFHO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSSxjQUFjLGdCQUFnQixhQUFhLGdCQUFnQixhQUFhLG9CQUFvQixhQUFhLG9CQUFvQjtBQUNqSTtBQUNBLDBGQUEwRixzREFBRyxVQUFVO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsTUFBTSxhQUFhLE9BQU8sdUJBQXVCLEVBQUUsTUFBTSxFQUFFO0FBQzNFO0FBQ0EsMkVBQTJFLHNEQUFHLFVBQVU7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDLFdBQVcscURBQU07QUFDbEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtDQUErQyxXQUFXLG9DQUFvQyxZQUFZLGFBQWEsYUFBYTtBQUNySSxXQUFXO0FBQ1g7QUFDQSxDQUFDLFFBQVEsT0FBTztBQUNoQixZQUFZO0FBQ1o7QUFDQSxDQUFDLFFBQVEsUUFBUTtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSSxnUUFBZ1EseUVBQWMsWUFBWSxzRUFBVztBQUN6UztBQUNBO0FBQ0E7QUFDQSwyR0FBMkcsMkRBQUksOEtBQThLLFlBQVksRUFBRSxXQUFXO0FBQ3RULElBQUk7QUFDSjtBQUNBO0FBQ0Esb0ZBQW9GLHNEQUFHLFdBQVcsa0ZBQWtGO0FBQ3BMO0FBQ0EseUVBQXlFLHNEQUFHLFVBQVUsMkNBQTJDO0FBQ2pJO0FBQ0EseURBQXlELHNEQUFHLFVBQVUsOEJBQThCO0FBQ3BHO0FBQ0EseUlBQXlJLHNEQUFHLE9BQU8sMkVBQTJFO0FBQzlOO0FBQ0EscUpBQXFKLHNEQUFHLE9BQU8sMkZBQTJGO0FBQzFQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5REFBTSxDQUFDLCtEQUFJO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGtGQUFrRixzREFBRyxXQUFXLHVFQUF1RSx1REFBSSxDQUFDLDJEQUFJLElBQUk7QUFDcEwsb0JBQW9CLHNEQUFHLENBQUMsOERBQU8sSUFBSSxpQkFBaUI7QUFDcEQsb0JBQW9CLHNEQUFHLENBQUMsMkRBQUksSUFBSSwrQkFBK0I7QUFDL0Qsb0JBQW9CLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUN0QyxLQUFLLEdBQUc7QUFDUixDQUFDO0FBQ0Q7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0Esa0RBQWtELCtDQUFRO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUcsdUlBQXVJLGdEQUFTO0FBQ25KO0FBQ0E7QUFDQTtBQUNBLEdBQUcsbUZBQW1GLGdEQUFTO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUVBQXlFLHNEQUFHLHFDQUFxQywwQkFBMEI7QUFDM0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsNENBQTRDLCtDQUFRLDRCQUE0QiwrQ0FBUTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFVBQVU7QUFDVjtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHLGtGQUFrRixnREFBUztBQUM5RjtBQUNBO0FBQ0EsMkJBQTJCLDZDQUFNLFdBQVcsdURBQWdCO0FBQzVEO0FBQ0E7QUFDQSxvQ0FBb0MsNkNBQU07QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxLQUFLO0FBQ0wsR0FBRyx5R0FBeUcsZ0RBQVM7QUFDckg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJGQUEyRixtQ0FBbUM7QUFDOUg7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVGQUF1RixtQ0FBbUM7QUFDMUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDBFQUEwRSxzREFBRywyQkFBMkIsMEJBQTBCO0FBQ2xJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLENBQUMsd0JBQXdCO0FBQ3pCLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0Esb0tBQW9LLGdEQUFTO0FBQzdLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0wsR0FBRyxrRkFBa0YsZ0RBQVM7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHVFQUF1RSxzREFBRyxDQUFDLGlGQUFrQixhQUFhLDBCQUEwQjtBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLCtEQUFNO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsMENBQTBDLE1BQU07QUFDaEQsR0FBRztBQUNIO0FBQ0E7QUFDQSxtRUFBbUUsc0RBQUcsQ0FBQyx5RUFBZ0IsYUFBYSxzQkFBc0I7QUFDMUg7QUFDQTtBQUNBLFlBQVkseURBQUMseUJBQXlCLDZDQUFNLGlDQUFpQyxnRkFBdUI7QUFDcEc7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLDBGQUF1QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHLGdOQUFnTixnREFBUztBQUM1TjtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHLDZHQUE2RyxnREFBUztBQUN6SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUMsb0JBQW9CLDZDQUFNO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUcsOEpBQThKLGdEQUFTO0FBQzFLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxhQUFhLHFEQUFNO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLG9DQUFvQywrQ0FBUTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUcsMEZBQTBGLGdEQUFTO0FBQ3RHLGdCQUFnQiwyRUFBa0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBVTtBQUM5QixPQUFPO0FBQ1A7QUFDQSxvQkFBb0IsbUVBQWM7QUFDbEMsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtEQUFVO0FBQ2hDLFNBQVM7QUFDVDtBQUNBLHNCQUFzQixtRUFBYztBQUNwQyxTQUFTO0FBQ1Q7QUFDQSxHQUFHLDJHQUEyRyxnREFBUztBQUN2SCxDQUFDO0FBQ0QsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSSxzQ0FBc0MseUVBQVk7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvS0FBb0ssZ0RBQVM7QUFDN0ssQ0FBQztBQUNELFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHVCQUF1Qix5RUFBYztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHlCQUF5QixpREFBVTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxzQ0FBc0MsK0NBQVEsOENBQThDLCtDQUFRO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUcsa0ZBQWtGLGdEQUFTO0FBQzlGO0FBQ0E7QUFDQSx5RUFBeUUsRUFBRSwyREFBMkQsbUJBQW1CO0FBQ3pKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLDRFQUE0RSxnREFBUztBQUN4Riw0Q0FBNEMsK0NBQVEsa0NBQWtDLCtDQUFRLDBCQUEwQiw2Q0FBTTtBQUM5SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsR0FBRyxrR0FBa0csZ0RBQVM7QUFDOUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILHVEQUF1RCxnRkFBdUI7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNLQUFzSyw4RkFBMkI7QUFDek0sNkJBQTZCLHNEQUFHLG1CQUFtQiw2VkFBNlY7QUFDaFosS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSxzREFBRyxxQkFBcUIsMEJBQTBCO0FBQzVIO0FBQ0Esc0xBQXNMLHNEQUFHLHVCQUF1Qix3R0FBd0c7QUFDeFQ7QUFDQSxnRUFBZ0Usc0RBQUcsZ0JBQWdCLDZDQUE2QztBQUNoSTtBQUNBLHlOQUF5Tix1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDMU8sMENBQTBDLHNEQUFHLDRCQUE0QixvQkFBb0I7QUFDN0YsNkNBQTZDLHNEQUFHLHlCQUF5QjtBQUN6RSxxQ0FBcUMsc0RBQUcseUJBQXlCLGVBQWU7QUFDaEYsS0FBSztBQUNMO0FBQ0Esd0dBQXdHLHNEQUFHLHVCQUF1Qix3QkFBd0I7QUFDMUo7QUFDQSxpTUFBaU0sdURBQUksU0FBUztBQUM5TTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSw4REFBOEQsc0RBQUcsd0JBQXdCLHdCQUF3QjtBQUNqSDtBQUNBLDhEQUE4RCxzREFBRyw2QkFBNkIsd0JBQXdCO0FBQ3RIO0FBQ0Esb0ZBQW9GLHNEQUFHLG1CQUFtQixrQ0FBa0M7QUFDNUk7QUFDQSxrRUFBa0Usc0RBQUcsQ0FBQyxvRUFBYSxJQUFJLDBCQUEwQixzREFBRyxDQUFDLHFFQUFjLElBQUkscUNBQXFDLEdBQUc7QUFDL0s7QUFDQSwwREFBMEQsc0RBQUcsQ0FBQyxvRUFBYSxJQUFJLG9CQUFvQixrRUFBVyxzQ0FBc0M7QUFDcEo7QUFDQSxxRUFBcUUsc0RBQUcsc0JBQXNCLHdCQUF3QjtBQUN0SCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLDhFQUFtQixZQUFZLHdFQUFhO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0EsSUFBSSw0QkFBNEIsNkNBQU0sMEJBQTBCLDZDQUFNO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRyw0R0FBNEcsZ0RBQVM7QUFDeEg7QUFDQTtBQUNBLFlBQVkseURBQUMseURBQXlELCtDQUFRLDBCQUEwQiwrQ0FBUTtBQUNoSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw0REFBVTtBQUMvQjtBQUNBO0FBQ0EsS0FBSyxFQUFFLG1FQUFpQjtBQUN4QixjQUFjLHdGQUF5QjtBQUN2QyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsZ0ZBQWdGLGdEQUFTO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHLGdGQUFnRixnREFBUztBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGtDQUFrQyxnREFBYSw4QkFBOEIsMENBQU87QUFDcEY7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSCxHQUFHO0FBQ0g7QUFDQSxHQUFHLEdBQUcsNENBQUs7QUFDWDtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLDJFQUFvQixxQkFBcUIsMENBQVc7QUFDekg7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0MsZ0VBQVE7QUFDMUMsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHLGtGQUFrRixnREFBUztBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLG1FQUFtRSwrQ0FBUSxnQ0FBZ0MsK0NBQVE7QUFDdkg7QUFDQTtBQUNBLGVBQWUsbUZBQW9CLGdCQUFnQixtRkFBb0I7QUFDdkUsR0FBRywyREFBMkQsZ0RBQVM7QUFDdkUsNENBQTRDLCtDQUFRO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdGQUFnRixnREFBUztBQUM1RjtBQUNBO0FBQ0E7QUFDQSxxTkFBcU4sc0RBQUcsYUFBYSwwRkFBMEY7QUFDL1Q7QUFDQSxpR0FBaUcsdURBQUksQ0FBQyx1REFBUSxJQUFJO0FBQ2xILG9CQUFvQixzREFBRyxZQUFZLGtCQUFrQjtBQUNyRCxvQkFBb0Isc0RBQUcsU0FBUyxTQUFTO0FBQ3pDLCtCQUErQixzREFBRyxZQUFZLGtCQUFrQjtBQUNoRSxLQUFLO0FBQ0w7QUFDQSx1REFBdUQsdURBQUksQ0FBQyx1REFBUSxJQUFJO0FBQ3hFO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsdURBQVk7QUFDM0U7QUFDQTtBQVVFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4vbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvcmVhY3QvaW5kZXguanM/MjU5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBqc3gsIGpzeHMsIEZyYWdtZW50IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG5pbXBvcnQgeyBjIH0gZnJvbSBcInJlYWN0LWNvbXBpbGVyLXJ1bnRpbWVcIjtcbmltcG9ydCB7IGNyZWF0ZUNvbXBhdGliaWxpdHlBY3RvcnMsIGlzTWF5YmVQcmV2aWV3SWZyYW1lLCBpc01heWJlUHJldmlld1dpbmRvdyB9IGZyb20gXCJAc2FuaXR5L3ByZXNlbnRhdGlvbi1jb21saW5rXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QsIGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZVN0YXRlLCBtZW1vLCB1c2VSZWYsIHVzZUlkLCBGcmFnbWVudCBhcyBGcmFnbWVudCQxLCBpc1ZhbGlkRWxlbWVudCwgdXNlU3luY0V4dGVybmFsU3RvcmUsIHVzZURlZmVycmVkVmFsdWUsIHVzZVJlZHVjZXIgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGNyZWF0ZVBvcnRhbCB9IGZyb20gXCJyZWFjdC1kb21cIjtcbmltcG9ydCB7IGNyZWF0ZUVkaXRVcmwsIHN0dWRpb1BhdGgsIGdldERyYWZ0SWQsIGdldFB1Ymxpc2hlZElkIH0gZnJvbSBcIkBzYW5pdHkvY2xpZW50L2NzbVwiO1xuaW1wb3J0IHsgTWVudUdyb3VwLCBNZW51RGl2aWRlciwgTWVudUl0ZW0sIEJveCwgVGV4dCwgU3Bpbm5lciwgU3RhY2ssIEZsZXgsIE1lbnUsIFBvcG92ZXIsIEJ1dHRvbiwgQ2FyZCwgdXNlUHJlZmVyc0RhcmssIHVzZVRoZW1lX3YyLCBIb3RrZXlzLCBMYXllclByb3ZpZGVyLCBQb3J0YWxQcm92aWRlciwgVGhlbWVQcm92aWRlciwgc3R1ZGlvVGhlbWUsIGlzSFRNTEFuY2hvckVsZW1lbnQsIGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiQHNhbml0eS91aS9fdmlzdWFsLWVkaXRpbmdcIjtcbmltcG9ydCB7IHN0eWxlZCB9IGZyb20gXCJzdHlsZWQtY29tcG9uZW50c1wiO1xuaW1wb3J0IHsgdXNlRG9jdW1lbnRzLCBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoLCBnZXQsIGdldEFycmF5TW92ZVBhdGNoZXMsIGdldEFycmF5SW5zZXJ0UGF0Y2hlcywgZ2V0QXJyYXlEdXBsaWNhdGVQYXRjaGVzLCBnZXRBcnJheVJlbW92ZVBhdGNoZXMsIHVzZU9wdGltaXN0aWNBY3RvclJlYWR5LCB1c2VPcHRpbWlzdGljQWN0b3IgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9tdXRhdGlvbnMuanNcIjtcbmltcG9ydCB7IHY0LCBTaGFyZWRTdGF0ZUNvbnRleHQsIGNyZWF0ZU92ZXJsYXlDb250cm9sbGVyLCBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXkgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9TaGFyZWRTdGF0ZUNvbnRleHQuanNcIjtcbmltcG9ydCB7IHVzZU9wdGltaXN0aWMgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9TaGFyZWRTdGF0ZUNvbnRleHQuanNcIjtcbmltcG9ydCB7IGF0LCByZW1vdmUsIGluc2VydCB9IGZyb20gXCJAc2FuaXR5L211dGF0ZVwiO1xuaW1wb3J0IHsgZ2V0Tm9kZUljb24sIEluc2VydE1lbnUsIFBvcG92ZXJQb3J0YWwsIHVzZVRlbGVtZXRyeSwgUG9wb3ZlckJhY2tncm91bmQsIFBvaW50ZXJFdmVudHMsIFRlbGVtZXRyeUNvbnRleHQsIGV2ZW50cyB9IGZyb20gXCIuLi9fY2h1bmtzLWVzL1BvaW50ZXJFdmVudHMuanNcIjtcbmltcG9ydCB7IEluc2VydEFib3ZlSWNvbiwgSW5zZXJ0QmVsb3dJY29uLCBDb3B5SWNvbiwgUmVtb3ZlSWNvbiwgU29ydEljb24sIFB1Ymxpc2hJY29uLCBBcnJvd1VwSWNvbiwgQXJyb3dEb3duSWNvbiwgVW5wdWJsaXNoSWNvbiwgRHJhZ0hhbmRsZUljb24sIFBsdWdJY29uLCBFbGxpcHNpc1ZlcnRpY2FsSWNvbiwgRG9jdW1lbnRJY29uLCBFeHBhbmRJY29uIH0gZnJvbSBcIkBzYW5pdHkvaWNvbnNcIjtcbmltcG9ydCB7IE1lbnVCdXR0b24sIE1lbnVEaXZpZGVyIGFzIE1lbnVEaXZpZGVyJDEgfSBmcm9tIFwiQHNhbml0eS91aVwiO1xuaW1wb3J0IHsgcGF0aFRvVXJsU3RyaW5nIH0gZnJvbSBcIkBzYW5pdHkvdmlzdWFsLWVkaXRpbmctY3NtXCI7XG5pbXBvcnQgeyBjcmVhdGVEYXRhQXR0cmlidXRlIH0gZnJvbSBcIkBzYW5pdHkvdmlzdWFsLWVkaXRpbmctY3NtXCI7XG5pbXBvcnQgc2Nyb2xsSW50b1ZpZXcgZnJvbSBcInNjcm9sbC1pbnRvLXZpZXctaWYtbmVlZGVkXCI7XG5pbXBvcnQgeyBjcmVhdGVOb2RlLCBjcmVhdGVOb2RlTWFjaGluZSB9IGZyb20gXCJAc2FuaXR5L2NvbWxpbmtcIjtcbmltcG9ydCB7IGNyZWF0ZUFjdG9yIH0gZnJvbSBcInhzdGF0ZVwiO1xuaW1wb3J0IHsgc2V0QWN0b3IgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9jb250ZXh0LmpzXCI7XG5pbXBvcnQgeyBlbXB0eUFjdG9yIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvY29udGV4dC5qc1wiO1xuaW1wb3J0IHsgUmVwbGF5U3ViamVjdCwgU3ViamVjdCwgbWVyZ2UgfSBmcm9tIFwicnhqc1wiO1xuaW1wb3J0IHsgY3JlYXRlRGF0YXNldE11dGF0b3IgfSBmcm9tIFwiLi4vb3B0aW1pc3RpYy9pbmRleC5qc1wiO1xuaW1wb3J0IHsgY3JlYXRlRG9jdW1lbnRNdXRhdG9yIH0gZnJvbSBcIi4uL29wdGltaXN0aWMvaW5kZXguanNcIjtcbmNvbnN0IEhpc3RvcnkgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoOCksIHtcbiAgICBjb21saW5rLFxuICAgIGhpc3RvcnlcbiAgfSA9IHByb3BzO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBjb21saW5rIHx8ICRbMV0gIT09IGhpc3RvcnkgPyAodDAgPSAoKSA9PiBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9uYXZpZ2F0ZVwiLCAoZGF0YSkgPT4ge1xuICAgIGhpc3Rvcnk/LnVwZGF0ZShkYXRhKTtcbiAgfSksIHQxID0gW2NvbWxpbmssIGhpc3RvcnldLCAkWzBdID0gY29tbGluaywgJFsxXSA9IGhpc3RvcnksICRbMl0gPSB0MCwgJFszXSA9IHQxKSA6ICh0MCA9ICRbMl0sIHQxID0gJFszXSksIHVzZUVmZmVjdCh0MCwgdDEpO1xuICBsZXQgdDIsIHQzO1xuICByZXR1cm4gJFs0XSAhPT0gY29tbGluayB8fCAkWzVdICE9PSBoaXN0b3J5ID8gKHQyID0gKCkgPT4ge1xuICAgIGlmIChoaXN0b3J5KVxuICAgICAgcmV0dXJuIGhpc3Rvcnkuc3Vic2NyaWJlKCh1cGRhdGUpID0+IHtcbiAgICAgICAgdXBkYXRlLnRpdGxlID0gdXBkYXRlLnRpdGxlIHx8IGRvY3VtZW50LnRpdGxlLCBjb21saW5rPy5wb3N0KFwidmlzdWFsLWVkaXRpbmcvbmF2aWdhdGVcIiwgdXBkYXRlKTtcbiAgICAgIH0pO1xuICB9LCB0MyA9IFtjb21saW5rLCBoaXN0b3J5XSwgJFs0XSA9IGNvbWxpbmssICRbNV0gPSBoaXN0b3J5LCAkWzZdID0gdDIsICRbN10gPSB0MykgOiAodDIgPSAkWzZdLCB0MyA9ICRbN10pLCB1c2VFZmZlY3QodDIsIHQzKSwgbnVsbDtcbn0sIE1ldGEgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoMyksIHtcbiAgICBjb21saW5rXG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwLCB0MTtcbiAgcmV0dXJuICRbMF0gIT09IGNvbWxpbmsgPyAodDAgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2VuZE1ldGEgPSAoKSA9PiB7XG4gICAgICBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9tZXRhXCIsIHtcbiAgICAgICAgdGl0bGU6IGRvY3VtZW50LnRpdGxlXG4gICAgICB9KTtcbiAgICB9LCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCh0MikgPT4ge1xuICAgICAgY29uc3QgW211dGF0aW9uXSA9IHQyO1xuICAgICAgbXV0YXRpb24udGFyZ2V0Lm5vZGVOYW1lID09PSBcIlRJVExFXCIgJiYgc2VuZE1ldGEoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5oZWFkLCB7XG4gICAgICBzdWJ0cmVlOiAhMCxcbiAgICAgIGNoYXJhY3RlckRhdGE6ICEwLFxuICAgICAgY2hpbGRMaXN0OiAhMFxuICAgIH0pLCBzZW5kTWV0YSgpLCAoKSA9PiBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gIH0sIHQxID0gW2NvbWxpbmtdLCAkWzBdID0gY29tbGluaywgJFsxXSA9IHQwLCAkWzJdID0gdDEpIDogKHQwID0gJFsxXSwgdDEgPSAkWzJdKSwgdXNlRWZmZWN0KHQwLCB0MSksIG51bGw7XG59O1xuZnVuY3Rpb24gZ2V0UmVmZXJlbmNlTm9kZUFuZEluc2VydFBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gIGlmIChwb3NpdGlvbikge1xuICAgIGNvbnN0IHtcbiAgICAgIHRvcCxcbiAgICAgIHJpZ2h0LFxuICAgICAgYm90dG9tLFxuICAgICAgbGVmdFxuICAgIH0gPSBwb3NpdGlvbjtcbiAgICBpZiAobGVmdCB8fCB0b3ApXG4gICAgICByZXR1cm4ge1xuICAgICAgICBub2RlOiAobGVmdCA/PyB0b3ApLnNhbml0eSxcbiAgICAgICAgcG9zaXRpb246IFwiYWZ0ZXJcIlxuICAgICAgfTtcbiAgICBpZiAocmlnaHQgfHwgYm90dG9tKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbm9kZTogKHJpZ2h0ID8/IGJvdHRvbSkuc2FuaXR5LFxuICAgICAgICBwb3NpdGlvbjogXCJiZWZvcmVcIlxuICAgICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gdXNlRHJhZ0VuZEV2ZW50cygpIHtcbiAgY29uc3QgJCA9IGMoNCksIHtcbiAgICBnZXREb2N1bWVudFxuICB9ID0gdXNlRG9jdW1lbnRzKCk7XG4gIGxldCB0MCwgdDE7XG4gICRbMF0gIT09IGdldERvY3VtZW50ID8gKHQwID0gKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZXIgPSAoZSkgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICBpbnNlcnRQb3NpdGlvbixcbiAgICAgICAgdGFyZ2V0LFxuICAgICAgICBwcmV2ZW50SW5zZXJ0RGVmYXVsdFxuICAgICAgfSA9IGUuZGV0YWlsO1xuICAgICAgaWYgKHByZXZlbnRJbnNlcnREZWZhdWx0KVxuICAgICAgICByZXR1cm47XG4gICAgICBjb25zdCByZWZlcmVuY2UgPSBnZXRSZWZlcmVuY2VOb2RlQW5kSW5zZXJ0UG9zaXRpb24oaW5zZXJ0UG9zaXRpb24pO1xuICAgICAgaWYgKHJlZmVyZW5jZSkge1xuICAgICAgICBjb25zdCBkb2MgPSBnZXREb2N1bWVudCh0YXJnZXQuaWQpLCB7XG4gICAgICAgICAgbm9kZSxcbiAgICAgICAgICBwb3NpdGlvblxuICAgICAgICB9ID0gcmVmZXJlbmNlLCB7XG4gICAgICAgICAga2V5OiB0YXJnZXRLZXksXG4gICAgICAgICAgaGFzRXhwbGljaXRLZXlcbiAgICAgICAgfSA9IGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgodGFyZ2V0KSwge1xuICAgICAgICAgIHBhdGg6IGFycmF5UGF0aCxcbiAgICAgICAgICBrZXk6IHJlZmVyZW5jZUl0ZW1LZXlcbiAgICAgICAgfSA9IGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgobm9kZSk7XG4gICAgICAgIGFycmF5UGF0aCAmJiByZWZlcmVuY2VJdGVtS2V5ICYmIHJlZmVyZW5jZUl0ZW1LZXkgIT09IHRhcmdldEtleSAmJiBkb2MucGF0Y2goYXN5bmMgKHQyMikgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGdldFNuYXBzaG90XG4gICAgICAgICAgfSA9IHQyMiwgc25hcHNob3QgPSBhd2FpdCBnZXRTbmFwc2hvdCgpLCBlbGVtZW50VmFsdWUgPSBnZXQoc25hcHNob3QsIHRhcmdldC5wYXRoKTtcbiAgICAgICAgICByZXR1cm4gaGFzRXhwbGljaXRLZXkgPyBbYXQoYXJyYXlQYXRoLCByZW1vdmUoe1xuICAgICAgICAgICAgX2tleTogdGFyZ2V0S2V5XG4gICAgICAgICAgfSkpLCBhdChhcnJheVBhdGgsIGluc2VydChlbGVtZW50VmFsdWUsIHBvc2l0aW9uLCB7XG4gICAgICAgICAgICBfa2V5OiByZWZlcmVuY2VJdGVtS2V5XG4gICAgICAgICAgfSkpXSA6IFthdChhcnJheVBhdGgsIHJlbW92ZSh+fnRhcmdldEtleSkpLCBhdChhcnJheVBhdGgsIGluc2VydChlbGVtZW50VmFsdWUsIHBvc2l0aW9uLCByZWZlcmVuY2VJdGVtS2V5ID4gdGFyZ2V0S2V5ID8gfn5yZWZlcmVuY2VJdGVtS2V5IC0gMSA6IH5+cmVmZXJlbmNlSXRlbUtleSkpXTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzYW5pdHkvZHJhZ0VuZFwiLCBoYW5kbGVyKSwgKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzYW5pdHkvZHJhZ0VuZFwiLCBoYW5kbGVyKTtcbiAgICB9O1xuICB9LCB0MSA9IFtnZXREb2N1bWVudF0sICRbMF0gPSBnZXREb2N1bWVudCwgJFsxXSA9IHQwLCAkWzJdID0gdDEpIDogKHQwID0gJFsxXSwgdDEgPSAkWzJdKSwgdXNlRWZmZWN0KHQwLCB0MSk7XG4gIGNvbnN0IGRpc3BhdGNoRHJhZ0VuZEV2ZW50ID0gX3RlbXAkOTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFszXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDIgPSB7XG4gICAgZGlzcGF0Y2hEcmFnRW5kRXZlbnRcbiAgfSwgJFszXSA9IHQyKSA6IHQyID0gJFszXSwgdDI7XG59XG5mdW5jdGlvbiBfdGVtcCQ5KGV2ZW50KSB7XG4gIGNvbnN0IGN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KFwic2FuaXR5L2RyYWdFbmRcIiwge1xuICAgIGRldGFpbDogZXZlbnQsXG4gICAgY2FuY2VsYWJsZTogITBcbiAgfSk7XG4gIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGN1c3RvbUV2ZW50KTtcbn1cbmNvbnN0IFNjaGVtYUNvbnRleHQgPSBjcmVhdGVDb250ZXh0KG51bGwpO1xuZnVuY3Rpb24gdXNlU2NoZW1hKCkge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChTY2hlbWFDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KVxuICAgIHRocm93IG5ldyBFcnJvcihcIlNjaGVtYSBjb250ZXh0IGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiBjb250ZXh0O1xufVxuZnVuY3Rpb24gZ2V0QXJyYXlSZW1vdmVBY3Rpb24obm9kZSwgZG9jKSB7XG4gIGlmICghbm9kZS50eXBlKSB0aHJvdyBuZXcgRXJyb3IoXCJOb2RlIHR5cGUgaXMgbWlzc2luZ1wiKTtcbiAgcmV0dXJuICgpID0+IGRvYy5wYXRjaChhc3luYyAoe1xuICAgIGdldFNuYXBzaG90XG4gIH0pID0+IGdldEFycmF5UmVtb3ZlUGF0Y2hlcyhub2RlLCBhd2FpdCBnZXRTbmFwc2hvdCgpKSk7XG59XG5mdW5jdGlvbiBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIGluc2VydFR5cGUsIHBvc2l0aW9uKSB7XG4gIGlmICghbm9kZS50eXBlKSB0aHJvdyBuZXcgRXJyb3IoXCJOb2RlIHR5cGUgaXMgbWlzc2luZ1wiKTtcbiAgcmV0dXJuICgpID0+IGRvYy5wYXRjaCgoKSA9PiBnZXRBcnJheUluc2VydFBhdGNoZXMobm9kZSwgaW5zZXJ0VHlwZSwgcG9zaXRpb24pKTtcbn1cbmZ1bmN0aW9uIGdldER1cGxpY2F0ZUFjdGlvbihub2RlLCBkb2MpIHtcbiAgaWYgKCFub2RlLnR5cGUpIHRocm93IG5ldyBFcnJvcihcIk5vZGUgdHlwZSBpcyBtaXNzaW5nXCIpO1xuICByZXR1cm4gKCkgPT4gZG9jLnBhdGNoKGFzeW5jICh7XG4gICAgZ2V0U25hcHNob3RcbiAgfSkgPT4gZ2V0QXJyYXlEdXBsaWNhdGVQYXRjaGVzKG5vZGUsIGF3YWl0IGdldFNuYXBzaG90KCkpKTtcbn1cbmZ1bmN0aW9uIGdldENvbnRleHRNZW51SXRlbXMoY29udGV4dCkge1xuICBjb25zdCB7XG4gICAgbm9kZSxcbiAgICBmaWVsZCxcbiAgICBwYXJlbnQsXG4gICAgZG9jXG4gIH0gPSBjb250ZXh0O1xuICByZXR1cm4gZmllbGQ/LnR5cGUgPT09IFwiYXJyYXlJdGVtXCIgPyBnZXRDb250ZXh0TWVudUFycmF5SXRlbXMoe1xuICAgIG5vZGUsXG4gICAgZmllbGQsXG4gICAgZG9jXG4gIH0pIDogcGFyZW50Py50eXBlID09PSBcInVuaW9uXCIgPyBnZXRDb250ZXh0TWVudVVuaW9uSXRlbXMoe1xuICAgIG5vZGUsXG4gICAgcGFyZW50LFxuICAgIGRvY1xuICB9KSA6IFByb21pc2UucmVzb2x2ZShbXSk7XG59XG5mdW5jdGlvbiBnZXREdXBsaWNhdGVJdGVtKGNvbnRleHQpIHtcbiAgY29uc3Qge1xuICAgIG5vZGUsXG4gICAgZG9jXG4gIH0gPSBjb250ZXh0O1xuICByZXR1cm4gZG9jID8gW3tcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIkR1cGxpY2F0ZVwiLFxuICAgIGljb246IENvcHlJY29uLFxuICAgIGFjdGlvbjogZ2V0RHVwbGljYXRlQWN0aW9uKG5vZGUsIGRvYyksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gRHVwbGljYXRlZFwiXG4gIH1dIDogW107XG59XG5mdW5jdGlvbiBnZXRSZW1vdmVJdGVtcyhjb250ZXh0KSB7XG4gIGNvbnN0IHtcbiAgICBub2RlLFxuICAgIGRvY1xuICB9ID0gY29udGV4dDtcbiAgcmV0dXJuIGRvYyA/IFt7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJSZW1vdmVcIixcbiAgICBpY29uOiBSZW1vdmVJY29uLFxuICAgIGFjdGlvbjogZ2V0QXJyYXlSZW1vdmVBY3Rpb24obm9kZSwgZG9jKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBSZW1vdmVkXCJcbiAgfV0gOiBbXTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldE1vdmVJdGVtcyhjb250ZXh0LCB3aXRoRGl2aWRlciA9ICEwKSB7XG4gIGNvbnN0IHtcbiAgICBub2RlLFxuICAgIGRvY1xuICB9ID0gY29udGV4dDtcbiAgaWYgKCFkb2MpIHJldHVybiBbXTtcbiAgY29uc3QgaXRlbXMgPSBbXSwgZ3JvdXBJdGVtcyA9IFtdLCBbbW92ZVVwUGF0Y2hlcywgbW92ZURvd25QYXRjaGVzLCBtb3ZlRmlyc3RQYXRjaGVzLCBtb3ZlTGFzdFBhdGNoZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW2dldEFycmF5TW92ZVBhdGNoZXMobm9kZSwgZG9jLCBcInByZXZpb3VzXCIpLCBnZXRBcnJheU1vdmVQYXRjaGVzKG5vZGUsIGRvYywgXCJuZXh0XCIpLCBnZXRBcnJheU1vdmVQYXRjaGVzKG5vZGUsIGRvYywgXCJmaXJzdFwiKSwgZ2V0QXJyYXlNb3ZlUGF0Y2hlcyhub2RlLCBkb2MsIFwibGFzdFwiKV0pO1xuICByZXR1cm4gbW92ZUZpcnN0UGF0Y2hlcy5sZW5ndGggJiYgZ3JvdXBJdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIlRvIHRvcFwiLFxuICAgIGljb246IFB1Ymxpc2hJY29uLFxuICAgIGFjdGlvbjogKCkgPT4gZG9jLnBhdGNoKG1vdmVGaXJzdFBhdGNoZXMpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIE1vdmVkXCJcbiAgfSksIG1vdmVVcFBhdGNoZXMubGVuZ3RoICYmIGdyb3VwSXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJVcFwiLFxuICAgIGljb246IEFycm93VXBJY29uLFxuICAgIGFjdGlvbjogKCkgPT4gZG9jLnBhdGNoKG1vdmVVcFBhdGNoZXMpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIE1vdmVkXCJcbiAgfSksIG1vdmVEb3duUGF0Y2hlcy5sZW5ndGggJiYgZ3JvdXBJdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIkRvd25cIixcbiAgICBpY29uOiBBcnJvd0Rvd25JY29uLFxuICAgIGFjdGlvbjogKCkgPT4gZG9jLnBhdGNoKG1vdmVEb3duUGF0Y2hlcyksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIlxuICB9KSwgbW92ZUxhc3RQYXRjaGVzLmxlbmd0aCAmJiBncm91cEl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiVG8gYm90dG9tXCIsXG4gICAgaWNvbjogVW5wdWJsaXNoSWNvbixcbiAgICBhY3Rpb246ICgpID0+IGRvYy5wYXRjaChtb3ZlTGFzdFBhdGNoZXMpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIE1vdmVkXCJcbiAgfSksIGdyb3VwSXRlbXMubGVuZ3RoICYmIChpdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImdyb3VwXCIsXG4gICAgbGFiZWw6IFwiTW92ZVwiLFxuICAgIGljb246IFNvcnRJY29uLFxuICAgIGl0ZW1zOiBncm91cEl0ZW1zXG4gIH0pLCB3aXRoRGl2aWRlciAmJiBpdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImRpdmlkZXJcIlxuICB9KSksIGl0ZW1zO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0Q29udGV4dE1lbnVBcnJheUl0ZW1zKGNvbnRleHQpIHtcbiAgY29uc3Qge1xuICAgIG5vZGUsXG4gICAgZmllbGQsXG4gICAgZG9jXG4gIH0gPSBjb250ZXh0LCBpdGVtcyA9IFtdO1xuICByZXR1cm4gaXRlbXMucHVzaCguLi5nZXREdXBsaWNhdGVJdGVtKGNvbnRleHQpKSwgaXRlbXMucHVzaCguLi5nZXRSZW1vdmVJdGVtcyhjb250ZXh0KSksIGl0ZW1zLnB1c2goLi4uYXdhaXQgZ2V0TW92ZUl0ZW1zKGNvbnRleHQpKSwgaXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJJbnNlcnQgYmVmb3JlXCIsXG4gICAgaWNvbjogSW5zZXJ0QWJvdmVJY29uLFxuICAgIGFjdGlvbjogZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCBmaWVsZC5uYW1lLCBcImJlZm9yZVwiKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiXG4gIH0pLCBpdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIkluc2VydCBhZnRlclwiLFxuICAgIGljb246IEluc2VydEJlbG93SWNvbixcbiAgICBhY3Rpb246IGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgZmllbGQubmFtZSwgXCJhZnRlclwiKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiXG4gIH0pLCBpdGVtcztcbn1cbmNvbnN0IEluc2VydE1lbnVXcmFwcGVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDEyKSwge1xuICAgIGxhYmVsLFxuICAgIHBhcmVudCxcbiAgICB3aWR0aCxcbiAgICBvblNlbGVjdCxcbiAgICBib3VuZGFyeUVsZW1lbnRcbiAgfSA9IHByb3BzO1xuICBsZXQgdDA7XG4gICRbMF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQwID0gW1wibGVmdC1zdGFydFwiLCBcInJpZ2h0XCIsIFwibGVmdFwiLCBcInJpZ2h0LWVuZFwiLCBcImxlZnQtZW5kXCIsIFwiYm90dG9tXCIsIFwidG9wXCJdLCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBsZXQgdDE7XG4gICRbMV0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxID0gWzQsIDQsIDQsIDRdLCAkWzFdID0gdDEpIDogdDEgPSAkWzFdO1xuICBsZXQgdDI7XG4gICRbMl0gIT09IGJvdW5kYXJ5RWxlbWVudCB8fCAkWzNdICE9PSB3aWR0aCA/ICh0MiA9IHtcbiAgICBhcnJvdzogITEsXG4gICAgY29uc3RyYWluU2l6ZTogITAsXG4gICAgZmxvYXRpbmdCb3VuZGFyeTogYm91bmRhcnlFbGVtZW50LFxuICAgIHBhZGRpbmc6IDAsXG4gICAgcGxhY2VtZW50OiBcInJpZ2h0LXN0YXJ0XCIsXG4gICAgZmFsbGJhY2tQbGFjZW1lbnRzOiB0MCxcbiAgICBwcmV2ZW50T3ZlcmZsb3c6ICEwLFxuICAgIHdpZHRoLFxuICAgIF9fdW5zdGFibGVfbWFyZ2luczogdDFcbiAgfSwgJFsyXSA9IGJvdW5kYXJ5RWxlbWVudCwgJFszXSA9IHdpZHRoLCAkWzRdID0gdDIpIDogdDIgPSAkWzRdO1xuICBsZXQgdDM7XG4gICRbNV0gIT09IG9uU2VsZWN0IHx8ICRbNl0gIT09IHBhcmVudCA/ICh0MyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goSW5zZXJ0TWVudSwgeyBub2RlOiBwYXJlbnQsIG9uU2VsZWN0IH0pLCAkWzVdID0gb25TZWxlY3QsICRbNl0gPSBwYXJlbnQsICRbN10gPSB0MykgOiB0MyA9ICRbN107XG4gIGxldCB0NDtcbiAgcmV0dXJuICRbOF0gIT09IGxhYmVsIHx8ICRbOV0gIT09IHQyIHx8ICRbMTBdICE9PSB0MyA/ICh0NCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudUdyb3VwLCB7IGZvbnRTaXplOiAxLCBpY29uOiBJbnNlcnRCZWxvd0ljb24sIHBhZGRpbmc6IDIsIHBvcG92ZXI6IHQyLCBzcGFjZTogMiwgdGV4dDogbGFiZWwsIGNoaWxkcmVuOiB0MyB9KSwgJFs4XSA9IGxhYmVsLCAkWzldID0gdDIsICRbMTBdID0gdDMsICRbMTFdID0gdDQpIDogdDQgPSAkWzExXSwgdDQ7XG59O1xuYXN5bmMgZnVuY3Rpb24gZ2V0Q29udGV4dE1lbnVVbmlvbkl0ZW1zKGNvbnRleHQpIHtcbiAgY29uc3Qge1xuICAgIGRvYyxcbiAgICBub2RlLFxuICAgIHBhcmVudFxuICB9ID0gY29udGV4dCwgaXRlbXMgPSBbXTtcbiAgaWYgKGl0ZW1zLnB1c2goLi4uZ2V0RHVwbGljYXRlSXRlbShjb250ZXh0KSksIGl0ZW1zLnB1c2goLi4uZ2V0UmVtb3ZlSXRlbXMoY29udGV4dCkpLCBpdGVtcy5wdXNoKC4uLmF3YWl0IGdldE1vdmVJdGVtcyhjb250ZXh0KSksIHBhcmVudC5vcHRpb25zPy5pbnNlcnRNZW51KSB7XG4gICAgY29uc3Qgd2lkdGggPSAocGFyZW50Lm9wdGlvbnMuaW5zZXJ0TWVudSB8fCB7fSkudmlld3M/LnNvbWUoKHZpZXcpID0+IHZpZXcubmFtZSA9PT0gXCJncmlkXCIpID8gMCA6IHZvaWQgMDtcbiAgICBpdGVtcy5wdXNoKHtcbiAgICAgIHR5cGU6IFwiY3VzdG9tXCIsXG4gICAgICBjb21wb25lbnQ6ICh7XG4gICAgICAgIGJvdW5kYXJ5RWxlbWVudCxcbiAgICAgICAgc2VuZFRlbGVtZXRyeVxuICAgICAgfSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChJbnNlcnRNZW51V3JhcHBlciwgeyBsYWJlbDogXCJJbnNlcnQgYmVmb3JlXCIsIG9uU2VsZWN0OiAoc2NoZW1hVHlwZSkgPT4ge1xuICAgICAgICBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIHNjaGVtYVR5cGUubmFtZSwgXCJiZWZvcmVcIikoKSwgc2VuZFRlbGVtZXRyeShcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCIsIG51bGwpO1xuICAgICAgfSwgcGFyZW50LCB3aWR0aCwgYm91bmRhcnlFbGVtZW50IH0pXG4gICAgfSksIGl0ZW1zLnB1c2goe1xuICAgICAgdHlwZTogXCJjdXN0b21cIixcbiAgICAgIGNvbXBvbmVudDogKHtcbiAgICAgICAgYm91bmRhcnlFbGVtZW50LFxuICAgICAgICBzZW5kVGVsZW1ldHJ5XG4gICAgICB9KSA9PiAvKiBAX19QVVJFX18gKi8ganN4KEluc2VydE1lbnVXcmFwcGVyLCB7IGxhYmVsOiBcIkluc2VydCBhZnRlclwiLCBvblNlbGVjdDogKHNjaGVtYVR5cGUpID0+IHtcbiAgICAgICAgZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCBzY2hlbWFUeXBlLm5hbWUsIFwiYWZ0ZXJcIikoKSwgc2VuZFRlbGVtZXRyeShcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCIsIG51bGwpO1xuICAgICAgfSwgcGFyZW50LCB3aWR0aCwgYm91bmRhcnlFbGVtZW50IH0pXG4gICAgfSk7XG4gIH0gZWxzZVxuICAgIGl0ZW1zLnB1c2goe1xuICAgICAgdHlwZTogXCJncm91cFwiLFxuICAgICAgbGFiZWw6IFwiSW5zZXJ0IGJlZm9yZVwiLFxuICAgICAgaWNvbjogSW5zZXJ0QWJvdmVJY29uLFxuICAgICAgaXRlbXM6IHBhcmVudC5vZi5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0udHlwZSA9PT0gXCJ1bmlvbk9wdGlvblwiKS5tYXAoKHQpID0+ICh7XG4gICAgICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgICAgIGljb246IGdldE5vZGVJY29uKHQpLFxuICAgICAgICBsYWJlbDogdC5uYW1lID09PSBcImJsb2NrXCIgPyBcIlBhcmFncmFwaFwiIDogdC50aXRsZSB8fCB0Lm5hbWUsXG4gICAgICAgIGFjdGlvbjogZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCB0Lm5hbWUsIFwiYmVmb3JlXCIpLFxuICAgICAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiXG4gICAgICB9KSlcbiAgICB9KSwgaXRlbXMucHVzaCh7XG4gICAgICB0eXBlOiBcImdyb3VwXCIsXG4gICAgICBsYWJlbDogXCJJbnNlcnQgYWZ0ZXJcIixcbiAgICAgIGljb246IEluc2VydEJlbG93SWNvbixcbiAgICAgIGl0ZW1zOiBwYXJlbnQub2YuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnR5cGUgPT09IFwidW5pb25PcHRpb25cIikubWFwKCh0KSA9PiAoe1xuICAgICAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgICAgICBsYWJlbDogdC5uYW1lID09PSBcImJsb2NrXCIgPyBcIlBhcmFncmFwaFwiIDogdC50aXRsZSB8fCB0Lm5hbWUsXG4gICAgICAgIGljb246IGdldE5vZGVJY29uKHQpLFxuICAgICAgICBhY3Rpb246IGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgdC5uYW1lLCBcImFmdGVyXCIpLFxuICAgICAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiXG4gICAgICB9KSlcbiAgICB9KTtcbiAgcmV0dXJuIGl0ZW1zO1xufVxuY29uc3QgUE9QT1ZFUl9NQVJHSU5TID0gWy00LCA0LCAtNCwgNF07XG5mdW5jdGlvbiBDb250ZXh0TWVudUl0ZW0ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoMjcpLCB7XG4gICAgbm9kZSxcbiAgICBvbkRpc21pc3MsXG4gICAgYm91bmRhcnlFbGVtZW50XG4gIH0gPSBwcm9wcywgc2VuZFRlbGVtZXRyeSA9IHVzZVRlbGVtZXRyeSgpO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IG5vZGUgfHwgJFsxXSAhPT0gb25EaXNtaXNzIHx8ICRbMl0gIT09IHNlbmRUZWxlbWV0cnkgPyAodDAgPSAoKSA9PiB7XG4gICAgbm9kZS50eXBlID09PSBcImFjdGlvblwiICYmIChub2RlLmFjdGlvbj8uKCksIG9uRGlzbWlzcz8uKCksIG5vZGUudGVsZW1ldHJ5RXZlbnQgJiYgc2VuZFRlbGVtZXRyeShub2RlLnRlbGVtZXRyeUV2ZW50LCBudWxsKSk7XG4gIH0sICRbMF0gPSBub2RlLCAkWzFdID0gb25EaXNtaXNzLCAkWzJdID0gc2VuZFRlbGVtZXRyeSwgJFszXSA9IHQwKSA6IHQwID0gJFszXTtcbiAgY29uc3Qgb25DbGljayA9IHQwO1xuICBpZiAobm9kZS50eXBlID09PSBcImRpdmlkZXJcIikge1xuICAgIGxldCB0MTtcbiAgICByZXR1cm4gJFs0XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDEgPSAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVEaXZpZGVyLCB7fSksICRbNF0gPSB0MSkgOiB0MSA9ICRbNF0sIHQxO1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09IFwiYWN0aW9uXCIpIHtcbiAgICBjb25zdCB0MSA9ICFub2RlLmFjdGlvbjtcbiAgICBsZXQgdDI7XG4gICAgcmV0dXJuICRbNV0gIT09IG5vZGUuaG90a2V5cyB8fCAkWzZdICE9PSBub2RlLmljb24gfHwgJFs3XSAhPT0gbm9kZS5sYWJlbCB8fCAkWzhdICE9PSBvbkNsaWNrIHx8ICRbOV0gIT09IHQxID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChNZW51SXRlbSwgeyBmb250U2l6ZTogMSwgaG90a2V5czogbm9kZS5ob3RrZXlzLCBpY29uOiBub2RlLmljb24sIHBhZGRpbmc6IDIsIHNwYWNlOiAyLCB0ZXh0OiBub2RlLmxhYmVsLCBkaXNhYmxlZDogdDEsIG9uQ2xpY2sgfSksICRbNV0gPSBub2RlLmhvdGtleXMsICRbNl0gPSBub2RlLmljb24sICRbN10gPSBub2RlLmxhYmVsLCAkWzhdID0gb25DbGljaywgJFs5XSA9IHQxLCAkWzEwXSA9IHQyKSA6IHQyID0gJFsxMF0sIHQyO1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09IFwiZ3JvdXBcIikge1xuICAgIGNvbnN0IHQxID0gbm9kZS5pY29uO1xuICAgIGxldCB0MjtcbiAgICAkWzExXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDIgPSB7XG4gICAgICBhcnJvdzogITEsXG4gICAgICBjb25zdHJhaW5TaXplOiAhMCxcbiAgICAgIHBsYWNlbWVudDogXCJyaWdodC1zdGFydFwiLFxuICAgICAgZmFsbGJhY2tQbGFjZW1lbnRzOiBbXCJsZWZ0LXN0YXJ0XCIsIFwicmlnaHRcIiwgXCJsZWZ0XCIsIFwicmlnaHQtZW5kXCIsIFwibGVmdC1lbmRcIiwgXCJib3R0b21cIiwgXCJ0b3BcIl0sXG4gICAgICBwcmV2ZW50T3ZlcmZsb3c6ICEwLFxuICAgICAgX191bnN0YWJsZV9tYXJnaW5zOiBQT1BPVkVSX01BUkdJTlNcbiAgICB9LCAkWzExXSA9IHQyKSA6IHQyID0gJFsxMV07XG4gICAgY29uc3QgdDMgPSBub2RlLmxhYmVsO1xuICAgIGxldCB0NDtcbiAgICBpZiAoJFsxMl0gIT09IGJvdW5kYXJ5RWxlbWVudCB8fCAkWzEzXSAhPT0gbm9kZS5pdGVtcyB8fCAkWzE0XSAhPT0gb25EaXNtaXNzKSB7XG4gICAgICBsZXQgdDUyO1xuICAgICAgJFsxNl0gIT09IGJvdW5kYXJ5RWxlbWVudCB8fCAkWzE3XSAhPT0gb25EaXNtaXNzID8gKHQ1MiA9IChpdGVtLCBpdGVtSW5kZXgpID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goQ29udGV4dE1lbnVJdGVtLCB7IG5vZGU6IGl0ZW0sIG9uRGlzbWlzcywgYm91bmRhcnlFbGVtZW50IH0sIGl0ZW1JbmRleCksICRbMTZdID0gYm91bmRhcnlFbGVtZW50LCAkWzE3XSA9IG9uRGlzbWlzcywgJFsxOF0gPSB0NTIpIDogdDUyID0gJFsxOF0sIHQ0ID0gbm9kZS5pdGVtcy5tYXAodDUyKSwgJFsxMl0gPSBib3VuZGFyeUVsZW1lbnQsICRbMTNdID0gbm9kZS5pdGVtcywgJFsxNF0gPSBvbkRpc21pc3MsICRbMTVdID0gdDQ7XG4gICAgfSBlbHNlXG4gICAgICB0NCA9ICRbMTVdO1xuICAgIGxldCB0NTtcbiAgICByZXR1cm4gJFsxOV0gIT09IG5vZGUuaWNvbiB8fCAkWzIwXSAhPT0gbm9kZS5sYWJlbCB8fCAkWzIxXSAhPT0gdDQgPyAodDUgPSAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVHcm91cCwgeyBmb250U2l6ZTogMSwgaWNvbjogdDEsIHBhZGRpbmc6IDIsIHBvcG92ZXI6IHQyLCBzcGFjZTogMiwgdGV4dDogdDMsIGNoaWxkcmVuOiB0NCB9KSwgJFsxOV0gPSBub2RlLmljb24sICRbMjBdID0gbm9kZS5sYWJlbCwgJFsyMV0gPSB0NCwgJFsyMl0gPSB0NSkgOiB0NSA9ICRbMjJdLCB0NTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSBcImN1c3RvbVwiKSB7XG4gICAgY29uc3Qge1xuICAgICAgY29tcG9uZW50OiBDb21wb25lbnRcbiAgICB9ID0gbm9kZTtcbiAgICBsZXQgdDE7XG4gICAgcmV0dXJuICRbMjNdICE9PSBDb21wb25lbnQgfHwgJFsyNF0gIT09IGJvdW5kYXJ5RWxlbWVudCB8fCAkWzI1XSAhPT0gc2VuZFRlbGVtZXRyeSA/ICh0MSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goQ29tcG9uZW50LCB7IGJvdW5kYXJ5RWxlbWVudCwgc2VuZFRlbGVtZXRyeSB9KSwgJFsyM10gPSBDb21wb25lbnQsICRbMjRdID0gYm91bmRhcnlFbGVtZW50LCAkWzI1XSA9IHNlbmRUZWxlbWV0cnksICRbMjZdID0gdDEpIDogdDEgPSAkWzI2XSwgdDE7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5jb25zdCBDb250ZXh0TWVudSA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYyg0MyksIHtcbiAgICBub2RlLFxuICAgIG9uRGlzbWlzcyxcbiAgICBwb3NpdGlvbjogdDBcbiAgfSA9IHByb3BzLCB7XG4gICAgeCxcbiAgICB5XG4gIH0gPSB0MCwgW2JvdW5kYXJ5RWxlbWVudCwgc2V0Qm91bmRhcnlFbGVtZW50XSA9IHVzZVN0YXRlKG51bGwpLCB7XG4gICAgZ2V0RmllbGRcbiAgfSA9IHVzZVNjaGVtYSgpLCB7XG4gICAgZ2V0RG9jdW1lbnRcbiAgfSA9IHVzZURvY3VtZW50cygpO1xuICBsZXQgdDE7XG4gICRbMF0gIT09IGdldEZpZWxkIHx8ICRbMV0gIT09IG5vZGUgPyAodDEgPSBnZXRGaWVsZChub2RlKSwgJFswXSA9IGdldEZpZWxkLCAkWzFdID0gbm9kZSwgJFsyXSA9IHQxKSA6IHQxID0gJFsyXTtcbiAgY29uc3Qge1xuICAgIGZpZWxkLFxuICAgIHBhcmVudFxuICB9ID0gdDE7XG4gIGxldCB0MjtcbiAgdDIgPSBmaWVsZD8udGl0bGUgfHwgZmllbGQ/Lm5hbWUgfHwgXCJVbmtub3duIHR5cGVcIjtcbiAgY29uc3QgdGl0bGUgPSB0MiwgW2l0ZW1zLCBzZXRJdGVtc10gPSB1c2VTdGF0ZSh2b2lkIDApO1xuICBsZXQgdDMsIHQ0O1xuICAkWzNdICE9PSBmaWVsZCB8fCAkWzRdICE9PSBnZXREb2N1bWVudCB8fCAkWzVdICE9PSBub2RlIHx8ICRbNl0gIT09IHBhcmVudCA/ICh0MyA9ICgpID0+IHtcbiAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZG9jID0gZ2V0RG9jdW1lbnQobm9kZS5pZCk7XG4gICAgICBpZiAoIWRvYylcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY29uc3QgaXRlbXNfMCA9IGF3YWl0IGdldENvbnRleHRNZW51SXRlbXMoe1xuICAgICAgICBub2RlLFxuICAgICAgICBmaWVsZCxcbiAgICAgICAgcGFyZW50LFxuICAgICAgICBkb2NcbiAgICAgIH0pO1xuICAgICAgc2V0SXRlbXMoaXRlbXNfMCk7XG4gICAgfSkoKTtcbiAgfSwgdDQgPSBbZmllbGQsIG5vZGUsIHBhcmVudCwgZ2V0RG9jdW1lbnRdLCAkWzNdID0gZmllbGQsICRbNF0gPSBnZXREb2N1bWVudCwgJFs1XSA9IG5vZGUsICRbNl0gPSBwYXJlbnQsICRbN10gPSB0MywgJFs4XSA9IHQ0KSA6ICh0MyA9ICRbN10sIHQ0ID0gJFs4XSksIHVzZUVmZmVjdCh0MywgdDQpO1xuICBsZXQgdDUsIHQ2O1xuICAkWzldICE9PSB4IHx8ICRbMTBdICE9PSB5ID8gKHQ2ID0ge1xuICAgIGdldEJvdW5kaW5nQ2xpZW50UmVjdDogKCkgPT4gKHtcbiAgICAgIGJvdHRvbTogeSxcbiAgICAgIGxlZnQ6IHgsXG4gICAgICByaWdodDogeCxcbiAgICAgIHRvcDogeSxcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwXG4gICAgfSlcbiAgfSwgJFs5XSA9IHgsICRbMTBdID0geSwgJFsxMV0gPSB0NikgOiB0NiA9ICRbMTFdLCB0NSA9IHQ2O1xuICBjb25zdCBjb250ZXh0TWVudVJlZmVyZW5jZUVsZW1lbnQgPSB0NTtcbiAgbGV0IHQ3LCB0ODtcbiAgJFsxMl0gIT09IGZpZWxkID8gKHQ4ID0gZ2V0Tm9kZUljb24oZmllbGQpLCAkWzEyXSA9IGZpZWxkLCAkWzEzXSA9IHQ4KSA6IHQ4ID0gJFsxM10sIHQ3ID0gdDg7XG4gIGNvbnN0IGljb24gPSB0NztcbiAgbGV0IHQ5O1xuICAkWzE0XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDkgPSB7XG4gICAgbWluV2lkdGg6IDEyMCxcbiAgICBtYXhXaWR0aDogMTYwXG4gIH0sICRbMTRdID0gdDkpIDogdDkgPSAkWzE0XTtcbiAgbGV0IHQxMDtcbiAgJFsxNV0gIT09IGljb24gfHwgJFsxNl0gIT09IGl0ZW1zID8gKHQxMCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goQm94LCB7IGZsZXg6IFwibm9uZVwiLCBjaGlsZHJlbjogaXRlbXMgPyAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMSwgY2hpbGRyZW46IGljb24gfSkgOiAvKiBAX19QVVJFX18gKi8ganN4KFNwaW5uZXIsIHsgc2l6ZTogMSB9KSB9KSwgJFsxNV0gPSBpY29uLCAkWzE2XSA9IGl0ZW1zLCAkWzE3XSA9IHQxMCkgOiB0MTAgPSAkWzE3XTtcbiAgY29uc3QgdDExID0gaXRlbXMgPyB0aXRsZSA6IFwiTG9hZGluZy4uLlwiO1xuICBsZXQgdDEyO1xuICAkWzE4XSAhPT0gdDExID8gKHQxMiA9IC8qIEBfX1BVUkVfXyAqLyBqc3goU3RhY2ssIHsgZmxleDogMSwgc3BhY2U6IDIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMSwgd2VpZ2h0OiBcInNlbWlib2xkXCIsIGNoaWxkcmVuOiB0MTEgfSkgfSksICRbMThdID0gdDExLCAkWzE5XSA9IHQxMikgOiB0MTIgPSAkWzE5XTtcbiAgbGV0IHQxMztcbiAgJFsyMF0gIT09IHQxMCB8fCAkWzIxXSAhPT0gdDEyID8gKHQxMyA9IC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZsZXgsIHsgZ2FwOiAyLCBwYWRkaW5nOiAyLCBjaGlsZHJlbjogW1xuICAgIHQxMCxcbiAgICB0MTJcbiAgXSB9KSwgJFsyMF0gPSB0MTAsICRbMjFdID0gdDEyLCAkWzIyXSA9IHQxMykgOiB0MTMgPSAkWzIyXTtcbiAgbGV0IHQxNDtcbiAgJFsyM10gIT09IGJvdW5kYXJ5RWxlbWVudCB8fCAkWzI0XSAhPT0gaXRlbXMgfHwgJFsyNV0gIT09IG9uRGlzbWlzcyA/ICh0MTQgPSBpdGVtcyAmJiAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudURpdmlkZXIsIHt9KSxcbiAgICBpdGVtcy5tYXAoKGl0ZW0sIGkpID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goQ29udGV4dE1lbnVJdGVtLCB7IG5vZGU6IGl0ZW0sIG9uRGlzbWlzcywgYm91bmRhcnlFbGVtZW50IH0sIGkpKVxuICBdIH0pLCAkWzIzXSA9IGJvdW5kYXJ5RWxlbWVudCwgJFsyNF0gPSBpdGVtcywgJFsyNV0gPSBvbkRpc21pc3MsICRbMjZdID0gdDE0KSA6IHQxNCA9ICRbMjZdO1xuICBsZXQgdDE1O1xuICAkWzI3XSAhPT0gdDEzIHx8ICRbMjhdICE9PSB0MTQgPyAodDE1ID0gLyogQF9fUFVSRV9fICovIGpzeHMoTWVudSwgeyBzdHlsZTogdDksIGNoaWxkcmVuOiBbXG4gICAgdDEzLFxuICAgIHQxNFxuICBdIH0pLCAkWzI3XSA9IHQxMywgJFsyOF0gPSB0MTQsICRbMjldID0gdDE1KSA6IHQxNSA9ICRbMjldO1xuICBjb25zdCB0MTYgPSBgJHt4fS0ke3l9YDtcbiAgbGV0IHQxNztcbiAgJFszMF0gIT09IHggfHwgJFszMV0gIT09IHkgPyAodDE3ID0ge1xuICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgbGVmdDogeCxcbiAgICB0b3A6IHlcbiAgfSwgJFszMF0gPSB4LCAkWzMxXSA9IHksICRbMzJdID0gdDE3KSA6IHQxNyA9ICRbMzJdO1xuICBsZXQgdDE4O1xuICAkWzMzXSAhPT0gdDE2IHx8ICRbMzRdICE9PSB0MTcgPyAodDE4ID0gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IHN0eWxlOiB0MTcgfSwgdDE2KSwgJFszM10gPSB0MTYsICRbMzRdID0gdDE3LCAkWzM1XSA9IHQxOCkgOiB0MTggPSAkWzM1XTtcbiAgbGV0IHQxOTtcbiAgJFszNl0gIT09IGNvbnRleHRNZW51UmVmZXJlbmNlRWxlbWVudCB8fCAkWzM3XSAhPT0gdDE1IHx8ICRbMzhdICE9PSB0MTggPyAodDE5ID0gLyogQF9fUFVSRV9fICovIGpzeChQb3BvdmVyLCB7IF9fdW5zdGFibGVfbWFyZ2luczogUE9QT1ZFUl9NQVJHSU5TLCBhcnJvdzogITEsIG9wZW46ICEwLCBwbGFjZW1lbnQ6IFwicmlnaHQtc3RhcnRcIiwgcmVmZXJlbmNlRWxlbWVudDogY29udGV4dE1lbnVSZWZlcmVuY2VFbGVtZW50LCBjb250ZW50OiB0MTUsIGNoaWxkcmVuOiB0MTggfSksICRbMzZdID0gY29udGV4dE1lbnVSZWZlcmVuY2VFbGVtZW50LCAkWzM3XSA9IHQxNSwgJFszOF0gPSB0MTgsICRbMzldID0gdDE5KSA6IHQxOSA9ICRbMzldO1xuICBsZXQgdDIwO1xuICByZXR1cm4gJFs0MF0gIT09IG9uRGlzbWlzcyB8fCAkWzQxXSAhPT0gdDE5ID8gKHQyMCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9wb3ZlclBvcnRhbCwgeyBzZXRCb3VuZGFyeUVsZW1lbnQsIG9uRGlzbWlzcywgY2hpbGRyZW46IHQxOSB9KSwgJFs0MF0gPSBvbkRpc21pc3MsICRbNDFdID0gdDE5LCAkWzQyXSA9IHQyMCkgOiB0MjAgPSAkWzQyXSwgdDIwO1xufTtcbmZ1bmN0aW9uIGdldExpbmtIcmVmKGhyZWYsIHJlZmVyZXIpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWQgPSBuZXcgVVJMKGhyZWYsIHR5cGVvZiBsb2NhdGlvbiA+IFwidVwiID8gdm9pZCAwIDogbG9jYXRpb24ub3JpZ2luKTtcbiAgICBpZiAocGFyc2VkLmhhc2gpIHtcbiAgICAgIGNvbnN0IGhhc2ggPSBuZXcgVVJMKGdldExpbmtIcmVmKHBhcnNlZC5oYXNoLnNsaWNlKDEpLCByZWZlcmVyKSk7XG4gICAgICByZXR1cm4gYCR7cGFyc2VkLm9yaWdpbn0ke3BhcnNlZC5wYXRobmFtZX0ke3BhcnNlZC5zZWFyY2h9IyR7aGFzaC5wYXRobmFtZX0ke2hhc2guc2VhcmNofWA7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZWQuc2VhcmNoUGFyYW1zLnNldChcInByZXZpZXdcIiwgcmVmZXJlciksIHBhcnNlZC50b1N0cmluZygpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gaHJlZjtcbiAgfVxufVxuY29uc3QgUHJldmlld1NuYXBzaG90c0NvbnRleHQgPSBjcmVhdGVDb250ZXh0KG51bGwpO1xuZnVuY3Rpb24gdXNlUHJldmlld1NuYXBzaG90cygpIHtcbiAgY29uc3QgY29udGV4dCA9IHVzZUNvbnRleHQoUHJldmlld1NuYXBzaG90c0NvbnRleHQpO1xuICBpZiAoIWNvbnRleHQpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUHJldmlldyBTbmFwc2hvdHMgY29udGV4dCBpcyBtaXNzaW5nXCIpO1xuICByZXR1cm4gY29udGV4dDtcbn1cbmNvbnN0IGlzUmVhY3RFbGVtZW50T3ZlcmxheUNvbXBvbmVudCA9IChjb21wb25lbnQpID0+IGlzVmFsaWRFbGVtZW50KGNvbXBvbmVudCksIFJvb3QkMyA9IHN0eWxlZChDYXJkKWBcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tb3ZlcmxheS1iZyk7XG4gIGJvcmRlci1yYWRpdXM6IDNweDtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybTtcbiAgYm94LXNoYWRvdzogdmFyKC0tb3ZlcmxheS1ib3gtc2hhZG93KTtcbiAgdHJhbnNpdGlvbjogbm9uZTtcblxuICAtLW92ZXJsYXktYmc6IHRyYW5zcGFyZW50O1xuICAtLW92ZXJsYXktYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHRyYW5zcGFyZW50O1xuXG4gIFtkYXRhLW92ZXJsYXlzXSAmIHtcbiAgICAtLW92ZXJsYXktYmc6IGNvbG9yLW1peChpbiBzcmdiLCB0cmFuc3BhcmVudCA5NSUsIHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcikpO1xuICAgIC0tb3ZlcmxheS1ib3gtc2hhZG93OiBpbnNldCAwIDAgMCAycHhcbiAgICAgIGNvbG9yLW1peChpbiBzcmdiLCB0cmFuc3BhcmVudCA1MCUsIHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcikpO1xuICB9XG5cbiAgW2RhdGEtZmFkaW5nLW91dF0gJiB7XG4gICAgdHJhbnNpdGlvbjpcbiAgICAgIGJveC1zaGFkb3cgMTU1MG1zLFxuICAgICAgYmFja2dyb3VuZC1jb2xvciAxNTUwbXM7XG5cbiAgICAtLW92ZXJsYXktYmc6IHJnYmEoMCwgMCwgMjU1LCAwKTtcbiAgICAtLW92ZXJsYXktYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHRyYW5zcGFyZW50O1xuICB9XG5cbiAgJltkYXRhLWZvY3VzZWRdIHtcbiAgICAtLW92ZXJsYXktYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcik7XG4gIH1cblxuICAmW2RhdGEtaG92ZXJlZF06bm90KFtkYXRhLWZvY3VzZWRdKSB7XG4gICAgdHJhbnNpdGlvbjogbm9uZTtcbiAgICAtLW92ZXJsYXktYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMnB4IHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcik7XG4gIH1cblxuICAvKiBbZGF0YS11bm1vdW50ZWRdICYge1xuICAgIC0tb3ZlcmxheS1ib3gtc2hhZG93OiBpbnNldCAwIDAgMCAxcHggdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKTtcbiAgfSAqL1xuXG4gIDpsaW5rIHtcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gIH1cbmAsIEFjdGlvbnMgPSBzdHlsZWQoRmxleClgXG4gIGJvdHRvbTogMTAwJTtcbiAgY3Vyc29yOiBwb2ludGVyO1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICByaWdodDogMDtcblxuICBbZGF0YS1ob3ZlcmVkXTpub3QoW2RhdGEtbWVudS1vcGVuXSkgJiB7XG4gICAgcG9pbnRlci1ldmVudHM6IGFsbDtcbiAgfVxuXG4gIFtkYXRhLWZsaXBwZWRdICYge1xuICAgIGJvdHRvbTogYXV0bztcbiAgICB0b3A6IDEwMCU7XG4gIH1cbmAsIEhVRCA9IHN0eWxlZChGbGV4KWBcbiAgdG9wOiAxMDAlO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGxlZnQ6IDA7XG5cbiAgZ2FwOiA0cHg7XG4gIHBhZGRpbmc6IDRweCAwO1xuICBmbGV4LXdyYXA6IHdyYXA7XG5cbiAgW2RhdGEtaG92ZXJlZF06bm90KFtkYXRhLW1lbnUtb3Blbl0pICYge1xuICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gIH1cblxuICBbZGF0YS1mbGlwcGVkXSAmIHtcbiAgICB0b3A6IGNhbGMoMTAwJSArIDJyZW0pO1xuICB9XG5gLCBNZW51V3JhcHBlciA9IHN0eWxlZChGbGV4KWBcbiAgbWFyZ2luOiAtMC41cmVtO1xuXG4gIFtkYXRhLWhvdmVyZWRdOm5vdChbZGF0YS1tZW51LW9wZW5dKSAmIHtcbiAgICBwb2ludGVyLWV2ZW50czogYWxsO1xuICB9XG5gLCBUYWIgPSBzdHlsZWQoRmxleClgXG4gIGJvdHRvbTogMTAwJTtcbiAgY3Vyc29yOiBwb2ludGVyO1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBsZWZ0OiAwO1xuXG4gIFtkYXRhLWhvdmVyZWRdOm5vdChbZGF0YS1tZW51LW9wZW5dKSAmIHtcbiAgICBwb2ludGVyLWV2ZW50czogYWxsO1xuICB9XG5cbiAgW2RhdGEtZmxpcHBlZF0gJiB7XG4gICAgYm90dG9tOiBhdXRvO1xuICAgIHRvcDogMTAwJTtcbiAgfVxuYCwgQWN0aW9uT3BlbiA9IHN0eWxlZChDYXJkKWBcbiAgY3Vyc29yOiBwb2ludGVyO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpO1xuICByaWdodDogMDtcbiAgYm9yZGVyLXJhZGl1czogM3B4O1xuXG4gICYgW2RhdGEtdWk9J1RleHQnXSB7XG4gICAgY29sb3I6ICNmZmY7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgfVxuYCwgTGFiZWxzID0gc3R5bGVkKEZsZXgpYFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpO1xuICByaWdodDogMDtcbiAgYm9yZGVyLXJhZGl1czogM3B4O1xuICAmIFtkYXRhLXVpPSdUZXh0J10sXG4gICYgW2RhdGEtc2FuaXR5LWljb25dIHtcbiAgICBjb2xvcjogI2ZmZjtcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB9XG5gLCBFeGNsdXNpdmVQbHVnaW5Db250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGluc2V0OiAwO1xuICBwb2ludGVyLWV2ZW50czogYWxsO1xuYDtcbmZ1bmN0aW9uIGNyZWF0ZUludGVudExpbmsobm9kZSkge1xuICBjb25zdCB7XG4gICAgaWQsXG4gICAgdHlwZSxcbiAgICBwYXRoLFxuICAgIGJhc2VVcmwsXG4gICAgdG9vbCxcbiAgICB3b3Jrc3BhY2VcbiAgfSA9IG5vZGU7XG4gIHJldHVybiBjcmVhdGVFZGl0VXJsKHtcbiAgICBiYXNlVXJsLFxuICAgIHdvcmtzcGFjZSxcbiAgICB0b29sLFxuICAgIHR5cGUsXG4gICAgaWQsXG4gICAgcGF0aDogcGF0aCA/IHBhdGhUb1VybFN0cmluZyhzdHVkaW9QYXRoLmZyb21TdHJpbmcocGF0aCkpIDogW11cbiAgfSk7XG59XG5jb25zdCBFbGVtZW50T3ZlcmxheUlubmVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDU5KSwge1xuICAgIGlkLFxuICAgIGVsZW1lbnQsXG4gICAgZm9jdXNlZCxcbiAgICBjb21wb25lbnRSZXNvbHZlcixcbiAgICBub2RlLFxuICAgIHNob3dBY3Rpb25zLFxuICAgIGRyYWdnYWJsZSxcbiAgICB0YXJnZXRzLFxuICAgIGVsZW1lbnRUeXBlLFxuICAgIGNvbWxpbmssXG4gICAgb25BY3RpdmF0ZUV4Y2x1c2l2ZVBsdWdpbixcbiAgICBvbk1lbnVPcGVuQ2hhbmdlXG4gIH0gPSBwcm9wcywge1xuICAgIGdldEZpZWxkLFxuICAgIGdldFR5cGVcbiAgfSA9IHVzZVNjaGVtYSgpO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IGdldFR5cGUgfHwgJFsxXSAhPT0gbm9kZSA/ICh0MCA9IGdldFR5cGUobm9kZSksICRbMF0gPSBnZXRUeXBlLCAkWzFdID0gbm9kZSwgJFsyXSA9IHQwKSA6IHQwID0gJFsyXTtcbiAgY29uc3Qgc2NoZW1hVHlwZSA9IHQwO1xuICBsZXQgdDE7XG4gICRbM10gIT09IG5vZGUgPyAodDEgPSBcInBhdGhcIiBpbiBub2RlID8gY3JlYXRlSW50ZW50TGluayhub2RlKSA6IG5vZGUuaHJlZiwgJFszXSA9IG5vZGUsICRbNF0gPSB0MSkgOiB0MSA9ICRbNF07XG4gIGNvbnN0IGhyZWYgPSB0MSwgcHJldmlld1NuYXBzaG90cyA9IHVzZVByZXZpZXdTbmFwc2hvdHMoKTtcbiAgbGV0IHQyO1xuICBiYjA6IHtcbiAgICBpZiAoIShcInBhdGhcIiBpbiBub2RlKSkge1xuICAgICAgdDIgPSB2b2lkIDA7XG4gICAgICBicmVhayBiYjA7XG4gICAgfVxuICAgIGxldCB0MzI7XG4gICAgJFs1XSAhPT0gbm9kZSB8fCAkWzZdICE9PSBwcmV2aWV3U25hcHNob3RzID8gKHQzMiA9IHByZXZpZXdTbmFwc2hvdHMuZmluZCgoc25hcHNob3QpID0+IHNuYXBzaG90Ll9pZCA9PT0gbm9kZS5pZCk/LnRpdGxlLCAkWzVdID0gbm9kZSwgJFs2XSA9IHByZXZpZXdTbmFwc2hvdHMsICRbN10gPSB0MzIpIDogdDMyID0gJFs3XSwgdDIgPSB0MzI7XG4gIH1cbiAgY29uc3QgdGl0bGUgPSB0MjtcbiAgbGV0IHQzLCB0NDtcbiAgJFs4XSAhPT0gZWxlbWVudCB8fCAkWzldICE9PSBmb2N1c2VkIHx8ICRbMTBdICE9PSBnZXRGaWVsZCB8fCAkWzExXSAhPT0gZ2V0VHlwZSA/ICh0NCA9IGZ1bmN0aW9uKG5vZGVfMCwgbm9kZUVsZW1lbnQpIHtcbiAgICBjb25zdCBzY2hlbWFUeXBlXzAgPSBnZXRUeXBlKG5vZGVfMCksIHtcbiAgICAgIGZpZWxkLFxuICAgICAgcGFyZW50XG4gICAgfSA9IGdldEZpZWxkKG5vZGVfMCk7XG4gICAgaWYgKCEoXCJpZFwiIGluIG5vZGVfMCkgfHwgIWZpZWxkIHx8ICFzY2hlbWFUeXBlXzApXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgdHlwZSA9IGZpZWxkLnZhbHVlLnR5cGU7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRvY3VtZW50OiBzY2hlbWFUeXBlXzAsXG4gICAgICBlbGVtZW50LFxuICAgICAgdGFyZ2V0RWxlbWVudDogbm9kZUVsZW1lbnQgfHwgZWxlbWVudCxcbiAgICAgIGZpZWxkLFxuICAgICAgZm9jdXNlZDogISFmb2N1c2VkLFxuICAgICAgbm9kZTogbm9kZV8wLFxuICAgICAgcGFyZW50LFxuICAgICAgdHlwZVxuICAgIH07XG4gIH0sICRbOF0gPSBlbGVtZW50LCAkWzldID0gZm9jdXNlZCwgJFsxMF0gPSBnZXRGaWVsZCwgJFsxMV0gPSBnZXRUeXBlLCAkWzEyXSA9IHQ0KSA6IHQ0ID0gJFsxMl07XG4gIGNvbnN0IGdldENvbnRleHQgPSB0NDtcbiAgbGV0IHQ1O1xuICAkWzEzXSAhPT0gZWxlbWVudFR5cGUgfHwgJFsxNF0gIT09IGdldENvbnRleHQgfHwgJFsxNV0gIT09IG5vZGUgPyAodDUgPSBlbGVtZW50VHlwZSA9PT0gXCJlbGVtZW50XCIgPyBnZXRDb250ZXh0KG5vZGUpIDogdm9pZCAwLCAkWzEzXSA9IGVsZW1lbnRUeXBlLCAkWzE0XSA9IGdldENvbnRleHQsICRbMTVdID0gbm9kZSwgJFsxNl0gPSB0NSkgOiB0NSA9ICRbMTZdO1xuICBsZXQgdDY7XG4gIGlmICgkWzE3XSAhPT0gZ2V0Q29udGV4dCB8fCAkWzE4XSAhPT0gdGFyZ2V0cykge1xuICAgIGxldCB0NzI7XG4gICAgJFsyMF0gIT09IGdldENvbnRleHQgPyAodDcyID0gKHRhcmdldCkgPT4gZ2V0Q29udGV4dCh0YXJnZXQuc2FuaXR5LCB0YXJnZXQuZWxlbWVudCksICRbMjBdID0gZ2V0Q29udGV4dCwgJFsyMV0gPSB0NzIpIDogdDcyID0gJFsyMV0sIHQ2ID0gdGFyZ2V0cy5tYXAodDcyKS5maWx0ZXIoX3RlbXAkOCksICRbMTddID0gZ2V0Q29udGV4dCwgJFsxOF0gPSB0YXJnZXRzLCAkWzE5XSA9IHQ2O1xuICB9IGVsc2VcbiAgICB0NiA9ICRbMTldO1xuICBsZXQgdDc7XG4gICRbMjJdICE9PSB0NSB8fCAkWzIzXSAhPT0gdDYgPyAodDcgPSB7XG4gICAgbGVnYWN5Q29tcG9uZW50Q29udGV4dDogdDUsXG4gICAgcGx1Z2luQ29udGV4dHM6IHQ2XG4gIH0sICRbMjJdID0gdDUsICRbMjNdID0gdDYsICRbMjRdID0gdDcpIDogdDcgPSAkWzI0XSwgdDMgPSB0NztcbiAgY29uc3QgcmVzb2x2ZXJDb250ZXh0cyA9IHQzLCBjdXN0b21Db21wb25lbnRzID0gdXNlQ3VzdG9tQ29tcG9uZW50cyhyZXNvbHZlckNvbnRleHRzLmxlZ2FjeUNvbXBvbmVudENvbnRleHQsIGNvbXBvbmVudFJlc29sdmVyKSwgbm9kZVBsdWdpbkNvbGxlY3Rpb25zID0gdXNlUmVzb2x2ZWROb2RlUGx1Z2lucyhyZXNvbHZlckNvbnRleHRzLnBsdWdpbkNvbnRleHRzLCBwcm9wcy5wbHVnaW5zKTtcbiAgbGV0IHQ4O1xuICAkWzI1XSAhPT0gc2NoZW1hVHlwZSA/ICh0OCA9IHNjaGVtYVR5cGU/Lmljb24gPyAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICBfX2h0bWw6IHNjaGVtYVR5cGUuaWNvblxuICB9IH0pIDogLyogQF9fUFVSRV9fICovIGpzeChEb2N1bWVudEljb24sIHt9KSwgJFsyNV0gPSBzY2hlbWFUeXBlLCAkWzI2XSA9IHQ4KSA6IHQ4ID0gJFsyNl07XG4gIGNvbnN0IGljb24gPSB0OCwgbWVudUlkID0gdXNlSWQoKTtcbiAgbGV0IHQ5O1xuICAkWzI3XSAhPT0gbm9kZVBsdWdpbkNvbGxlY3Rpb25zID8gKHQ5ID0gbm9kZVBsdWdpbkNvbGxlY3Rpb25zPy5zb21lKF90ZW1wMiQ1KSwgJFsyN10gPSBub2RlUGx1Z2luQ29sbGVjdGlvbnMsICRbMjhdID0gdDkpIDogdDkgPSAkWzI4XTtcbiAgY29uc3Qgc2hvd01lbnUgPSB0OSB8fCBub2RlUGx1Z2luQ29sbGVjdGlvbnM/Lmxlbmd0aCA+IDE7XG4gIGxldCB0MTA7XG4gICRbMjldICE9PSBpZCA/ICh0MTAgPSAoKSA9PiB7XG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwic2FuaXR5LW92ZXJsYXkvbGFiZWwtY2xpY2tcIiwge1xuICAgICAgZGV0YWlsOiB7XG4gICAgICAgIGlkXG4gICAgICB9XG4gICAgfSkpO1xuICB9LCAkWzI5XSA9IGlkLCAkWzMwXSA9IHQxMCkgOiB0MTAgPSAkWzMwXTtcbiAgY29uc3QgaGFuZGxlTGFiZWxDbGljayA9IHQxMDtcbiAgbGV0IHQxMTtcbiAgJFszMV0gIT09IGhyZWYgfHwgJFszMl0gIT09IHNob3dBY3Rpb25zID8gKHQxMSA9IHNob3dBY3Rpb25zID8gLyogQF9fUFVSRV9fICovIGpzeChBY3Rpb25zLCB7IGdhcDogMSwgcGFkZGluZ1k6IDEsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KExpbmssIHsgaHJlZiB9KSB9KSA6IG51bGwsICRbMzFdID0gaHJlZiwgJFszMl0gPSBzaG93QWN0aW9ucywgJFszM10gPSB0MTEpIDogdDExID0gJFszM107XG4gIGxldCB0MTI7XG4gICRbMzRdICE9PSBjb21saW5rIHx8ICRbMzVdICE9PSBkcmFnZ2FibGUgfHwgJFszNl0gIT09IGhhbmRsZUxhYmVsQ2xpY2sgfHwgJFszN10gIT09IGljb24gfHwgJFszOF0gIT09IG1lbnVJZCB8fCAkWzM5XSAhPT0gbm9kZVBsdWdpbkNvbGxlY3Rpb25zIHx8ICRbNDBdICE9PSBvbkFjdGl2YXRlRXhjbHVzaXZlUGx1Z2luIHx8ICRbNDFdICE9PSBvbk1lbnVPcGVuQ2hhbmdlIHx8ICRbNDJdICE9PSBzaG93TWVudSB8fCAkWzQzXSAhPT0gdGl0bGUgPyAodDEyID0gKHRpdGxlIHx8IHNob3dNZW51KSAmJiAvKiBAX19QVVJFX18gKi8ganN4KFRhYiwgeyBnYXA6IDEsIHBhZGRpbmdZOiAxLCBvbkNsaWNrOiBoYW5kbGVMYWJlbENsaWNrLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHMoTGFiZWxzLCB7IGdhcDogMiwgcGFkZGluZzogMiwgY2hpbGRyZW46IFtcbiAgICBkcmFnZ2FibGUgJiYgLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgbWFyZ2luUmlnaHQ6IDEsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgY2xhc3NOYW1lOiBcImRyYWctaGFuZGxlXCIsIHNpemU6IDAsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KERyYWdIYW5kbGVJY29uLCB7fSkgfSkgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IHNpemU6IDAsIGNoaWxkcmVuOiBpY29uIH0pLFxuICAgIHRpdGxlICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCB3ZWlnaHQ6IFwibWVkaXVtXCIsIGNoaWxkcmVuOiB0aXRsZSB9KSxcbiAgICBzaG93TWVudSAmJiAvKiBAX19QVVJFX18gKi8ganN4KEJveCwgeyBwYWRkaW5nTGVmdDogMiwgb25DbGljazogX3RlbXAzJDIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVXcmFwcGVyLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVCdXR0b24sIHsgaWQ6IG1lbnVJZCwgcG9wb3Zlcjoge1xuICAgICAgYW5pbWF0ZTogITAsXG4gICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tLXN0YXJ0XCIsXG4gICAgICBjb25zdHJhaW5TaXplOiAhMCxcbiAgICAgIHRvbmU6IFwiZGVmYXVsdFwiXG4gICAgfSwgb25PcGVuOiAoKSA9PiB7XG4gICAgICBvbk1lbnVPcGVuQ2hhbmdlPy4oITApO1xuICAgIH0sIG9uQ2xvc2U6ICgpID0+IHtcbiAgICAgIG9uTWVudU9wZW5DaGFuZ2U/LighMSk7XG4gICAgfSwgYnV0dG9uOiAvKiBAX19QVVJFX18gKi8ganN4KEJ1dHRvbiwgeyBpY29uOiBFbGxpcHNpc1ZlcnRpY2FsSWNvbiwgdG9uZTogXCJwcmltYXJ5XCIsIHBhZGRpbmc6IDIgfSksIG1lbnU6IC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudSwgeyBwYWRkaW5nWTogMCwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9pbnRlckV2ZW50cywgeyBjaGlsZHJlbjogbm9kZVBsdWdpbkNvbGxlY3Rpb25zPy5tYXAoKG5vZGVQbHVnaW5Db2xsZWN0aW9uXzAsIGluZGV4KSA9PiAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCQxLCB7IGNoaWxkcmVuOiBbXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4cyhTdGFjaywgeyByb2xlOiBcImdyb3VwXCIsIHBhZGRpbmdZOiAxLCBzcGFjZTogMCwgY2hpbGRyZW46IFtcbiAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeChNZW51SXRlbSwgeyBwYWRkaW5nWTogMiwgdGV4dDogLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgcGFkZGluZ1k6IDIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgbXV0ZWQ6ICEwLCBzaXplOiAxLCBzdHlsZToge1xuICAgICAgICAgIHRleHRUcmFuc2Zvcm06IFwiY2FwaXRhbGl6ZVwiXG4gICAgICAgIH0sIGNoaWxkcmVuOiBgJHtub2RlUGx1Z2luQ29sbGVjdGlvbl8wLmNvbnRleHQuZG9jdW1lbnQubmFtZX06ICR7bm9kZVBsdWdpbkNvbGxlY3Rpb25fMC5jb250ZXh0LmZpZWxkPy5uYW1lfWAgfSkgfSksIG9uQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICBub2RlUGx1Z2luQ29sbGVjdGlvbl8wLmNvbnRleHQubm9kZSAmJiBjb21saW5rPy5wb3N0KFwidmlzdWFsLWVkaXRpbmcvZm9jdXNcIiwgbm9kZVBsdWdpbkNvbGxlY3Rpb25fMC5jb250ZXh0Lm5vZGUpO1xuICAgICAgICB9IH0pLFxuICAgICAgICBub2RlUGx1Z2luQ29sbGVjdGlvbl8wLmV4Y2x1c2l2ZS5tYXAoKGV4Y2x1c2l2ZSkgPT4gZXhjbHVzaXZlLmNvbXBvbmVudCA/IC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudUl0ZW0sIHsgcGFkZGluZ1k6IDIsIGljb246IGV4Y2x1c2l2ZS5pY29uIHx8IC8qIEBfX1BVUkVfXyAqLyBqc3goUGx1Z0ljb24sIHt9KSwgdGV4dDogLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgcGFkZGluZ1k6IDIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMSwgY2hpbGRyZW46IGV4Y2x1c2l2ZS50aXRsZSB8fCBleGNsdXNpdmUubmFtZSB9KSB9KSwgb25DbGljazogKCkgPT4gb25BY3RpdmF0ZUV4Y2x1c2l2ZVBsdWdpbj8uKGV4Y2x1c2l2ZSwgbm9kZVBsdWdpbkNvbGxlY3Rpb25fMC5jb250ZXh0KSB9LCBleGNsdXNpdmUubmFtZSkgOiBudWxsKVxuICAgICAgXSB9KSxcbiAgICAgIGluZGV4IDwgbm9kZVBsdWdpbkNvbGxlY3Rpb25zLmxlbmd0aCAtIDEgJiYgLyogQF9fUFVSRV9fICovIGpzeChNZW51RGl2aWRlciQxLCB7fSlcbiAgICBdIH0sIG5vZGVQbHVnaW5Db2xsZWN0aW9uXzAuaWQpKSB9KSB9KSB9KSB9KSB9KVxuICBdIH0pIH0pLCAkWzM0XSA9IGNvbWxpbmssICRbMzVdID0gZHJhZ2dhYmxlLCAkWzM2XSA9IGhhbmRsZUxhYmVsQ2xpY2ssICRbMzddID0gaWNvbiwgJFszOF0gPSBtZW51SWQsICRbMzldID0gbm9kZVBsdWdpbkNvbGxlY3Rpb25zLCAkWzQwXSA9IG9uQWN0aXZhdGVFeGNsdXNpdmVQbHVnaW4sICRbNDFdID0gb25NZW51T3BlbkNoYW5nZSwgJFs0Ml0gPSBzaG93TWVudSwgJFs0M10gPSB0aXRsZSwgJFs0NF0gPSB0MTIpIDogdDEyID0gJFs0NF07XG4gIGxldCB0MTM7XG4gICRbNDVdICE9PSBub2RlUGx1Z2luQ29sbGVjdGlvbnMgPyAodDEzID0gbm9kZVBsdWdpbkNvbGxlY3Rpb25zPy5tYXAoX3RlbXA0JDEpLCAkWzQ1XSA9IG5vZGVQbHVnaW5Db2xsZWN0aW9ucywgJFs0Nl0gPSB0MTMpIDogdDEzID0gJFs0Nl07XG4gIGxldCB0MTQ7XG4gICRbNDddICE9PSB0MTMgPyAodDE0ID0gLyogQF9fUFVSRV9fICovIGpzeChIVUQsIHsgY2hpbGRyZW46IHQxMyB9KSwgJFs0N10gPSB0MTMsICRbNDhdID0gdDE0KSA6IHQxNCA9ICRbNDhdO1xuICBsZXQgdDE1O1xuICAkWzQ5XSAhPT0gdDExIHx8ICRbNTBdICE9PSB0MTIgfHwgJFs1MV0gIT09IHQxNCA/ICh0MTUgPSAvKiBAX19QVVJFX18gKi8ganN4cyhQb2ludGVyRXZlbnRzLCB7IGNoaWxkcmVuOiBbXG4gICAgdDExLFxuICAgIHQxMixcbiAgICB0MTRcbiAgXSB9KSwgJFs0OV0gPSB0MTEsICRbNTBdID0gdDEyLCAkWzUxXSA9IHQxNCwgJFs1Ml0gPSB0MTUpIDogdDE1ID0gJFs1Ml07XG4gIGxldCB0MTY7XG4gICRbNTNdICE9PSBjdXN0b21Db21wb25lbnRzIHx8ICRbNTRdICE9PSByZXNvbHZlckNvbnRleHRzLmxlZ2FjeUNvbXBvbmVudENvbnRleHQgPyAodDE2ID0gQXJyYXkuaXNBcnJheShjdXN0b21Db21wb25lbnRzKSA/IGN1c3RvbUNvbXBvbmVudHMubWFwKCh0MTcyLCBpKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgY29tcG9uZW50OiBDb21wb25lbnRfMSxcbiAgICAgIHByb3BzOiBwcm9wc18wXG4gICAgfSA9IHQxNzI7XG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goQ29tcG9uZW50XzEsIHsgUG9pbnRlckV2ZW50cywgLi4ucmVzb2x2ZXJDb250ZXh0cy5sZWdhY3lDb21wb25lbnRDb250ZXh0LCAuLi5wcm9wc18wIH0sIGkpO1xuICB9KSA6IGN1c3RvbUNvbXBvbmVudHMsICRbNTNdID0gY3VzdG9tQ29tcG9uZW50cywgJFs1NF0gPSByZXNvbHZlckNvbnRleHRzLmxlZ2FjeUNvbXBvbmVudENvbnRleHQsICRbNTVdID0gdDE2KSA6IHQxNiA9ICRbNTVdO1xuICBsZXQgdDE3O1xuICByZXR1cm4gJFs1Nl0gIT09IHQxNSB8fCAkWzU3XSAhPT0gdDE2ID8gKHQxNyA9IC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgdDE1LFxuICAgIHQxNlxuICBdIH0pLCAkWzU2XSA9IHQxNSwgJFs1N10gPSB0MTYsICRbNThdID0gdDE3KSA6IHQxNyA9ICRbNThdLCB0MTc7XG59LCBFbGVtZW50T3ZlcmxheSA9IG1lbW8oZnVuY3Rpb24ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoMzgpLCB7XG4gICAgZHJhZ2dhYmxlLFxuICAgIGZvY3VzZWQsXG4gICAgaG92ZXJlZCxcbiAgICByZWN0LFxuICAgIHdhc01heWJlQ29sbGFwc2VkLFxuICAgIGVuYWJsZVNjcm9sbEludG9WaWV3XG4gIH0gPSBwcm9wcywgcmVmID0gdXNlUmVmKG51bGwpLCBzY3JvbGxlZEludG9WaWV3UmVmID0gdXNlUmVmKCExKTtcbiAgbGV0IHQwO1xuICBjb25zdCB0MSA9IGAke3JlY3Qud31weGAsIHQyID0gYCR7cmVjdC5ofXB4YCwgdDMgPSBgdHJhbnNsYXRlKCR7cmVjdC54fXB4LCAke3JlY3QueX1weClgO1xuICBsZXQgdDQ7XG4gICRbMF0gIT09IHQxIHx8ICRbMV0gIT09IHQyIHx8ICRbMl0gIT09IHQzID8gKHQ0ID0ge1xuICAgIHdpZHRoOiB0MSxcbiAgICBoZWlnaHQ6IHQyLFxuICAgIHRyYW5zZm9ybTogdDNcbiAgfSwgJFswXSA9IHQxLCAkWzFdID0gdDIsICRbMl0gPSB0MywgJFszXSA9IHQ0KSA6IHQ0ID0gJFszXSwgdDAgPSB0NDtcbiAgY29uc3Qgc3R5bGUgPSB0MDtcbiAgbGV0IHQ1LCB0NjtcbiAgJFs0XSAhPT0gZW5hYmxlU2Nyb2xsSW50b1ZpZXcgfHwgJFs1XSAhPT0gZm9jdXNlZCB8fCAkWzZdICE9PSB3YXNNYXliZUNvbGxhcHNlZCA/ICh0NSA9ICgpID0+IHtcbiAgICBpZiAoIXNjcm9sbGVkSW50b1ZpZXdSZWYuY3VycmVudCAmJiAhd2FzTWF5YmVDb2xsYXBzZWQgJiYgZm9jdXNlZCA9PT0gITAgJiYgcmVmLmN1cnJlbnQgJiYgZW5hYmxlU2Nyb2xsSW50b1ZpZXcpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IHJlZi5jdXJyZW50O1xuICAgICAgc2Nyb2xsSW50b1ZpZXcocmVmLmN1cnJlbnQsIHtcbiAgICAgICAgYmVoYXZpb3I6IChhY3Rpb25zKSA9PiB7XG4gICAgICAgICAgYWN0aW9ucy5sZW5ndGggIT09IDAgJiYgdGFyZ2V0LnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJlaGF2aW9yOiBcInNtb290aFwiLFxuICAgICAgICAgICAgYmxvY2s6IFwiY2VudGVyXCIsXG4gICAgICAgICAgICBpbmxpbmU6IFwibmVhcmVzdFwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbE1vZGU6IFwiaWYtbmVlZGVkXCIsXG4gICAgICAgIGJsb2NrOiBcImNlbnRlclwiLFxuICAgICAgICBpbmxpbmU6IFwibmVhcmVzdFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgc2Nyb2xsZWRJbnRvVmlld1JlZi5jdXJyZW50ID0gZm9jdXNlZCA9PT0gITA7XG4gIH0sIHQ2ID0gW2ZvY3VzZWQsIHdhc01heWJlQ29sbGFwc2VkLCBlbmFibGVTY3JvbGxJbnRvVmlld10sICRbNF0gPSBlbmFibGVTY3JvbGxJbnRvVmlldywgJFs1XSA9IGZvY3VzZWQsICRbNl0gPSB3YXNNYXliZUNvbGxhcHNlZCwgJFs3XSA9IHQ1LCAkWzhdID0gdDYpIDogKHQ1ID0gJFs3XSwgdDYgPSAkWzhdKSwgdXNlRWZmZWN0KHQ1LCB0Nik7XG4gIGNvbnN0IFtpc05lYXJUb3AsIHNldElzTmVhclRvcF0gPSB1c2VTdGF0ZSghMSk7XG4gIGxldCB0NztcbiAgJFs5XSAhPT0gaG92ZXJlZCA/ICh0NyA9ICgpID0+IHtcbiAgICBpZiAoIXJlZi5jdXJyZW50IHx8ICFob3ZlcmVkKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGlvID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKCh0ODIpID0+IHtcbiAgICAgIGNvbnN0IFtpbnRlcnNlY3Rpb25dID0gdDgyO1xuICAgICAgc2V0SXNOZWFyVG9wKGludGVyc2VjdGlvbi5ib3VuZGluZ0NsaWVudFJlY3QudG9wIDwgMCk7XG4gICAgfSwge1xuICAgICAgdGhyZXNob2xkOiAxXG4gICAgfSk7XG4gICAgcmV0dXJuIGlvLm9ic2VydmUocmVmLmN1cnJlbnQpLCAoKSA9PiBpby5kaXNjb25uZWN0KCk7XG4gIH0sICRbOV0gPSBob3ZlcmVkLCAkWzEwXSA9IHQ3KSA6IHQ3ID0gJFsxMF07XG4gIGxldCB0ODtcbiAgJFsxMV0gIT09IGhvdmVyZWQgfHwgJFsxMl0gIT09IGlzTmVhclRvcCA/ICh0OCA9IFtob3ZlcmVkLCBpc05lYXJUb3BdLCAkWzExXSA9IGhvdmVyZWQsICRbMTJdID0gaXNOZWFyVG9wLCAkWzEzXSA9IHQ4KSA6IHQ4ID0gJFsxM10sIHVzZUVmZmVjdCh0NywgdDgpO1xuICBjb25zdCBbYWN0aXZlRXhjbHVzaXZlUGx1Z2luLCBzZXRBY3RpdmVFeGNsdXNpdmVQbHVnaW5dID0gdXNlU3RhdGUobnVsbCk7XG4gIGxldCB0OTtcbiAgJFsxNF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQ5ID0gKCkgPT4ge1xuICAgIHNldEFjdGl2ZUV4Y2x1c2l2ZVBsdWdpbihudWxsKSwgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwic2FuaXR5LW92ZXJsYXkvZXhjbHVzaXZlLXBsdWdpbi1jbG9zZWRcIikpO1xuICB9LCAkWzE0XSA9IHQ5KSA6IHQ5ID0gJFsxNF07XG4gIGNvbnN0IGNsb3NlRXhjbHVzaXZlUGx1Z2luVmlldyA9IHQ5O1xuICBsZXQgdDEwO1xuICAkWzE1XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDEwID0gKHBsdWdpbiwgY29udGV4dCkgPT4ge1xuICAgIHNldEFjdGl2ZUV4Y2x1c2l2ZVBsdWdpbih7XG4gICAgICBwbHVnaW4sXG4gICAgICBjb250ZXh0XG4gICAgfSk7XG4gIH0sICRbMTVdID0gdDEwKSA6IHQxMCA9ICRbMTVdO1xuICBjb25zdCBvbkFjdGl2YXRlRXhjbHVzaXZlUGx1Z2luID0gdDEwLCBoYW5kbGVFeGNsdXNpdmVQbHVnaW5DbGljayA9IF90ZW1wNSQxLCBFeGNsdXNpdmVQbHVnaW5Db21wb25lbnQgPSBhY3RpdmVFeGNsdXNpdmVQbHVnaW4/LnBsdWdpbi5jb21wb25lbnQsIFttZW51T3Blbiwgc2V0TWVudU9wZW5dID0gdXNlU3RhdGUoITEpO1xuICBsZXQgdDExO1xuICAkWzE2XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDExID0gKCkgPT4ge1xuICAgIHNldE1lbnVPcGVuKCExKTtcbiAgfSwgJFsxNl0gPSB0MTEpIDogdDExID0gJFsxNl07XG4gIGxldCB0MTI7XG4gICRbMTddICE9PSBob3ZlcmVkID8gKHQxMiA9IFtob3ZlcmVkXSwgJFsxN10gPSBob3ZlcmVkLCAkWzE4XSA9IHQxMikgOiB0MTIgPSAkWzE4XSwgdXNlRWZmZWN0KHQxMSwgdDEyKTtcbiAgbGV0IHQxMztcbiAgJFsxOV0gIT09IEV4Y2x1c2l2ZVBsdWdpbkNvbXBvbmVudCB8fCAkWzIwXSAhPT0gbWVudU9wZW4gPyAodDEzID0gbWVudU9wZW4gfHwgRXhjbHVzaXZlUGx1Z2luQ29tcG9uZW50ID8gLyogQF9fUFVSRV9fICovIGpzeChQb3BvdmVyQmFja2dyb3VuZCwgeyBvbkRpc21pc3M6IGNsb3NlRXhjbHVzaXZlUGx1Z2luVmlldywgYmxvY2tTY3JvbGw6IG1lbnVPcGVuIH0pIDogbnVsbCwgJFsxOV0gPSBFeGNsdXNpdmVQbHVnaW5Db21wb25lbnQsICRbMjBdID0gbWVudU9wZW4sICRbMjFdID0gdDEzKSA6IHQxMyA9ICRbMjFdO1xuICBjb25zdCB0MTQgPSBmb2N1c2VkID8gXCJcIiA6IHZvaWQgMCwgdDE1ID0gaG92ZXJlZCA/IFwiXCIgOiB2b2lkIDAsIHQxNiA9IGlzTmVhclRvcCA/IFwiXCIgOiB2b2lkIDAsIHQxNyA9IGRyYWdnYWJsZSA/IFwiXCIgOiB2b2lkIDAsIHQxOCA9IG1lbnVPcGVuID8gXCJcIiA6IHZvaWQgMDtcbiAgbGV0IHQxOTtcbiAgJFsyMl0gIT09IEV4Y2x1c2l2ZVBsdWdpbkNvbXBvbmVudCB8fCAkWzIzXSAhPT0gYWN0aXZlRXhjbHVzaXZlUGx1Z2luIHx8ICRbMjRdICE9PSBob3ZlcmVkIHx8ICRbMjVdICE9PSBwcm9wcyA/ICh0MTkgPSBFeGNsdXNpdmVQbHVnaW5Db21wb25lbnQgPyAvKiBAX19QVVJFX18gKi8ganN4KEV4Y2x1c2l2ZVBsdWdpbkNvbnRhaW5lciwgeyBcImRhdGEtc2FuaXR5LW92ZXJsYXktZWxlbWVudFwiOiAhMCwgb25DbGljazogaGFuZGxlRXhjbHVzaXZlUGx1Z2luQ2xpY2ssIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KEV4Y2x1c2l2ZVBsdWdpbkNvbXBvbmVudCwgeyAuLi5hY3RpdmVFeGNsdXNpdmVQbHVnaW4uY29udGV4dCwgY2xvc2VFeGNsdXNpdmVWaWV3OiBjbG9zZUV4Y2x1c2l2ZVBsdWdpblZpZXcgfSkgfSkgOiBob3ZlcmVkID8gLyogQF9fUFVSRV9fICovIGpzeChFbGVtZW50T3ZlcmxheUlubmVyLCB7IC4uLnByb3BzLCBvbkFjdGl2YXRlRXhjbHVzaXZlUGx1Z2luLCBvbk1lbnVPcGVuQ2hhbmdlOiBzZXRNZW51T3BlbiB9KSA6IG51bGwsICRbMjJdID0gRXhjbHVzaXZlUGx1Z2luQ29tcG9uZW50LCAkWzIzXSA9IGFjdGl2ZUV4Y2x1c2l2ZVBsdWdpbiwgJFsyNF0gPSBob3ZlcmVkLCAkWzI1XSA9IHByb3BzLCAkWzI2XSA9IHQxOSkgOiB0MTkgPSAkWzI2XTtcbiAgbGV0IHQyMDtcbiAgJFsyN10gIT09IHN0eWxlIHx8ICRbMjhdICE9PSB0MTQgfHwgJFsyOV0gIT09IHQxNSB8fCAkWzMwXSAhPT0gdDE2IHx8ICRbMzFdICE9PSB0MTcgfHwgJFszMl0gIT09IHQxOCB8fCAkWzMzXSAhPT0gdDE5ID8gKHQyMCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUm9vdCQzLCB7IFwiZGF0YS1mb2N1c2VkXCI6IHQxNCwgXCJkYXRhLWhvdmVyZWRcIjogdDE1LCBcImRhdGEtZmxpcHBlZFwiOiB0MTYsIFwiZGF0YS1kcmFnZ2FibGVcIjogdDE3LCBcImRhdGEtbWVudS1vcGVuXCI6IHQxOCwgcmVmLCBzdHlsZSwgY2hpbGRyZW46IHQxOSB9KSwgJFsyN10gPSBzdHlsZSwgJFsyOF0gPSB0MTQsICRbMjldID0gdDE1LCAkWzMwXSA9IHQxNiwgJFszMV0gPSB0MTcsICRbMzJdID0gdDE4LCAkWzMzXSA9IHQxOSwgJFszNF0gPSB0MjApIDogdDIwID0gJFszNF07XG4gIGxldCB0MjE7XG4gIHJldHVybiAkWzM1XSAhPT0gdDEzIHx8ICRbMzZdICE9PSB0MjAgPyAodDIxID0gLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICB0MTMsXG4gICAgdDIwXG4gIF0gfSksICRbMzVdID0gdDEzLCAkWzM2XSA9IHQyMCwgJFszN10gPSB0MjEpIDogdDIxID0gJFszN10sIHQyMTtcbn0pO1xuZnVuY3Rpb24gdXNlUmVzb2x2ZWROb2RlUGx1Z2lucyhjb21wb25lbnRDb250ZXh0cywgcGx1Z2lucykge1xuICBjb25zdCAkID0gYyg1KTtcbiAgbGV0IHQwLCB0MTtcbiAgaWYgKCRbMF0gIT09IGNvbXBvbmVudENvbnRleHRzIHx8ICRbMV0gIT09IHBsdWdpbnMpIHtcbiAgICBsZXQgdDI7XG4gICAgJFszXSAhPT0gcGx1Z2lucyA/ICh0MiA9IChjb21wb25lbnRDb250ZXh0KSA9PiB7XG4gICAgICBjb25zdCBpbnN0YW5jZSA9IHtcbiAgICAgICAgaWQ6IHY0KCksXG4gICAgICAgIGNvbnRleHQ6IGNvbXBvbmVudENvbnRleHQsXG4gICAgICAgIGh1ZDogW10sXG4gICAgICAgIGV4Y2x1c2l2ZTogW11cbiAgICAgIH07XG4gICAgICByZXR1cm4gcGx1Z2lucz8uZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgICAgIHBsdWdpbi5ndWFyZD8uKGNvbXBvbmVudENvbnRleHQpICYmIChwbHVnaW4udHlwZSA9PT0gXCJodWRcIiAmJiBpbnN0YW5jZS5odWQucHVzaChwbHVnaW4pLCBwbHVnaW4udHlwZSA9PT0gXCJleGNsdXNpdmVcIiAmJiBpbnN0YW5jZS5leGNsdXNpdmUucHVzaChwbHVnaW4pKTtcbiAgICAgIH0pLCBpbnN0YW5jZTtcbiAgICB9LCAkWzNdID0gcGx1Z2lucywgJFs0XSA9IHQyKSA6IHQyID0gJFs0XSwgdDEgPSBjb21wb25lbnRDb250ZXh0cy5tYXAodDIpLCAkWzBdID0gY29tcG9uZW50Q29udGV4dHMsICRbMV0gPSBwbHVnaW5zLCAkWzJdID0gdDE7XG4gIH0gZWxzZVxuICAgIHQxID0gJFsyXTtcbiAgcmV0dXJuIHQwID0gdDEsIHQwO1xufVxuZnVuY3Rpb24gdXNlQ3VzdG9tQ29tcG9uZW50cyhjb21wb25lbnRDb250ZXh0LCBjb21wb25lbnRSZXNvbHZlcikge1xuICBjb25zdCAkID0gYyg0KTtcbiAgbGV0IHQwO1xuICBiYjA6IHtcbiAgICBpZiAoIWNvbXBvbmVudENvbnRleHQpIHtcbiAgICAgIHQwID0gdm9pZCAwO1xuICAgICAgYnJlYWsgYmIwO1xuICAgIH1cbiAgICBsZXQgdDE7XG4gICAgaWYgKCRbMF0gIT09IGNvbXBvbmVudENvbnRleHQgfHwgJFsxXSAhPT0gY29tcG9uZW50UmVzb2x2ZXIpIHtcbiAgICAgIGNvbnN0IHJlc29sdmVkID0gY29tcG9uZW50UmVzb2x2ZXI/Lihjb21wb25lbnRDb250ZXh0KTtcbiAgICAgIGlmICghcmVzb2x2ZWQpIHtcbiAgICAgICAgdDAgPSB2b2lkIDA7XG4gICAgICAgIGJyZWFrIGJiMDtcbiAgICAgIH1cbiAgICAgIGlmIChpc1JlYWN0RWxlbWVudE92ZXJsYXlDb21wb25lbnQocmVzb2x2ZWQpKSB7XG4gICAgICAgIHQwID0gcmVzb2x2ZWQ7XG4gICAgICAgIGJyZWFrIGJiMDtcbiAgICAgIH1cbiAgICAgIHQxID0gKEFycmF5LmlzQXJyYXkocmVzb2x2ZWQpID8gcmVzb2x2ZWQgOiBbcmVzb2x2ZWRdKS5tYXAoX3RlbXA2JDEpLCAkWzBdID0gY29tcG9uZW50Q29udGV4dCwgJFsxXSA9IGNvbXBvbmVudFJlc29sdmVyLCAkWzJdID0gdDEsICRbM10gPSB0MDtcbiAgICB9IGVsc2VcbiAgICAgIHQxID0gJFsyXSwgdDAgPSAkWzNdO1xuICAgIHQwID0gdDE7XG4gIH1cbiAgcmV0dXJuIHQwO1xufVxuZnVuY3Rpb24gX3RlbXA2JDEoY29tcG9uZW50KSB7XG4gIHJldHVybiB0eXBlb2YgY29tcG9uZW50ID09IFwib2JqZWN0XCIgJiYgXCJjb21wb25lbnRcIiBpbiBjb21wb25lbnQgPyBjb21wb25lbnQgOiB7XG4gICAgY29tcG9uZW50LFxuICAgIHByb3BzOiB7fVxuICB9O1xufVxuY29uc3QgTGluayA9IG1lbW8oZnVuY3Rpb24ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoNiksIHJlZmVyZXIgPSB1c2VTeW5jRXh0ZXJuYWxTdG9yZShfdGVtcDckMSwgX3RlbXA4JDEpO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBwcm9wcy5ocmVmIHx8ICRbMV0gIT09IHJlZmVyZXIgPyAodDEgPSBnZXRMaW5rSHJlZihwcm9wcy5ocmVmLCByZWZlcmVyKSwgJFswXSA9IHByb3BzLmhyZWYsICRbMV0gPSByZWZlcmVyLCAkWzJdID0gdDEpIDogdDEgPSAkWzJdLCB0MCA9IHQxO1xuICBjb25zdCBocmVmID0gdDA7XG4gIGxldCB0MjtcbiAgJFszXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDIgPSAvKiBAX19QVVJFX18gKi8ganN4KEFjdGlvbk9wZW4sIHsgcGFkZGluZzogMiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCB3ZWlnaHQ6IFwibWVkaXVtXCIsIGNoaWxkcmVuOiBcIk9wZW4gaW4gU3R1ZGlvXCIgfSkgfSksICRbM10gPSB0MikgOiB0MiA9ICRbM107XG4gIGxldCB0MztcbiAgcmV0dXJuICRbNF0gIT09IGhyZWYgPyAodDMgPSAvKiBAX19QVVJFX18gKi8ganN4KEJveCwgeyBhczogXCJhXCIsIGhyZWYsIHRhcmdldDogXCJfYmxhbmtcIiwgcmVsOiBcIm5vb3BlbmVyIG5vcmVmZXJyZXJcIiwgY2hpbGRyZW46IHQyIH0pLCAkWzRdID0gaHJlZiwgJFs1XSA9IHQzKSA6IHQzID0gJFs1XSwgdDM7XG59KTtcbmZ1bmN0aW9uIF90ZW1wJDgoY3R4KSB7XG4gIHJldHVybiBjdHggIT09IHZvaWQgMDtcbn1cbmZ1bmN0aW9uIF90ZW1wMiQ1KG5vZGVQbHVnaW5Db2xsZWN0aW9uKSB7XG4gIHJldHVybiBub2RlUGx1Z2luQ29sbGVjdGlvbi5leGNsdXNpdmUubGVuZ3RoID4gMDtcbn1cbmZ1bmN0aW9uIF90ZW1wMyQyKGUpIHtcbiAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbn1cbmZ1bmN0aW9uIF90ZW1wNCQxKG5vZGVQbHVnaW5Db2xsZWN0aW9uXzEpIHtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goRnJhZ21lbnQkMSwgeyBjaGlsZHJlbjogbm9kZVBsdWdpbkNvbGxlY3Rpb25fMS5odWQubWFwKChodWQpID0+IHtcbiAgICBjb25zdCBDb21wb25lbnRfMCA9IGh1ZC5jb21wb25lbnQ7XG4gICAgcmV0dXJuIENvbXBvbmVudF8wID8gLyogQF9fUFVSRV9fICovIGpzeChDb21wb25lbnRfMCwgeyAuLi5ub2RlUGx1Z2luQ29sbGVjdGlvbl8xLmNvbnRleHQgfSwgaHVkLm5hbWUpIDogbnVsbDtcbiAgfSkgfSwgbm9kZVBsdWdpbkNvbGxlY3Rpb25fMS5pZCk7XG59XG5mdW5jdGlvbiBfdGVtcDUkMShldmVudCkge1xuICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbn1cbmZ1bmN0aW9uIF90ZW1wNyQxKG9uU3RvcmVDaGFuZ2UpIHtcbiAgY29uc3QgaGFuZGxlUG9wU3RhdGUgPSAoKSA9PiBvblN0b3JlQ2hhbmdlKCk7XG4gIHJldHVybiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIGhhbmRsZVBvcFN0YXRlKSwgKCkgPT4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCBoYW5kbGVQb3BTdGF0ZSk7XG59XG5mdW5jdGlvbiBfdGVtcDgkMSgpIHtcbiAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xufVxuY29uc3QgT3ZlcmxheURyYWdHcm91cFJlY3QgPSAodDApID0+IHtcbiAgY29uc3QgJCA9IGMoNSksIHtcbiAgICBkcmFnR3JvdXBSZWN0XG4gIH0gPSB0MCwgdDEgPSBgJHtkcmFnR3JvdXBSZWN0Lnl9cHhgLCB0MiA9IGAke2RyYWdHcm91cFJlY3QueH1weGAsIHQzID0gYCR7ZHJhZ0dyb3VwUmVjdC53IC0gMX1weGAsIHQ0ID0gYCR7ZHJhZ0dyb3VwUmVjdC5oIC0gMX1weGA7XG4gIGxldCB0NTtcbiAgcmV0dXJuICRbMF0gIT09IHQxIHx8ICRbMV0gIT09IHQyIHx8ICRbMl0gIT09IHQzIHx8ICRbM10gIT09IHQ0ID8gKHQ1ID0gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IHN0eWxlOiB7XG4gICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICB0b3A6IHQxLFxuICAgIGxlZnQ6IHQyLFxuICAgIHdpZHRoOiB0MyxcbiAgICBoZWlnaHQ6IHQ0LFxuICAgIGJvcmRlcjogXCIxcHggZGFzaGVkICNmMDcwOWJcIixcbiAgICBwb2ludGVyRXZlbnRzOiBcIm5vbmVcIlxuICB9IH0pLCAkWzBdID0gdDEsICRbMV0gPSB0MiwgJFsyXSA9IHQzLCAkWzNdID0gdDQsICRbNF0gPSB0NSkgOiB0NSA9ICRbNF0sIHQ1O1xufSwgbWFya2VyVGhpY2tuZXNzID0gNjtcbmZ1bmN0aW9uIGxlcnAodjAsIHYxLCB0KSB7XG4gIHJldHVybiB2MCAqICgxIC0gdCkgKyB2MSAqIHQ7XG59XG5jb25zdCBPdmVybGF5RHJhZ0luc2VydE1hcmtlciA9ICh0MCkgPT4ge1xuICBjb25zdCAkID0gYyg0KSwge1xuICAgIGRyYWdJbnNlcnRQb3NpdGlvblxuICB9ID0gdDA7XG4gIGlmIChkcmFnSW5zZXJ0UG9zaXRpb24gPT09IG51bGwpXG4gICAgcmV0dXJuO1xuICBjb25zdCBmbG93ID0gZHJhZ0luc2VydFBvc2l0aW9uPy5sZWZ0IHx8IGRyYWdJbnNlcnRQb3NpdGlvbj8ucmlnaHQgPyBcImhvcml6b250YWxcIiA6IFwidmVydGljYWxcIjtcbiAgbGV0IHggPSAwLCB5ID0gMCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwO1xuICBpZiAoZmxvdyA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICBjb25zdCB7XG4gICAgICBsZWZ0LFxuICAgICAgcmlnaHRcbiAgICB9ID0gZHJhZ0luc2VydFBvc2l0aW9uO1xuICAgIGlmICh3aWR0aCA9IG1hcmtlclRoaWNrbmVzcywgcmlnaHQgJiYgbGVmdCkge1xuICAgICAgY29uc3Qgc3RhcnRYID0gbGVmdC5yZWN0LnggKyBsZWZ0LnJlY3QudywgZW5kWCA9IHJpZ2h0LnJlY3QueCwgb2Zmc2V0ID0gTWF0aC5taW4ocmlnaHQucmVjdC5oLCBsZWZ0LnJlY3QuaCkgKiAwLjAxMjU7XG4gICAgICB4ID0gbGVycChzdGFydFgsIGVuZFgsIDAuNSkgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB5ID0gbGVmdC5yZWN0LnkgKyBvZmZzZXQsIGhlaWdodCA9IE1hdGgubWluKHJpZ2h0LnJlY3QuaCwgbGVmdC5yZWN0LmgpIC0gb2Zmc2V0ICogMjtcbiAgICB9IGVsc2UgaWYgKHJpZ2h0ICYmICFsZWZ0KSB7XG4gICAgICBjb25zdCBvZmZzZXRfMCA9IHJpZ2h0LnJlY3QuaCAqIDAuMDEyNTtcbiAgICAgIHggPSByaWdodC5yZWN0LnggLSBtYXJrZXJUaGlja25lc3MgLyAyLCB5ID0gcmlnaHQucmVjdC55ICsgb2Zmc2V0XzAsIGhlaWdodCA9IHJpZ2h0LnJlY3QuaCAtIG9mZnNldF8wICogMjtcbiAgICB9IGVsc2UgaWYgKGxlZnQgJiYgIXJpZ2h0KSB7XG4gICAgICBjb25zdCBvZmZzZXRfMSA9IGxlZnQucmVjdC5oICogMC4wMTI1O1xuICAgICAgeCA9IGxlZnQucmVjdC54ICsgbGVmdC5yZWN0LncgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB5ID0gbGVmdC5yZWN0LnkgKyBvZmZzZXRfMSwgaGVpZ2h0ID0gbGVmdC5yZWN0LmggLSBvZmZzZXRfMSAqIDI7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IHtcbiAgICAgIGJvdHRvbSxcbiAgICAgIHRvcFxuICAgIH0gPSBkcmFnSW5zZXJ0UG9zaXRpb247XG4gICAgaWYgKGJvdHRvbSAmJiB0b3ApIHtcbiAgICAgIGNvbnN0IHN0YXJ0WF8wID0gTWF0aC5taW4odG9wLnJlY3QueCwgYm90dG9tLnJlY3QueCksIHN0YXJ0WSA9IHRvcC5yZWN0LnkgKyB0b3AucmVjdC5oLCBlbmRZID0gYm90dG9tLnJlY3QueSwgb2Zmc2V0XzIgPSBNYXRoLm1pbihib3R0b20ucmVjdC53LCB0b3AucmVjdC53KSAqIDAuMDEyNTtcbiAgICAgIGhlaWdodCA9IG1hcmtlclRoaWNrbmVzcywgeCA9IHN0YXJ0WF8wICsgb2Zmc2V0XzIsIHkgPSBsZXJwKHN0YXJ0WSwgZW5kWSwgMC41KSAtIG1hcmtlclRoaWNrbmVzcyAvIDIsIHdpZHRoID0gTWF0aC5tYXgoYm90dG9tLnJlY3QudywgdG9wLnJlY3QudykgLSBvZmZzZXRfMiAqIDI7XG4gICAgfSBlbHNlIGlmIChib3R0b20gJiYgIXRvcCkge1xuICAgICAgY29uc3Qgb2Zmc2V0XzMgPSBib3R0b20ucmVjdC53ICogMC4wMTI1O1xuICAgICAgeCA9IGJvdHRvbS5yZWN0LnggKyBvZmZzZXRfMywgeSA9IGJvdHRvbS5yZWN0LnkgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB3aWR0aCA9IGJvdHRvbS5yZWN0LncgLSBvZmZzZXRfMyAqIDIsIGhlaWdodCA9IG1hcmtlclRoaWNrbmVzcztcbiAgICB9IGVsc2UgaWYgKHRvcCAmJiAhYm90dG9tKSB7XG4gICAgICBjb25zdCBvZmZzZXRfNCA9IHRvcC5yZWN0LncgKiAwLjAxMjU7XG4gICAgICB4ID0gdG9wLnJlY3QueCArIG9mZnNldF80LCB5ID0gdG9wLnJlY3QueSArIHRvcC5yZWN0LmggLSBtYXJrZXJUaGlja25lc3MgLyAyLCB3aWR0aCA9IHRvcC5yZWN0LncgLSBvZmZzZXRfNCAqIDIsIGhlaWdodCA9IG1hcmtlclRoaWNrbmVzcztcbiAgICB9XG4gIH1cbiAgY29uc3QgdDEgPSBgJHt3aWR0aH1weGAsIHQyID0gYCR7aGVpZ2h0fXB4YCwgdDMgPSBgdHJhbnNsYXRlKCR7eH1weCwgJHt5fXB4KWA7XG4gIGxldCB0NDtcbiAgcmV0dXJuICRbMF0gIT09IHQxIHx8ICRbMV0gIT09IHQyIHx8ICRbMl0gIT09IHQzID8gKHQ0ID0gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IHN0eWxlOiB7XG4gICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICB3aWR0aDogdDEsXG4gICAgaGVpZ2h0OiB0MixcbiAgICB0cmFuc2Zvcm06IHQzLFxuICAgIGJhY2tncm91bmQ6IFwiIzU1NmJmY1wiLFxuICAgIGJvcmRlcjogXCIycHggc29saWQgd2hpdGVcIixcbiAgICBib3JkZXJSYWRpdXM6IFwiOTk5cHhcIixcbiAgICB6SW5kZXg6IFwiOTk5OTk5XCJcbiAgfSB9KSwgJFswXSA9IHQxLCAkWzFdID0gdDIsICRbMl0gPSB0MywgJFszXSA9IHQ0KSA6IHQ0ID0gJFszXSwgdDQ7XG59LCBSb290JDIgPSBzdHlsZWQuZGl2YFxuICAtLWRyYWctcHJldmlldy1vcGFjaXR5OiAwLjk4O1xuICAtLWRyYWctcHJldmlldy1za2VsZXRvbi1zdHJva2U6ICNmZmZmZmY7XG5cbiAgQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykge1xuICAgIC0tZHJhZy1wcmV2aWV3LXNrZWxldG9uLXN0cm9rZTogIzM4M2Q1MTtcbiAgfVxuXG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgZGlzcGxheTogZ3JpZDtcbiAgdHJhbnNmb3JtOiAkeyh7XG4gICRzY2FsZUZhY3RvcixcbiAgJHdpZHRoLFxuICAkaGVpZ2h0XG59KSA9PiBgdHJhbnNsYXRlKGNhbGModmFyKC0tZHJhZy1wcmV2aWV3LXgpIC0gJHskd2lkdGggLyAyfXB4KSwgY2FsYyh2YXIoLS1kcmFnLXByZXZpZXcteSkgLSAkeyRoZWlnaHQgLyAyfXB4KSkgc2NhbGUoJHskc2NhbGVGYWN0b3J9KWB9O1xuICB3aWR0aDogJHsoe1xuICAkd2lkdGhcbn0pID0+IGAkeyR3aWR0aH1weGB9O1xuICBoZWlnaHQ6ICR7KHtcbiAgJGhlaWdodFxufSkgPT4gYCR7JGhlaWdodH1weGB9O1xuICB6LWluZGV4OiA5OTk5OTk5O1xuICBvcGFjaXR5OiB2YXIoLS1kcmFnLXByZXZpZXctb3BhY2l0eSk7XG4gIGN1cnNvcjogbW92ZTtcblxuICAuZHJhZy1wcmV2aWV3LWNvbnRlbnQtd3JhcHBlciB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgICBjb250YWluZXItdHlwZTogaW5saW5lLXNpemU7XG4gIH1cblxuICBbZGF0YS11aT0nY2FyZCddIHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICB9XG5cbiAgLmRyYWctcHJldmlldy1za2VsZXRvbiB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIGluc2V0OiAwO1xuXG4gICAgcmVjdCB7XG4gICAgICBzdHJva2U6IHZhcigtLWRyYWctcHJldmlldy1za2VsZXRvbi1zdHJva2UpO1xuICAgIH1cbiAgfVxuXG4gIC5kcmFnLXByZXZpZXctaGFuZGxlIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiA0Y3FtaW47XG4gICAgbGVmdDogNGNxbWluO1xuICAgIHdpZHRoOiA2Y3FtaW47XG4gICAgZmlsbDogdmFyKC0tZHJhZy1wcmV2aWV3LWhhbmRsZS1maWxsKTtcbiAgfVxuYDtcbmZ1bmN0aW9uIGNsYW1wKG51bWJlciwgbWluLCBtYXgpIHtcbiAgcmV0dXJuIG51bWJlciA8IG1pbiA/IG1pbiA6IG51bWJlciA+IG1heCA/IG1heCA6IG51bWJlcjtcbn1cbmZ1bmN0aW9uIG1hcChudW1iZXIsIGluTWluLCBpbk1heCwgb3V0TWluLCBvdXRNYXgpIHtcbiAgY29uc3QgbWFwcGVkID0gKG51bWJlciAtIGluTWluKSAqIChvdXRNYXggLSBvdXRNaW4pIC8gKGluTWF4IC0gaW5NaW4pICsgb3V0TWluO1xuICByZXR1cm4gY2xhbXAobWFwcGVkLCBvdXRNaW4sIG91dE1heCk7XG59XG5jb25zdCBPdmVybGF5RHJhZ1ByZXZpZXcgPSAodDApID0+IHtcbiAgY29uc3QgJCA9IGMoNTApLCB7XG4gICAgc2tlbGV0b25cbiAgfSA9IHQwLCBtYXhTa2VsZXRvbldpZHRoID0gTWF0aC5taW4oc2tlbGV0b24ubWF4V2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoIC8gMiksIHNjYWxlRmFjdG9yID0gc2tlbGV0b24udyA+IG1heFNrZWxldG9uV2lkdGggPyBtYXhTa2VsZXRvbldpZHRoIC8gc2tlbGV0b24udyA6IDEsIG9mZnNldFggPSBza2VsZXRvbi5vZmZzZXRYICogc2NhbGVGYWN0b3IsIG9mZnNldFkgPSBza2VsZXRvbi5vZmZzZXRZICogc2NhbGVGYWN0b3IsIHByZWZlcnNEYXJrID0gdXNlUHJlZmVyc0RhcmsoKSwgdGhlbWUgPSB1c2VUaGVtZV92MigpLCByYWRpdXMgPSB0aGVtZS5yYWRpdXNbfn5tYXAoc2tlbGV0b24udywgMCwgMTkyMCwgMSwgdGhlbWUucmFkaXVzLmxlbmd0aCAtIDIpXTtcbiAgbGV0IFQwLCBUMSwgdDEsIHQxMCwgdDExLCB0MTIsIHQxMywgdDE0LCB0MiwgdDMsIHQ0LCB0NSwgdDYsIHQ3LCB0OCwgdDk7XG4gIGlmICgkWzBdICE9PSBvZmZzZXRYIHx8ICRbMV0gIT09IG9mZnNldFkgfHwgJFsyXSAhPT0gcHJlZmVyc0RhcmsgfHwgJFszXSAhPT0gcmFkaXVzIHx8ICRbNF0gIT09IHNjYWxlRmFjdG9yIHx8ICRbNV0gIT09IHNrZWxldG9uLmNoaWxkUmVjdHMgfHwgJFs2XSAhPT0gc2tlbGV0b24uaCB8fCAkWzddICE9PSBza2VsZXRvbi53KSB7XG4gICAgY29uc3QgaW1hZ2VSZWN0cyA9IHNrZWxldG9uLmNoaWxkUmVjdHMuZmlsdGVyKF90ZW1wJDcpLCB0ZXh0UmVjdHMgPSBza2VsZXRvbi5jaGlsZFJlY3RzLmZpbHRlcihfdGVtcDIkNCk7XG4gICAgVDEgPSBSb290JDIsIHQxMCA9IHNrZWxldG9uLncsIHQxMSA9IHNrZWxldG9uLmgsIHQxMiA9IG9mZnNldFgsIHQxMyA9IG9mZnNldFksIHQxNCA9IHNjYWxlRmFjdG9yLCBUMCA9IENhcmQsIHQ1ID0gcmFkaXVzLCB0NiA9IDQsIHQ3ID0gXCJoaWRkZW5cIiwgdDggPSBcInRyYW5zcGFyZW50XCIsIHQ5ID0gcHJlZmVyc0RhcmsgPyBcImRhcmtcIiA6IFwibGlnaHRcIiwgdDQgPSBcImRyYWctcHJldmlldy1jb250ZW50LXdyYXBwZXJcIiwgdDIgPSBcImRyYWctcHJldmlldy1za2VsZXRvblwiLCB0MyA9IGAwIDAgJHtza2VsZXRvbi53fSAke3NrZWxldG9uLmh9YCwgdDEgPSBbLi4uaW1hZ2VSZWN0cywgLi4udGV4dFJlY3RzXSwgJFswXSA9IG9mZnNldFgsICRbMV0gPSBvZmZzZXRZLCAkWzJdID0gcHJlZmVyc0RhcmssICRbM10gPSByYWRpdXMsICRbNF0gPSBzY2FsZUZhY3RvciwgJFs1XSA9IHNrZWxldG9uLmNoaWxkUmVjdHMsICRbNl0gPSBza2VsZXRvbi5oLCAkWzddID0gc2tlbGV0b24udywgJFs4XSA9IFQwLCAkWzldID0gVDEsICRbMTBdID0gdDEsICRbMTFdID0gdDEwLCAkWzEyXSA9IHQxMSwgJFsxM10gPSB0MTIsICRbMTRdID0gdDEzLCAkWzE1XSA9IHQxNCwgJFsxNl0gPSB0MiwgJFsxN10gPSB0MywgJFsxOF0gPSB0NCwgJFsxOV0gPSB0NSwgJFsyMF0gPSB0NiwgJFsyMV0gPSB0NywgJFsyMl0gPSB0OCwgJFsyM10gPSB0OTtcbiAgfSBlbHNlXG4gICAgVDAgPSAkWzhdLCBUMSA9ICRbOV0sIHQxID0gJFsxMF0sIHQxMCA9ICRbMTFdLCB0MTEgPSAkWzEyXSwgdDEyID0gJFsxM10sIHQxMyA9ICRbMTRdLCB0MTQgPSAkWzE1XSwgdDIgPSAkWzE2XSwgdDMgPSAkWzE3XSwgdDQgPSAkWzE4XSwgdDUgPSAkWzE5XSwgdDYgPSAkWzIwXSwgdDcgPSAkWzIxXSwgdDggPSAkWzIyXSwgdDkgPSAkWzIzXTtcbiAgbGV0IHQxNTtcbiAgJFsyNF0gIT09IHQxIHx8ICRbMjVdICE9PSB0aGVtZS5jb2xvciA/ICh0MTUgPSB0MS5tYXAoKHJfMSwgaSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChcInJlY3RcIiwgeyB4OiByXzEueCwgeTogcl8xLnksIHdpZHRoOiByXzEudywgaGVpZ2h0OiByXzEuaCwgZmlsbDogdGhlbWUuY29sb3Iuc2tlbGV0b24uZnJvbSB9LCBpKSksICRbMjRdID0gdDEsICRbMjVdID0gdGhlbWUuY29sb3IsICRbMjZdID0gdDE1KSA6IHQxNSA9ICRbMjZdO1xuICBsZXQgdDE2O1xuICAkWzI3XSAhPT0gdDE1IHx8ICRbMjhdICE9PSB0MiB8fCAkWzI5XSAhPT0gdDMgPyAodDE2ID0gLyogQF9fUFVSRV9fICovIGpzeChcInN2Z1wiLCB7IGNsYXNzTmFtZTogdDIsIHZpZXdCb3g6IHQzLCBjaGlsZHJlbjogdDE1IH0pLCAkWzI3XSA9IHQxNSwgJFsyOF0gPSB0MiwgJFsyOV0gPSB0MywgJFszMF0gPSB0MTYpIDogdDE2ID0gJFszMF07XG4gIGxldCB0MTc7XG4gICRbMzFdICE9PSB0MTYgfHwgJFszMl0gIT09IHQ0ID8gKHQxNyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IHQ0LCBjaGlsZHJlbjogdDE2IH0pLCAkWzMxXSA9IHQxNiwgJFszMl0gPSB0NCwgJFszM10gPSB0MTcpIDogdDE3ID0gJFszM107XG4gIGxldCB0MTg7XG4gICRbMzRdICE9PSBUMCB8fCAkWzM1XSAhPT0gdDE3IHx8ICRbMzZdICE9PSB0NSB8fCAkWzM3XSAhPT0gdDYgfHwgJFszOF0gIT09IHQ3IHx8ICRbMzldICE9PSB0OCB8fCAkWzQwXSAhPT0gdDkgPyAodDE4ID0gLyogQF9fUFVSRV9fICovIGpzeChUMCwgeyByYWRpdXM6IHQ1LCBzaGFkb3c6IHQ2LCBvdmVyZmxvdzogdDcsIHRvbmU6IHQ4LCBzY2hlbWU6IHQ5LCBjaGlsZHJlbjogdDE3IH0pLCAkWzM0XSA9IFQwLCAkWzM1XSA9IHQxNywgJFszNl0gPSB0NSwgJFszN10gPSB0NiwgJFszOF0gPSB0NywgJFszOV0gPSB0OCwgJFs0MF0gPSB0OSwgJFs0MV0gPSB0MTgpIDogdDE4ID0gJFs0MV07XG4gIGxldCB0MTk7XG4gIHJldHVybiAkWzQyXSAhPT0gVDEgfHwgJFs0M10gIT09IHQxMCB8fCAkWzQ0XSAhPT0gdDExIHx8ICRbNDVdICE9PSB0MTIgfHwgJFs0Nl0gIT09IHQxMyB8fCAkWzQ3XSAhPT0gdDE0IHx8ICRbNDhdICE9PSB0MTggPyAodDE5ID0gLyogQF9fUFVSRV9fICovIGpzeChUMSwgeyAkd2lkdGg6IHQxMCwgJGhlaWdodDogdDExLCAkb2Zmc2V0WDogdDEyLCAkb2Zmc2V0WTogdDEzLCAkc2NhbGVGYWN0b3I6IHQxNCwgY2hpbGRyZW46IHQxOCB9KSwgJFs0Ml0gPSBUMSwgJFs0M10gPSB0MTAsICRbNDRdID0gdDExLCAkWzQ1XSA9IHQxMiwgJFs0Nl0gPSB0MTMsICRbNDddID0gdDE0LCAkWzQ4XSA9IHQxOCwgJFs0OV0gPSB0MTkpIDogdDE5ID0gJFs0OV0sIHQxOTtcbn07XG5mdW5jdGlvbiBfdGVtcCQ3KHIpIHtcbiAgcmV0dXJuIHIudGFnTmFtZSA9PT0gXCJJTUdcIjtcbn1cbmZ1bmN0aW9uIF90ZW1wMiQ0KHJfMCkge1xuICByZXR1cm4gcl8wLnRhZ05hbWUgIT09IFwiSU1HXCI7XG59XG5jb25zdCBSb290JDEgPSBzdHlsZWQoQ2FyZClgXG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgYm90dG9tOiAycmVtO1xuICBsZWZ0OiAycmVtO1xuYCwgT3ZlcmxheU1pbmltYXBQcm9tcHQgPSAoKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDIpO1xuICBsZXQgdDA7XG4gICRbMF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQwID0ge1xuICAgIHpJbmRleDogXCI5OTk5OTlcIlxuICB9LCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBsZXQgdDE7XG4gIHJldHVybiAkWzFdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUm9vdCQxLCB7IHBhZGRpbmc6IDIsIHNoYWRvdzogMiwgcmFkaXVzOiAyLCBzdHlsZTogdDAsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhGbGV4LCB7IGFsaWduOiBcImNlbnRlclwiLCBnYXA6IDIsIGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChIb3RrZXlzLCB7IGtleXM6IFtcIlNoaWZ0XCJdIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCBjaGlsZHJlbjogXCJab29tIE91dFwiIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goRXhwYW5kSWNvbiwge30pXG4gIF0gfSkgfSksICRbMV0gPSB0MSkgOiB0MSA9ICRbMV0sIHQxO1xufSwgZWxlbWVudHNSZWR1Y2VyID0gKGVsZW1lbnRzLCBtZXNzYWdlKSA9PiB7XG4gIGNvbnN0IHtcbiAgICB0eXBlXG4gIH0gPSBtZXNzYWdlO1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIFwiZWxlbWVudC9yZWdpc3RlclwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbmQoKGUpID0+IGUuaWQgPT09IG1lc3NhZ2UuaWQpID8gZWxlbWVudHMgOiBbLi4uZWxlbWVudHMsIHtcbiAgICAgICAgaWQ6IG1lc3NhZ2UuaWQsXG4gICAgICAgIGFjdGl2YXRlZDogITEsXG4gICAgICAgIGVsZW1lbnQ6IG1lc3NhZ2UuZWxlbWVudCxcbiAgICAgICAgZm9jdXNlZDogITEsXG4gICAgICAgIGhvdmVyZWQ6ICExLFxuICAgICAgICByZWN0OiBtZXNzYWdlLnJlY3QsXG4gICAgICAgIHNhbml0eTogbWVzc2FnZS5zYW5pdHksXG4gICAgICAgIGRyYWdEaXNhYmxlZDogbWVzc2FnZS5kcmFnRGlzYWJsZWQsXG4gICAgICAgIHRhcmdldHM6IG1lc3NhZ2UudGFyZ2V0cyxcbiAgICAgICAgZWxlbWVudFR5cGU6IG1lc3NhZ2UuZWxlbWVudFR5cGVcbiAgICAgIH1dO1xuICAgIGNhc2UgXCJlbGVtZW50L2FjdGl2YXRlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICBhY3RpdmF0ZWQ6ICEwXG4gICAgICB9IDogZSk7XG4gICAgY2FzZSBcImVsZW1lbnQvdXBkYXRlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICBzYW5pdHk6IG1lc3NhZ2Uuc2FuaXR5LFxuICAgICAgICByZWN0OiBtZXNzYWdlLnJlY3QsXG4gICAgICAgIHRhcmdldHM6IG1lc3NhZ2UudGFyZ2V0cyxcbiAgICAgICAgZWxlbWVudFR5cGU6IG1lc3NhZ2UuZWxlbWVudFR5cGVcbiAgICAgIH0gOiBlKTtcbiAgICBjYXNlIFwiZWxlbWVudC91bnJlZ2lzdGVyXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMuZmlsdGVyKChlKSA9PiBlLmlkICE9PSBtZXNzYWdlLmlkKTtcbiAgICBjYXNlIFwiZWxlbWVudC9kZWFjdGl2YXRlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICBhY3RpdmF0ZWQ6ICExLFxuICAgICAgICBob3ZlcmVkOiAhMVxuICAgICAgfSA6IGUpO1xuICAgIGNhc2UgXCJlbGVtZW50L21vdXNlZW50ZXJcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+IGUuaWQgPT09IG1lc3NhZ2UuaWQgPyB7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIHJlY3Q6IG1lc3NhZ2UucmVjdCxcbiAgICAgICAgaG92ZXJlZDogITBcbiAgICAgIH0gOiB7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIGhvdmVyZWQ6ICExXG4gICAgICB9KTtcbiAgICBjYXNlIFwiZWxlbWVudC9tb3VzZWxlYXZlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlbGVtZW50KSA9PiBlbGVtZW50LmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lbGVtZW50LFxuICAgICAgICBob3ZlcmVkOiAhMVxuICAgICAgfSA6IGVsZW1lbnQpO1xuICAgIGNhc2UgXCJlbGVtZW50L3VwZGF0ZVJlY3RcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGVsZW1lbnQpID0+IGVsZW1lbnQuaWQgPT09IG1lc3NhZ2UuaWQgPyB7XG4gICAgICAgIC4uLmVsZW1lbnQsXG4gICAgICAgIHJlY3Q6IG1lc3NhZ2UucmVjdFxuICAgICAgfSA6IGVsZW1lbnQpO1xuICAgIGNhc2UgXCJlbGVtZW50L2NsaWNrXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiAoe1xuICAgICAgICAuLi5lLFxuICAgICAgICBmb2N1c2VkOiBlLmlkID09PSBtZXNzYWdlLmlkICYmIFwiY2xpY2tlZFwiXG4gICAgICB9KSk7XG4gICAgY2FzZSBcIm92ZXJsYXkvcmVzZXQtbW91c2Utc3RhdGVcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+ICh7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIGZvY3VzZWQ6ICExLFxuICAgICAgICBob3ZlcmVkOiAhMVxuICAgICAgfSkpO1xuICAgIGNhc2UgXCJvdmVybGF5L2JsdXJcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+ICh7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIGZvY3VzZWQ6ICExXG4gICAgICB9KSk7XG4gICAgY2FzZSBcInByZXNlbnRhdGlvbi9ibHVyXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiAoe1xuICAgICAgICAuLi5lLFxuICAgICAgICBmb2N1c2VkOiAhMVxuICAgICAgfSkpO1xuICAgIGNhc2UgXCJwcmVzZW50YXRpb24vZm9jdXNcIjoge1xuICAgICAgY29uc3QgY2xpY2tlZEVsZW1lbnQgPSBlbGVtZW50cy5maW5kKChlKSA9PiBlLmZvY3VzZWQgPT09IFwiY2xpY2tlZFwiKTtcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+IHtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IFwicGF0aFwiIGluIGUuc2FuaXR5ICYmIGUuc2FuaXR5LmlkID09PSBtZXNzYWdlLmRhdGEuaWQgJiYgZS5zYW5pdHkucGF0aCA9PT0gbWVzc2FnZS5kYXRhLnBhdGg7XG4gICAgICAgIHJldHVybiBjbGlja2VkRWxlbWVudCAmJiBlID09PSBjbGlja2VkRWxlbWVudCAmJiBmb2N1c2VkID8gZSA6IHtcbiAgICAgICAgICAuLi5lLFxuICAgICAgICAgIC8vIE1hcmsgYXMgYSBkdXBlIGlmIGFub3RoZXIgbWF0Y2hpbmcgaXRlbSBoYXMgYmVlbiBjbGlja2VkIHRvIHByZXZlbnRcbiAgICAgICAgICAvLyBzY3JvbGxpbmcsIG90aGVyd2lzZSBqdXN0IHNldCBmb2N1cyBhcyBhIGJvb2xlYW5cbiAgICAgICAgICBmb2N1c2VkOiBmb2N1c2VkICYmIGNsaWNrZWRFbGVtZW50ID8gXCJkdXBsaWNhdGVcIiA6IGZvY3VzZWRcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGVsZW1lbnRzO1xuICB9XG59O1xuZnVuY3Rpb24gb3ZlcmxheVN0YXRlUmVkdWNlcihzdGF0ZSwgbWVzc2FnZSkge1xuICBjb25zdCB7XG4gICAgdHlwZVxuICB9ID0gbWVzc2FnZTtcbiAgbGV0IHtcbiAgICBjb250ZXh0TWVudSxcbiAgICBmb2N1c1BhdGgsXG4gICAgcGVyc3BlY3RpdmUsXG4gICAgaXNEcmFnZ2luZyxcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb24sXG4gICAgZHJhZ1Nob3dNaW5pbWFwLFxuICAgIGRyYWdTaG93TWluaW1hcFByb21wdCxcbiAgICBkcmFnU2tlbGV0b24sXG4gICAgZHJhZ01pbmltYXBUcmFuc2l0aW9uLFxuICAgIGRyYWdHcm91cFJlY3RcbiAgfSA9IHN0YXRlLCB3YXNNYXliZUNvbGxhcHNlZCA9ICExO1xuICBpZiAodHlwZSA9PT0gXCJwcmVzZW50YXRpb24vZm9jdXNcIikge1xuICAgIGNvbnN0IHByZXZGb2N1c1BhdGggPSBzdGF0ZS5mb2N1c1BhdGg7XG4gICAgZm9jdXNQYXRoID0gbWVzc2FnZS5kYXRhLnBhdGgsIHByZXZGb2N1c1BhdGggIT09IGZvY3VzUGF0aCAmJiAod2FzTWF5YmVDb2xsYXBzZWQgPSBwcmV2Rm9jdXNQYXRoLnNsaWNlKGZvY3VzUGF0aC5sZW5ndGgpLnN0YXJ0c1dpdGgoXCJbXCIpKTtcbiAgfVxuICByZXR1cm4gdHlwZSA9PT0gXCJwcmVzZW50YXRpb24vcGVyc3BlY3RpdmVcIiAmJiAocGVyc3BlY3RpdmUgPSBtZXNzYWdlLmRhdGEucGVyc3BlY3RpdmUpLCB0eXBlID09PSBcImVsZW1lbnQvY29udGV4dG1lbnVcIiAmJiAoXCJzYW5pdHlcIiBpbiBtZXNzYWdlID8gY29udGV4dE1lbnUgPSB7XG4gICAgbm9kZTogbWVzc2FnZS5zYW5pdHksXG4gICAgcG9zaXRpb246IG1lc3NhZ2UucG9zaXRpb25cbiAgfSA6IGNvbnRleHRNZW51ID0gbnVsbCksICh0eXBlID09PSBcImVsZW1lbnQvY2xpY2tcIiB8fCB0eXBlID09PSBcImVsZW1lbnQvbW91c2VsZWF2ZVwiIHx8IHR5cGUgPT09IFwib3ZlcmxheS9ibHVyXCIgfHwgdHlwZSA9PT0gXCJwcmVzZW50YXRpb24vYmx1clwiIHx8IHR5cGUgPT09IFwicHJlc2VudGF0aW9uL2ZvY3VzXCIpICYmIChjb250ZXh0TWVudSA9IG51bGwpLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUluc2VydFBvc2l0aW9uXCIgJiYgKGRyYWdJbnNlcnRQb3NpdGlvbiA9IG1lc3NhZ2UuaW5zZXJ0UG9zaXRpb24pLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ1N0YXJ0XCIgJiYgKGlzRHJhZ2dpbmcgPSAhMCksIG1lc3NhZ2UudHlwZSA9PT0gXCJvdmVybGF5L2RyYWdVcGRhdGVTa2VsZXRvblwiICYmIChkcmFnU2tlbGV0b24gPSBtZXNzYWdlLnNrZWxldG9uKSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdFbmRcIiAmJiAoaXNEcmFnZ2luZyA9ICExKSwgbWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBQcm9tcHRcIiAmJiAoZHJhZ1Nob3dNaW5pbWFwUHJvbXB0ID0gbWVzc2FnZS5kaXNwbGF5KSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdTdGFydE1pbmltYXBUcmFuc2l0aW9uXCIgJiYgKGRyYWdNaW5pbWFwVHJhbnNpdGlvbiA9ICEwKSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdFbmRNaW5pbWFwVHJhbnNpdGlvblwiICYmIChkcmFnTWluaW1hcFRyYW5zaXRpb24gPSAhMSksIHR5cGUgPT09IFwib3ZlcmxheS9kcmFnVXBkYXRlR3JvdXBSZWN0XCIgJiYgKGRyYWdHcm91cFJlY3QgPSBtZXNzYWdlLmdyb3VwUmVjdCksIHR5cGUgPT09IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFwiICYmIChkcmFnU2hvd01pbmltYXAgPSBtZXNzYWdlLmRpc3BsYXkpLCB7XG4gICAgLi4uc3RhdGUsXG4gICAgY29udGV4dE1lbnUsXG4gICAgZWxlbWVudHM6IGVsZW1lbnRzUmVkdWNlcihzdGF0ZS5lbGVtZW50cywgbWVzc2FnZSksXG4gICAgZHJhZ0luc2VydFBvc2l0aW9uLFxuICAgIGRyYWdTa2VsZXRvbixcbiAgICBkcmFnR3JvdXBSZWN0LFxuICAgIGlzRHJhZ2dpbmcsXG4gICAgZm9jdXNQYXRoLFxuICAgIHBlcnNwZWN0aXZlLFxuICAgIHdhc01heWJlQ29sbGFwc2VkLFxuICAgIGRyYWdTaG93TWluaW1hcCxcbiAgICBkcmFnU2hvd01pbmltYXBQcm9tcHQsXG4gICAgZHJhZ01pbmltYXBUcmFuc2l0aW9uXG4gIH07XG59XG5jb25zdCBQcmV2aWV3U25hcHNob3RzUHJvdmlkZXIgPSBmdW5jdGlvbihwcm9wcykge1xuICBjb25zdCAkID0gYygxMyksIHtcbiAgICBjb21saW5rLFxuICAgIGNoaWxkcmVuXG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IFtdLCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBjb25zdCBbcHJldmlld1NuYXBzaG90cywgc2V0UHJldmlld1NuYXBzaG90c10gPSB1c2VTdGF0ZSh0MCk7XG4gIGxldCB0MTtcbiAgJFsxXSAhPT0gY29tbGluayA/ICh0MSA9IGFzeW5jIChzaWduYWwpID0+IHtcbiAgICBpZiAoY29tbGluaylcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL3ByZXZpZXctc25hcHNob3RzXCIsIHZvaWQgMCwge1xuICAgICAgICAgIHNpZ25hbCxcbiAgICAgICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgc2V0UHJldmlld1NuYXBzaG90cyhyZXNwb25zZS5zbmFwc2hvdHMpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICB9XG4gIH0sICRbMV0gPSBjb21saW5rLCAkWzJdID0gdDEpIDogdDEgPSAkWzJdO1xuICBjb25zdCBmZXRjaFByZXZpZXdTbmFwc2hvdHMgPSB0MTtcbiAgbGV0IHQyLCB0MztcbiAgJFszXSAhPT0gY29tbGluayB8fCAkWzRdICE9PSBmZXRjaFByZXZpZXdTbmFwc2hvdHMgPyAodDIgPSAoKSA9PiB7XG4gICAgaWYgKCFjb21saW5rKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IHByZXZpZXdTYXBzaG90c0ZldGNoID0gbmV3IEFib3J0Q29udHJvbGxlcigpLCB1bnN1YiA9IGNvbWxpbmsub25TdGF0dXMoKCkgPT4ge1xuICAgICAgZmV0Y2hQcmV2aWV3U25hcHNob3RzKHByZXZpZXdTYXBzaG90c0ZldGNoLnNpZ25hbCk7XG4gICAgfSwgXCJjb25uZWN0ZWRcIik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHByZXZpZXdTYXBzaG90c0ZldGNoLmFib3J0KCksIHVuc3ViKCk7XG4gICAgfTtcbiAgfSwgdDMgPSBbY29tbGluaywgZmV0Y2hQcmV2aWV3U25hcHNob3RzXSwgJFszXSA9IGNvbWxpbmssICRbNF0gPSBmZXRjaFByZXZpZXdTbmFwc2hvdHMsICRbNV0gPSB0MiwgJFs2XSA9IHQzKSA6ICh0MiA9ICRbNV0sIHQzID0gJFs2XSksIHVzZUVmZmVjdCh0MiwgdDMpO1xuICBsZXQgdDQsIHQ1O1xuICAkWzddICE9PSBjb21saW5rID8gKHQ0ID0gKCkgPT4gY29tbGluaz8ub24oXCJwcmVzZW50YXRpb24vcHJldmlldy1zbmFwc2hvdHNcIiwgKGRhdGEpID0+IHtcbiAgICBzZXRQcmV2aWV3U25hcHNob3RzKGRhdGEuc25hcHNob3RzKTtcbiAgfSksIHQ1ID0gW2NvbWxpbmtdLCAkWzddID0gY29tbGluaywgJFs4XSA9IHQ0LCAkWzldID0gdDUpIDogKHQ0ID0gJFs4XSwgdDUgPSAkWzldKSwgdXNlRWZmZWN0KHQ0LCB0NSk7XG4gIGxldCB0NjtcbiAgdDYgPSBwcmV2aWV3U25hcHNob3RzO1xuICBjb25zdCBjb250ZXh0ID0gdDY7XG4gIGxldCB0NztcbiAgcmV0dXJuICRbMTBdICE9PSBjaGlsZHJlbiB8fCAkWzExXSAhPT0gY29udGV4dCA/ICh0NyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUHJldmlld1NuYXBzaG90c0NvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IGNvbnRleHQsIGNoaWxkcmVuIH0pLCAkWzEwXSA9IGNoaWxkcmVuLCAkWzExXSA9IGNvbnRleHQsICRbMTJdID0gdDcpIDogdDcgPSAkWzEyXSwgdDc7XG59O1xuZnVuY3Rpb24gaXNTYW5pdHlOb2RlKG5vZGUpIHtcbiAgcmV0dXJuIFwicGF0aFwiIGluIG5vZGU7XG59XG5mdW5jdGlvbiBpc0RvY3VtZW50U2NoZW1hVHlwZSh0eXBlKSB7XG4gIHJldHVybiB0eXBlLnR5cGUgPT09IFwiZG9jdW1lbnRcIjtcbn1cbmZ1bmN0aW9uIGlzVHlwZVNjaGVtYVR5cGUodHlwZSkge1xuICByZXR1cm4gdHlwZS50eXBlID09PSBcInR5cGVcIjtcbn1cbmZ1bmN0aW9uIHBvcFVua2V5ZWRQYXRoU2VnbWVudHMocGF0aCkge1xuICByZXR1cm4gcGF0aC5zcGxpdChcIi5cIikudG9SZXZlcnNlZCgpLnJlZHVjZSgoYWNjLCBwYXJ0KSA9PiBhY2MubGVuZ3RoID8gW3BhcnQsIC4uLmFjY10gOiBwYXJ0LmluY2x1ZGVzKFwiW19rZXk9PVwiKSA/IFtwYXJ0XSA6IFtdLCBbXSkuam9pbihcIi5cIik7XG59XG5mdW5jdGlvbiBnZXRQYXRoc1dpdGhVbnJlc29sdmVkVHlwZXMoZWxlbWVudHMpIHtcbiAgcmV0dXJuIGVsZW1lbnRzLnJlZHVjZSgoYWNjLCBlbGVtZW50KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgc2FuaXR5XG4gICAgfSA9IGVsZW1lbnQ7XG4gICAgaWYgKCEoXCJpZFwiIGluIHNhbml0eSkgfHwgIXNhbml0eS5wYXRoLmluY2x1ZGVzKFwiW19rZXk9PVwiKSkgcmV0dXJuIGFjYztcbiAgICBjb25zdCBwYXRoID0gcG9wVW5rZXllZFBhdGhTZWdtZW50cyhzYW5pdHkucGF0aCk7XG4gICAgcmV0dXJuIGFjYy5maW5kKChpdGVtKSA9PiBpdGVtLmlkID09PSBzYW5pdHkuaWQgJiYgaXRlbS5wYXRoID09PSBwYXRoKSB8fCBhY2MucHVzaCh7XG4gICAgICBpZDogc2FuaXR5LmlkLFxuICAgICAgcGF0aFxuICAgIH0pLCBhY2M7XG4gIH0sIFtdKTtcbn1cbmNvbnN0IFNjaGVtYVByb3ZpZGVyID0gZnVuY3Rpb24ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoMjIpLCB7XG4gICAgY29tbGluayxcbiAgICBjaGlsZHJlbixcbiAgICBlbGVtZW50c1xuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBjb25zdCBbcmVzb2x2ZWRUeXBlcywgc2V0UmVzb2x2ZWRUeXBlc10gPSB1c2VTdGF0ZSh0MCksIFtzY2hlbWEsIHNldFNjaGVtYV0gPSB1c2VTdGF0ZShudWxsKTtcbiAgbGV0IHQxLCB0MjtcbiAgJFsxXSAhPT0gY29tbGluayA/ICh0MSA9ICgpID0+IHtcbiAgICBpZiAoIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZmV0Y2hTY2hlbWEgPSBhc3luYyBmdW5jdGlvbihzaWduYWwpIHtcbiAgICAgIGlmIChjb21saW5rKVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL3NjaGVtYVwiLCB2b2lkIDAsIHtcbiAgICAgICAgICAgIHNpZ25hbCxcbiAgICAgICAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgc2V0U2NoZW1hKHJlc3BvbnNlLnNjaGVtYSk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICB9XG4gICAgfSwgc2NoZW1hRmV0Y2ggPSBuZXcgQWJvcnRDb250cm9sbGVyKCksIHVuc3ViID0gY29tbGluay5vblN0YXR1cygoKSA9PiB7XG4gICAgICBmZXRjaFNjaGVtYShzY2hlbWFGZXRjaC5zaWduYWwpO1xuICAgIH0sIFwiY29ubmVjdGVkXCIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBzY2hlbWFGZXRjaC5hYm9ydCgpLCB1bnN1YigpO1xuICAgIH07XG4gIH0sIHQyID0gW2NvbWxpbmtdLCAkWzFdID0gY29tbGluaywgJFsyXSA9IHQxLCAkWzNdID0gdDIpIDogKHQxID0gJFsyXSwgdDIgPSAkWzNdKSwgdXNlRWZmZWN0KHQxLCB0Mik7XG4gIGxldCB0MztcbiAgJFs0XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDMgPSBbXSwgJFs0XSA9IHQzKSA6IHQzID0gJFs0XTtcbiAgY29uc3QgcmVwb3J0ZWRQYXRoc1JlZiA9IHVzZVJlZih0MyksIHQ0ID0gdXNlRGVmZXJyZWRWYWx1ZShlbGVtZW50cyk7XG4gIGxldCB0NTtcbiAgJFs1XSAhPT0gdDQgPyAodDUgPSBnZXRQYXRoc1dpdGhVbnJlc29sdmVkVHlwZXModDQpLCAkWzVdID0gdDQsICRbNl0gPSB0NSkgOiB0NSA9ICRbNl07XG4gIGNvbnN0IHBhdGhzID0gdDUsIGNvbnRyb2xsZXJSZWYgPSB1c2VSZWYobnVsbCk7XG4gIGxldCB0NiwgdDc7XG4gICRbN10gIT09IGNvbWxpbmsgfHwgJFs4XSAhPT0gcGF0aHMgPyAodDYgPSAoKSA9PiB7XG4gICAgaWYgKCFwYXRocy5sZW5ndGggfHwgIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgcmVwb3J0UGF0aHMgPSBhc3luYyAocGF0aHNfMCwgc2lnbmFsXzApID0+IHtcbiAgICAgIGNvbnN0IGluaXRpYWxSZXBvcnRlZFBhdGhzID0gcmVwb3J0ZWRQYXRoc1JlZi5jdXJyZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVwb3J0ZWRQYXRoc1JlZi5jdXJyZW50ID0gcGF0aHNfMDtcbiAgICAgICAgY29uc3QgcmVzcG9uc2VfMCA9IGF3YWl0IGNvbWxpbmsuZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9zY2hlbWEtdW5pb24tdHlwZXNcIiwge1xuICAgICAgICAgIHBhdGhzOiBwYXRoc18wXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBzaWduYWw6IHNpZ25hbF8wLFxuICAgICAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2lnbmFsXzAuYWJvcnRlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNldFJlc29sdmVkVHlwZXMocmVzcG9uc2VfMC50eXBlcyksIGNvbnRyb2xsZXJSZWYuY3VycmVudCA9IG51bGw7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgIH1cbiAgICAgIHNpZ25hbF8wLmFib3J0ZWQgJiYgKHJlcG9ydGVkUGF0aHNSZWYuY3VycmVudCA9IGluaXRpYWxSZXBvcnRlZFBhdGhzKTtcbiAgICB9O1xuICAgIHBhdGhzLnNvbWUoKHApID0+ICFyZXBvcnRlZFBhdGhzUmVmLmN1cnJlbnQuZmluZCgodDgyKSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGlkLFxuICAgICAgICBwYXRoXG4gICAgICB9ID0gdDgyO1xuICAgICAgcmV0dXJuIGlkID09PSBwLmlkICYmIHBhdGggPT09IHAucGF0aDtcbiAgICB9KSkgJiYgKGNvbnRyb2xsZXJSZWYuY3VycmVudD8uYWJvcnQoKSwgY29udHJvbGxlclJlZi5jdXJyZW50ID0gbmV3IEFib3J0Q29udHJvbGxlcigpLCByZXBvcnRQYXRocyhwYXRocywgY29udHJvbGxlclJlZi5jdXJyZW50LnNpZ25hbCkpO1xuICB9LCB0NyA9IFtjb21saW5rLCBwYXRoc10sICRbN10gPSBjb21saW5rLCAkWzhdID0gcGF0aHMsICRbOV0gPSB0NiwgJFsxMF0gPSB0NykgOiAodDYgPSAkWzldLCB0NyA9ICRbMTBdKSwgdXNlRWZmZWN0KHQ2LCB0Nyk7XG4gIGxldCB0ODtcbiAgJFsxMV0gIT09IHNjaGVtYSA/ICh0OCA9IChub2RlLCBfdHlwZSkgPT4ge1xuICAgIGNvbnN0IHR5cGUgPSBfdHlwZSB8fCBcImRvY3VtZW50XCI7XG4gICAgaWYgKCFzY2hlbWEgfHwgdHlwZW9mIG5vZGUgIT0gXCJzdHJpbmdcIiAmJiAoIWlzU2FuaXR5Tm9kZShub2RlKSB8fCAhQXJyYXkuaXNBcnJheShzY2hlbWEpKSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBuYW1lID0gdHlwZW9mIG5vZGUgPT0gXCJzdHJpbmdcIiA/IG5vZGUgOiBub2RlLnR5cGUsIGZpbHRlciA9IHR5cGUgPT09IFwiZG9jdW1lbnRcIiA/IGlzRG9jdW1lbnRTY2hlbWFUeXBlIDogaXNUeXBlU2NoZW1hVHlwZTtcbiAgICByZXR1cm4gc2NoZW1hLmZpbHRlcihmaWx0ZXIpLmZpbmQoKHNjaGVtYVR5cGUpID0+IHNjaGVtYVR5cGUubmFtZSA9PT0gbmFtZSk7XG4gIH0sICRbMTFdID0gc2NoZW1hLCAkWzEyXSA9IHQ4KSA6IHQ4ID0gJFsxMl07XG4gIGNvbnN0IGdldFR5cGUgPSB0ODtcbiAgbGV0IHQ5O1xuICAkWzEzXSAhPT0gZ2V0VHlwZSB8fCAkWzE0XSAhPT0gcmVzb2x2ZWRUeXBlcyA/ICh0OSA9IChub2RlXzApID0+IHtcbiAgICBpZiAoIWlzU2FuaXR5Tm9kZShub2RlXzApKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmllbGQ6IHZvaWQgMCxcbiAgICAgICAgcGFyZW50OiB2b2lkIDBcbiAgICAgIH07XG4gICAgY29uc3Qgc2NoZW1hVHlwZV8wID0gZ2V0VHlwZShub2RlXzApO1xuICAgIGlmICghc2NoZW1hVHlwZV8wKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmllbGQ6IHZvaWQgMCxcbiAgICAgICAgcGFyZW50OiB2b2lkIDBcbiAgICAgIH07XG4gICAgZnVuY3Rpb24gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzEsIHBhdGhfMCwgcGFyZW50LCB0MTAyKSB7XG4gICAgICBjb25zdCBwcmV2UGF0aCA9IHQxMDIgPT09IHZvaWQgMCA/IFtdIDogdDEwMjtcbiAgICAgIGlmICghc2NoZW1hVHlwZV8xKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZpZWxkOiB2b2lkIDAsXG4gICAgICAgICAgcGFyZW50OiB2b2lkIDBcbiAgICAgICAgfTtcbiAgICAgIGNvbnN0IFtuZXh0LCAuLi5yZXN0XSA9IHBhdGhfMDtcbiAgICAgIGlmIChcImZpZWxkc1wiIGluIHNjaGVtYVR5cGVfMSkge1xuICAgICAgICBjb25zdCBvYmplY3RGaWVsZCA9IHNjaGVtYVR5cGVfMS5maWVsZHNbbmV4dF07XG4gICAgICAgIGlmICghb2JqZWN0RmllbGQgJiYgXCJyZXN0XCIgaW4gc2NoZW1hVHlwZV8xKVxuICAgICAgICAgIHJldHVybiBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS5yZXN0LCBwYXRoXzAsIHNjaGVtYVR5cGVfMSwgcHJldlBhdGgpO1xuICAgICAgICBpZiAoIXJlc3QubGVuZ3RoKVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZDogb2JqZWN0RmllbGQsXG4gICAgICAgICAgICBwYXJlbnRcbiAgICAgICAgICB9O1xuICAgICAgICBpZiAoIW9iamVjdEZpZWxkKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0BzYW5pdHkvdmlzdWFsLWVkaXRpbmddIE5vIGZpZWxkIGNvdWxkIGJlIHJlc29sdmVkIGF0IHBhdGg6IFwiJHtbLi4ucHJldlBhdGgsIC4uLnBhdGhfMF0uam9pbihcIi5cIil9XCJgKTtcbiAgICAgICAgcmV0dXJuIGZpZWxkRnJvbVBhdGgob2JqZWN0RmllbGQudmFsdWUsIHJlc3QsIHNjaGVtYVR5cGVfMSwgWy4uLnByZXZQYXRoLCBuZXh0XSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoc2NoZW1hVHlwZV8xLnR5cGUgPT09IFwiYXJyYXlcIilcbiAgICAgICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzEub2YsIHBhdGhfMCwgc2NoZW1hVHlwZV8xLCBwcmV2UGF0aCk7XG4gICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJhcnJheUl0ZW1cIilcbiAgICAgICAgICByZXR1cm4gcmVzdC5sZW5ndGggPyBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS52YWx1ZSwgcmVzdCwgc2NoZW1hVHlwZV8xLCBbLi4ucHJldlBhdGgsIG5leHRdKSA6IHtcbiAgICAgICAgICAgIGZpZWxkOiBzY2hlbWFUeXBlXzEsXG4gICAgICAgICAgICBwYXJlbnRcbiAgICAgICAgICB9O1xuICAgICAgICBpZiAoc2NoZW1hVHlwZV8xLnR5cGUgPT09IFwidW5pb25cIikge1xuICAgICAgICAgIGNvbnN0IG5hbWVfMCA9IG5leHQuc3RhcnRzV2l0aChcIltfa2V5PT1cIikgPyByZXNvbHZlZFR5cGVzPy5nZXQobm9kZV8wLmlkKT8uZ2V0KFtwcmV2UGF0aC5qb2luKFwiLlwiKSwgbmV4dF0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oXCJcIikpIDogbmV4dDtcbiAgICAgICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzEub2YuZmluZCgoaXRlbSkgPT4gaXRlbS50eXBlID09PSBcInVuaW9uT3B0aW9uXCIgPyBpdGVtLm5hbWUgPT09IG5hbWVfMCA6IGl0ZW0pLCByZXN0LCBzY2hlbWFUeXBlXzEsIFsuLi5wcmV2UGF0aCwgbmV4dF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJ1bmlvbk9wdGlvblwiKVxuICAgICAgICAgICAgcmV0dXJuIG5leHQgPyBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS52YWx1ZSwgcGF0aF8wLCBzY2hlbWFUeXBlXzEsIHByZXZQYXRoKSA6IHtcbiAgICAgICAgICAgICAgZmllbGQ6IHNjaGVtYVR5cGVfMSxcbiAgICAgICAgICAgICAgcGFyZW50XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJpbmxpbmVcIikge1xuICAgICAgICAgICAgY29uc3QgdHlwZV8wID0gZ2V0VHlwZShzY2hlbWFUeXBlXzEubmFtZSwgXCJ0eXBlXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZpZWxkRnJvbVBhdGgodHlwZV8wLnZhbHVlLCBwYXRoXzAsIHNjaGVtYVR5cGVfMSwgcHJldlBhdGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBbQHNhbml0eS92aXN1YWwtZWRpdGluZ10gTm8gZmllbGQgY291bGQgYmUgcmVzb2x2ZWQgYXQgcGF0aDogXCIke1suLi5wcmV2UGF0aCwgLi4ucGF0aF8wXS5qb2luKFwiLlwiKX1cImApO1xuICAgIH1cbiAgICBjb25zdCBub2RlUGF0aCA9IG5vZGVfMC5wYXRoLnNwbGl0KFwiLlwiKS5mbGF0TWFwKF90ZW1wJDYpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzAsIG5vZGVQYXRoLCB2b2lkIDApO1xuICAgIH0gY2F0Y2ggKHQxMTIpIHtcbiAgICAgIGNvbnN0IGUgPSB0MTEyO1xuICAgICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBFcnJvciAmJiBjb25zb2xlLndhcm4oZS5tZXNzYWdlKSwge1xuICAgICAgICBmaWVsZDogdm9pZCAwLFxuICAgICAgICBwYXJlbnQ6IHZvaWQgMFxuICAgICAgfTtcbiAgICB9XG4gIH0sICRbMTNdID0gZ2V0VHlwZSwgJFsxNF0gPSByZXNvbHZlZFR5cGVzLCAkWzE1XSA9IHQ5KSA6IHQ5ID0gJFsxNV07XG4gIGNvbnN0IGdldEZpZWxkID0gdDk7XG4gIGxldCB0MTAsIHQxMTtcbiAgJFsxNl0gIT09IGdldEZpZWxkIHx8ICRbMTddICE9PSBnZXRUeXBlID8gKHQxMSA9IHtcbiAgICBnZXRGaWVsZCxcbiAgICBnZXRUeXBlXG4gIH0sICRbMTZdID0gZ2V0RmllbGQsICRbMTddID0gZ2V0VHlwZSwgJFsxOF0gPSB0MTEpIDogdDExID0gJFsxOF0sIHQxMCA9IHQxMTtcbiAgY29uc3QgY29udGV4dCA9IHQxMDtcbiAgbGV0IHQxMjtcbiAgcmV0dXJuICRbMTldICE9PSBjaGlsZHJlbiB8fCAkWzIwXSAhPT0gY29udGV4dCA/ICh0MTIgPSAvKiBAX19QVVJFX18gKi8ganN4KFNjaGVtYUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IGNvbnRleHQsIGNoaWxkcmVuIH0pLCAkWzE5XSA9IGNoaWxkcmVuLCAkWzIwXSA9IGNvbnRleHQsICRbMjFdID0gdDEyKSA6IHQxMiA9ICRbMjFdLCB0MTI7XG59O1xuZnVuY3Rpb24gX3RlbXAkNihwYXJ0KSB7XG4gIHJldHVybiBwYXJ0LmluY2x1ZGVzKFwiW1wiKSA/IHBhcnQuc3BsaXQoLyhcXFsuK1xcXSkvLCAyKSA6IFtwYXJ0XTtcbn1cbmNvbnN0IGNyZWF0ZVN0b3JlID0gKGluaXRpYWxTdGF0ZSkgPT4ge1xuICBsZXQgc3RhdGUgPSBpbml0aWFsU3RhdGU7XG4gIGNvbnN0IGdldFN0YXRlID0gKCkgPT4gc3RhdGUsIGxpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gIHJldHVybiB7XG4gICAgZ2V0U3RhdGUsXG4gICAgc2V0U3RhdGU6IChmbikgPT4ge1xuICAgICAgc3RhdGUgPSBmbihzdGF0ZSksIGxpc3RlbmVycy5mb3JFYWNoKChsKSA9PiBsKCkpO1xuICAgIH0sXG4gICAgc3Vic2NyaWJlOiAobGlzdGVuZXIpID0+IChsaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKSwgKCkgPT4gbGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcikpXG4gIH07XG59LCBzdG9yZSA9IGNyZWF0ZVN0b3JlKHt9KSwgU2hhcmVkU3RhdGVQcm92aWRlciA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMSksIHtcbiAgICBjb21saW5rLFxuICAgIGNoaWxkcmVuXG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gY29tbGluayA/ICh0MCA9ICgpID0+IGNvbWxpbms/Lm9uKFwicHJlc2VudGF0aW9uL3NoYXJlZC1zdGF0ZVwiLCBfdGVtcCQ1KSwgdDEgPSBbY29tbGlua10sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDAsICRbMl0gPSB0MSkgOiAodDAgPSAkWzFdLCB0MSA9ICRbMl0pLCB1c2VFZmZlY3QodDAsIHQxKTtcbiAgbGV0IHQyLCB0MztcbiAgJFszXSAhPT0gY29tbGluayA/ICh0MiA9ICgpID0+IHtcbiAgICAoYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGF3YWl0IGNvbWxpbms/LmZldGNoKFwidmlzdWFsLWVkaXRpbmcvc2hhcmVkLXN0YXRlXCIsIHZvaWQgMCwge1xuICAgICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgICAgfSk7XG4gICAgICB2YWx1ZSAmJiBzdG9yZS5zZXRTdGF0ZSgoKSA9PiB2YWx1ZS5zdGF0ZSk7XG4gICAgfSkoKS5jYXRjaChfdGVtcDIkMyk7XG4gIH0sIHQzID0gW2NvbWxpbmtdLCAkWzNdID0gY29tbGluaywgJFs0XSA9IHQyLCAkWzVdID0gdDMpIDogKHQyID0gJFs0XSwgdDMgPSAkWzVdKSwgdXNlRWZmZWN0KHQyLCB0Myk7XG4gIGxldCB0NCwgdDU7XG4gICRbNl0gIT09IGNvbWxpbmsgPyAodDUgPSB7XG4gICAgY29tbGluayxcbiAgICBzdG9yZVxuICB9LCAkWzZdID0gY29tbGluaywgJFs3XSA9IHQ1KSA6IHQ1ID0gJFs3XSwgdDQgPSB0NTtcbiAgY29uc3QgdmFsdWVfMCA9IHQ0O1xuICBsZXQgdDY7XG4gIHJldHVybiAkWzhdICE9PSBjaGlsZHJlbiB8fCAkWzldICE9PSB2YWx1ZV8wID8gKHQ2ID0gLyogQF9fUFVSRV9fICovIGpzeChTaGFyZWRTdGF0ZUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IHZhbHVlXzAsIGNoaWxkcmVuIH0pLCAkWzhdID0gY2hpbGRyZW4sICRbOV0gPSB2YWx1ZV8wLCAkWzEwXSA9IHQ2KSA6IHQ2ID0gJFsxMF0sIHQ2O1xufTtcbmZ1bmN0aW9uIF90ZW1wJDUoZGF0YSkge1xuICBcInZhbHVlXCIgaW4gZGF0YSA/IHN0b3JlLnNldFN0YXRlKChwcmV2KSA9PiAoe1xuICAgIC4uLnByZXYsXG4gICAgW2RhdGEua2V5XTogZGF0YS52YWx1ZVxuICB9KSkgOiBzdG9yZS5zZXRTdGF0ZSgocHJldl8wKSA9PiBPYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXMocHJldl8wKS5maWx0ZXIoKHQwKSA9PiB7XG4gICAgY29uc3QgW2tleV0gPSB0MDtcbiAgICByZXR1cm4ga2V5ICE9PSBkYXRhLmtleTtcbiAgfSkpKTtcbn1cbmZ1bmN0aW9uIF90ZW1wMiQzKHJlYXNvbikge1xuICBjb25zb2xlLmRlYnVnKHJlYXNvbiksIGNvbnNvbGUud2FybihcIltAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nXTogRmFpbGVkIHRvIGZldGNoIHNoYXJlZCBzdGF0ZS4gQ2hlY2sgeW91ciB2ZXJzaW9uIG9mIGBzYW5pdHlgIGlzIHVwLXRvLWRhdGVcIik7XG59XG5jb25zdCBUZWxlbWV0cnlQcm92aWRlciA9ICh0MCkgPT4ge1xuICBjb25zdCAkID0gYyg1KSwge1xuICAgIGNoaWxkcmVuLFxuICAgIGNvbWxpbmtcbiAgfSA9IHQwO1xuICBsZXQgdDE7XG4gICRbMF0gIT09IGNvbWxpbmsgPyAodDEgPSAobmFtZSwgZGF0YSkgPT4ge1xuICAgIGlmICghY29tbGluaylcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBldmVudCA9IGV2ZW50c1tuYW1lXTtcbiAgICBpZiAoZXZlbnQpXG4gICAgICBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy90ZWxlbWV0cnktbG9nXCIsIHtcbiAgICAgICAgZXZlbnQsXG4gICAgICAgIGRhdGFcbiAgICAgIH0pO1xuICAgIGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGVsZW1ldHJ5IGV2ZW50OiAke25hbWV9IGRvZXMgbm90IGV4aXN0YCk7XG4gIH0sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDEpIDogdDEgPSAkWzFdO1xuICBjb25zdCBsb2cgPSB0MTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFsyXSAhPT0gY2hpbGRyZW4gfHwgJFszXSAhPT0gbG9nID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChUZWxlbWV0cnlDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiBsb2csIGNoaWxkcmVuIH0pLCAkWzJdID0gY2hpbGRyZW4sICRbM10gPSBsb2csICRbNF0gPSB0MikgOiB0MiA9ICRbNF0sIHQyO1xufTtcbmZ1bmN0aW9uIHVzZUNvbnRyb2xsZXIoZWxlbWVudCwgaGFuZGxlciwgaW5GcmFtZSwgaW5Qb3BVcCkge1xuICBjb25zdCAkID0gYyg3KSwgb3ZlcmxheUNvbnRyb2xsZXIgPSB1c2VSZWYodm9pZCAwKSwgb3B0aW1pc3RpY0FjdG9yUmVhZHkgPSB1c2VPcHRpbWlzdGljQWN0b3JSZWFkeSgpO1xuICBsZXQgdDAsIHQxO1xuICByZXR1cm4gJFswXSAhPT0gZWxlbWVudCB8fCAkWzFdICE9PSBoYW5kbGVyIHx8ICRbMl0gIT09IGluRnJhbWUgfHwgJFszXSAhPT0gaW5Qb3BVcCB8fCAkWzRdICE9PSBvcHRpbWlzdGljQWN0b3JSZWFkeSA/ICh0MCA9ICgpID0+IHtcbiAgICBpZiAoZWxlbWVudClcbiAgICAgIHJldHVybiBvdmVybGF5Q29udHJvbGxlci5jdXJyZW50ID0gY3JlYXRlT3ZlcmxheUNvbnRyb2xsZXIoe1xuICAgICAgICBoYW5kbGVyLFxuICAgICAgICBvdmVybGF5RWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgaW5GcmFtZSxcbiAgICAgICAgaW5Qb3BVcCxcbiAgICAgICAgb3B0aW1pc3RpY0FjdG9yUmVhZHlcbiAgICAgIH0pLCAoKSA9PiB7XG4gICAgICAgIG92ZXJsYXlDb250cm9sbGVyLmN1cnJlbnQ/LmRlc3Ryb3koKSwgb3ZlcmxheUNvbnRyb2xsZXIuY3VycmVudCA9IHZvaWQgMDtcbiAgICAgIH07XG4gIH0sIHQxID0gW2VsZW1lbnQsIGhhbmRsZXIsIGluRnJhbWUsIGluUG9wVXAsIG9wdGltaXN0aWNBY3RvclJlYWR5XSwgJFswXSA9IGVsZW1lbnQsICRbMV0gPSBoYW5kbGVyLCAkWzJdID0gaW5GcmFtZSwgJFszXSA9IGluUG9wVXAsICRbNF0gPSBvcHRpbWlzdGljQWN0b3JSZWFkeSwgJFs1XSA9IHQwLCAkWzZdID0gdDEpIDogKHQwID0gJFs1XSwgdDEgPSAkWzZdKSwgdXNlRWZmZWN0KHQwLCB0MSksIG92ZXJsYXlDb250cm9sbGVyO1xufVxuZnVuY3Rpb24gdXNlUGVyc3BlY3RpdmVTeW5jKGNvbWxpbmssIGRpc3BhdGNoKSB7XG4gIGNvbnN0ICQgPSBjKDQpO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBjb21saW5rIHx8ICRbMV0gIT09IGRpc3BhdGNoID8gKHQwID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgY29tbGluaz8uZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9mZXRjaC1wZXJzcGVjdGl2ZVwiLCB2b2lkIDAsIHtcbiAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXG4gICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgIH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogXCJwcmVzZW50YXRpb24vcGVyc3BlY3RpdmVcIixcbiAgICAgICAgZGF0YVxuICAgICAgfSk7XG4gICAgfSkuY2F0Y2goX3RlbXAkNCk7XG4gICAgY29uc3QgdW5zdWIgPSBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9wZXJzcGVjdGl2ZVwiLCAoZGF0YV8wKSA9PiB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFwicHJlc2VudGF0aW9uL3BlcnNwZWN0aXZlXCIsXG4gICAgICAgIGRhdGE6IGRhdGFfMFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHVuc3ViPy4oKSwgY29udHJvbGxlci5hYm9ydCgpO1xuICAgIH07XG4gIH0sIHQxID0gW2NvbWxpbmssIGRpc3BhdGNoXSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSBkaXNwYXRjaCwgJFsyXSA9IHQwLCAkWzNdID0gdDEpIDogKHQwID0gJFsyXSwgdDEgPSAkWzNdKSwgdXNlRWZmZWN0KHQwLCB0MSk7XG59XG5mdW5jdGlvbiBfdGVtcCQ0KCkge1xufVxuZnVuY3Rpb24gaXNFcXVhbFNldHMoYSwgYikge1xuICBpZiAoYSA9PT0gYikgcmV0dXJuICEwO1xuICBpZiAoYS5zaXplICE9PSBiLnNpemUpIHJldHVybiAhMTtcbiAgZm9yIChjb25zdCB2YWx1ZSBvZiBhKSBpZiAoIWIuaGFzKHZhbHVlKSkgcmV0dXJuICExO1xuICByZXR1cm4gITA7XG59XG5mdW5jdGlvbiB1c2VSZXBvcnREb2N1bWVudHMoY29tbGluaywgZWxlbWVudHMsIHBlcnNwZWN0aXZlKSB7XG4gIGNvbnN0ICQgPSBjKDcpLCBsYXN0UmVwb3J0ZWQgPSB1c2VSZWYodm9pZCAwKTtcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBjb21saW5rID8gKHQwID0gKGRvY3VtZW50cywgcGVyc3BlY3RpdmVfMCkgPT4ge1xuICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9kb2N1bWVudHNcIiwge1xuICAgICAgZG9jdW1lbnRzLFxuICAgICAgcGVyc3BlY3RpdmU6IHBlcnNwZWN0aXZlXzBcbiAgICB9KTtcbiAgfSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IHJlcG9ydERvY3VtZW50cyA9IHQwO1xuICBsZXQgdDEsIHQyO1xuICAkWzJdICE9PSBlbGVtZW50cyB8fCAkWzNdICE9PSBwZXJzcGVjdGl2ZSB8fCAkWzRdICE9PSByZXBvcnREb2N1bWVudHMgPyAodDEgPSAoKSA9PiB7XG4gICAgY29uc3Qgbm9kZXMgPSBlbGVtZW50cy5tYXAoX3RlbXAkMykuZmlsdGVyKF90ZW1wMiQyKSwgbm9kZUlkcyA9IG5ldyBTZXQobm9kZXMubWFwKF90ZW1wMyQxKSk7XG4gICAgaWYgKCFsYXN0UmVwb3J0ZWQuY3VycmVudCB8fCAhaXNFcXVhbFNldHMobm9kZUlkcywgbGFzdFJlcG9ydGVkLmN1cnJlbnQubm9kZUlkcykgfHwgcGVyc3BlY3RpdmUgIT09IGxhc3RSZXBvcnRlZC5jdXJyZW50LnBlcnNwZWN0aXZlKSB7XG4gICAgICBjb25zdCBkb2N1bWVudHNPblBhZ2UgPSBBcnJheS5mcm9tKG5vZGVJZHMpLm1hcCgoX2lkKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vZGVfMCA9IG5vZGVzLmZpbmQoKG5vZGUpID0+IG5vZGUuaWQgPT09IF9pZCksIHtcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIHByb2plY3RJZDogX3Byb2plY3RJZCxcbiAgICAgICAgICBkYXRhc2V0OiBfZGF0YXNldFxuICAgICAgICB9ID0gbm9kZV8wO1xuICAgICAgICByZXR1cm4gX3Byb2plY3RJZCAmJiBfZGF0YXNldCA/IHtcbiAgICAgICAgICBfaWQsXG4gICAgICAgICAgX3R5cGU6IHR5cGUsXG4gICAgICAgICAgX3Byb2plY3RJZCxcbiAgICAgICAgICBfZGF0YXNldFxuICAgICAgICB9IDoge1xuICAgICAgICAgIF9pZCxcbiAgICAgICAgICBfdHlwZTogdHlwZVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBsYXN0UmVwb3J0ZWQuY3VycmVudCA9IHtcbiAgICAgICAgbm9kZUlkcyxcbiAgICAgICAgcGVyc3BlY3RpdmVcbiAgICAgIH0sIHJlcG9ydERvY3VtZW50cyhkb2N1bWVudHNPblBhZ2UsIHBlcnNwZWN0aXZlKTtcbiAgICB9XG4gIH0sIHQyID0gW2VsZW1lbnRzLCBwZXJzcGVjdGl2ZSwgcmVwb3J0RG9jdW1lbnRzXSwgJFsyXSA9IGVsZW1lbnRzLCAkWzNdID0gcGVyc3BlY3RpdmUsICRbNF0gPSByZXBvcnREb2N1bWVudHMsICRbNV0gPSB0MSwgJFs2XSA9IHQyKSA6ICh0MSA9ICRbNV0sIHQyID0gJFs2XSksIHVzZUVmZmVjdCh0MSwgdDIpO1xufVxuZnVuY3Rpb24gX3RlbXAzJDEoZV8wKSB7XG4gIHJldHVybiBlXzAuaWQ7XG59XG5mdW5jdGlvbiBfdGVtcDIkMihzKSB7XG4gIHJldHVybiAhIXM7XG59XG5mdW5jdGlvbiBfdGVtcCQzKGUpIHtcbiAgY29uc3Qge1xuICAgIHNhbml0eVxuICB9ID0gZTtcbiAgcmV0dXJuICFzYW5pdHkgfHwgIShcImlkXCIgaW4gc2FuaXR5KSA/IG51bGwgOiBzYW5pdHk7XG59XG5jb25zdCBSb290ID0gc3R5bGVkLmRpdmBcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gIGRpcmVjdGlvbjogbHRyO1xuICBpbnNldDogMDtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgei1pbmRleDogJHsoe1xuICAkekluZGV4XG59KSA9PiAkekluZGV4ID8/IFwiOTk5OTk5OVwifTtcbmA7XG5mdW5jdGlvbiByYWYyKGZuKSB7XG4gIGxldCByMCwgcjE7XG4gIHJldHVybiByMCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgcjEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZm4pO1xuICB9KSwgKCkgPT4ge1xuICAgIHIwICE9PSB2b2lkIDAgJiYgY2FuY2VsQW5pbWF0aW9uRnJhbWUocjApLCByMSAhPT0gdm9pZCAwICYmIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHIxKTtcbiAgfTtcbn1cbmNvbnN0IERvY3VtZW50UmVwb3J0ZXIgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoOCksIHtcbiAgICBkb2N1bWVudElkc1xuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDAgPSBbXSwgJFswXSA9IHQwKSA6IHQwID0gJFswXTtcbiAgY29uc3QgW3VuaXF1ZUlkcywgc2V0VW5pcXVlSWRzXSA9IHVzZVN0YXRlKHQwKTtcbiAgbGV0IHQxLCB0MjtcbiAgJFsxXSAhPT0gZG9jdW1lbnRJZHMgPyAodDEgPSAoKSA9PiB7XG4gICAgc2V0VW5pcXVlSWRzKChwcmV2KSA9PiB7XG4gICAgICBjb25zdCBuZXh0ID0gQXJyYXkuZnJvbShuZXcgU2V0KGRvY3VtZW50SWRzKSk7XG4gICAgICByZXR1cm4gcHJldi5sZW5ndGggPT09IG5leHQubGVuZ3RoICYmIHByZXYucmVkdWNlKF90ZW1wJDIsIG5leHQpPy5sZW5ndGggPT09IDAgPyBwcmV2IDogbmV4dDtcbiAgICB9KTtcbiAgfSwgdDIgPSBbZG9jdW1lbnRJZHNdLCAkWzFdID0gZG9jdW1lbnRJZHMsICRbMl0gPSB0MSwgJFszXSA9IHQyKSA6ICh0MSA9ICRbMl0sIHQyID0gJFszXSksIHVzZUVmZmVjdCh0MSwgdDIpO1xuICBjb25zdCBhY3RvciA9IHVzZU9wdGltaXN0aWNBY3RvcigpO1xuICBsZXQgdDMsIHQ0O1xuICByZXR1cm4gJFs0XSAhPT0gYWN0b3IgfHwgJFs1XSAhPT0gdW5pcXVlSWRzID8gKHQzID0gKCkgPT4ge1xuICAgIGZvciAoY29uc3QgaWRfMCBvZiB1bmlxdWVJZHMpXG4gICAgICBhY3Rvci5zZW5kKHtcbiAgICAgICAgdHlwZTogXCJvYnNlcnZlXCIsXG4gICAgICAgIGRvY3VtZW50SWQ6IGdldERyYWZ0SWQoaWRfMClcbiAgICAgIH0pLCBhY3Rvci5zZW5kKHtcbiAgICAgICAgdHlwZTogXCJvYnNlcnZlXCIsXG4gICAgICAgIGRvY3VtZW50SWQ6IGdldFB1Ymxpc2hlZElkKGlkXzApXG4gICAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZm9yIChjb25zdCBpZF8xIG9mIHVuaXF1ZUlkcylcbiAgICAgICAgYWN0b3Iuc2VuZCh7XG4gICAgICAgICAgdHlwZTogXCJ1bm9ic2VydmVcIixcbiAgICAgICAgICBkb2N1bWVudElkOiBnZXREcmFmdElkKGlkXzEpXG4gICAgICAgIH0pLCBhY3Rvci5zZW5kKHtcbiAgICAgICAgICB0eXBlOiBcInVub2JzZXJ2ZVwiLFxuICAgICAgICAgIGRvY3VtZW50SWQ6IGdldFB1Ymxpc2hlZElkKGlkXzEpXG4gICAgICAgIH0pO1xuICAgIH07XG4gIH0sIHQ0ID0gW2FjdG9yLCB1bmlxdWVJZHNdLCAkWzRdID0gYWN0b3IsICRbNV0gPSB1bmlxdWVJZHMsICRbNl0gPSB0MywgJFs3XSA9IHQ0KSA6ICh0MyA9ICRbNl0sIHQ0ID0gJFs3XSksIHVzZUVmZmVjdCh0MywgdDQpLCBudWxsO1xufSwgT3ZlcmxheXNDb250cm9sbGVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDEyKSwge1xuICAgIGNvbWxpbmssXG4gICAgZGlzcGF0Y2gsXG4gICAgaW5GcmFtZSxcbiAgICBpblBvcFVwLFxuICAgIG9uRHJhZyxcbiAgICBvdmVybGF5RW5hYmxlZCxcbiAgICByb290RWxlbWVudFxuICB9ID0gcHJvcHMsIHtcbiAgICBkaXNwYXRjaERyYWdFbmRFdmVudFxuICB9ID0gdXNlRHJhZ0VuZEV2ZW50cygpLCBzZW5kVGVsZW1ldHJ5ID0gdXNlVGVsZW1ldHJ5KCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gY29tbGluayB8fCAkWzFdICE9PSBkaXNwYXRjaCB8fCAkWzJdICE9PSBkaXNwYXRjaERyYWdFbmRFdmVudCB8fCAkWzNdICE9PSBvbkRyYWcgfHwgJFs0XSAhPT0gc2VuZFRlbGVtZXRyeSA/ICh0MCA9IChtZXNzYWdlKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJlbGVtZW50L2NsaWNrXCIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgc2FuaXR5XG4gICAgICB9ID0gbWVzc2FnZTtcbiAgICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9mb2N1c1wiLCBzYW5pdHkpLCBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgT3ZlcmxheSBDbGlja2VkXCIsIG51bGwpO1xuICAgIH0gZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvYWN0aXZhdGVcIilcbiAgICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy90b2dnbGVcIiwge1xuICAgICAgICBlbmFibGVkOiAhMFxuICAgICAgfSk7XG4gICAgZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZGVhY3RpdmF0ZVwiKVxuICAgICAgY29tbGluaz8ucG9zdChcInZpc3VhbC1lZGl0aW5nL3RvZ2dsZVwiLCB7XG4gICAgICAgIGVuYWJsZWQ6ICExXG4gICAgICB9KTtcbiAgICBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9kcmFnRW5kXCIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaW5zZXJ0UG9zaXRpb24sXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgZHJhZ0dyb3VwLFxuICAgICAgICBmbG93LFxuICAgICAgICBwcmV2ZW50SW5zZXJ0RGVmYXVsdFxuICAgICAgfSA9IG1lc3NhZ2U7XG4gICAgICBkaXNwYXRjaERyYWdFbmRFdmVudCh7XG4gICAgICAgIGluc2VydFBvc2l0aW9uLFxuICAgICAgICB0YXJnZXQsXG4gICAgICAgIGRyYWdHcm91cCxcbiAgICAgICAgZmxvdyxcbiAgICAgICAgcHJldmVudEluc2VydERlZmF1bHRcbiAgICAgIH0pLCBpbnNlcnRQb3NpdGlvbiAmJiBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBTZXF1ZW5jZSBDb21wbGV0ZWRcIiwgbnVsbCk7XG4gICAgfSBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9kcmFnVXBkYXRlQ3Vyc29yUG9zaXRpb25cIikge1xuICAgICAgb25EcmFnKG1lc3NhZ2UueCwgbWVzc2FnZS55KTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwXCIgJiYgbWVzc2FnZS5kaXNwbGF5ID09PSAhMClcbiAgICAgIHNlbmRUZWxlbWV0cnkoXCJWaXN1YWwgRWRpdGluZyBEcmFnIE1pbmltYXAgRW5hYmxlZFwiLCBudWxsKTtcbiAgICBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9zZXRDdXJzb3JcIikge1xuICAgICAgY29uc3Qge1xuICAgICAgICBlbGVtZW50LFxuICAgICAgICBjdXJzb3JcbiAgICAgIH0gPSBtZXNzYWdlO1xuICAgICAgY3Vyc29yID8gZWxlbWVudC5zdHlsZS5jdXJzb3IgPSBjdXJzb3IgOiBlbGVtZW50LnN0eWxlLnJlbW92ZVByb3BlcnR5KFwiY3Vyc29yXCIpO1xuICAgIH1cbiAgICBkaXNwYXRjaChtZXNzYWdlKTtcbiAgfSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSBkaXNwYXRjaCwgJFsyXSA9IGRpc3BhdGNoRHJhZ0VuZEV2ZW50LCAkWzNdID0gb25EcmFnLCAkWzRdID0gc2VuZFRlbGVtZXRyeSwgJFs1XSA9IHQwKSA6IHQwID0gJFs1XTtcbiAgY29uc3QgY29udHJvbGxlciA9IHVzZUNvbnRyb2xsZXIocm9vdEVsZW1lbnQsIHQwLCBpbkZyYW1lLCBpblBvcFVwKTtcbiAgbGV0IHQxO1xuICAkWzZdICE9PSBjb250cm9sbGVyLmN1cnJlbnQgfHwgJFs3XSAhPT0gb3ZlcmxheUVuYWJsZWQgPyAodDEgPSAoKSA9PiB7XG4gICAgb3ZlcmxheUVuYWJsZWQgPyBjb250cm9sbGVyLmN1cnJlbnQ/LmFjdGl2YXRlKCkgOiBjb250cm9sbGVyLmN1cnJlbnQ/LmRlYWN0aXZhdGUoKTtcbiAgfSwgJFs2XSA9IGNvbnRyb2xsZXIuY3VycmVudCwgJFs3XSA9IG92ZXJsYXlFbmFibGVkLCAkWzhdID0gdDEpIDogdDEgPSAkWzhdO1xuICBsZXQgdDI7XG4gIHJldHVybiAkWzldICE9PSBjb250cm9sbGVyIHx8ICRbMTBdICE9PSBvdmVybGF5RW5hYmxlZCA/ICh0MiA9IFtjb250cm9sbGVyLCBvdmVybGF5RW5hYmxlZF0sICRbOV0gPSBjb250cm9sbGVyLCAkWzEwXSA9IG92ZXJsYXlFbmFibGVkLCAkWzExXSA9IHQyKSA6IHQyID0gJFsxMV0sIHVzZUVmZmVjdCh0MSwgdDIpLCBudWxsO1xufSwgT3ZlcmxheXMgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoNzYpLCB7XG4gICAgY29tbGluayxcbiAgICBjb21saW5rU3RhdHVzLFxuICAgIGNvbXBvbmVudFJlc29sdmVyOiBfY29tcG9uZW50UmVzb2x2ZXIsXG4gICAgaW5GcmFtZSxcbiAgICBpblBvcFVwLFxuICAgIHpJbmRleFxuICB9ID0gcHJvcHMsIHByZWZlcnNEYXJrID0gdXNlUHJlZmVyc0RhcmsoKTtcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IHtcbiAgICBjb250ZXh0TWVudTogbnVsbCxcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb246IG51bGwsXG4gICAgZHJhZ1Nob3dNaW5pbWFwOiAhMSxcbiAgICBkcmFnU2hvd01pbmltYXBQcm9tcHQ6ICExLFxuICAgIGRyYWdTa2VsZXRvbjogbnVsbCxcbiAgICBlbGVtZW50czogW10sXG4gICAgZm9jdXNQYXRoOiBcIlwiLFxuICAgIGlzRHJhZ2dpbmc6ICExLFxuICAgIHBlcnNwZWN0aXZlOiBcInB1Ymxpc2hlZFwiLFxuICAgIHdhc01heWJlQ29sbGFwc2VkOiAhMSxcbiAgICBkcmFnTWluaW1hcFRyYW5zaXRpb246ICExLFxuICAgIGRyYWdHcm91cFJlY3Q6IG51bGxcbiAgfSwgJFswXSA9IHQwKSA6IHQwID0gJFswXTtcbiAgY29uc3QgW3QxLCBkaXNwYXRjaF0gPSB1c2VSZWR1Y2VyKG92ZXJsYXlTdGF0ZVJlZHVjZXIsIHQwKSwge1xuICAgIGNvbnRleHRNZW51LFxuICAgIGRyYWdJbnNlcnRQb3NpdGlvbixcbiAgICBkcmFnU2hvd01pbmltYXAsXG4gICAgZHJhZ1Nob3dNaW5pbWFwUHJvbXB0LFxuICAgIGRyYWdTa2VsZXRvbixcbiAgICBlbGVtZW50cyxcbiAgICBpc0RyYWdnaW5nLFxuICAgIHBlcnNwZWN0aXZlLFxuICAgIHdhc01heWJlQ29sbGFwc2VkLFxuICAgIGRyYWdNaW5pbWFwVHJhbnNpdGlvbixcbiAgICBkcmFnR3JvdXBSZWN0XG4gIH0gPSB0MSwgW3Jvb3RFbGVtZW50LCBzZXRSb290RWxlbWVudF0gPSB1c2VTdGF0ZShudWxsKSwgW292ZXJsYXlFbmFibGVkLCBzZXRPdmVybGF5RW5hYmxlZF0gPSB1c2VTdGF0ZSghMCk7XG4gIGxldCB0MiwgdDM7XG4gICRbMV0gIT09IGNvbWxpbmsgPyAodDIgPSAoKSA9PiB7XG4gICAgY29uc3QgdW5zdWJzID0gW2NvbWxpbms/Lm9uKFwicHJlc2VudGF0aW9uL2ZvY3VzXCIsIChkYXRhKSA9PiB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFwicHJlc2VudGF0aW9uL2ZvY3VzXCIsXG4gICAgICAgIGRhdGFcbiAgICAgIH0pO1xuICAgIH0pLCBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9ibHVyXCIsIChkYXRhXzApID0+IHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogXCJwcmVzZW50YXRpb24vYmx1clwiLFxuICAgICAgICBkYXRhOiBkYXRhXzBcbiAgICAgIH0pO1xuICAgIH0pLCBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi90b2dnbGUtb3ZlcmxheVwiLCAoKSA9PiB7XG4gICAgICBzZXRPdmVybGF5RW5hYmxlZChfdGVtcDIkMSk7XG4gICAgfSldLmZpbHRlcihCb29sZWFuKTtcbiAgICByZXR1cm4gKCkgPT4gdW5zdWJzLmZvckVhY2goX3RlbXAzKTtcbiAgfSwgdDMgPSBbY29tbGlua10sICRbMV0gPSBjb21saW5rLCAkWzJdID0gdDIsICRbM10gPSB0MykgOiAodDIgPSAkWzJdLCB0MyA9ICRbM10pLCB1c2VFZmZlY3QodDIsIHQzKSwgdXNlUGVyc3BlY3RpdmVTeW5jKGNvbWxpbmssIGRpc3BhdGNoKSwgdXNlUmVwb3J0RG9jdW1lbnRzKGNvbWxpbmssIGVsZW1lbnRzLCBwZXJzcGVjdGl2ZSk7XG4gIGxldCB0NDtcbiAgJFs0XSAhPT0gcm9vdEVsZW1lbnQgPyAodDQgPSAoeCwgeSkgPT4ge1xuICAgIHJvb3RFbGVtZW50ICYmIChyb290RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZHJhZy1wcmV2aWV3LXhcIiwgYCR7eH1weGApLCByb290RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZHJhZy1wcmV2aWV3LXlcIiwgYCR7eSAtIHdpbmRvdy5zY3JvbGxZfXB4YCkpO1xuICB9LCAkWzRdID0gcm9vdEVsZW1lbnQsICRbNV0gPSB0NCkgOiB0NCA9ICRbNV07XG4gIGNvbnN0IHVwZGF0ZURyYWdQcmV2aWV3Q3VzdG9tUHJvcHMgPSB0NDtcbiAgbGV0IHQ1LCB0NjtcbiAgJFs2XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDUgPSAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2xpY2sgPSBfdGVtcDQsIGhhbmRsZUtleVVwID0gKGUpID0+IHtcbiAgICAgIGlzQWx0S2V5KGUpICYmIHNldE92ZXJsYXlFbmFibGVkKF90ZW1wNSk7XG4gICAgfSwgaGFuZGxlS2V5ZG93biA9IChlXzApID0+IHtcbiAgICAgIGlzQWx0S2V5KGVfMCkgJiYgc2V0T3ZlcmxheUVuYWJsZWQoX3RlbXA2KSwgaXNIb3RrZXkoW1wibW9kXCIsIFwiXFxcXFwiXSwgZV8wKSAmJiBzZXRPdmVybGF5RW5hYmxlZChfdGVtcDcpO1xuICAgIH07XG4gICAgcmV0dXJuIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2spLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlS2V5ZG93biksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgaGFuZGxlS2V5VXApLCAoKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleWRvd24pLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUtleVVwKTtcbiAgICB9O1xuICB9LCB0NiA9IFtzZXRPdmVybGF5RW5hYmxlZF0sICRbNl0gPSB0NSwgJFs3XSA9IHQ2KSA6ICh0NSA9ICRbNl0sIHQ2ID0gJFs3XSksIHVzZUVmZmVjdCh0NSwgdDYpO1xuICBjb25zdCBbb3ZlcmxheXNGbGFzaCwgc2V0T3ZlcmxheXNGbGFzaF0gPSB1c2VTdGF0ZSghMSksIFtmYWRpbmdPdXQsIHNldEZhZGluZ091dF0gPSB1c2VTdGF0ZSghMSksIGZhZGVPdXRUaW1lb3V0UmVmID0gdXNlUmVmKHZvaWQgMCk7XG4gIGxldCB0NywgdDg7XG4gICRbOF0gIT09IG92ZXJsYXlFbmFibGVkID8gKHQ3ID0gKCkgPT4ge1xuICAgIGlmIChvdmVybGF5RW5hYmxlZClcbiAgICAgIHJldHVybiByYWYyKCgpID0+IHtcbiAgICAgICAgc2V0T3ZlcmxheXNGbGFzaCghMCksIHJhZjIoKCkgPT4ge1xuICAgICAgICAgIHNldEZhZGluZ091dCghMCksIGZhZGVPdXRUaW1lb3V0UmVmLmN1cnJlbnQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHNldEZhZGluZ091dCghMSksIHNldE92ZXJsYXlzRmxhc2goITEpO1xuICAgICAgICAgIH0sIDE1MDApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIGZhZGVPdXRUaW1lb3V0UmVmLmN1cnJlbnQgJiYgKGNsZWFyVGltZW91dChmYWRlT3V0VGltZW91dFJlZi5jdXJyZW50KSwgc2V0T3ZlcmxheXNGbGFzaCghMSksIHNldEZhZGluZ091dCghMSkpO1xuICB9LCB0OCA9IFtvdmVybGF5RW5hYmxlZF0sICRbOF0gPSBvdmVybGF5RW5hYmxlZCwgJFs5XSA9IHQ3LCAkWzEwXSA9IHQ4KSA6ICh0NyA9ICRbOV0sIHQ4ID0gJFsxMF0pLCB1c2VFZmZlY3QodDcsIHQ4KTtcbiAgbGV0IHQ5LCB0MTA7XG4gICRbMTFdICE9PSBlbGVtZW50cyA/ICh0MTAgPSBlbGVtZW50cy5mbGF0TWFwKF90ZW1wOCksICRbMTFdID0gZWxlbWVudHMsICRbMTJdID0gdDEwKSA6IHQxMCA9ICRbMTJdLCB0OSA9IHQxMDtcbiAgY29uc3QgZG9jdW1lbnRJZHMgPSB0OTtcbiAgbGV0IHQxMTtcbiAgJFsxM10gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxMSA9ICgpID0+IHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvYmx1clwiXG4gICAgfSk7XG4gIH0sICRbMTNdID0gdDExKSA6IHQxMSA9ICRbMTNdO1xuICBjb25zdCBjbG9zZUNvbnRleHRNZW51ID0gdDExLCBvcHRpbWlzdGljQWN0b3JSZWFkeSA9IHVzZU9wdGltaXN0aWNBY3RvclJlYWR5KCk7XG4gIGxldCB0MTI7XG4gIHQxMiA9IG9wdGltaXN0aWNBY3RvclJlYWR5ID8gX2NvbXBvbmVudFJlc29sdmVyIDogdm9pZCAwO1xuICBjb25zdCBjb21wb25lbnRSZXNvbHZlciA9IHQxMjtcbiAgbGV0IHQxMztcbiAgYmIwOiB7XG4gICAgaWYgKChpbkZyYW1lIHx8IGluUG9wVXApICYmIGNvbWxpbmtTdGF0dXMgIT09IFwiY29ubmVjdGVkXCIgfHwgaXNEcmFnZ2luZykge1xuICAgICAgbGV0IHQxNDM7XG4gICAgICAkWzE0XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDE0MyA9IFtdLCAkWzE0XSA9IHQxNDMpIDogdDE0MyA9ICRbMTRdLCB0MTMgPSB0MTQzO1xuICAgICAgYnJlYWsgYmIwO1xuICAgIH1cbiAgICBsZXQgdDE0MjtcbiAgICAkWzE1XSAhPT0gY29tbGluayB8fCAkWzE2XSAhPT0gY29tcG9uZW50UmVzb2x2ZXIgfHwgJFsxN10gIT09IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiB8fCAkWzE4XSAhPT0gZHJhZ1Nob3dNaW5pbWFwIHx8ICRbMTldICE9PSBlbGVtZW50cyB8fCAkWzIwXSAhPT0gaW5GcmFtZSB8fCAkWzIxXSAhPT0gaXNEcmFnZ2luZyB8fCAkWzIyXSAhPT0gb3B0aW1pc3RpY0FjdG9yUmVhZHkgfHwgJFsyM10gIT09IHByb3BzLnBsdWdpbnMgfHwgJFsyNF0gIT09IHdhc01heWJlQ29sbGFwc2VkID8gKHQxNDIgPSBlbGVtZW50cy5maWx0ZXIoX3RlbXA5KS5tYXAoKHQxNTIpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaWQsXG4gICAgICAgIGVsZW1lbnQ6IGVsZW1lbnRfMCxcbiAgICAgICAgZm9jdXNlZCxcbiAgICAgICAgaG92ZXJlZCxcbiAgICAgICAgcmVjdCxcbiAgICAgICAgc2FuaXR5LFxuICAgICAgICBkcmFnRGlzYWJsZWQsXG4gICAgICAgIHRhcmdldHMsXG4gICAgICAgIGVsZW1lbnRUeXBlXG4gICAgICB9ID0gdDE1MiwgZHJhZ2dhYmxlID0gIWRyYWdEaXNhYmxlZCAmJiAhIWVsZW1lbnRfMC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eVwiKSAmJiBvcHRpbWlzdGljQWN0b3JSZWFkeSAmJiBlbGVtZW50cy5zb21lKChlXzIpID0+IFwiaWRcIiBpbiBlXzIuc2FuaXR5ICYmIFwiaWRcIiBpbiBzYW5pdHkgPyBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXkoZV8yLnNhbml0eSwgc2FuaXR5KSAmJiBlXzIuc2FuaXR5LnBhdGggIT09IHNhbml0eS5wYXRoIDogITEpO1xuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goRWxlbWVudE92ZXJsYXksIHsgY29tbGluaywgY29tcG9uZW50UmVzb2x2ZXIsIHBsdWdpbnM6IHByb3BzLnBsdWdpbnMsIGVsZW1lbnQ6IGVsZW1lbnRfMCwgZW5hYmxlU2Nyb2xsSW50b1ZpZXc6ICFpc0RyYWdnaW5nICYmICFkcmFnTWluaW1hcFRyYW5zaXRpb24gJiYgIWRyYWdTaG93TWluaW1hcCwgaWQsIGZvY3VzZWQsIGhvdmVyZWQsIG5vZGU6IHNhbml0eSwgcmVjdCwgc2hvd0FjdGlvbnM6ICFpbkZyYW1lLCBkcmFnZ2FibGUsIGlzRHJhZ2dpbmc6IGlzRHJhZ2dpbmcgfHwgZHJhZ01pbmltYXBUcmFuc2l0aW9uLCB3YXNNYXliZUNvbGxhcHNlZDogZm9jdXNlZCAmJiB3YXNNYXliZUNvbGxhcHNlZCwgdGFyZ2V0cywgZWxlbWVudFR5cGUgfSwgaWQpO1xuICAgIH0pLCAkWzE1XSA9IGNvbWxpbmssICRbMTZdID0gY29tcG9uZW50UmVzb2x2ZXIsICRbMTddID0gZHJhZ01pbmltYXBUcmFuc2l0aW9uLCAkWzE4XSA9IGRyYWdTaG93TWluaW1hcCwgJFsxOV0gPSBlbGVtZW50cywgJFsyMF0gPSBpbkZyYW1lLCAkWzIxXSA9IGlzRHJhZ2dpbmcsICRbMjJdID0gb3B0aW1pc3RpY0FjdG9yUmVhZHksICRbMjNdID0gcHJvcHMucGx1Z2lucywgJFsyNF0gPSB3YXNNYXliZUNvbGxhcHNlZCwgJFsyNV0gPSB0MTQyKSA6IHQxNDIgPSAkWzI1XSwgdDEzID0gdDE0MjtcbiAgfVxuICBjb25zdCBlbGVtZW50c1RvUmVuZGVyID0gdDEzLCB0MTQgPSBwcmVmZXJzRGFyayA/IFwiZGFya1wiIDogXCJsaWdodFwiLCB0MTUgPSBmYWRpbmdPdXQgPyBcIlwiIDogdm9pZCAwLCB0MTYgPSBvdmVybGF5c0ZsYXNoID8gXCJcIiA6IHZvaWQgMDtcbiAgbGV0IHQxNztcbiAgJFsyNl0gIT09IGRvY3VtZW50SWRzIHx8ICRbMjddICE9PSBwZXJzcGVjdGl2ZSA/ICh0MTcgPSAvKiBAX19QVVJFX18gKi8ganN4KERvY3VtZW50UmVwb3J0ZXIsIHsgZG9jdW1lbnRJZHMsIHBlcnNwZWN0aXZlIH0pLCAkWzI2XSA9IGRvY3VtZW50SWRzLCAkWzI3XSA9IHBlcnNwZWN0aXZlLCAkWzI4XSA9IHQxNykgOiB0MTcgPSAkWzI4XTtcbiAgbGV0IHQxODtcbiAgJFsyOV0gIT09IGNvbWxpbmsgfHwgJFszMF0gIT09IGluRnJhbWUgfHwgJFszMV0gIT09IGluUG9wVXAgfHwgJFszMl0gIT09IG92ZXJsYXlFbmFibGVkIHx8ICRbMzNdICE9PSByb290RWxlbWVudCB8fCAkWzM0XSAhPT0gdXBkYXRlRHJhZ1ByZXZpZXdDdXN0b21Qcm9wcyA/ICh0MTggPSAvKiBAX19QVVJFX18gKi8ganN4KE92ZXJsYXlzQ29udHJvbGxlciwgeyBjb21saW5rLCBkaXNwYXRjaCwgaW5GcmFtZSwgaW5Qb3BVcCwgb25EcmFnOiB1cGRhdGVEcmFnUHJldmlld0N1c3RvbVByb3BzLCBvdmVybGF5RW5hYmxlZCwgcm9vdEVsZW1lbnQgfSksICRbMjldID0gY29tbGluaywgJFszMF0gPSBpbkZyYW1lLCAkWzMxXSA9IGluUG9wVXAsICRbMzJdID0gb3ZlcmxheUVuYWJsZWQsICRbMzNdID0gcm9vdEVsZW1lbnQsICRbMzRdID0gdXBkYXRlRHJhZ1ByZXZpZXdDdXN0b21Qcm9wcywgJFszNV0gPSB0MTgpIDogdDE4ID0gJFszNV07XG4gIGxldCB0MTk7XG4gICRbMzZdICE9PSBjb250ZXh0TWVudSA/ICh0MTkgPSBjb250ZXh0TWVudSAmJiAvKiBAX19QVVJFX18gKi8ganN4KENvbnRleHRNZW51LCB7IC4uLmNvbnRleHRNZW51LCBvbkRpc21pc3M6IGNsb3NlQ29udGV4dE1lbnUgfSksICRbMzZdID0gY29udGV4dE1lbnUsICRbMzddID0gdDE5KSA6IHQxOSA9ICRbMzddO1xuICBsZXQgdDIwO1xuICAkWzM4XSAhPT0gZHJhZ0dyb3VwUmVjdCB8fCAkWzM5XSAhPT0gZHJhZ0luc2VydFBvc2l0aW9uIHx8ICRbNDBdICE9PSBkcmFnTWluaW1hcFRyYW5zaXRpb24gfHwgJFs0MV0gIT09IGRyYWdTaG93TWluaW1hcFByb21wdCB8fCAkWzQyXSAhPT0gaXNEcmFnZ2luZyA/ICh0MjAgPSBpc0RyYWdnaW5nICYmICFkcmFnTWluaW1hcFRyYW5zaXRpb24gJiYgLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb24gJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5RHJhZ0luc2VydE1hcmtlciwgeyBkcmFnSW5zZXJ0UG9zaXRpb24gfSksXG4gICAgZHJhZ1Nob3dNaW5pbWFwUHJvbXB0ICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goT3ZlcmxheU1pbmltYXBQcm9tcHQsIHt9KSxcbiAgICBkcmFnR3JvdXBSZWN0ICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goT3ZlcmxheURyYWdHcm91cFJlY3QsIHsgZHJhZ0dyb3VwUmVjdCB9KVxuICBdIH0pLCAkWzM4XSA9IGRyYWdHcm91cFJlY3QsICRbMzldID0gZHJhZ0luc2VydFBvc2l0aW9uLCAkWzQwXSA9IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiwgJFs0MV0gPSBkcmFnU2hvd01pbmltYXBQcm9tcHQsICRbNDJdID0gaXNEcmFnZ2luZywgJFs0M10gPSB0MjApIDogdDIwID0gJFs0M107XG4gIGxldCB0MjE7XG4gICRbNDRdICE9PSBkcmFnU2tlbGV0b24gfHwgJFs0NV0gIT09IGlzRHJhZ2dpbmcgPyAodDIxID0gaXNEcmFnZ2luZyAmJiBkcmFnU2tlbGV0b24gJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5RHJhZ1ByZXZpZXcsIHsgc2tlbGV0b246IGRyYWdTa2VsZXRvbiB9KSwgJFs0NF0gPSBkcmFnU2tlbGV0b24sICRbNDVdID0gaXNEcmFnZ2luZywgJFs0Nl0gPSB0MjEpIDogdDIxID0gJFs0Nl07XG4gIGxldCB0MjI7XG4gICRbNDddICE9PSBlbGVtZW50c1RvUmVuZGVyIHx8ICRbNDhdICE9PSB0MTUgfHwgJFs0OV0gIT09IHQxNiB8fCAkWzUwXSAhPT0gdDE3IHx8ICRbNTFdICE9PSB0MTggfHwgJFs1Ml0gIT09IHQxOSB8fCAkWzUzXSAhPT0gdDIwIHx8ICRbNTRdICE9PSB0MjEgfHwgJFs1NV0gIT09IHpJbmRleCA/ICh0MjIgPSAvKiBAX19QVVJFX18gKi8ganN4cyhSb290LCB7IFwiZGF0YS1mYWRpbmctb3V0XCI6IHQxNSwgXCJkYXRhLW92ZXJsYXlzXCI6IHQxNiwgcmVmOiBzZXRSb290RWxlbWVudCwgJHpJbmRleDogekluZGV4LCBjaGlsZHJlbjogW1xuICAgIHQxNyxcbiAgICB0MTgsXG4gICAgdDE5LFxuICAgIGVsZW1lbnRzVG9SZW5kZXIsXG4gICAgdDIwLFxuICAgIHQyMVxuICBdIH0pLCAkWzQ3XSA9IGVsZW1lbnRzVG9SZW5kZXIsICRbNDhdID0gdDE1LCAkWzQ5XSA9IHQxNiwgJFs1MF0gPSB0MTcsICRbNTFdID0gdDE4LCAkWzUyXSA9IHQxOSwgJFs1M10gPSB0MjAsICRbNTRdID0gdDIxLCAkWzU1XSA9IHpJbmRleCwgJFs1Nl0gPSB0MjIpIDogdDIyID0gJFs1Nl07XG4gIGxldCB0MjM7XG4gICRbNTddICE9PSBjb21saW5rIHx8ICRbNThdICE9PSB0MjIgPyAodDIzID0gLyogQF9fUFVSRV9fICovIGpzeChTaGFyZWRTdGF0ZVByb3ZpZGVyLCB7IGNvbWxpbmssIGNoaWxkcmVuOiB0MjIgfSksICRbNTddID0gY29tbGluaywgJFs1OF0gPSB0MjIsICRbNTldID0gdDIzKSA6IHQyMyA9ICRbNTldO1xuICBsZXQgdDI0O1xuICAkWzYwXSAhPT0gY29tbGluayB8fCAkWzYxXSAhPT0gdDIzID8gKHQyNCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUHJldmlld1NuYXBzaG90c1Byb3ZpZGVyLCB7IGNvbWxpbmssIGNoaWxkcmVuOiB0MjMgfSksICRbNjBdID0gY29tbGluaywgJFs2MV0gPSB0MjMsICRbNjJdID0gdDI0KSA6IHQyNCA9ICRbNjJdO1xuICBsZXQgdDI1O1xuICAkWzYzXSAhPT0gY29tbGluayB8fCAkWzY0XSAhPT0gZWxlbWVudHMgfHwgJFs2NV0gIT09IHQyNCA/ICh0MjUgPSAvKiBAX19QVVJFX18gKi8ganN4KFNjaGVtYVByb3ZpZGVyLCB7IGNvbWxpbmssIGVsZW1lbnRzLCBjaGlsZHJlbjogdDI0IH0pLCAkWzYzXSA9IGNvbWxpbmssICRbNjRdID0gZWxlbWVudHMsICRbNjVdID0gdDI0LCAkWzY2XSA9IHQyNSkgOiB0MjUgPSAkWzY2XTtcbiAgbGV0IHQyNjtcbiAgJFs2N10gIT09IHJvb3RFbGVtZW50IHx8ICRbNjhdICE9PSB0MjUgPyAodDI2ID0gLyogQF9fUFVSRV9fICovIGpzeChMYXllclByb3ZpZGVyLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFBvcnRhbFByb3ZpZGVyLCB7IGVsZW1lbnQ6IHJvb3RFbGVtZW50LCBjaGlsZHJlbjogdDI1IH0pIH0pLCAkWzY3XSA9IHJvb3RFbGVtZW50LCAkWzY4XSA9IHQyNSwgJFs2OV0gPSB0MjYpIDogdDI2ID0gJFs2OV07XG4gIGxldCB0Mjc7XG4gICRbNzBdICE9PSB0MTQgfHwgJFs3MV0gIT09IHQyNiA/ICh0MjcgPSAvKiBAX19QVVJFX18gKi8ganN4KFRoZW1lUHJvdmlkZXIsIHsgc2NoZW1lOiB0MTQsIHRoZW1lOiBzdHVkaW9UaGVtZSwgdG9uZTogXCJ0cmFuc3BhcmVudFwiLCBjaGlsZHJlbjogdDI2IH0pLCAkWzcwXSA9IHQxNCwgJFs3MV0gPSB0MjYsICRbNzJdID0gdDI3KSA6IHQyNyA9ICRbNzJdO1xuICBsZXQgdDI4O1xuICByZXR1cm4gJFs3M10gIT09IGNvbWxpbmsgfHwgJFs3NF0gIT09IHQyNyA/ICh0MjggPSAvKiBAX19QVVJFX18gKi8ganN4KFRlbGVtZXRyeVByb3ZpZGVyLCB7IGNvbWxpbmssIGNoaWxkcmVuOiB0MjcgfSksICRbNzNdID0gY29tbGluaywgJFs3NF0gPSB0MjcsICRbNzVdID0gdDI4KSA6IHQyOCA9ICRbNzVdLCB0Mjg7XG59LCBJU19NQUMgPSB0eXBlb2Ygd2luZG93IDwgXCJ1XCIgJiYgL01hY3xpUG9kfGlQaG9uZXxpUGFkLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0pLCBNT0RJRklFUlMgPSB7XG4gIGFsdDogXCJhbHRLZXlcIixcbiAgY3RybDogXCJjdHJsS2V5XCIsXG4gIG1vZDogSVNfTUFDID8gXCJtZXRhS2V5XCIgOiBcImN0cmxLZXlcIixcbiAgc2hpZnQ6IFwic2hpZnRLZXlcIlxufTtcbmZ1bmN0aW9uIGlzSG90a2V5KGtleXMsIGV2ZW50KSB7XG4gIHJldHVybiBrZXlzLmV2ZXJ5KChrZXkpID0+IE1PRElGSUVSU1trZXldID8gZXZlbnRbTU9ESUZJRVJTW2tleV1dIDogZXZlbnQua2V5ID09PSBrZXkudG9VcHBlckNhc2UoKSk7XG59XG5mdW5jdGlvbiBpc0FsdEtleShldmVudCkge1xuICByZXR1cm4gZXZlbnQua2V5ID09PSBcIkFsdFwiO1xufVxuZnVuY3Rpb24gX3RlbXAkMihhY2MsIHByZXZJZCkge1xuICByZXR1cm4gYWNjLmZpbHRlcigoaWQpID0+IGlkICE9PSBwcmV2SWQpO1xufVxuZnVuY3Rpb24gX3RlbXAyJDEoZW5hYmxlZCkge1xuICByZXR1cm4gIWVuYWJsZWQ7XG59XG5mdW5jdGlvbiBfdGVtcDModW5zdWIpIHtcbiAgcmV0dXJuIHVuc3ViKCk7XG59XG5mdW5jdGlvbiBfdGVtcDQoZXZlbnQpIHtcbiAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICBpZiAoKGlzSFRNTEFuY2hvckVsZW1lbnQodGFyZ2V0KSB8fCBpc0hUTUxFbGVtZW50KHRhcmdldCkgJiYgdGFyZ2V0LmNsb3Nlc3QoXCJhXCIpKSAmJiBldmVudC5hbHRLZXkpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBjb25zdCBuZXdFdmVudCA9IG5ldyBNb3VzZUV2ZW50KGV2ZW50LnR5cGUsIHtcbiAgICAgIC4uLmV2ZW50LFxuICAgICAgYWx0S2V5OiAhMSxcbiAgICAgIGJ1YmJsZXM6ICEwLFxuICAgICAgY2FuY2VsYWJsZTogITBcbiAgICB9KTtcbiAgICBldmVudC50YXJnZXQ/LmRpc3BhdGNoRXZlbnQobmV3RXZlbnQpO1xuICB9XG59XG5mdW5jdGlvbiBfdGVtcDUoZW5hYmxlZF8wKSB7XG4gIHJldHVybiAhZW5hYmxlZF8wO1xufVxuZnVuY3Rpb24gX3RlbXA2KGVuYWJsZWRfMSkge1xuICByZXR1cm4gIWVuYWJsZWRfMTtcbn1cbmZ1bmN0aW9uIF90ZW1wNyhlbmFibGVkXzIpIHtcbiAgcmV0dXJuICFlbmFibGVkXzI7XG59XG5mdW5jdGlvbiBfdGVtcDgoZWxlbWVudCkge1xuICByZXR1cm4gXCJpZFwiIGluIGVsZW1lbnQuc2FuaXR5ID8gW2VsZW1lbnQuc2FuaXR5LmlkXSA6IFtdO1xufVxuZnVuY3Rpb24gX3RlbXA5KGVfMSkge1xuICByZXR1cm4gZV8xLmFjdGl2YXRlZCB8fCBlXzEuZm9jdXNlZDtcbn1cbmNvbnN0IFJlZnJlc2ggPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoNCksIHtcbiAgICBjb21saW5rLFxuICAgIHJlZnJlc2hcbiAgfSA9IHByb3BzLCBtYW51YWxSZWZyZXNoUmVmID0gdXNlUmVmKDApLCBtdXRhdGlvblJlZnJlc2hSZWYgPSB1c2VSZWYoMCk7XG4gIGxldCB0MCwgdDE7XG4gIHJldHVybiAkWzBdICE9PSBjb21saW5rIHx8ICRbMV0gIT09IHJlZnJlc2ggPyAodDAgPSAoKSA9PiBjb21saW5rLm9uKFwicHJlc2VudGF0aW9uL3JlZnJlc2hcIiwgKGRhdGEpID0+IHtcbiAgICBpZiAoZGF0YS5zb3VyY2UgPT09IFwibWFudWFsXCIpIHtcbiAgICAgIGNsZWFyVGltZW91dChtYW51YWxSZWZyZXNoUmVmLmN1cnJlbnQpO1xuICAgICAgY29uc3QgcHJvbWlzZSA9IHJlZnJlc2goZGF0YSk7XG4gICAgICBpZiAocHJvbWlzZSA9PT0gITEpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hpbmdcIiwgZGF0YSk7XG4gICAgICBsZXQgdGltZWRPdXQgPSAhMTtcbiAgICAgIG1hbnVhbFJlZnJlc2hSZWYuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpLCB0aW1lZE91dCA9ICEwO1xuICAgICAgfSwgM2UzKSwgcHJvbWlzZT8uZmluYWxseT8uKCgpID0+IHtcbiAgICAgICAgdGltZWRPdXQgfHwgKGNsZWFyVGltZW91dChtYW51YWxSZWZyZXNoUmVmLmN1cnJlbnQpLCBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9yZWZyZXNoZWRcIiwgZGF0YSkpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhLnNvdXJjZSA9PT0gXCJtdXRhdGlvblwiKSB7XG4gICAgICBjbGVhclRpbWVvdXQobXV0YXRpb25SZWZyZXNoUmVmLmN1cnJlbnQpO1xuICAgICAgY29uc3QgcHJvbWlzZV8wID0gcmVmcmVzaChkYXRhKTtcbiAgICAgIGlmIChwcm9taXNlXzAgPT09ICExKVxuICAgICAgICByZXR1cm47XG4gICAgICBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9yZWZyZXNoaW5nXCIsIGRhdGEpLCBtdXRhdGlvblJlZnJlc2hSZWYuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvbWlzZV8xID0gcmVmcmVzaChkYXRhKTtcbiAgICAgICAgcHJvbWlzZV8xICE9PSAhMSAmJiAoY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGluZ1wiLCBkYXRhKSwgcHJvbWlzZV8xPy5maW5hbGx5Py4oKCkgPT4ge1xuICAgICAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hlZFwiLCBkYXRhKTtcbiAgICAgICAgfSkgfHwgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpKTtcbiAgICAgIH0sIDFlMyksIHByb21pc2VfMD8uZmluYWxseT8uKCgpID0+IHtcbiAgICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpO1xuICAgICAgfSkgfHwgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpO1xuICAgIH1cbiAgfSksIHQxID0gW2NvbWxpbmssIHJlZnJlc2hdLCAkWzBdID0gY29tbGluaywgJFsxXSA9IHJlZnJlc2gsICRbMl0gPSB0MCwgJFszXSA9IHQxKSA6ICh0MCA9ICRbMl0sIHQxID0gJFszXSksIHVzZUVmZmVjdCh0MCwgdDEpLCBudWxsO1xufTtcbmZ1bmN0aW9uIHVzZUNvbWxpbmsodDApIHtcbiAgY29uc3QgJCA9IGMoOSksIGFjdGl2ZSA9IHQwID09PSB2b2lkIDAgPyAhMCA6IHQwLCBbbm9kZSwgc2V0Tm9kZV0gPSB1c2VTdGF0ZSgpLCBbc3RhdHVzLCBzZXRTdGF0dXNdID0gdXNlU3RhdGUoXCJpZGxlXCIpO1xuICBsZXQgdDEsIHQyO1xuICAkWzBdICE9PSBhY3RpdmUgPyAodDEgPSAoKSA9PiB7XG4gICAgaWYgKCFhY3RpdmUpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgaW5zdGFuY2UgPSBjcmVhdGVOb2RlKHtcbiAgICAgIG5hbWU6IFwidmlzdWFsLWVkaXRpbmdcIixcbiAgICAgIGNvbm5lY3RUbzogXCJwcmVzZW50YXRpb25cIlxuICAgIH0sIGNyZWF0ZU5vZGVNYWNoaW5lKCkucHJvdmlkZSh7XG4gICAgICBhY3RvcnM6IGNyZWF0ZUNvbXBhdGliaWxpdHlBY3RvcnMoKVxuICAgIH0pKSwgdW5zdWIgPSBpbnN0YW5jZS5vblN0YXR1cygoKSA9PiBzZXRTdGF0dXMoXCJjb25uZWN0ZWRcIiksIFwiY29ubmVjdGVkXCIpO1xuICAgIHNldE5vZGUoaW5zdGFuY2UpO1xuICAgIGNvbnN0IHN0b3AgPSBpbnN0YW5jZS5zdGFydCgpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB1bnN1YigpLCBzdG9wKCksIHNldE5vZGUodm9pZCAwKTtcbiAgICB9O1xuICB9LCB0MiA9IFthY3RpdmVdLCAkWzBdID0gYWN0aXZlLCAkWzFdID0gdDEsICRbMl0gPSB0MikgOiAodDEgPSAkWzFdLCB0MiA9ICRbMl0pLCB1c2VFZmZlY3QodDEsIHQyKTtcbiAgbGV0IHQzLCB0NDtcbiAgJFszXSAhPT0gc3RhdHVzID8gKHQzID0gKCkgPT4ge1xuICAgIGlmIChzdGF0dXMgPT09IFwiY29ubmVjdGVkXCIpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICByZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIF90ZW1wJDEsIHtcbiAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICB9KSwgKCkgPT4ge1xuICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgIH07XG4gIH0sIHQ0ID0gW3N0YXR1c10sICRbM10gPSBzdGF0dXMsICRbNF0gPSB0MywgJFs1XSA9IHQ0KSA6ICh0MyA9ICRbNF0sIHQ0ID0gJFs1XSksIHVzZUVmZmVjdCh0MywgdDQpO1xuICBsZXQgdDU7XG4gIHJldHVybiAkWzZdICE9PSBub2RlIHx8ICRbN10gIT09IHN0YXR1cyA/ICh0NSA9IFtub2RlLCBzdGF0dXNdLCAkWzZdID0gbm9kZSwgJFs3XSA9IHN0YXR1cywgJFs4XSA9IHQ1KSA6IHQ1ID0gJFs4XSwgdDU7XG59XG5mdW5jdGlvbiBfdGVtcCQxKHQwKSB7XG4gIGNvbnN0IHtcbiAgICBkYXRhLFxuICAgIG9yaWdpblxuICB9ID0gdDA7XG4gIGRhdGEgJiYgdHlwZW9mIGRhdGEgPT0gXCJvYmplY3RcIiAmJiBcImRvbWFpblwiIGluIGRhdGEgJiYgZGF0YS5kb21haW4gPT09IFwic2FuaXR5L2NoYW5uZWxzXCIgJiYgXCJmcm9tXCIgaW4gZGF0YSAmJiBkYXRhLmZyb20gPT09IFwicHJlc2VudGF0aW9uXCIgJiYgXCJ0eXBlXCIgaW4gZGF0YSAmJiBkYXRhLnR5cGUgPT09IFwicHJlc2VudGF0aW9uL3N0YXR1c1wiICYmIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2Uoe1xuICAgIGRvbWFpbjogXCJzYW5pdHkvY2hhbm5lbHNcIixcbiAgICB0eXBlOiBcInZpc3VhbC1lZGl0aW5nL3N0YXR1c1wiLFxuICAgIGRhdGE6IHtcbiAgICAgIG9yaWdpbjogbG9jYXRpb24ub3JpZ2luXG4gICAgfVxuICB9LCBvcmlnaW4pO1xufVxuZnVuY3Rpb24gY3JlYXRlU2hhcmVkTGlzdGVuZXIoY29tbGluaykge1xuICBjb25zdCBpbmNvbWluZ0Nvbm5lY3Rpb24kID0gbmV3IFJlcGxheVN1YmplY3QoMSksIGluY29taW5nTXV0YXRpb25zJCA9IG5ldyBTdWJqZWN0KCk7XG4gIHJldHVybiBjb21saW5rLmZldGNoKFwidmlzdWFsLWVkaXRpbmcvc25hcHNob3Qtd2VsY29tZVwiLCB2b2lkIDAsIHtcbiAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgaW5jb21pbmdDb25uZWN0aW9uJC5uZXh0KGRhdGEuZXZlbnQpO1xuICB9KS5jYXRjaCgoKSA9PiB7XG4gIH0pLCBjb21saW5rLm9uKFwicHJlc2VudGF0aW9uL3NuYXBzaG90LWV2ZW50XCIsIChkYXRhKSA9PiB7XG4gICAgZGF0YS5ldmVudC50eXBlID09PSBcInJlY29ubmVjdFwiICYmIGluY29taW5nQ29ubmVjdGlvbiQubmV4dChkYXRhLmV2ZW50KSwgZGF0YS5ldmVudC50eXBlID09PSBcIm11dGF0aW9uXCIgJiYgaW5jb21pbmdNdXRhdGlvbnMkLm5leHQoZGF0YS5ldmVudCk7XG4gIH0pLCBtZXJnZShpbmNvbWluZ0Nvbm5lY3Rpb24kLCBpbmNvbWluZ011dGF0aW9ucyQpO1xufVxuZnVuY3Rpb24gdXNlRGF0YXNldE11dGF0b3IoY29tbGluaykge1xuICBjb25zdCAkID0gYygzKTtcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gY29tbGluayA/ICh0MCA9ICgpID0+IHtcbiAgICBpZiAoIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgbGlzdGVuZXIgPSBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjb21saW5rKSwgZGF0YXNldE11dGF0b3IgPSBjcmVhdGVEYXRhc2V0TXV0YXRvcihjb21saW5rKSwgbXV0YXRvciA9IGNyZWF0ZUFjdG9yKGRhdGFzZXRNdXRhdG9yLCB7XG4gICAgICBpbnB1dDoge1xuICAgICAgICBjbGllbnQ6IHtcbiAgICAgICAgICB3aXRoQ29uZmlnOiBfdGVtcFxuICAgICAgICB9LFxuICAgICAgICBzaGFyZWRMaXN0ZW5lcjogbGlzdGVuZXJcbiAgICAgIH1cbiAgICB9KTtcbiAgICBtdXRhdG9yLnN0YXJ0KCk7XG4gICAgY29uc3QgZmVhdHVyZXNGZXRjaCA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICByZXR1cm4gY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL2ZlYXR1cmVzXCIsIHZvaWQgMCwge1xuICAgICAgc2lnbmFsOiBmZWF0dXJlc0ZldGNoLnNpZ25hbCxcbiAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgZGF0YS5mZWF0dXJlcy5vcHRpbWlzdGljICYmIHNldEFjdG9yKG11dGF0b3IpO1xuICAgIH0pLmNhdGNoKF90ZW1wMiksICgpID0+IHtcbiAgICAgIG11dGF0b3Iuc3RvcCgpLCBmZWF0dXJlc0ZldGNoLmFib3J0KCk7XG4gICAgfTtcbiAgfSwgdDEgPSBbY29tbGlua10sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDAsICRbMl0gPSB0MSkgOiAodDAgPSAkWzFdLCB0MSA9ICRbMl0pLCB1c2VFZmZlY3QodDAsIHQxKTtcbn1cbmZ1bmN0aW9uIF90ZW1wMigpIHtcbiAgY29uc29sZS53YXJuKFwiW0BzYW5pdHkvdmlzdWFsLWVkaXRpbmddIFBhY2thZ2UgdmVyc2lvbiBtaXNtYXRjaCBkZXRlY3RlZDogUGxlYXNlIHVwZGF0ZSB5b3VyIFNhbml0eSBzdHVkaW8gdG8gcHJldmVudCBwb3RlbnRpYWwgY29tcGF0aWJpbGl0eSBpc3N1ZXMuXCIpO1xufVxuZnVuY3Rpb24gX3RlbXAoKSB7XG59XG5jb25zdCBWaXN1YWxFZGl0aW5nID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDIzKSwge1xuICAgIGNvbXBvbmVudHMsXG4gICAgcGx1Z2lucyxcbiAgICBoaXN0b3J5LFxuICAgIHBvcnRhbDogdDAsXG4gICAgcmVmcmVzaCxcbiAgICB6SW5kZXhcbiAgfSA9IHByb3BzLCBwb3J0YWwgPSB0MCA9PT0gdm9pZCAwID8gITAgOiB0MCwgW2luRnJhbWUsIHNldEluRnJhbWVdID0gdXNlU3RhdGUobnVsbCksIFtpblBvcFVwLCBzZXRJblBvcFVwXSA9IHVzZVN0YXRlKG51bGwpO1xuICBsZXQgdDEsIHQyO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9ICgpID0+IHtcbiAgICBzZXRJbkZyYW1lKGlzTWF5YmVQcmV2aWV3SWZyYW1lKCkpLCBzZXRJblBvcFVwKGlzTWF5YmVQcmV2aWV3V2luZG93KCkpO1xuICB9LCB0MiA9IFtdLCAkWzBdID0gdDEsICRbMV0gPSB0MikgOiAodDEgPSAkWzBdLCB0MiA9ICRbMV0pLCB1c2VFZmZlY3QodDEsIHQyKTtcbiAgY29uc3QgW3BvcnRhbEVsZW1lbnQsIHNldFBvcnRhbEVsZW1lbnRdID0gdXNlU3RhdGUobnVsbCk7XG4gIGxldCB0MywgdDQ7XG4gICRbMl0gIT09IHBvcnRhbCA/ICh0MyA9ICgpID0+IHtcbiAgICBpZiAocG9ydGFsID09PSAhMSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNhbml0eS12aXN1YWwtZWRpdGluZ1wiKTtcbiAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKG5vZGUpLCBzZXRQb3J0YWxFbGVtZW50KG5vZGUpLCAoKSA9PiB7XG4gICAgICBzZXRQb3J0YWxFbGVtZW50KG51bGwpLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSkgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKG5vZGUpO1xuICAgIH07XG4gIH0sIHQ0ID0gW3BvcnRhbF0sICRbMl0gPSBwb3J0YWwsICRbM10gPSB0MywgJFs0XSA9IHQ0KSA6ICh0MyA9ICRbM10sIHQ0ID0gJFs0XSksIHVzZUVmZmVjdCh0MywgdDQpO1xuICBjb25zdCBbY29tbGluaywgY29tbGlua1N0YXR1c10gPSB1c2VDb21saW5rKGluRnJhbWUgPT09ICEwIHx8IGluUG9wVXAgPT09ICEwKTtcbiAgdXNlRGF0YXNldE11dGF0b3IoY29tbGlua1N0YXR1cyA9PT0gXCJjb25uZWN0ZWRcIiA/IGNvbWxpbmsgOiB2b2lkIDApO1xuICBsZXQgdDU7XG4gICRbNV0gIT09IGNvbWxpbmsgfHwgJFs2XSAhPT0gY29tbGlua1N0YXR1cyB8fCAkWzddICE9PSBjb21wb25lbnRzIHx8ICRbOF0gIT09IGluRnJhbWUgfHwgJFs5XSAhPT0gaW5Qb3BVcCB8fCAkWzEwXSAhPT0gcGx1Z2lucyB8fCAkWzExXSAhPT0gekluZGV4ID8gKHQ1ID0gaW5GcmFtZSAhPT0gbnVsbCAmJiBpblBvcFVwICE9PSBudWxsICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goT3ZlcmxheXMsIHsgY29tbGluaywgY29tbGlua1N0YXR1cywgY29tcG9uZW50UmVzb2x2ZXI6IGNvbXBvbmVudHMsIHBsdWdpbnMsIGluRnJhbWUsIGluUG9wVXAsIHpJbmRleCB9KSwgJFs1XSA9IGNvbWxpbmssICRbNl0gPSBjb21saW5rU3RhdHVzLCAkWzddID0gY29tcG9uZW50cywgJFs4XSA9IGluRnJhbWUsICRbOV0gPSBpblBvcFVwLCAkWzEwXSA9IHBsdWdpbnMsICRbMTFdID0gekluZGV4LCAkWzEyXSA9IHQ1KSA6IHQ1ID0gJFsxMl07XG4gIGxldCB0NjtcbiAgJFsxM10gIT09IGNvbWxpbmsgfHwgJFsxNF0gIT09IGhpc3RvcnkgfHwgJFsxNV0gIT09IHJlZnJlc2ggPyAodDYgPSBjb21saW5rICYmIC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChIaXN0b3J5LCB7IGNvbWxpbmssIGhpc3RvcnkgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChNZXRhLCB7IGNvbWxpbmsgfSksXG4gICAgcmVmcmVzaCAmJiAvKiBAX19QVVJFX18gKi8ganN4KFJlZnJlc2gsIHsgY29tbGluaywgcmVmcmVzaCB9KVxuICBdIH0pLCAkWzEzXSA9IGNvbWxpbmssICRbMTRdID0gaGlzdG9yeSwgJFsxNV0gPSByZWZyZXNoLCAkWzE2XSA9IHQ2KSA6IHQ2ID0gJFsxNl07XG4gIGxldCB0NztcbiAgJFsxN10gIT09IHQ1IHx8ICRbMThdICE9PSB0NiA/ICh0NyA9IC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgdDUsXG4gICAgdDZcbiAgXSB9KSwgJFsxN10gPSB0NSwgJFsxOF0gPSB0NiwgJFsxOV0gPSB0NykgOiB0NyA9ICRbMTldO1xuICBjb25zdCBjaGlsZHJlbiA9IHQ3O1xuICBpZiAocG9ydGFsID09PSAhMSB8fCAhcG9ydGFsRWxlbWVudClcbiAgICByZXR1cm4gY2hpbGRyZW47XG4gIGxldCB0ODtcbiAgcmV0dXJuICRbMjBdICE9PSBjaGlsZHJlbiB8fCAkWzIxXSAhPT0gcG9ydGFsRWxlbWVudCA/ICh0OCA9IGNyZWF0ZVBvcnRhbChjaGlsZHJlbiwgcG9ydGFsRWxlbWVudCksICRbMjBdID0gY2hpbGRyZW4sICRbMjFdID0gcG9ydGFsRWxlbWVudCwgJFsyMl0gPSB0OCkgOiB0OCA9ICRbMjJdLCB0ODtcbn07XG5WaXN1YWxFZGl0aW5nLmRpc3BsYXlOYW1lID0gXCJWaXN1YWxFZGl0aW5nXCI7XG5leHBvcnQge1xuICBWaXN1YWxFZGl0aW5nLFxuICBjcmVhdGVEYXRhQXR0cmlidXRlLFxuICBjcmVhdGVEYXRhc2V0TXV0YXRvcixcbiAgY3JlYXRlRG9jdW1lbnRNdXRhdG9yLFxuICBlbXB0eUFjdG9yLFxuICB1c2VEb2N1bWVudHMsXG4gIHVzZU9wdGltaXN0aWMsXG4gIHVzZU9wdGltaXN0aWNBY3RvclxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/next-sanity/dist/visual-editing/server-actions.js":
/*!************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/server-actions.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   revalidateRootLayout: () => (/* binding */ revalidateRootLayout)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(action-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(action-browser)/./node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var next_cache_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/cache.js */ \"(action-browser)/./node_modules/next/cache.js\");\n/* harmony import */ var next_headers_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/headers.js */ \"(action-browser)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(action-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"ff49dcf5d2c6ac001bfbd839f9208853e1c73848\":\"revalidateRootLayout\"} */ \n\n\n\nasync function revalidateRootLayout() {\n    if (!(await (0,next_headers_js__WEBPACK_IMPORTED_MODULE_3__.draftMode)()).isEnabled) {\n        console.warn(\"Skipped revalidatePath request because draft mode is not enabled\");\n        return;\n    }\n    await (0,next_cache_js__WEBPACK_IMPORTED_MODULE_2__.revalidatePath)(\"/\", \"layout\");\n}\n //# sourceMappingURL=server-actions.js.map\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_4__.ensureServerEntryExports)([\n    revalidateRootLayout\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"ff49dcf5d2c6ac001bfbd839f9208853e1c73848\", revalidateRootLayout);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9kaXN0L3Zpc3VhbC1lZGl0aW5nL3NlcnZlci1hY3Rpb25zLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFJQSxlQUFzQkE7SUFDcEIsSUFBSSxFQUFFLE1BQU1DLDBEQUFTQSxFQUFULEVBQWFDLFNBQUEsRUFBVztRQUVsQ0MsUUFBUUMsSUFBQSxDQUFLO1FBQ2I7SUFDRjtJQUNBLE1BQU1DLDZEQUFjQSxDQUFDLEtBQUs7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmVkaWFuLW5ld3Nyb29tLy4uLy4uL3NyYy92aXN1YWwtZWRpdGluZy9zZXJ2ZXItYWN0aW9ucy9pbmRleC50cz84ZWVjIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuaW1wb3J0IHtyZXZhbGlkYXRlUGF0aH0gZnJvbSAnbmV4dC9jYWNoZS5qcydcbmltcG9ydCB7ZHJhZnRNb2RlfSBmcm9tICduZXh0L2hlYWRlcnMuanMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXZhbGlkYXRlUm9vdExheW91dCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCEoYXdhaXQgZHJhZnRNb2RlKCkpLmlzRW5hYmxlZCkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS53YXJuKCdTa2lwcGVkIHJldmFsaWRhdGVQYXRoIHJlcXVlc3QgYmVjYXVzZSBkcmFmdCBtb2RlIGlzIG5vdCBlbmFibGVkJylcbiAgICByZXR1cm5cbiAgfVxuICBhd2FpdCByZXZhbGlkYXRlUGF0aCgnLycsICdsYXlvdXQnKVxufVxuIl0sIm5hbWVzIjpbInJldmFsaWRhdGVSb290TGF5b3V0IiwiZHJhZnRNb2RlIiwiaXNFbmFibGVkIiwiY29uc29sZSIsIndhcm4iLCJyZXZhbGlkYXRlUGF0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/next-sanity/dist/visual-editing/server-actions.js\n");

/***/ })

};
;